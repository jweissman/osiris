{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/actors/Building/index.ts","webpack:///./src/values/Orientation.ts","webpack:///./src/Util.ts","webpack:///./src/models/Economy.ts","webpack:///./src/actors/Building/Building.ts","webpack:///./src/models/Structure.ts","webpack:///./src/models/Machine.ts","webpack:///./src/values/Scale.ts","webpack:///./src/actors/Building/CloneMatrixView.ts","webpack:///./src/actors/Building/ArcologyView.ts","webpack:///./src/values/Graph.ts","webpack:///./src/Game.ts","webpack:///./src/actors/Building/RefineryView.ts","webpack:///./src/actors/Building/StudyView.ts","webpack:///./src/actors/Building/PowerPlantView.ts","webpack:///./src/actors/Building/KitchenView.ts","webpack:///./src/actors/Building/SurfaceRoadView.ts","webpack:///./src/actors/Hud/ResourceListEntry.ts","webpack:///./src/actors/Hud/ResourcesList.ts","webpack:///./src/actors/Hud/Hud.ts","webpack:///./src/actors/Building/MineView.ts","webpack:///./src/actors/Building/LadderView.ts","webpack:///./src/actors/Building/LabView.ts","webpack:///./src/actors/Building/TunnelView.ts","webpack:///./src/actors/Building/MissionControlView.ts","webpack:///./src/actors/Building/DomeView.ts","webpack:///./src/actors/Building/CommonAreaView.ts","webpack:///./src/actors/Building/CorridorView.ts","webpack:///./src/actors/Device.ts","webpack:///./src/actors/player.ts","webpack:///./src/actors/Citizen.ts","webpack:///./src/actors/Planet/Population.ts","webpack:///./src/actors/Planet/NavigationTree.ts","webpack:///./src/images/stove-plain.svg","webpack:///./src/images/bench-simple-plain.svg","webpack:///./src/images/vat-plain.svg","webpack:///./src/images/bookshelf-plain.svg","webpack:///./src/actors/Planet/Colony.ts","webpack:///./src/actors/Planet/PlanetBackground.ts","webpack:///./src/actors/Planet/Planet.ts","webpack:///./src/scenes/Construct.ts","webpack:///./src/models/World.ts","webpack:///./src/images/bookshelf.png","webpack:///./src/images/sword.png","webpack:///./src/Resources.ts","webpack:///./src/index.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","1","exports","module","l","m","c","d","name","getter","o","defineProperty","configurable","enumerable","get","r","value","n","__esModule","default","object","property","p","jsonpArray","window","webpackJsonp","oldJsonpFunction","bind","slice","Building_1","Building","CorridorView_1","CorridorView","CommonAreaView_1","CommonAreaView","DomeView_1","DomeView","MissionControlView_1","MissionControlView","TunnelView_1","TunnelView","ArcologyView_1","ArcologyView","CloneMatrixView_1","CloneMatrixView","LabView_1","LabView","LadderView_1","LadderView","MineView_1","MineView","Orientation","Left","Up","Right","Down","compass","flip","orientation","Error","excalibur_1","extremumBy","arr","pluck","extremum","reduce","best","next","pair","_ecRange","a","minBy","fn","Math","min","maxBy","max","sample","floor","random","range","Array","fill","map","_val","idx","closest","cursor","getVector","predicate","matching","filter","elem","distance","flatSingle","concat","deleteByValue","e","eachCons","measureDistance","b","drawLine","ctx","lineWidth","Color","White","beginPath","moveTo","x","y","lineTo","strokeStyle","toRGBA","stroke","drawRect","rectangle","edgeWidth","color","width","height","edge","fillStyle","fillRect","main","PureValue","Power","Hope","Shelter","Oxygen","emptyMarket","supply","demand","ResourceBlock","Food","Ore","Data","Meal","Hypothesis","Mineral","blockColors","Green","Blue","Red","Yellow","darken","Violet","blockColor","block","desaturate","lighten","t","this","__extends","setPrototypeOf","__proto__","constructor","create","Orientation_1","Util_1","Graph_1","Device_1","_super","structure","planet","_this","origin","built","hover","showLabel","facing","hideBox","childrenBuildings","level","devices","step","anchor","Vector","setup","traits","trait","Traits","OffscreenCulling","on","console","log","building","collisionType","CollisionType","PreventCollision","nameLabel","Label","levelLabel","fontSize","levelUp","text","draw","delta","aabb","processedColor","forEach","device","pos","getCenter","measureText","update","engine","produce","constrainCursor","clone","reshape","afterConstruct","machines","machine_1","devicePlaces","place","theDevice","Device","add","handleClick","slots","nodes","getWidth","getHeight","graph","supergraph","Graph","g","rootNode","findOrCreate","_i","_a","child","slot","parentSlot","childNode","redeem","res","gather","populate","overlaps","other","rect1","rect2","overlapsAny","colony","buildings","find","bldg","edgeColor","mainColor","colorBase","clr","connections","findSlot","validConnections","slotList","dir","validStructures","flipped","closestBuildingByType","matchingSlot","compass_1","warn","alignToSlot","theSlot","offset","sub","addEqual","buildSlot","parent","Actor","Economy_1","Scale_1","Machine_1","major","Scale","minor","Structure","description","view","zoom","dominantColor","consumes","produces","productionTime","Corridor","Ladder","prereqs","MissionControl","arguments","third","SurfaceRoad","MainTunnel","CommandCenter","second","eighth","Dome","fourth","Orchard","Study","OxygenAccumulator","fifth","CloneMatrix","Kitchen","Laboratory","CommonArea","first","Arcology","sixth","ExperimentBench","Stove","Mine","Refinery","MiningDrill","SolarFarm","Bookshelf","MineralProcessor","PowerPlant","CloningVat","OxygenExtractor","SolarCell","MachineOperation","images","bookshelf","vat","bench","stove","Work","SpawnCitizen","CollectResource","Machine","LightGray","behavior","image","majorUnit","seventh","minorUnit","minorScale","drawShape","xoff","yoff","h","w","bezierCurveTo","empty","edges","edgesInverse","isEmpty","node","newNode","contains","testNode","includes","measure","tolerance","dfs","src","dst","indexOf","union","otherGraph","edgeList","theEdges","index","_b","_c","otherIndex","otherNode","adjacent","adjacentIndices","testNodeIndex","es","esInv","root","visited","rIndex","dfsIndex","rootIndex","childIndex","bfs","cb","bfsIndex","halt","visited_1","visitedNode","adj_1","adjacentNode","shortestPath","maxStep","prevStep","dstIndex","prev","curr","path","steps","srcIndex","reverse","Resources_1","Game","world","displayMode","DisplayMode","FullScreen","backgroundColor","skyColor","start","loader","Loader","key","Resources","addResource","citizenSpeed","Engine","_1","Structure_1","RefineryView","validConnectingStructures","StudyView","PowerPlantView","theSlots","slotY","leftSlot","rightSlot","KitchenView","SurfaceRoadView","ResourceListEntry","resourceBlock","icon","count","credit","amt","ResourceListEntry_1","ResourcesList","DarkGray","entries","resource","ry","entry","increment","ResourcesList_1","StatusAnalysisView","market","powerDemand","powerSupply","powerStatus","powerStatusLabel","Hud","game","onBuildingSelect","canvasWidth","canvasHeight","comprehendedStructures","messageLabel","_makePalette","resources","econ","statusY","status","setMessage","_paletteElement","left","canvas","offsetLeft","top_1","offsetTop","style","top","resourceGathered","updatePalette","bldgs","builtStructures","structuresForPalette","some","every","prereq","comprehended","parentElement","removeChild","document","createElement","id","position","border","body","appendChild","sort","_paletteButton","buttonFactory","onclick","bg","fg","paletteButton","textContent","display","fontFamily","fontWeight","padding","textTransform","background","onmouseover","onmouseleave","UIActor","floorHeight","originSlot","pickingOrigin","maxHeight","getTop","setHeight","rect","halfWidth","slotHeights","heights","y0","y1","btm","lst","right","slotCount","flagX","flagY","arc","PI","closePath","originX","newCursor","setWidth","abs","machine","initialPos","product","capacity","imageLoaded","Image","onload","drawImage","bx","by","produced","blockSize","interact","citizen","pop","progressBar","sent","carry","carrying","drop","setTimeout","ex","Player","Game_1","Citizen","walkSpeed","workInProgress","now","Date","getTime","progress","workStarted","workDuration","px","pw","py","strokeRect","vel","glideTo","actions","asPromise","duration","Promise","resolve","reject","pathTo","pathBetween","all","label","work","item","sinks","theSink","closestDevice","source","Citizen_1","Population","citizens","increase","home","NavigationTree","seekPath","dest","closestNode","NavigationTree_1","Colony","currentlyConstructing","maxPop","navTree","placeBuilding","buildNavTree","structureTypes","structureType","destination","srcNode","destNode","closestDeviceByType","machineTypes","ctrl","Mountains","peaks","onInitialize","xOff","peakDistance","times","heightRange","drift","baseColor","brightColor","saturate","yBase","peak","mtnWidth","PlanetBackground","PlanetBackground_1","Colony_1","Population_1","Planet","hud","depth","createLayer","layerHeight","population","size","theLayer","Planet_1","player_1","Hud_1","SurfaceRoadView_1","KitchenView_1","PowerPlantView_1","StudyView_1","RefineryView_1","Construct","dragging","startConstructing","player","prepareNextBuilding","camera","onActivate","input","pointers","primary","dragOrigin","currentBuilding","constrained","button","Input","PointerButton","placementValid","Middle","z","getZoom","deltaY","keyboard","Keys","H","move","onDeactivate","off","nextMissingRequiredStructure","requiredStructures","requiredStructureList","actualStructureNames","nextMissing","theNextOne","spawnBuilding","anotherBuilding","assembleBuildingFromStructure","structureViews","Scene","World","colors","Cyan","Vermillion","sword","Sword","Texture","World_1","Construct_1","theWorld","construct","then","goToScene"],"mappings":"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","file":"main.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t1: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([46,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import { Building } from './Building';\r\n\r\nimport { CorridorView } from './CorridorView';\r\nimport { CommonAreaView } from './CommonAreaView';\r\nimport { DomeView } from './DomeView';\r\nimport { MissionControlView } from './MissionControlView';\r\nimport { TunnelView } from './TunnelView';\r\nimport { ArcologyView } from './ArcologyView';\r\nimport { CloneMatrixView } from './CloneMatrixView';\r\nimport { LabView } from './LabView';\r\nimport { LadderView } from './LadderView';\r\nimport { MineView } from './MineView';\r\n\r\n\r\n// import { LivingQuartersView } from './LivingQuartersView';\r\n\r\nexport {\r\n    Building,\r\n\r\n    CorridorView, // as AccessTunnelView,\r\n    CommonAreaView,\r\n    DomeView,\r\n    MissionControlView,\r\n    TunnelView,\r\n    ArcologyView,\r\n    CloneMatrixView,\r\n    LabView,\r\n    LadderView,\r\n    MineView,\r\n\r\n}","\r\nexport enum Orientation { Left, Up, Right, Down } //, Angle }\r\n\r\nexport const compass = [\r\n    Orientation.Left,\r\n    Orientation.Right,\r\n    Orientation.Up,\r\n    Orientation.Down,\r\n]\r\n\r\n\r\nexport function flip(orientation: Orientation): Orientation {\r\n    switch (orientation) {\r\n        case Orientation.Left: return Orientation.Right\r\n        case Orientation.Right: return Orientation.Left\r\n        case Orientation.Up: return Orientation.Down\r\n        case Orientation.Down: return Orientation.Up\r\n    }\r\n    throw new Error(`Don't know orientation ${ orientation }`)\r\n}","import { Vector, Color } from \"excalibur\";\r\nimport { Rectangle } from \"./values/Rectangle\";\r\n\r\nconst extremumBy = (arr, pluck, extremum) => {\r\n  return arr.reduce(function(best, next) {\r\n    var pair = [ pluck(next), next ];\r\n    if (!best) {\r\n       return pair;\r\n    } else if (extremum.apply(null, [ best[0], pair[0] ]) == best[0]) {\r\n       return best;\r\n    } else {\r\n       return pair;\r\n    }\r\n  },null)[1];\r\n}\r\n\r\nexport const minBy = (arr, fn) => extremumBy(arr, fn, Math.min)\r\nexport const maxBy = (arr, fn) => extremumBy(arr, fn, Math.max)\r\n\r\n\r\nexport const sample = (arr) => arr[Math.floor(Math.random() * arr.length)]\r\n\r\nexport const range = (n) => Array(n).fill(0).map((_val,idx) => idx)\r\n\r\nexport function closest<T>(cursor: Vector, arr: Array<T>, getVector: (T) => Vector, predicate?: (T) => boolean) {\r\n   let matching: Array<T> = arr;\r\n   if (predicate) { arr = arr.filter(predicate) }\r\n   if (matching) {\r\n      let distanceToCursor = (elem: T) => cursor.distance(getVector(elem)) //vec) => cursor.distance(vec)\r\n      return minBy(matching, distanceToCursor)\r\n   }\r\n}\r\n\r\nexport const flatSingle = arr => [].concat(...arr);\r\n\r\nexport const deleteByValue = (arr, elem) => arr.filter(e => e !== elem)\r\n\r\nexport function eachCons(a, n) {\r\n  var r = []\r\n  for (var i = 0; i < a.length - n + 1; i++) {\r\n    r.push(_ecRange(a, i, n))\r\n  }\r\n  return r\r\n}\r\n\r\nfunction _ecRange (a, i, n) {\r\n  var r = []\r\n  for (var j = 0; j < n; j++) {\r\n    r.push(a[i + j])\r\n  }\r\n  return r\r\n}\r\n\r\nexport const measureDistance = (a: Vector, b: Vector) => a.distance(b)\r\n\r\n\r\n// tiny rendering lib\r\nexport function drawLine(ctx: CanvasRenderingContext2D, a: Vector, b: Vector, c: Color = Color.White, lineWidth: number = 1) {\r\n  c.a = 0.5\r\n  ctx.beginPath()\r\n  ctx.moveTo(a.x, a.y)\r\n  ctx.lineTo(b.x, b.y)\r\n  ctx.strokeStyle = c.toRGBA()\r\n  ctx.lineWidth = lineWidth\r\n  ctx.stroke()\r\n}\r\n\r\nexport function drawRect(ctx: CanvasRenderingContext2D, rectangle: Rectangle, edgeWidth: number = 0, color: Color = Color.White) {\r\n  let { x, y, width, height } = rectangle;\r\n\r\n  if (edgeWidth > 0) {\r\n    let edge = Color.White;\r\n    ctx.fillStyle = edge.toRGBA();\r\n    ctx.fillRect(x, y, width, height)\r\n  }\r\n\r\n  let main = color;\r\n  ctx.fillStyle = main.toRGBA();\r\n  ctx.fillRect(\r\n    x + edgeWidth,\r\n    y + edgeWidth,\r\n    width - edgeWidth * 2,\r\n    height - edgeWidth * 2\r\n  )\r\n}","import { Color } from \"excalibur\";\r\n\r\n// an abstract/intangible thing (or at least something we don't represent)\r\nexport enum PureValue {\r\n    Power = 'Power',\r\n    Hope = 'Hope',\r\n    Shelter = 'Shelter',\r\n    Oxygen = 'Oxygen',\r\n}\r\n\r\nexport type Economy = { [key in PureValue]: {\r\n    supply: number,\r\n    demand: number\r\n} }\r\n\r\nexport const emptyMarket : Economy = {\r\n    Power: {\r\n        supply: 0,\r\n        demand: 0\r\n    },\r\n    Hope: {\r\n        supply: 0,\r\n        demand: 0\r\n    },\r\n    Shelter: {\r\n        supply: 0,\r\n        demand: 0\r\n    },\r\n    Oxygen: {\r\n        supply: 0,\r\n        demand: 0\r\n    },\r\n}\r\n\r\nexport enum ResourceBlock {\r\n    // base\r\n    Food = 'Food',\r\n    Ore = 'Ore',\r\n    Data = 'Data',\r\n    // derived\r\n    Meal = 'Meal',\r\n    Hypothesis = 'Hypothesis',\r\n    Mineral = 'Mineral'\r\n}\r\n\r\nconst blockColors: { [key in ResourceBlock]: Color } = {\r\n    Food: Color.Green,\r\n    Data: Color.Blue,\r\n    Mineral: Color.Red,\r\n\r\n    Meal: Color.Yellow.darken(0.2),\r\n    Hypothesis: Color.Violet.darken(0.4),\r\n    Ore: Color.Red.darken(0.5),\r\n\r\n}\r\n\r\nexport function blockColor(block: ResourceBlock) {\r\n    let baseColor = blockColors[block]\r\n    //Color.Violet\r\n    //switch(block) {\r\n    //    case ResourceBlock.Food: baseColor = Color.Green; break\r\n    //    case ResourceBlock.Ore:  baseColor = Color.Red; break\r\n    //    case ResourceBlock.Data: baseColor = Color.Blue; break\r\n    //    case ResourceBlock.Meal: baseColor = Color.Yellow; break\r\n    //}\r\n    return baseColor.desaturate(0.25).lighten(0.125)\r\n}\r\n\r\n","import { Actor, Vector, CollisionType, Color, Label, Traits } from \"excalibur\";\r\nimport { Planet } from \"../Planet/Planet\";\r\nimport { Structure } from \"../../models/Structure\";\r\nimport { Slot } from \"../../values/Slot\";\r\nimport { Orientation, flip, compass } from \"../../values/Orientation\";\r\nimport { Citizen } from \"../Citizen\";\r\nimport { Game } from \"../../Game\";\r\nimport { Rectangle } from \"../../values/Rectangle\";\r\nimport { closest, measureDistance, drawRect, drawLine } from \"../../Util\";\r\nimport { Graph } from \"../../values/Graph\";\r\nimport { ResourceBlock, blockColor } from \"../../models/Economy\";\r\nimport { Device } from \"../Device\";\r\n\r\nexport class Building extends Actor {\r\n    edgeWidth: number = 0 //.1\r\n\r\n    nameLabel: Label\r\n    levelLabel: Label\r\n\r\n    built: boolean = false\r\n    hover: boolean = false\r\n    showLabel: boolean = false\r\n    facing: Orientation = Orientation.Right\r\n    hideBox: boolean = false\r\n    parentSlot: Slot\r\n    childrenBuildings: Building[] = []\r\n    //product: ResourceBlock[] = []\r\n    //capacity: number = 4\r\n\r\n    level: number = 1\r\n\r\n    devices: Device[] = []\r\n\r\n    // colorBase() { return this.color.darken(0.1); }\r\n\r\n    constructor(public structure: Structure, protected planet: Planet) {\r\n        super(\r\n          structure.origin.x,\r\n          structure.origin.y,\r\n          structure.width,\r\n          structure.height,\r\n          planet.color\r\n        )\r\n        this.anchor = new Vector(0,0)\r\n\r\n        this.setup();\r\n        this.traits = this.traits.filter(trait => !(trait instanceof Traits.OffscreenCulling))\r\n\r\n        this.on('pointerenter', () => {\r\n            this.hover = true\r\n            console.log(\"HOVER ON\", { building: this })\r\n        })\r\n\r\n        // this.on('pointerdown', () => {\r\n        //     console.log(\"CLICKED BUILDING\", { building: this })\r\n        //     this.levelUp();\r\n        // })\r\n\r\n        this.on('pointerleave', () => {\r\n            this.hover = false\r\n        })\r\n\r\n        this.collisionType = CollisionType.PreventCollision\r\n\r\n        this.nameLabel = new Label(this.structure.name, 0, 0, 'Helvetica')\r\n        // this.nameLabel.fontSize = 11\r\n        this.nameLabel.color = Color.White\r\n\r\n        this.levelLabel = new Label(`Lvl. ${this.level}`, 0, 0, 'Helvetica')\r\n        this.levelLabel.fontSize = 6\r\n        this.levelLabel.color = Color.White.darken(0.2)\r\n    }\r\n\r\n    levelUp() {\r\n        this.level += 1\r\n        this.levelLabel.text = `Lvl. ${this.level}`\r\n    }\r\n\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        if (!this.hideBox) {\r\n            drawRect(ctx, this.aabb(), this.edgeWidth, this.processedColor())\r\n        }\r\n        this.devices.forEach(device => device.draw(ctx, delta))\r\n\r\n        if (this.showLabel) {\r\n            this.nameLabel.pos = this.getCenter()\r\n            this.nameLabel.pos.x -= ctx.measureText(this.structure.name).width / 2\r\n            this.nameLabel.draw(ctx, delta)\r\n\r\n            // this.levelLabel.text = `Lvl. ${this.level}`\r\n            // this.levelLabel.pos = this.getCenter()\r\n            // this.levelLabel.pos.y += 10\r\n            // this.levelLabel.pos.x -= ctx.measureText(this.structure.name).width / 4\r\n            // this.levelLabel.draw(ctx, delta)\r\n        }\r\n\r\n        let debug = false;\r\n        if (debug) {\r\n            if (this.slots().length > 0) {\r\n                // draw slots\r\n                this.slots().forEach((slot: Slot) => {\r\n                    let rect: Rectangle = { x: slot.pos.x, y: slot.pos.y, width: 3, height: 3 }\r\n                    drawRect(ctx, rect, 1, Color.Gray.lighten(0.5))\r\n                })\r\n            }\r\n            if (this.nodes().length > 0) {\r\n                // draw nodes\r\n                this.nodes().forEach((node: Vector) => {\r\n                    let rect: Rectangle = { x: node.x, y: node.y, width: 4, height: 4 }\r\n                    drawRect(ctx, rect, 1, Color.Yellow.lighten(0.5))\r\n                })\r\n            }\r\n        }\r\n    }\r\n\r\n    step: number = 0\r\n    update(engine: Game, delta: number) {\r\n        super.update(engine, delta)\r\n        let tryProduce = this.built;\r\n        if (tryProduce) {\r\n            this.devices.forEach(device => device.produce(this.step));\r\n        }\r\n        this.step += 1\r\n    }\r\n\r\n    setup(): void {}\r\n\r\n    constrainCursor(cursor: Vector): Vector {\r\n        return cursor.clone();\r\n    } \r\n    reshape(cursor: Vector): void {\r\n        this.pos = cursor.clone()\r\n    }\r\n\r\n    afterConstruct(): void {\r\n\r\n        let { machines } = this.structure; \r\n        if (machines && machines.length > 0) {\r\n            let machine = new machines[0]();\r\n            this.devicePlaces().forEach(place => {\r\n                let theDevice = new Device(this, machine, place)\r\n                this.devices.push(theDevice)\r\n                this.add(theDevice)\r\n            })\r\n        }\r\n\r\n    }\r\n\r\n    handleClick(cursor: Vector): boolean { return true; }\r\n\r\n    slots(): Slot[] {\r\n        return []\r\n    }\r\n\r\n    nodes(): Vector[] {\r\n        let x = this.pos.x + this.getWidth()/2;\r\n        let y = this.pos.y + this.getHeight()\r\n        return [\r\n            new Vector(Math.floor(x), Math.floor(y)-4)\r\n        ];\r\n    }\r\n\r\n    devicePlaces(): Vector[] {\r\n        return this.nodes();\r\n    }\r\n    \r\n\r\n    graph(supergraph: Graph<Vector> = new Graph()): Graph<Vector> {\r\n        let g = supergraph\r\n        // assemble subgraph\r\n        let nodes = this.nodes()\r\n        let rootNode = g.findOrCreate(nodes[0], measureDistance)\r\n        for (let child of this.childrenBuildings) {\r\n            let slot = g.findOrCreate(child.parentSlot.pos, measureDistance)\r\n            g.edge(rootNode, slot)\r\n\r\n            let childNode = g.findOrCreate(child.nodes()[0], measureDistance)\r\n            g.edge(slot, childNode)\r\n\r\n            child.graph(g)\r\n        }\r\n        return g\r\n    }\r\n\r\n    // just a patch through to planet -- but could animate something here?\r\n    public redeem(res: ResourceBlock) {\r\n        this.planet.gather(res)\r\n    }\r\n\r\n    public populate(pos: Vector) {\r\n        this.planet.populate(pos) //this.pos)\r\n    }\r\n\r\n\r\n    protected aabb(): Rectangle {\r\n        return {\r\n            x: this.pos.x,\r\n            y: this.pos.y,\r\n            width: this.getWidth(),\r\n            height: this.getHeight()\r\n        }\r\n    }\r\n\r\n    protected overlaps(other: Building): boolean {\r\n        let rect1 = this.aabb(), rect2 = other.aabb();\r\n        let doesOverlap = (\r\n            rect1.x < rect2.x + rect2.width &&\r\n            rect1.x + rect1.width > rect2.x &&\r\n            rect1.y < rect2.y + rect2.height &&\r\n            rect1.y + rect1.height > rect2.y\r\n        )\r\n        return(!!doesOverlap);\r\n    }\r\n\r\n    public overlapsAny(): boolean {\r\n        return !!this.planet.colony.buildings.find(bldg => bldg !== this && this.overlaps(bldg))\r\n    }\r\n\r\n    protected edgeColor(): Color {\r\n        let edge = this.processedColor().lighten(0.85);\r\n        return edge;\r\n    }\r\n\r\n    protected mainColor(): Color {\r\n        let main = this.processedColor().darken(0.08);\r\n        return main;\r\n    }\r\n\r\n    protected colorBase(): Color {\r\n        return this.color;\r\n    }\r\n\r\n    protected processedColor(): Color {\r\n        let clr = this.colorBase().clone();\r\n        if (!this.built)  { \r\n            if (this.overlapsAny()) { clr = Color.Red }\r\n            clr.a = 0.8\r\n        }\r\n        if (this.hover) { clr.a = 0.5 }\r\n        return clr;\r\n    }\r\n\r\n    get connections() {\r\n        return this.structure.connections;\r\n    }\r\n\r\n\r\n    protected findSlot(\r\n        pos: Vector,\r\n        validConnections: { [key in Orientation]: (typeof Structure)[] } = this.connections\r\n    ): Slot {\r\n        let slotList = []\r\n            for (let dir of compass) {\r\n                const validStructures = validConnections[dir];\r\n                let flipped = flip(dir)\r\n                const buildings = validStructures.map(structure =>\r\n                    this.planet.closestBuildingByType(pos, [structure])\r\n                )\r\n                buildings.forEach(building => {\r\n                    if (building) {\r\n                        let neighborSlots = building.slots()\r\n                        neighborSlots.filter(slot => slot.facing === flipped)\r\n                        .forEach(matchingSlot => {\r\n                            slotList.push(matchingSlot)\r\n                        })\r\n                    }\r\n                })\r\n            }\r\n\r\n        if (slotList.length > 0) {\r\n            return closest(pos, slotList, (slot) => slot.pos)\r\n        } else {\r\n            console.warn('no conecting structures found')\r\n        }\r\n    }\r\n\r\n    protected alignToSlot(\r\n        cursor: Vector,\r\n        validConnections: { [key in Orientation]: (typeof Structure)[] } = this.connections\r\n    ) {\r\n        let theSlot = this.findSlot(cursor, validConnections)\r\n        if (theSlot) {\r\n            let matchingSlot = this.slots()\r\n                .find(s => s.facing == flip(theSlot.facing))\r\n            if (matchingSlot) {\r\n                let offset = theSlot.pos.sub(matchingSlot.pos)\r\n                this.pos.addEqual(offset)\r\n\r\n                this.parentSlot = theSlot;\r\n                return theSlot;\r\n            }\r\n        }\r\n    }\r\n\r\n    protected buildSlot(x: number, y: number, facing: Orientation = Orientation.Right): Slot {\r\n        return {\r\n            pos: new Vector(x,y),\r\n            facing,\r\n            parent: this\r\n        }\r\n    }\r\n}","import { Vector, Color } from 'excalibur';\r\nimport { ResourceBlock } from './Economy';\r\nimport { Scale } from '../values/Scale';\r\nimport { Orientation } from '../values/Orientation';\r\nimport { Machine, Orchard, ExperimentBench, Stove, MiningDrill, Bookshelf, MineralProcessor, CommandCenter, CloningVat, OxygenExtractor, SolarCell } from './Machine';\r\n\r\nconst { major, minor } = Scale\r\n\r\n\r\n\r\nexport class Structure {\r\n    name: string = '(structure name)';\r\n    description: string = '(structure description)';\r\n    view: string = '<structure (room) view>';\r\n    width: number = 10\r\n    height: number = 10\r\n    zoom: number = 1\r\n    dominantColor: Color = Color.White\r\n\r\n    consumes: ResourceBlock = null\r\n    produces: ResourceBlock = null\r\n    productionTime: number = 500\r\n\r\n    constructor(public origin: Vector = new Vector(0, 0)) { }\r\n\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Left]: [ Corridor ],\r\n        [Orientation.Right]: [ Corridor ],\r\n        [Orientation.Up]: [ Ladder ],\r\n        [Orientation.Down]: [ Ladder ],\r\n    }\r\n\r\n    machines: (typeof Machine)[] = []\r\n\r\n    prereqs: (typeof Structure)[] = []\r\n}\r\n\r\nexport class MissionControl extends Structure {\r\n    name: string = 'Mission Control';\r\n    description: string = 'Keeping everything on track';\r\n    view: string = 'MissionControlView';\r\n    width: number = 4 * major.third\r\n    height: number = 4 * minor.third\r\n    zoom = 0.1\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Left]: [ SurfaceRoad ],\r\n        [Orientation.Right]: [ SurfaceRoad ],\r\n        [Orientation.Up]: [ MainTunnel ],\r\n        [Orientation.Down]: [ MainTunnel ],\r\n    }\r\n\r\n    machines = [ CommandCenter ]\r\n}\r\n\r\nexport class MainTunnel extends Structure {\r\n    name: string = 'Main Tunnel';\r\n    description: string = 'Elevating';\r\n    view: string = 'TunnelView';\r\n    width: number = major.second\r\n    height: number = major.eighth\r\n    zoom = 0.25\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Left]: [ Corridor ],\r\n        [Orientation.Right]: [ Corridor ],\r\n        [Orientation.Up]: [ MissionControl ],\r\n        [Orientation.Down]: [ ],\r\n    }\r\n}\r\n\r\nexport class Dome extends Structure {\r\n    name: string = 'Biodome';\r\n    description: string = 'Biome sweet biome';\r\n    produces = ResourceBlock.Food\r\n    dominantColor = Color.Green\r\n\r\n    view: string = 'DomeView';\r\n    width: number  = 2 * major.eighth\r\n    height: number = 2 * major.fourth\r\n    zoom = 0.2\r\n    productionTime = 5000\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Left]: [ SurfaceRoad ],\r\n        [Orientation.Right]: [ SurfaceRoad ],\r\n        [Orientation.Up]: [ ],\r\n        [Orientation.Down]: [ ],\r\n    }\r\n    machines = [Orchard]\r\n\r\n    prereqs = [ Study, OxygenAccumulator ]\r\n}\r\n\r\nexport class Corridor extends Structure {\r\n    name: string = 'Corridor'\r\n    description: string = 'in the hallway'\r\n    view: string = 'CorridorView'\r\n    width: number = minor.fifth\r\n    height: number = minor.third\r\n    zoom = 0.5\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Left]: [\r\n            MainTunnel,\r\n            Ladder,\r\n            CloneMatrix, Kitchen, Laboratory, Study, CommonArea \r\n        ],\r\n        [Orientation.Right]: [\r\n            MainTunnel,\r\n            Ladder,\r\n            CloneMatrix, Kitchen, Laboratory, Study, CommonArea \r\n        ],\r\n        [Orientation.Up]: [ ],\r\n        [Orientation.Down]: [ ],\r\n    }\r\n}\r\n\r\nexport class CommonArea extends Structure {\r\n    name: string = 'Commons'\r\n    description: string = 'hallway cap'\r\n    view: string = 'CommonAreaView'\r\n    width: number = major.eighth\r\n    height: number = major.fifth\r\n\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Left]: [ Corridor, CloneMatrix, Kitchen, Laboratory, Study, CommonArea ],\r\n        [Orientation.Right]: [ Corridor, CloneMatrix, Kitchen, Laboratory, Study, CommonArea ],\r\n        [Orientation.Up]: [ Ladder ],\r\n        [Orientation.Down]: [ Ladder ],\r\n    }\r\n}\r\n\r\nexport class SurfaceRoad extends Structure {\r\n    name: string = 'Road'\r\n    description: string = 'go for a walk'\r\n    view: string = 'SurfaceRoadView'\r\n    width: number = minor.fifth\r\n    height: number = minor.first\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Left]: [ Arcology, Dome, MissionControl ],\r\n        [Orientation.Right]: [ Arcology, Dome, MissionControl ],\r\n        [Orientation.Up]: [ ],\r\n        [Orientation.Down]: [ ],\r\n    }\r\n}\r\n\r\nexport class Laboratory extends CommonArea {\r\n    name: string = 'Lab'\r\n    description: string = 'learn some things'\r\n    consumes = ResourceBlock.Hypothesis\r\n    produces = ResourceBlock.Data\r\n    dominantColor = Color.Blue\r\n    view: string = 'LabView'\r\n    width: number = major.sixth\r\n    height: number = major.fifth\r\n    productionTime = 6500\r\n    machines = [ExperimentBench]\r\n    prereqs = [ Kitchen, Study ]\r\n}\r\n\r\n\r\nexport class Kitchen extends CommonArea {\r\n    name: string = 'Kitchen'\r\n    description: string = 'veg -> meals'\r\n    dominantColor = Color.Green\r\n    consumes = ResourceBlock.Food\r\n    produces = ResourceBlock.Meal\r\n    view: string = 'KitchenView'\r\n    width: number = major.fourth\r\n    height: number = major.fifth\r\n    productionTime = 2000\r\n    machines = [Stove]\r\n}\r\n\r\n// a mine is maybe a wide structure that you\r\n// can gradually dig deeper??\r\nexport class Mine extends Structure {\r\n    name: string = 'Mine'\r\n    description: string = 'ore else'\r\n    dominantColor = Color.Red\r\n    produces = ResourceBlock.Ore\r\n    productionTime = 20000\r\n    view: string = 'MineView'\r\n    width: number = major.eighth // 20 * majorUnit\r\n    height: number = 3 * major.sixth //20 * majorUnit\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Left]: [ Mine, Refinery, Corridor ],\r\n        [Orientation.Right]: [ Mine, Refinery, Corridor ],\r\n        [Orientation.Up]: [ Ladder ],\r\n        [Orientation.Down]: [ Ladder ],\r\n    }\r\n    machines = [MiningDrill]\r\n    prereqs = [SolarFarm]\r\n}\r\n\r\nexport class Study extends CommonArea {\r\n    name: string = 'Study'\r\n    description: string = 'reflect'\r\n    dominantColor = Color.Blue\r\n    view: string = 'StudyView'\r\n    width = major.third\r\n    height = major.fifth\r\n    produces = ResourceBlock.Hypothesis\r\n    productionTime = 2000\r\n    machines = [Bookshelf]\r\n}\r\n\r\nexport class Refinery extends Structure {\r\n    name = 'Refinery'\r\n    description = 'flotate'\r\n    dominantColor = Color.Red\r\n    consumes = ResourceBlock.Ore\r\n    produces = ResourceBlock.Mineral\r\n    view = 'RefineryView'\r\n    width = major.fifth\r\n    height = major.fifth\r\n    productionTime = 9000\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Left]: [ Mine, Refinery, Corridor ],\r\n        [Orientation.Right]: [ Mine, Refinery, Corridor ],\r\n        [Orientation.Up]: [ Ladder ],\r\n        [Orientation.Down]: [ Ladder ],\r\n    }\r\n    machines = [MineralProcessor]\r\n    prereqs = [Mine]\r\n}\r\n\r\nexport class Ladder extends Structure {\r\n    name = 'Ladder'\r\n    description = 'connect vertically'\r\n    view = 'LadderView'\r\n    width = minor.third\r\n    height = 100 + major.third\r\n    zoom = 0.5\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Up]: [ CloneMatrix, Kitchen, Laboratory, Study, CommonArea ],\r\n        [Orientation.Down]: [ CloneMatrix, Kitchen, Laboratory, Study, CommonArea ],\r\n        [Orientation.Left]: [ ],\r\n        [Orientation.Right]: [ ],\r\n    }\r\n}\r\n\r\nexport class Arcology extends Structure {\r\n    name = 'Arcology'\r\n    description = 'megalith'\r\n    view = 'ArcologyView'\r\n    dominantColor = Color.Green\r\n    width = 12 * major.fifth\r\n    height = 34 * major.fifth\r\n    zoom = 0.01\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Left]: [ SurfaceRoad ],\r\n        [Orientation.Right]: [ SurfaceRoad ],\r\n        [Orientation.Up]: [ ],\r\n        [Orientation.Down]: [ ],\r\n    }\r\n    prereqs = [ Dome, PowerPlant ]\r\n}\r\n\r\nexport class CloneMatrix extends CommonArea {\r\n    name = 'Clone Matrix'\r\n    description = 'you seem familiar'\r\n    dominantColor = Color.Blue\r\n    view = 'CloneMatrixView'\r\n    width = major.fifth\r\n    height = major.eighth\r\n    machines = [ CloningVat ]\r\n    prereqs = [ Study ]\r\n}\r\n\r\nexport class OxygenAccumulator extends Dome {\r\n    name = 'O2'\r\n    description = 'breathe free'\r\n    // view = 'OxygenAccumulatorView'\r\n    machines = [ OxygenExtractor ]\r\n    prereqs = []\r\n}\r\n\r\nexport class SolarFarm extends Dome {\r\n    name = 'Solar Farm'\r\n    description = 'feel the warmth on your face'\r\n    // view = 'SolarFarmView'\r\n    machines = [ SolarCell ]\r\n    prereqs = []\r\n}\r\n\r\n// huge octagonal generating station with four 'slots'\r\n// for sub-structures (add-ons) which auto-generate data/ore\r\n// for the central 'power' slot ...\r\n// ...you can build either...\r\n// ...a mini black hole or mini sun\r\n// (the sun takes ore and the hole takes data?)\r\nexport class PowerPlant extends Structure {\r\n    name: string = 'Power Plant'\r\n    description: string = 'sunny day'\r\n    dominantColor = Color.Red\r\n    view: string = 'PowerPlantView'\r\n    width: number = 2 * major.eighth //30 * majorUnit\r\n    height: number = 2 * major.eighth // 30 * majorUnit\r\n\r\n    prereqs = [ Mine ] // Factory, CO2\r\n\r\n    //connections: {[key in Orientation]: (typeof Structure)[] } = {\r\n    //    [Orientation.Left]: [ Corridor ],\r\n    //    [Orientation.Right]: [ Corridor ],\r\n    //    [Orientation.Up]: [ Ladder ],\r\n    //    [Orientation.Down]: [ Ladder ],\r\n    //}\r\n}\r\n","import { ResourceBlock } from \"./Economy\";\r\nimport { Scale } from \"../values/Scale\";\r\nimport { Color } from \"excalibur\";\r\n\r\nlet { major, minor } = Scale\r\n\r\nconst bookshelfSvg = require('../images/bookshelf-plain.svg');\r\nconst vatSvg = require('../images/vat-plain.svg');\r\nconst benchSimple = require('../images/bench-simple-plain.svg');\r\nconst stove = require('../images/stove-plain.svg');\r\n\r\nconst images = {\r\n    bookshelf: bookshelfSvg,\r\n    vat: vatSvg,\r\n    bench: benchSimple,\r\n    stove: stove,\r\n}\r\n\r\nexport enum MachineOperation {\r\n  // generic functioning: consuming a block to produce a new block\r\n  Work,\r\n\r\n  // more interesting functions\r\n  SpawnCitizen,\r\n  CollectResource,\r\n\r\n  // ...ProduceValue? [i.e., hope]\r\n  // StoreResource ??\r\n}\r\n\r\nexport class Machine {\r\n    name: string = '(machine name)'\r\n    description: string = '(machine description)'\r\n    width: number = major.second\r\n    height: number = major.second\r\n    color: Color = Color.LightGray\r\n\r\n    consumes: ResourceBlock = null\r\n    produces: ResourceBlock = null\r\n    productionTime: number = 1000\r\n\r\n    behavior: MachineOperation = MachineOperation.Work\r\n\r\n    image = images.bookshelf\r\n\r\n\r\n}\r\n\r\n// resource collection\r\nexport class CommandCenter extends Machine {\r\n    name = 'Command'\r\n    description = 'gather resources'\r\n    behavior = MachineOperation.CollectResource\r\n\r\n    image = images.bench\r\n}\r\n\r\n// meals\r\n\r\nexport class Orchard extends Machine {\r\n    name = 'Orchard'\r\n    description = 'grow some food'\r\n    produces = ResourceBlock.Food\r\n}\r\n\r\nexport class Stove extends Machine {\r\n    name = 'Stove'\r\n    description = 'make a meal'\r\n    consumes = ResourceBlock.Food\r\n    produces = ResourceBlock.Meal\r\n    image = images.stove\r\n}\r\n\r\n// minerals\r\n\r\nexport class MiningDrill extends Machine {\r\n    name = 'Drill'\r\n    description = 'find some ores'\r\n    produces = ResourceBlock.Ore\r\n}\r\n\r\nexport class MineralProcessor extends Machine {\r\n    name = 'Processor'\r\n    description = 'extract some minerals'\r\n\r\n    consumes = ResourceBlock.Ore\r\n    produces = ResourceBlock.Mineral\r\n}\r\n\r\n// data\r\n\r\nexport class Bookshelf extends Machine {\r\n    name = 'Shelf'\r\n    description = 'brainstorm'\r\n    produces = ResourceBlock.Hypothesis\r\n}\r\n\r\nexport class ExperimentBench extends Machine {\r\n    name = 'Bench'\r\n    description = 'test some hypotheses'\r\n    consumes = ResourceBlock.Hypothesis\r\n    produces = ResourceBlock.Data\r\n    image = images.bench\r\n}\r\n\r\n// reproduction\r\n\r\nexport class CloningVat extends Machine {\r\n    name = 'Cloning Vat'\r\n    description = 'grow some replacements'\r\n    // consumes = ResourceBlock.Meal\r\n    behavior = MachineOperation.SpawnCitizen \r\n    productionTime = 1500\r\n\r\n    height = major.third\r\n    // width = minor.fifth\r\n    // height = major.first\r\n\r\n    image = images.vat\r\n}\r\n\r\n// providence (power, life support...)\r\n\r\nexport class OxygenExtractor extends Machine {\r\n    name = 'O2 Extractor'\r\n    description = 'breathe deep'\r\n    // behavior\r\n    // height = \r\n    image = images.vat\r\n}\r\n\r\nexport class SolarCell extends Machine {\r\n    name = 'Solar Cell'\r\n    description = 'feel the warmth'\r\n}\r\n\r\n// maybe library node 'stores' data?\r\n//export class LibraryNode {\r\n//    name = 'Library Node'\r\n//\r\n//    consumes = ResourceBlock.\r\n//}","const majorUnit = 16\r\nconst minorUnit = 4\r\n\r\nconst majorScale = {\r\n    first: majorUnit,\r\n    second: majorUnit * 2,\r\n    third: majorUnit * 3,\r\n    fourth: majorUnit * 4,\r\n    fifth: majorUnit * 5,\r\n    sixth: majorUnit * 6,\r\n    seventh: majorUnit * 7,\r\n    eighth: majorUnit * 8,\r\n}\r\n\r\nconst minorScale = {\r\n    first:   minorUnit,\r\n    second:  minorUnit * 2,\r\n    third:   minorUnit * 3,\r\n    fourth:  minorUnit * 4,\r\n    fifth:   minorUnit * 5,\r\n    sixth:   minorUnit * 6,\r\n    seventh: minorUnit * 7,\r\n    eighth:  minorUnit * 8,\r\n}\r\n\r\nexport const Scale = {\r\n    major: majorScale,\r\n    minor: minorScale\r\n}","import { Building, CommonAreaView } from \".\";\r\n\r\nexport class CloneMatrixView extends CommonAreaView {\r\n    //afterConstruct() {\r\n    //    this.spawnCitizen()\r\n    //}\r\n\r\n    //protected spawnCitizen() {\r\n    //    setTimeout(() => this.planet.populate(this.pos), 100)\r\n    //}\r\n\r\n    //draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n    //    super.draw(ctx, delta)\r\n    //}\r\n}","import { DomeView } from \".\";\r\nimport { Color } from \"excalibur\";\r\n\r\nexport class ArcologyView extends DomeView {\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n\r\n        this.drawShape(ctx, this.pos.x, this.pos.y)\r\n\r\n    }\r\n\r\n    drawShape(ctx, xoff, yoff) {\r\n        let h = this.getHeight()\r\n        let w = this.getWidth()\r\n        ctx.beginPath();\r\n        ctx.moveTo(0 + xoff, h + yoff);\r\n        // ctx.bezierCurveTo(-3 + xoff, 514 + yoff, 1 + xoff, 406 + yoff, 1 + xoff, 391 + yoff);\r\n        ctx.bezierCurveTo(1 + xoff, h - 150 + yoff, 121 + xoff, 70 + yoff, w - 80 + xoff, 8 + yoff);\r\n        ctx.bezierCurveTo(w - 40 + xoff, 2 + yoff, w - 5 + xoff, 11 + yoff, w - 10 + xoff, 25 + yoff);\r\n        ctx.bezierCurveTo(w - 5 + xoff, 10 + yoff, w + xoff, (h-10) + yoff, w + xoff, h + yoff);\r\n        ctx.lineTo(0 + xoff, h + yoff);\r\n        ctx.fillStyle = this.mainColor().toRGBA()\r\n        ctx.fill();\r\n    }\r\n}","import { minBy } from \"../Util\";\r\n\r\nexport class Graph<T> {\r\n    private empty: boolean = true\r\n    public nodes: T[] = []\r\n    private edges: { [key: number]: number[] } = {}\r\n    private edgesInverse: { [key: number]: number[] } = {}\r\n\r\n    public isEmpty(): boolean {\r\n        return this.empty;\r\n    }\r\n\r\n    public get size() { return this.nodes.length }\r\n\r\n    public node(newNode: T) {\r\n        this.empty = false;\r\n        if (!this.contains(newNode)) {\r\n            this.nodes.push(newNode)\r\n        }\r\n    }\r\n\r\n    public contains(testNode: T) {\r\n        return this.nodes.includes(testNode)\r\n    }\r\n\r\n    public findOrCreate(testNode: T, measure: (a: T, b: T) => number, tolerance: number = 5): T {\r\n        let nodes = this.dfs();\r\n        let closest = minBy(nodes, (node: T) => measure(testNode, node))\r\n        if (closest && measure(closest, testNode) < tolerance) {\r\n            return closest;\r\n        }\r\n        return testNode;\r\n    }\r\n\r\n    public edge(src: T, dst: T) {\r\n        this.node(src)\r\n        this.node(dst)\r\n\r\n        let s = this.indexOf(src), d = this.indexOf(dst)\r\n        this.edges[s] = this.edges[s] || []\r\n        this.edges[s].push(d)\r\n\r\n        this.edgesInverse[d] = this.edgesInverse[d] || []\r\n        this.edgesInverse[d].push(s)\r\n    }\r\n\r\n    public union(otherGraph: Graph<T>) {\r\n       otherGraph.edgeList().forEach(([a,b]) => this.edge(a,b))\r\n    }\r\n\r\n    public edgeList(): [T,T][] {\r\n        let theEdges = []\r\n        for (let node of this.nodes) {\r\n            let index = this.indexOf(node)\r\n            if (this.edges[index]) {\r\n                for (let otherIndex of this.edges[index]) {\r\n                    let otherNode = this.nodes[otherIndex]\r\n                    if (!theEdges.includes([otherNode, node])) {\r\n                        theEdges.push([node, otherNode])\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return theEdges\r\n    }\r\n\r\n    public adjacent(testNode: T): T[] {\r\n        let index = this.indexOf(testNode)\r\n        let vertex = this.adjacentIndices(index)\r\n        return vertex.map((n) => this.nodes[n])\r\n    }\r\n\r\n    private adjacentIndices(testNodeIndex: number): number[] {\r\n        let es = this.edges[testNodeIndex] || []\r\n        let esInv = this.edgesInverse[testNodeIndex] || []\r\n        let vertex = [...es, ...esInv ]\r\n        return vertex\r\n    }\r\n\r\n    public dfs(root:T=null, visited=[]): T[] {\r\n        let rIndex = root ? this.indexOf(root) : 0\r\n        return this.dfsIndex(rIndex).map(n => this.nodes[n])\r\n    }\r\n\r\n    private dfsIndex(rootIndex:number=0, visited:number[]=[]) {\r\n        visited.push(rootIndex)\r\n        let children = this.adjacentIndices(rootIndex)\r\n        children.forEach((childIndex: number) => {\r\n            if (!visited.includes(childIndex)) {\r\n                this.dfsIndex(childIndex, visited)\r\n            }\r\n        })\r\n\r\n        return visited\r\n    }\r\n\r\n    public bfs(root:T=null, cb: (x: number,y: number)=>boolean = ()=>true): T[] {\r\n        let rIndex = root ? this.indexOf(root) : 0\r\n        return this.bfsIndex(rIndex, cb).map(n => this.nodes[n])\r\n    }\r\n\r\n    private bfsIndex(rootIndex:number=null, cb: (x: number, y: number) => boolean = () => true): number[] {\r\n        let halt = false;\r\n        let visited: number[] = []\r\n        visited.push(rootIndex)\r\n        while (visited.length < this.nodes.length) {\r\n            for (let visitedNode of visited) {\r\n                let adj: number[] = this.adjacentIndices(visitedNode)\r\n                for (let adjacentNode of adj) {\r\n                    if (!visited.includes(adjacentNode)) {\r\n                        if (!cb(visitedNode, adjacentNode)) {\r\n                            halt = true;\r\n                            break;\r\n                        }\r\n                        visited.push(adjacentNode)\r\n                    }\r\n                }\r\n                if (halt) break;\r\n            }\r\n            if (halt) break;\r\n        }\r\n        return visited\r\n    }\r\n\r\n    public shortestPath(src: T, dst: T, maxStep: number = 256): T[] {\r\n        let prevStep = {}\r\n        let dstIndex = this.indexOf(dst)\r\n        this.bfs(src, (prev, curr) => {\r\n            prevStep[curr] = prev;\r\n            return curr !== dstIndex\r\n        })\r\n        let path = []\r\n        let curr = dstIndex\r\n        let steps = 0\r\n        let srcIndex = this.indexOf(src)\r\n        while (!path.includes(srcIndex) && steps < maxStep) {\r\n            path.push(curr)\r\n            curr = prevStep[curr]\r\n            steps += 1\r\n        }\r\n        let pathNodes = path.map(n => this.nodes[n])\r\n        return pathNodes.reverse()\r\n    }\r\n\r\n    private indexOf(node: T) {\r\n        return this.nodes.indexOf(node)\r\n    }\r\n\r\n}","import { Engine, DisplayMode, Loader } from 'excalibur';\r\nimport { World } from './models/World';\r\nimport { Resources } from './Resources';\r\n\r\nexport class Game extends Engine {\r\n\r\n  static citizenSpeed: number = 100\r\n\r\n  constructor(public world: World) {\r\n    super({\r\n      width: 800,\r\n      height: 600,\r\n      displayMode: DisplayMode.FullScreen,\r\n      backgroundColor: world.skyColor\r\n    });\r\n  }\r\n  public start() { //loader: ex.Loader) {\r\n    let loader = new Loader();\r\n    for (let key in Resources) {\r\n      loader.addResource(Resources[key]);\r\n    }\r\n    return super.start(loader);\r\n  }\r\n}","import { CommonAreaView } from \".\";\r\nimport { Corridor, Mine, Refinery } from \"../../models/Structure\";\r\n\r\nexport class RefineryView extends CommonAreaView {\r\n    validConnectingStructures() { return [ Corridor, Mine, Refinery ]}\r\n\r\n}","import { CommonAreaView } from \".\";\r\n\r\nexport class StudyView extends CommonAreaView {}","import { Building } from \".\";\r\nimport { Corridor } from \"../../models/Structure\";\r\nimport { Slot } from \"../../values/Slot\";\r\nimport { Orientation } from \"../../values/Orientation\";\r\nimport { Vector, Polygon } from \"excalibur\";\r\n\r\nexport class PowerPlantView extends Building {\r\n    showLabel = true\r\n    edgeWidth = 5\r\n\r\n    validConnectingStructures() { return [ Corridor ]}\r\n\r\n    draw(ctx, delta) {\r\n        // octagon...\r\n        super.draw(ctx, delta)\r\n    }\r\n\r\n    slots() {\r\n        let theSlots = []\r\n        let slotY = this.getHeight() / 2\r\n        let leftSlot: Slot = this.buildSlot(\r\n            this.pos.x,\r\n            this.pos.y + slotY,\r\n            Orientation.Left,\r\n        )\r\n        theSlots.push(leftSlot)\r\n\r\n        let rightSlot: Slot = this.buildSlot(\r\n            this.pos.x + this.getWidth(),\r\n            this.pos.y + slotY,\r\n            Orientation.Right,\r\n        )\r\n        theSlots.push(rightSlot)\r\n        return theSlots;\r\n    }\r\n\r\n   nodes(): Vector[] {\r\n        let x = this.pos.x + this.getWidth()/2;\r\n        let y = this.pos.y + this.getHeight()/2 //-this.floorHeight\r\n        return [\r\n            new Vector(Math.floor(x), Math.floor(y)) //-16)\r\n        ];\r\n    }\r\n\r\n    reshape(cursor) {\r\n        this.alignToSlot(cursor);\r\n    }\r\n\r\n\r\n}","import { CommonAreaView } from \".\";\r\nimport { Color } from \"excalibur\";\r\nimport { Citizen } from \"../Citizen\";\r\nimport { ResourceBlock } from \"../../models/Economy\";\r\n\r\nexport class KitchenView extends CommonAreaView {\r\n}","import { CorridorView } from \".\";\r\n\r\nexport class SurfaceRoadView extends CorridorView {\r\n    edgeWidth: 0 //.5\r\n    colorBase() { return this.color.lighten(0.1); }\r\n\r\n}","import { Label, Color, Actor } from \"excalibur\";\r\nimport { ResourceBlock, blockColor } from \"../../models/Economy\";\r\nexport class ResourceListEntry extends Actor {\r\n    icon: Actor;\r\n    count: Label;\r\n    constructor(x: number, y: number, resourceBlock: ResourceBlock, protected value: number) {\r\n        super(x, y, 10, 10); // 10,10,blockColor(resourceBlock))\r\n        let icon = new Actor(x, y, 10, 10, blockColor(resourceBlock)); //ResourceBlock.Meal))\r\n        this.add(icon);\r\n        this.count = new Label(`x${value}`, x + 10, y + 8, 'Helvetica');\r\n        this.count.fontSize = 12;\r\n        this.count.color = Color.White;\r\n        this.add(this.count);\r\n    }\r\n    credit(amt: number) {\r\n        this.value += amt;\r\n        this.count.text = `x${this.value}`;\r\n    }\r\n}\r\n","import { Color, Actor } from \"excalibur\";\r\nimport { ResourceBlock } from \"../../models/Economy\";\r\nimport { ResourceListEntry } from \"./ResourceListEntry\";\r\nexport class ResourcesList extends Actor {\r\n    entries: {\r\n        [block in ResourceBlock]: ResourceListEntry;\r\n    } = {\r\n            // non-accruable\r\n            [ResourceBlock.Food]: null,\r\n            [ResourceBlock.Hypothesis]: null,\r\n            [ResourceBlock.Ore]: null,\r\n            // displayed/accruable\r\n            [ResourceBlock.Meal]: null,\r\n            [ResourceBlock.Mineral]: null,\r\n            [ResourceBlock.Data]: null,\r\n        };\r\n\r\n    constructor(x: number, y: number) {\r\n        super(x, y, 60, 60, Color.DarkGray.darken(0.8));\r\n        let rx0 = -8, ry0 = -10;\r\n        let resources = [ResourceBlock.Meal, ResourceBlock.Data, ResourceBlock.Mineral];\r\n        resources.forEach((resource, index) => {\r\n            let rx = rx0, ry = ry0 + index * 10;\r\n            let entry = new ResourceListEntry(rx, ry, resource, 0);\r\n            this.add(entry);\r\n            this.entries[resource] = entry;\r\n        });\r\n    }\r\n\r\n    increment(resource: ResourceBlock) {\r\n        this.entries[resource].credit(1);\r\n    }\r\n}\r\n","import { Label, UIActor, Color, Actor } from \"excalibur\";\r\nimport { Dome, Structure, Corridor, CommonArea, SurfaceRoad, Mine, Laboratory, Kitchen, PowerPlant, Study, Refinery, CloneMatrix, Arcology, Ladder, OxygenAccumulator, SolarFarm } from \"../../models/Structure\";\r\nimport { Game } from \"../../Game\";\r\nimport { ResourceBlock, Economy, PureValue, emptyMarket } from \"../../models/Economy\";\r\nimport { ResourcesList } from \"./ResourcesList\";\r\nimport { Building } from \"../Building\";\r\n\r\nclass StatusAnalysisView extends Actor {\r\n    private colonyStatusLabel: Label\r\n    private powerStatusLabel: Label\r\n    private atmosphereStatusLabel: Label\r\n    private shelterStatusLabel: Label\r\n    private automationStatusLabel: Label\r\n    private continuityStatusLabel: Label\r\n\r\n    constructor(market: Economy, x: number, y: number, w: number = 200, h: number = 100) {\r\n        super(x+w/2, y-h/2, w, h, Color.DarkGray.darken(0.8))\r\n        // this.colonyStatusLabel = new Label(\"Colony: Lost (no wealth/no knowledge/no starport)\", x, y)\r\n        // this.colonyStatusLabel.fontSize = 20\r\n        // this.colonyStatusLabel.color = Color.White\r\n        // this.add(this.colonyStatusLabel)\r\n\r\n        let { demand: powerDemand, supply: powerSupply } = market['Power']\r\n\r\n        // this.providence = new ProvidenceList()\r\n        let powerStatus = powerDemand < powerSupply ? 'Up' : 'Down'\r\n        this.powerStatusLabel = new Label(\r\n            `Power: ${powerStatus} (${powerSupply}/${powerDemand})`,\r\n            -80, -20\r\n        )\r\n        this.powerStatusLabel.fontSize = 20\r\n        this.powerStatusLabel.color = Color.White\r\n        this.add(this.powerStatusLabel)\r\n\r\n        // this.shelterStatusLabel = new Label(\"Shelter: Inadequate (no housing demand/no housing supply)\", x, y + 40)\r\n        // this.shelterStatusLabel.fontSize = 20\r\n        // this.shelterStatusLabel.color = Color.White\r\n        // this.add(this.shelterStatusLabel)\r\n\r\n        // this.atmosphereStatusLabel = new Label(\"Atmosphere: Toxic (no O2 demand/no O2 supply/no CO2 scrubbing)\", x, y + 60)\r\n        // this.atmosphereStatusLabel.fontSize = 20\r\n        // this.atmosphereStatusLabel.color = Color.White\r\n        // this.add(this.atmosphereStatusLabel)\r\n\r\n        // this.automationStatusLabel = new Label(\"Automation: Primitive (no algorithmic demand/no algorithmic supply)\", x, y + 80)\r\n        // this.automationStatusLabel.fontSize = 20\r\n        // this.automationStatusLabel.color = Color.White\r\n        // this.add(this.automationStatusLabel)\r\n\r\n        // this.continuityStatusLabel = new Label(\"Praxis Continuity: Mortal (no ghosts/no neural webs/no academies)\", x, y + 100)\r\n        // this.continuityStatusLabel.fontSize = 20\r\n        // this.continuityStatusLabel.color = Color.White\r\n        // this.add(this.continuityStatusLabel)\r\n    }\r\n}\r\n\r\nexport class Hud extends UIActor {\r\n    private messageLabel: Label\r\n\r\n\r\n    private resources: ResourcesList\r\n    private status: StatusAnalysisView\r\n\r\n    private _paletteElement: HTMLDivElement\r\n\r\n    static structuresForPalette = [\r\n        SurfaceRoad,\r\n        Corridor, \r\n        Ladder,\r\n\r\n        // LivingQuarters, \r\n        Dome, Kitchen,\r\n        // Mess,\r\n\r\n        Study, Laboratory,\r\n        Mine, Refinery,\r\n        PowerPlant,\r\n\r\n        CloneMatrix,\r\n        Arcology,\r\n\r\n        OxygenAccumulator,\r\n        SolarFarm\r\n\r\n   // CommonArea,\r\n    ];\r\n\r\n    comprehendedStructures: (typeof Structure)[] = []\r\n\r\n    constructor(game: Game, protected onBuildingSelect = null) {\r\n        super(0, 0, game.canvasWidth, game.canvasHeight);\r\n\r\n        this.messageLabel = new Label('hi', 20, game.canvasHeight - 64, 'Verdana')\r\n        this.messageLabel.fontSize = 24\r\n        this.messageLabel.color = Color.White\r\n        this.add(this.messageLabel)\r\n\r\n        this._makePalette(onBuildingSelect)\r\n\r\n        this.resources = new ResourcesList(50, 40)\r\n        this.add(this.resources)\r\n\r\n        // start economy empty?\r\n        let econ = emptyMarket\r\n        let statusX = 20;\r\n        let statusY = game.canvasHeight - 200\r\n        this.status = new StatusAnalysisView(econ, statusX, statusY)\r\n        // this.add(this.status)\r\n\r\n    }\r\n\r\n    setMessage(text: string) { this.messageLabel.text = text }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        super.draw(ctx, delta)\r\n\r\n        if (this._paletteElement) {\r\n            let left = ctx.canvas.offsetLeft;\r\n            let top = ctx.canvas.offsetTop;\r\n            this._paletteElement.style.left = `${left + 20}px`;\r\n            this._paletteElement.style.top = `${top + 100}px`;\r\n        }\r\n    }\r\n\r\n    resourceGathered(resource: ResourceBlock) {\r\n        this.resources.increment(resource)\r\n    }\r\n\r\n    updatePalette(bldgs: Building[]) {\r\n        let builtStructures: (typeof Structure[]) = //bldgs\r\n          Hud.structuresForPalette.filter((structure) => bldgs.some(b => b.structure instanceof structure))\r\n\r\n\r\n        this.comprehendedStructures = Hud.structuresForPalette.filter((structure: typeof Structure) => {\r\n            let s = new structure()\r\n            let prereqs: (typeof Structure)[] = s.prereqs\r\n            console.log(\"can i build\", { name: s.name, prereqs })\r\n            return prereqs.every((prereq: (typeof Structure)) => {\r\n                let built = builtStructures.some((s: (typeof Structure)) => s === prereq)\r\n                console.log(\"do i have any\", { prereq, built })\r\n                return built\r\n            })\r\n        })\r\n\r\n          console.log(\"Built\", { builtStructures, comprehended: this.comprehendedStructures })\r\n\r\n          // rebuild palette with updated available buildings\r\n        this._paletteElement.parentElement.removeChild(this._paletteElement)\r\n          this._makePalette(this.onBuildingSelect)\r\n    }\r\n\r\n    protected _makePalette(fn: (Structure) => any) {\r\n        this._paletteElement = document.createElement('div') \r\n        this._paletteElement.id = '_thePalette'\r\n        this._paletteElement.style.position = 'absolute'\r\n        this._paletteElement.style.border = '1px solid white'\r\n        document.body.appendChild(this._paletteElement)\r\n\r\n        this.comprehendedStructures\r\n        .map(structure => new structure())\r\n        .sort((a,b) => a.dominantColor > b.dominantColor ? -1 : 1)\r\n        .forEach((structure: Structure) => {\r\n            let _paletteButton = this.buttonFactory(structure);\r\n            this._paletteElement.appendChild(\r\n                _paletteButton\r\n            )\r\n            _paletteButton.onclick = (e) => { fn(structure) }\r\n        });\r\n    }\r\n\r\n    private buttonFactory(s: Structure) {\r\n        let bg = s.dominantColor.darken(0.8) //.desaturate(0.25) //.toRGBA()\r\n        bg.a = 0.6\r\n        let fg = Color.Blue.lighten(0.8).desaturate(0.55) //.toRGBA()\r\n        let paletteButton = document.createElement('button');\r\n        paletteButton.textContent = `${s.name}`;\r\n        paletteButton.style.display = 'block';\r\n        paletteButton.style.fontSize = '10pt';\r\n\r\n        paletteButton.style.fontFamily = 'Helvetica';\r\n        paletteButton.style.fontWeight = '600';\r\n        paletteButton.style.padding = '8px';\r\n        paletteButton.style.width = '130px';\r\n        paletteButton.style.textTransform = 'uppercase'\r\n        paletteButton.style.border = 'none'\r\n\r\n        paletteButton.style.background = bg.toRGBA();\r\n        paletteButton.style.color = fg.toRGBA()\r\n        paletteButton.onmouseover = () => {\r\n            paletteButton.style.background = bg.lighten(0.4).toRGBA()\r\n            paletteButton.style.color = fg.lighten(0.9).toRGBA()\r\n        }\r\n        paletteButton.onmouseleave = () => {\r\n            paletteButton.style.background = bg.toRGBA()\r\n            paletteButton.style.color = fg.toRGBA()\r\n        }\r\n\r\n        return paletteButton;\r\n    }\r\n}","import { CommonAreaView } from '.'\r\nimport { Vector } from 'excalibur';\r\nimport { Corridor, Refinery, Mine } from '../../models/Structure';\r\n\r\nexport class MineView extends CommonAreaView {\r\n    floorHeight = 150\r\n\r\n    nodes(): Vector[] {\r\n        let x = this.pos.x + this.getWidth()/2;\r\n        let y = this.pos.y + this.getHeight() - this.floorHeight\r\n        return [\r\n            new Vector(Math.floor(x), Math.floor(y)-4)\r\n        ];\r\n    }\r\n\r\n    validConnectingStructures() { return [ Corridor, Mine, Refinery ]}\r\n}","import { TunnelView } from \".\";\r\nimport { Orientation } from \"../../values/Orientation\";\r\nimport { Slot } from \"../../values/Slot\";\r\nimport { Vector } from \"excalibur\";\r\n\r\nexport class LadderView extends TunnelView {\r\n    // edgeWidth = 1\r\n    originSlot: Slot = null\r\n    constrainCursor(cursor: Vector): Vector {\r\n       if (this.pickingOrigin) {\r\n\r\n       } else {\r\n           cursor.x = this.pos.x\r\n       }\r\n       return cursor;\r\n    }\r\n\r\n    reshape(cursor: Vector) {\r\n        if (this.pickingOrigin) { \r\n            let theSlot = this.alignToSlot(cursor)\r\n            if (theSlot) {\r\n                this.facing = theSlot.facing\r\n\r\n                if (theSlot) {\r\n                    this.originSlot = theSlot\r\n                }\r\n            }\r\n        } else {\r\n            if (this.facing === Orientation.Up) {\r\n                let maxHeight = this.originSlot.pos.y - this.planet.getTop() - 25\r\n\r\n                let h = Math.min(maxHeight, Math.max(100, this.originSlot.pos.y - cursor.y))\r\n                this.setHeight((h/50)*50)\r\n                this.pos.y = this.originSlot.pos.y - this.getHeight()\r\n            } else {\r\n                let h = Math.max(100, cursor.y - this.originSlot.pos.y)\r\n                this.setHeight((h/50)*50) // - cursor.y))\r\n            }\r\n        }\r\n    }\r\n}","import { CommonAreaView } from \".\";\r\nimport { Color } from \"excalibur\";\r\nimport { Citizen } from \"../Citizen\";\r\nimport { ResourceBlock } from \"../../models/Economy\";\r\n\r\nexport class LabView extends CommonAreaView {\r\n}","import { Vector } from \"excalibur\";\r\nimport { Building } from \"./Building\";\r\nimport { MissionControl } from \"../../models/Structure\";\r\nimport { range, eachCons, measureDistance, drawRect } from \"../../Util\";\r\nimport { Slot } from \"../../values/Slot\";\r\nimport { Orientation, flip } from \"../../values/Orientation\";\r\nimport { Graph } from \"../../values/Graph\";\r\n\r\nexport class TunnelView extends Building {\r\n    pickingOrigin: boolean = true\r\n    hideBox = true\r\n    // edgeWidth = 0.2\r\n\r\n    colorBase() { return this.color.darken(0.2); }\r\n\r\n    draw(ctx, delta) {\r\n        let rect = this.aabb()\r\n        drawRect(ctx, rect, 0, this.color.darken(0.1)) \r\n\r\n        let n = 5\r\n        rect.x = rect.x + this.getWidth() / n\r\n        rect.width -= (2) * (this.getWidth() / n)\r\n        drawRect(ctx, rect, 0, this.color.darken(0.2)) \r\n        super.draw(ctx, delta)\r\n    }\r\n\r\n    nodes(): Vector[] {\r\n        let x = this.pos.x + this.getWidth()/2;\r\n        let y = this.pos.y\r\n        return [\r\n            new Vector(Math.floor(x), y) //, Math.floor(y)-4)\r\n        ];\r\n    }\r\n\r\n    graph(supergraph: Graph<Vector> = new Graph()): Graph<Vector> {\r\n        let g = supergraph;\r\n\r\n        let halfWidth = this.getWidth()/2\r\n        let x = this.pos.x + halfWidth\r\n\r\n        // connect node to first slot...\r\n        let root = g.findOrCreate(this.nodes()[0], measureDistance)\r\n        let first = g.findOrCreate(new Vector(x,this.slotHeights()[0]), measureDistance)\r\n        g.edge(root,first)\r\n\r\n        let heights = this.slotHeights()\r\n\r\n        eachCons(heights, 2).forEach(([y0,y1]: [number,number]) => {\r\n            let top = g.findOrCreate(new Vector(x,y0), measureDistance)\r\n            let btm = g.findOrCreate(new Vector(x,y1), measureDistance)\r\n            g.edge(top, btm)\r\n        })\r\n\r\n        let btm = g.findOrCreate(new Vector(x, this.pos.y + this.getHeight()), measureDistance)\r\n        let lst = g.findOrCreate(new Vector(x, heights[heights.length-1]), measureDistance)\r\n        g.edge(btm,lst)\r\n\r\n        heights.forEach(y1 => {\r\n            let btm = g.findOrCreate(new Vector(x,y1), measureDistance)\r\n\r\n            let left = g.findOrCreate(new Vector(x-halfWidth,y1), measureDistance)\r\n            g.edge(left,btm)\r\n\r\n            let right = g.findOrCreate(new Vector(x+halfWidth,y1), measureDistance)\r\n            g.edge(btm,right)\r\n        });\r\n\r\n        for (let child of this.childrenBuildings) {\r\n            let slot = g.findOrCreate(child.parentSlot.pos, measureDistance)\r\n            let childNode = g.findOrCreate(child.nodes()[0], measureDistance)\r\n            g.edge(childNode, slot)\r\n            g.edge(slot, childNode)\r\n\r\n            child.graph(g)\r\n        }\r\n\r\n        return g;\r\n    }\r\n\r\n    private slotHeights() {\r\n        let slotSize = 50\r\n        let slotCount = Math.floor((this.getHeight()) / slotSize)\r\n        let heights = []\r\n        for (let i of range(slotCount)) {\r\n            heights.push(\r\n                50 + this.pos.y + i * slotSize,\r\n            )\r\n        }\r\n        return heights\r\n    }\r\n\r\n    slots() {\r\n        let theSlots: Slot[] = []\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth()/2,\r\n                this.pos.y,\r\n                Orientation.Up\r\n            )\r\n        )\r\n\r\n        for (let y of this.slotHeights()) {\r\n            theSlots.push(\r\n                this.buildSlot(\r\n                    this.pos.x, y,\r\n                    Orientation.Left\r\n                )\r\n            )\r\n\r\n            theSlots.push(\r\n                this.buildSlot(\r\n                    this.pos.x + this.getWidth(),\r\n                    y,\r\n                    Orientation.Right,\r\n                )\r\n            )\r\n        }\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth()/2,\r\n                this.pos.y + this.getHeight(),\r\n                Orientation.Down\r\n            )\r\n        )\r\n        return theSlots;\r\n    } \r\n\r\n    handleClick(cursor: Vector) {\r\n        if (this.pickingOrigin) {\r\n            this.pickingOrigin = false;\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    constrainCursor(cursor: Vector): Vector {\r\n        if (this.pickingOrigin) {\r\n            this.alignToSlot(cursor)\r\n        } else {\r\n            // we're determining depth of tunnel\r\n            cursor.y = Math.max(this.planet.getTop() + 100, cursor.y)\r\n        }\r\n        return cursor;\r\n    }\r\n\r\n    // expand\r\n    reshape(cursor: Vector) {\r\n        this.pos.y = this.planet.getTop() + 2\r\n        if (!this.pickingOrigin) {\r\n          this.setHeight(cursor.y - this.planet.getTop())\r\n        }\r\n    }\r\n\r\n}","import { Color, Vector } from \"excalibur\";\r\nimport { Building } from \"./Building\";\r\nimport { Citizen } from \"../Citizen\";\r\nimport { Orientation } from \"../../values/Orientation\";\r\nimport { Slot } from \"../../values/Slot\";\r\n\r\nexport class MissionControlView extends Building {\r\n    hideBox = true\r\n\r\n    slots() {\r\n        let theSlots: Slot[] = []\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth()/2,\r\n                this.pos.y + this.getHeight(),\r\n                Orientation.Down\r\n            )\r\n        )\r\n\r\n        let slotY = this.getHeight();\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x, this.pos.y + slotY,\r\n                Orientation.Left\r\n            )\r\n        )\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth(),\r\n                this.pos.y + slotY,\r\n                Orientation.Right\r\n            )\r\n        )\r\n           \r\n\r\n        return theSlots;\r\n    }\r\n\r\n    constrainCursor(cursor: Vector): Vector {\r\n        cursor.y = this.planet.getTop();\r\n        return cursor;\r\n    }\r\n\r\n    reshape(cursor: Vector) {\r\n        this.pos = cursor\r\n        this.pos.y -= this.getHeight() - 2 // + 1\r\n    }\r\n\r\n    //async interact(citizen: Citizen) {\r\n    //}\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        let color = this.mainColor();\r\n\r\n        ctx.fillStyle = color.toRGBA()\r\n        // y is going to be surface height\r\n        ctx.fillRect(this.pos.x, this.pos.y, this.getWidth(), this.getHeight())\r\n\r\n        // could draw a little flag :)\r\n        let flagpoleHeight = 18\r\n        let flagX = this.pos.x + 3*(this.getWidth()/4)\r\n        let flagY = this.pos.y - flagpoleHeight\r\n        ctx.fillRect(flagX, flagY, 2, flagpoleHeight)\r\n        ctx.fillRect(flagX, flagY, 10, 5)\r\n\r\n        super.draw(ctx, delta)\r\n    }\r\n\r\n    colorBase() { return Color.White; }\r\n}","import { Color, Vector } from \"excalibur\";\r\nimport { Building } from \"./Building\";\r\nimport { Orientation } from \"../../values/Orientation\";\r\n\r\nexport class DomeView extends Building {\r\n    hideBox = true\r\n\r\n    slots() {\r\n        let theSlots = [];\r\n        let slotY = this.getHeight();\r\n\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x, this.pos.y + slotY,\r\n                Orientation.Left\r\n            )\r\n        )\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth(),\r\n                this.pos.y + slotY,\r\n                Orientation.Right\r\n            )\r\n        )\r\n\r\n        return theSlots;\r\n    } \r\n\r\n    reshape(cursor: Vector) {\r\n        this.alignToSlot(cursor)\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        let color: Color = this.mainColor()\r\n\r\n        ctx.beginPath()\r\n        ctx.arc(\r\n            this.pos.x + this.getWidth()/2,\r\n            this.pos.y + this.getHeight(),\r\n            this.getHeight()/1.5,\r\n            0,\r\n            Math.PI,\r\n            true\r\n        )\r\n        ctx.closePath()\r\n        ctx.fillStyle = color.toRGBA()\r\n        ctx.fill()\r\n\r\n        super.draw(ctx, delta)\r\n    }\r\n\r\n    colorBase() { return Color.White.darken(0.05); } \r\n\r\n    devicePlaces() {\r\n        let w = this.getWidth()/2\r\n        let x = this.pos.x + w;\r\n        let y = this.pos.y + this.getHeight() - 6\r\n        return [\r\n            new Vector(x - w/3, y),\r\n            new Vector(x, y),\r\n            new Vector(x + w/3, y),\r\n        ]\r\n    }\r\n}","import { Building } from \"./Building\";\r\nimport { Orientation } from \"../../values/Orientation\";\r\nimport { Slot } from \"../../values/Slot\";\r\nimport { Vector } from \"excalibur\";\r\n\r\nexport class CommonAreaView extends Building {\r\n    floorHeight: number = 8\r\n    edgeWidth: number = 0.5 //.1\r\n    showLabel = true\r\n    // maybe you can set height AND width of common area view??\r\n    // maybe just width...\r\n    colorBase() { return this.color.darken(0.1); }\r\n\r\n    slots() {\r\n        let theSlots = []\r\n        let slotY = this.getHeight() - this.floorHeight\r\n        let leftSlot: Slot = this.buildSlot(\r\n            this.pos.x,\r\n            this.pos.y + slotY,\r\n            Orientation.Left,\r\n        )\r\n        theSlots.push(leftSlot)\r\n\r\n        let rightSlot: Slot = this.buildSlot(\r\n            this.pos.x + this.getWidth(),\r\n            this.pos.y + slotY,\r\n            Orientation.Right,\r\n        )\r\n        theSlots.push(rightSlot)\r\n\r\n        // top slot\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth()/2,\r\n                this.pos.y,\r\n                Orientation.Up\r\n            )\r\n        )\r\n\r\n        // bottom slot\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth()/2,\r\n                this.pos.y + this.getHeight(),\r\n                Orientation.Down\r\n            )\r\n        )\r\n        return theSlots;\r\n    }\r\n\r\n    nodes(): Vector[] {\r\n        let x = this.pos.x + this.getWidth()/2;\r\n        let y = this.pos.y + this.getHeight()-this.floorHeight\r\n        return [\r\n            new Vector(Math.floor(x), Math.floor(y)) //-16)\r\n        ];\r\n    }\r\n  \r\n    reshape(cursor) {\r\n        this.alignToSlot(cursor);\r\n    }\r\n}","import { Building } from \"./Building\";\r\nimport { Vector } from \"excalibur\";\r\nimport { Orientation } from \"../../values/Orientation\";\r\nimport { Slot } from \"../../values/Slot\";\r\n\r\nexport class CorridorView extends Building {\r\n    edgeWidth: number = 0\r\n\r\n    pickingOrigin: boolean = true\r\n    facing: Orientation = Orientation.Left\r\n\r\n    colorBase() { return this.color.darken(0.2); }\r\n\r\n    slots() {\r\n        // left slot -- right slot\r\n        let theSlots: Slot[] = [];\r\n        let slotY = this.getHeight() / 2;\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x, this.pos.y + slotY,\r\n                Orientation.Left\r\n            )\r\n        )\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth(),\r\n                this.pos.y + slotY,\r\n                Orientation.Right\r\n            )\r\n        )\r\n\r\n        return theSlots;\r\n    } \r\n\r\n    \r\n    handleClick(cursor: Vector) {\r\n        if (this.pickingOrigin) {\r\n            this.pickingOrigin = false;\r\n            this.reshape(this.constrainCursor(cursor))\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    constrainCursor(cursor: Vector): Vector {\r\n        let newCursor = cursor.clone();\r\n        if (this.pickingOrigin) {\r\n        } else {\r\n            newCursor.y = this.pos.y\r\n        }\r\n\r\n        return newCursor;\r\n    }\r\n\r\n    originX: number = 0\r\n    reshape(cursor: Vector) {\r\n\r\n        if (this.pickingOrigin) {\r\n            let theSlot = this.alignToSlot(cursor)\r\n            if (theSlot) {\r\n                this.facing = theSlot.facing\r\n\r\n                if (theSlot && this.facing === Orientation.Left) {\r\n                    this.originX = theSlot.pos.x\r\n                }\r\n            }\r\n\r\n        } else {\r\n            if (this.facing === Orientation.Left) {\r\n                this.setWidth(Math.abs(this.originX - cursor.x))\r\n                this.pos.x = this.originX - this.getWidth()\r\n            } else {\r\n                this.setWidth(Math.abs(this.pos.x - cursor.x))\r\n            }\r\n        }\r\n    }\r\n}","import { Actor, Label, Color, Vector } from \"excalibur\";\r\nimport { Machine, MachineOperation } from \"../models/Machine\";\r\nimport { Building } from \"./Building\";\r\nimport { ResourceBlock, blockColor } from \"../models/Economy\";\r\nimport { Citizen } from \"./Citizen\";\r\n\r\nexport class Device extends Actor {\r\n    product: ResourceBlock[] = []\r\n    capacity: number = 4\r\n\r\n    nameLabel: Label\r\n\r\n    image: any\r\n    imageLoaded: boolean = false\r\n\r\n    constructor(\r\n        public building: Building, private machine: Machine, private initialPos: Vector\r\n    ) {\r\n        super(\r\n            initialPos.x,\r\n            initialPos.y,\r\n            machine.width,\r\n            machine.height,\r\n            machine.color\r\n        )\r\n\r\n        this.nameLabel = new Label(this.machine.name, 0, 0, 'Helvetica')\r\n        this.nameLabel.fontSize = 8\r\n        this.nameLabel.color = Color.White\r\n\r\n        this.image = new Image();\r\n        this.image.onload = function () {\r\n             this.imageLoaded = true\r\n        }\r\n        this.image.src = machine.image\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        // super.draw(ctx, delta)\r\n        ctx.drawImage(\r\n            this.image,\r\n            this.pos.x - this.getWidth() / 2,\r\n            this.pos.y - this.getHeight() / 2,\r\n            this.getWidth(), this.getHeight()\r\n        )\r\n\r\n        let showLabel = true\r\n        if (showLabel) {\r\n            this.nameLabel.pos = this.getCenter()\r\n            this.nameLabel.pos.x -= ctx.measureText(this.machine.name).width / 2\r\n            this.nameLabel.pos.y -= 20\r\n            this.nameLabel.draw(ctx, delta)\r\n        }\r\n\r\n        let bx = this.x - this.getWidth()/2, by = this.y - 10\r\n        let blockSize = 5\r\n        this.product.forEach((produced, index) => {\r\n            ctx.fillStyle = blockColor(produced).desaturate(0.3).lighten(0.2).toRGBA();\r\n            ctx.fillRect(bx + blockSize * index, by - blockSize, blockSize-1, blockSize-1)\r\n        })\r\n    }\r\n\r\n    get produces()       { return this.machine.produces }\r\n    get consumes()       { return this.machine.consumes }\r\n    get productionTime() { return this.machine.productionTime }\r\n\r\n    async interact(citizen: Citizen) {\r\n        if (this.machine.behavior === MachineOperation.Work) {\r\n            if (this.product.length > 0) {\r\n                this.product.pop()\r\n                await citizen.progressBar(200) //this.productionTime)\r\n                citizen.carry(this.produces)\r\n            } else {\r\n                if (this.consumes && citizen.carrying === this.consumes) {\r\n                    await citizen.progressBar(this.productionTime)\r\n                    citizen.carry(this.produces)\r\n                }\r\n            }\r\n        } else if (this.machine.behavior === MachineOperation.CollectResource) {\r\n            // assume we are gathering a resource here?\r\n            let resource = citizen.drop()\r\n            if (resource) {\r\n                this.building.redeem(resource) //planet.gather(resource)\r\n            }\r\n        }\r\n    }\r\n\r\n    public produce(step: number) {\r\n        if (step % this.productionTime === 0) {\r\n            if (this.machine.behavior === MachineOperation.Work) {\r\n\r\n                if (this.produces && !this.consumes && this.product.length < this.capacity) {\r\n                    this.product.push(this.produces)\r\n                }\r\n            } else if (this.machine.behavior === MachineOperation.SpawnCitizen) {\r\n                setTimeout(() => this.building.populate(this.pos), 100)\r\n            }\r\n        }\r\n    }\r\n\r\n}","import * as ex from 'excalibur';\r\n\r\nexport class Player extends ex.Actor {\r\n  constructor() {\r\n    super();\r\n    this.setWidth(5);\r\n    this.setHeight(5);\r\n    this.x = 5;\r\n    this.y = 5;\r\n    this.color = new ex.Color(255, 255, 255);\r\n  }\r\n}\r\n","import { Actor, Color, Traits, Vector } from \"excalibur\";\r\nimport { Building } from \"./Building\";\r\nimport { Planet } from \"./Planet/Planet\";\r\nimport { Structure, MissionControl, Laboratory, Mine, Dome, Kitchen, Study, Refinery } from \"../models/Structure\";\r\nimport { ResourceBlock, blockColor } from \"../models/Economy\";\r\nimport { Game } from \"../Game\";\r\nimport { eachCons } from \"../Util\";\r\nimport { Machine, Stove, ExperimentBench, MineralProcessor, CommandCenter, Orchard, MiningDrill, Bookshelf } from \"../models/Machine\";\r\nimport { Device } from \"./Device\";\r\nimport { Scale } from \"../values/Scale\";\r\n\r\nexport class Citizen extends Actor {\r\n\r\n    walkSpeed: number = Game.citizenSpeed\r\n    carrying: ResourceBlock = null\r\n    path: Vector[] = []\r\n\r\n    workInProgress: boolean = false\r\n    workStarted: number\r\n    workDuration: number\r\n    progress: number\r\n\r\n    constructor(private device: Device, protected planet: Planet) {\r\n        super(device.x, device.y, Scale.minor.first, Scale.minor.third, Color.White)\r\n        this.traits = this.traits.filter(trait => !(trait instanceof Traits.OffscreenCulling))\r\n    }\r\n\r\n    update(engine, delta) {\r\n        super.update(engine, delta)\r\n\r\n        // check wip\r\n        if (this.workInProgress) {\r\n            let now = (new Date()).getTime()\r\n            this.progress = (now - this.workStarted) / this.workDuration //0.5\r\n        }\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        super.draw(ctx, delta)\r\n        if (this.carrying) {\r\n            ctx.fillStyle = blockColor(this.carrying).toRGBA()\r\n            ctx.fillRect(this.x+4, this.y-3, 5, 5)\r\n        }\r\n\r\n        if (this.workInProgress) {\r\n            ctx.lineWidth = 1\r\n            let pw = 10, ph = 3\r\n            let px = this.x - pw/2, py = this.y - 10;\r\n            // draw progress bar?\r\n            ctx.strokeStyle = Color.White.toRGBA()\r\n            // ctx.stroke(20)\r\n            ctx.strokeRect(px, py, pw, ph)\r\n\r\n            ctx.fillStyle = Color.Violet.darken(0.9).toRGBA()\r\n            ctx.fillRect(px, py, pw, ph)\r\n            ctx.fillStyle = Color.Violet.toRGBA()\r\n            ctx.fillRect(px, py, this.progress * pw, ph)\r\n\r\n            this.vel.x += (Math.random())-0.5 // * 10.0)\r\n        }\r\n\r\n        let debugPath = false\r\n        if (this.path && debugPath) {\r\n            let c = Color.White.lighten(0.5)\r\n            c.a = 0.5\r\n            eachCons(this.path, 2).forEach(([a,b]) => {\r\n                ctx.beginPath()\r\n                ctx.moveTo(a.x,a.y)\r\n                ctx.lineTo(b.x,b.y)\r\n                ctx.strokeStyle = c.toRGBA()\r\n                ctx.lineWidth = 10\r\n                ctx.stroke()\r\n            })\r\n        }\r\n    }\r\n\r\n    carry(c: ResourceBlock) { //c: Color) {\r\n        this.carrying = c;\r\n    }\r\n\r\n    drop(): ResourceBlock {\r\n        if (this.carrying) {\r\n            let c = this.carrying; //.clone();\r\n            this.carrying = null;\r\n            return c\r\n        }\r\n        return null\r\n    }\r\n\r\n    glideTo(pos: Vector) {\r\n        return this.actions.moveTo(pos.x, pos.y, this.walkSpeed).asPromise()\r\n    }\r\n\r\n    async progressBar(duration: number) {\r\n        // console.log(\"PROGRESS BAR\")\r\n        this.workInProgress = true\r\n        this.workStarted = (new Date()).getTime()\r\n        this.workDuration = duration\r\n        await new Promise((resolve, reject) => setTimeout(resolve, duration));\r\n        // console.log(\"PROGRESS BAR DONE!\")\r\n        this.workInProgress = false\r\n    }\r\n\r\n    async pathTo(building: Building) { //}, onArrival: (Building) => any) {\r\n        // let building = this.planet.closestBuildingByType(this.pos, structure)\r\n\r\n        let path = this.planet.pathBetween(this.pos.clone(), building)\r\n\r\n        if (path.length > 0) {\r\n            this.path = path\r\n            path.pop()\r\n            path.shift()\r\n            await Promise.all(\r\n                path.map(step => this.glideTo(step))\r\n            )\r\n            this.path = null\r\n            // onArrival(building);\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n\r\n    async work() {\r\n        if (this.carrying) {\r\n            let item: ResourceBlock = this.carrying;\r\n            let sinks: (typeof Machine)[] = []\r\n\r\n            if (ResourceBlock[item] === 'Food') {\r\n                sinks = [Stove]\r\n            } else if (ResourceBlock[item] === 'Hypothesis') {\r\n                sinks = [ExperimentBench]\r\n            } else if (ResourceBlock[item] === 'Ore') {\r\n                sinks = [MineralProcessor]\r\n            } else {\r\n                sinks = [CommandCenter]\r\n            }\r\n\r\n            if (sinks.length > 0) {\r\n                let theSink: Device = this.planet.closestDevice(this.pos, sinks)\r\n                if (theSink) {\r\n                    await this.pathTo(theSink.building)\r\n                    await this.glideTo(theSink.pos)\r\n                    await theSink.interact(this)\r\n                }\r\n            } else {\r\n                console.log(\"nowhere to deliver it\", this.carrying)\r\n            }\r\n        } else {\r\n            let source: Device = this.planet.closestDevice(this.pos,\r\n                [ Orchard, MiningDrill, Bookshelf ],\r\n                (d) => d.product.length > 0\r\n            )\r\n\r\n            if (source) {\r\n                await this.pathTo(source.building)\r\n                await this.glideTo(source.pos)\r\n                await source.interact(this)\r\n            } else {\r\n                console.log(\"i guess i can try again? (sleep for a bit first)\")\r\n                await new Promise((resolve, reject) => setTimeout(resolve, 150));\r\n            }\r\n        }\r\n\r\n        setTimeout(() => this.work(), 100)\r\n    }\r\n}","import { Actor, Traits } from 'excalibur';\r\nimport { Citizen } from '../Citizen';\r\nimport { Planet } from './Planet';\r\nimport { Device } from '../Device';\r\n\r\nexport class Population extends Actor {\r\n    citizens: Citizen[] = [];\r\n    constructor(private planet: Planet) {\r\n        super(0, -planet.getHeight() / 2, 0, 0);\r\n        this.traits = this.traits.filter(trait => !(trait instanceof Traits.OffscreenCulling));\r\n    }\r\n\r\n    increase(home: Device) {\r\n        let citizen = new Citizen(home, this.planet);\r\n        citizen.work();\r\n        this.citizens.push(citizen);\r\n        this.add(citizen);\r\n    }\r\n}\r\n","import { Graph } from \"../../values/Graph\";\r\nimport { Vector } from \"excalibur\";\r\nimport { Building } from \"../Building\";\r\nimport { minBy } from \"../../Util\";\r\n\r\nexport class NavigationTree {\r\n   graph: Graph<Vector>\r\n\r\n   constructor(root: Building) {\r\n       this.graph = root.graph()\r\n   }\r\n\r\n   seekPath(origin: Vector, dest: Vector): Vector[] {\r\n      return this.graph.shortestPath(origin, dest)\r\n   }\r\n\r\n   closestNode(testNode: Vector) {\r\n       let nodes = this.graph.dfs()\r\n       let closest = minBy(nodes,\r\n           (node: Vector) => Math.abs(testNode.distance(node))\r\n       )\r\n       if (closest) {\r\n           return closest\r\n       }\r\n       return false\r\n   }\r\n}","module.exports = __webpack_public_path__ + \"7441c2ab240d0f733451d75204ac0792.svg\";","module.exports = __webpack_public_path__ + \"91a8cce06c3c05ce6e4b176afafd7b0a.svg\";","module.exports = __webpack_public_path__ + \"0ce4f9c3384680565b6bb16495b64233.svg\";","module.exports = __webpack_public_path__ + \"1db542acabeb82ec8da785e77afd4dca.svg\";","import { Actor, Vector, Traits, Color } from 'excalibur';\r\nimport { Building } from '../Building';\r\nimport { minBy, flatSingle } from '../../Util';\r\nimport { Structure, MissionControl } from '../../models/Structure';\r\nimport { NavigationTree } from './NavigationTree';\r\nimport { Machine } from '../../models/Machine';\r\nexport class Colony extends Actor {\r\n    navTree: NavigationTree;\r\n    buildings: Building[] = [];\r\n    currentlyConstructing: Building = null;\r\n    maxPop: number = 8\r\n\r\n    constructor(x: number, y: number) {\r\n        super(x, y, 0, 0); // 1000, 1000);\r\n        this.traits = this.traits.filter(trait => !(trait instanceof Traits.OffscreenCulling));\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        super.draw(ctx, delta);\r\n\r\n        let debugTree = false\r\n        if (this.navTree && debugTree) {\r\n            let edges = this.navTree.graph.edgeList();\r\n            edges.forEach((edge) => {\r\n                let [a,b] = edge;\r\n                var gradient = ctx.createLinearGradient(a.x,a.y+this.pos.y,b.x,b.y+this.pos.y);\r\n\r\n                gradient.addColorStop(0, 'green');\r\n                gradient.addColorStop(1, 'blue');\r\n\r\n                ctx.beginPath()\r\n                ctx.moveTo(a.x, a.y + this.pos.y)\r\n                ctx.lineTo(b.x, b.y + this.pos.y)\r\n                ctx.closePath()\r\n                ctx.strokeStyle = gradient\r\n                ctx.lineWidth = 0.5\r\n                ctx.stroke()\r\n            })\r\n        }\r\n\r\n    }\r\n\r\n    placeBuilding(building: Building) {\r\n        building.built = true;\r\n        if (building.parentSlot) {\r\n            building.parentSlot.parent.childrenBuildings.push(building);\r\n            this.buildNavTree();\r\n        }\r\n        this.buildings.push(building);\r\n        building.afterConstruct();\r\n        this.add(building);\r\n    }\r\n\r\n    closestBuildingByType(cursor: Vector, structureTypes: (typeof Structure)[], predicate: (Building) => boolean = () => true): Building {\r\n        let matching = this.buildings\r\n        .filter(building => structureTypes.some(structureType => (building.structure instanceof structureType)) && predicate(building));\r\n        if (matching && matching.length > 0) {\r\n            let distanceToCursor = (building) => cursor.distance(building.nodes()[0]);\r\n            return minBy(matching, distanceToCursor);\r\n        }\r\n    }\r\n\r\n    pathBetween(origin: Vector, destination: Building): Vector[] {\r\n        if (!this.navTree) {\r\n            this.buildNavTree();\r\n        }\r\n        let srcNode = this.navTree.closestNode(origin);\r\n        let dest = destination.nodes()[0];\r\n        let destNode = this.navTree.closestNode(dest);\r\n        let path = this.navTree.seekPath(srcNode, destNode);\r\n        return path;\r\n    }\r\n\r\n    closestDeviceByType(cursor: Vector, machineTypes: (typeof Machine)[], predicate: (Device) => boolean = () => true) {\r\n        let devices = flatSingle(this.buildings.map(b => b.devices))\r\n        devices = devices.filter(d => machineTypes.some(machine => d.machine instanceof machine) && predicate(d))\r\n\r\n        if (devices && devices.length > 0) {\r\n            let proximity = (d) => cursor.distance(d)\r\n            return minBy(devices, proximity)\r\n        }\r\n    }\r\n\r\n    private buildNavTree() {\r\n        let ctrl = this.buildings.find(building => building.structure instanceof MissionControl);\r\n        if (ctrl) {\r\n            this.navTree = new NavigationTree(ctrl);\r\n        }\r\n    }\r\n}\r\n","import { Actor, Color } from 'excalibur';\r\nimport { range } from '../../Util';\r\n\r\nclass PlanetBackground extends Actor {\r\n    constructor(y: number, width: number, color: Color) {\r\n        super(0, y, width, 500, color); // y + size, size, layerSize, color.darken(0.2))\r\n    }\r\n}\r\n\r\nexport class Mountains extends PlanetBackground {\r\n    peaks: {\r\n        x: number;\r\n        height: number;\r\n    }[] = [];\r\n    onInitialize() {\r\n        let peakCount = 20; // Math.floor(this.getWidth() / 2000)\r\n        let peakHeight = 3000;\r\n        // let mtnWidth = 180\r\n        // figure out mountain peaks?\r\n        // let yBase = this.pos.y //-1000 //this.pos.y //this.getHeight()\r\n        let xOff = this.getWidth() / 2;\r\n        let peakDistance = this.getWidth() / peakCount;\r\n        for (let times of range(5)) {\r\n            let heightRange = 100*times;\r\n            let drift = 3 * times * (peakDistance / 2);\r\n            for (let i of range(peakCount)) { //} / 2)) {\r\n                this.peaks.push({\r\n                    x: -xOff + i * peakDistance + ((Math.random() * drift) - (drift / 2)),\r\n                    height: Math.max(10, 1000 + (Math.random()*peakHeight) + ((Math.random() * heightRange)-(heightRange/2))) //(Util.randomIntInRange(-160,160))\r\n                    // y = yBase - peakHeight\r\n                });\r\n            }\r\n        }\r\n        // console.log({ peaks: this.peaks });\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        let baseColor = this.color.desaturate(0.25); //.toRGB\r\n        // baseColor.a = 0.6\r\n        let brightColor = this.color.saturate(0.2).lighten(0.5)\r\n        // super.draw(ctx, delta)\r\n        ctx.fillStyle = baseColor.toRGBA() // this.color.desaturate(0.45).lighten(0.15).toRGBA();\r\n        //let peakHeight = 250\r\n        // let mtnWidth = 180\r\n        let yBase = this.pos.y-3; //-1000 //this.pos.y //this.getHeight()\r\n        // let xOff = this.getWidth() / 2\r\n        this.peaks.forEach(peak => {\r\n            let y0 = yBase - peak.height;\r\n            let mtnWidth = peak.height * 3.4;\r\n            ctx.beginPath();\r\n            ctx.moveTo(peak.x, y0);\r\n            ctx.lineTo(peak.x - mtnWidth, yBase);\r\n            ctx.lineTo(peak.x + mtnWidth, yBase);\r\n\r\n            ctx.fillStyle = baseColor.toRGBA() // this.color.desaturate(0.45).lighten(0.15).toRGBA();\r\n            ctx.fill();\r\n\r\n            ctx.beginPath();\r\n            ctx.moveTo(peak.x, y0);\r\n            ctx.lineTo(peak.x + 3*(mtnWidth/4), yBase);\r\n            ctx.lineTo(peak.x + mtnWidth, yBase);\r\n            ctx.fillStyle = brightColor.toRGBA() // this.color.desaturate(0.45).lighten(0.15).toRGBA();\r\n            ctx.fill();\r\n\r\n        });\r\n    }\r\n}","import * as ex from 'excalibur';\r\nimport { Actor, Color, Vector, Util, EdgeArea } from 'excalibur';\r\nimport { Building } from '../Building';\r\nimport { range } from '../../Util';\r\nimport { Mountains } from './PlanetBackground';\r\nimport { Structure, CloneMatrix } from '../../models/Structure';\r\nimport { Hud } from '../Hud/Hud';\r\nimport { ResourceBlock } from '../../models/Economy';\r\nimport { Colony } from './Colony';\r\nimport { Population } from './Population';\r\nimport { Machine, CloningVat } from '../../models/Machine';\r\n\r\n\r\nexport class Planet extends Actor {\r\n    colony: Colony\r\n    population: Population\r\n\r\n    constructor(\r\n        public hud: Hud,\r\n        public color: Color,\r\n        public width: number = 2000000,\r\n        public depth: number = 10000000,\r\n        ) {\r\n        super(0, depth/2, width, depth, color)\r\n        this.traits = this.traits.filter(trait => !(trait instanceof ex.Traits.OffscreenCulling))\r\n\r\n        let yBase = -depth/2\r\n        // crust\r\n        let crustHeight = 20\r\n        this.createLayer(yBase, crustHeight, this.color.lighten(0.25))\r\n\r\n\r\n        let layerCount = 10\r\n        let layerHeight = depth / layerCount \r\n        for (let i of range(layerCount)) {\r\n            this.createLayer(\r\n                yBase + crustHeight + (layerHeight/2) + (layerHeight * (i+1)),\r\n                layerHeight,\r\n                this.color.darken(0.05 + 0.01 * i)\r\n            )\r\n        }\r\n\r\n        this.add(new Mountains(-depth/2, this.getWidth(), this.color.lighten(0.15)))\r\n\r\n        this.colony = new Colony(0,-depth/2) //yBase)\r\n        this.add(this.colony)\r\n\r\n        this.population = new Population(this)\r\n        this.add(this.population)\r\n    }\r\n\r\n    private createLayer(y: number, size: number, color: Color) {\r\n        let theLayer = new Actor(0, y, this.getWidth(), size, color);\r\n        this.add(theLayer);\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta) {\r\n        super.draw(ctx, delta)\r\n\r\n        if (this.currentlyConstructing) {\r\n            this.currentlyConstructing.draw(ctx, delta)\r\n        }\r\n    }\r\n\r\n    update(engine, delta) {\r\n        super.update(engine, delta)\r\n\r\n        this.colony.buildings.forEach(building => building.update(engine, delta))\r\n        this.population.citizens.forEach(citizen => citizen.update(engine, delta))\r\n    }\r\n\r\n    get currentlyConstructing() {\r\n        return this.colony.currentlyConstructing\r\n    }\r\n\r\n    gather(resource: ResourceBlock): any {\r\n        this.hud.resourceGathered(resource)\r\n    }\r\n\r\n    placeBuilding(building: Building) {\r\n        this.colony.placeBuilding(building)\r\n    }\r\n\r\n    populate(pos: Vector) {\r\n        // we could have a colony pop limit for now?\r\n        if (this.population.citizens.length < this.colony.maxPop) {\r\n            // let home = this.closestBuildingByType(pos, [CloneMatrix])\r\n            let home = this.closestDevice(pos, [CloningVat])\r\n            this.population.increase(home)\r\n        }\r\n    }\r\n\r\n    closestBuildingByType(cursor: Vector, structureTypes: (typeof Structure)[], predicate: (Building) => boolean = ()=>true): Building {\r\n        return this.colony.closestBuildingByType(cursor, structureTypes, predicate)\r\n    }\r\n\r\n    closestDevice(cursor: Vector, machineTypes: (typeof Machine)[], predicate: (Device) => boolean = () => true) {\r\n        return this.colony.closestDeviceByType(cursor, machineTypes, predicate);\r\n    }\r\n\r\n    pathBetween(origin: Vector, destination: Building): Vector[] {\r\n        return this.colony.pathBetween(origin, destination)\r\n    }\r\n}","import { Scene, Input, UIActor, Label, Vector, LockCameraToActorStrategy } from \"excalibur\";\r\nimport { Game } from \"../Game\";\r\nimport { Planet } from \"../actors/Planet/Planet\";\r\nimport { Player } from \"../actors/player\";\r\nimport { Structure, MissionControl, MainTunnel, Dome, Corridor, SurfaceRoad, Kitchen, CloneMatrix, OxygenAccumulator } from \"../models/Structure\";\r\nimport { Building, DomeView, CorridorView, CommonAreaView, TunnelView, MissionControlView, LadderView, MineView, LabView, } from \"../actors/Building\";\r\nimport { Hud } from \"../actors/Hud/Hud\";\r\nimport { SurfaceRoadView } from \"../actors/Building/SurfaceRoadView\";\r\nimport { KitchenView } from \"../actors/Building/KitchenView\";\r\nimport { PowerPlantView } from \"../actors/Building/PowerPlantView\";\r\nimport { StudyView } from \"../actors/Building/StudyView\";\r\nimport { RefineryView } from \"../actors/Building/RefineryView\";\r\nimport { ArcologyView } from \"../actors/Building/ArcologyView\";\r\nimport { CloneMatrixView } from \"../actors/Building/CloneMatrixView\";\r\n\r\n\r\nexport class Construct extends Scene {\r\n    game: Game\r\n    planet: Planet\r\n    hud: Hud\r\n    player: Player\r\n\r\n    dragging: boolean = false\r\n    dragOrigin: Vector\r\n\r\n    static structureViews: { [key: string]: typeof Building } = {\r\n        TunnelView,\r\n        MissionControlView,\r\n        DomeView,\r\n        CorridorView,\r\n        CommonAreaView,\r\n        SurfaceRoadView,\r\n        LabView,\r\n        MineView,\r\n        KitchenView,\r\n        PowerPlantView,\r\n        StudyView,\r\n        RefineryView,\r\n\r\n        ArcologyView,\r\n        CloneMatrixView,\r\n\r\n        LadderView,\r\n    }\r\n    ////\r\n    static requiredStructureList: Array<typeof Structure> = [\r\n        MissionControl,\r\n\r\n        SurfaceRoad,\r\n        OxygenAccumulator,\r\n        // Dome,\r\n        MainTunnel,\r\n        Corridor,\r\n        Kitchen,\r\n        // Study,\r\n        // CloneMatrix,\r\n    ]\r\n\r\n    public onInitialize(game: Game) {\r\n        this.game = game\r\n\r\n\r\n        this.hud = new Hud(game, (structure) => {\r\n            this.startConstructing(structure)\r\n        });\r\n        this.add(this.hud)\r\n\r\n        this.planet = new Planet(this.hud, game.world.color);\r\n        this.add(this.planet)\r\n  \r\n        this.player = new Player()\r\n        this.add(this.player)\r\n\r\n        this.prepareNextBuilding()\r\n        this.camera.zoom(0.001)\r\n        this.camera.zoom(2, 10000)\r\n    }\r\n\r\n    public onActivate() {\r\n        this.game.input.pointers.primary.on('move', (e: Input.PointerMoveEvent) => {\r\n            if (this.dragging) {\r\n                this.camera.pos = this.camera.pos.add(\r\n                    this.dragOrigin.sub(e.pos)\r\n                )\r\n            } else {\r\n                this.player.pos = e.pos\r\n\r\n                let currentBuilding = this.planet.currentlyConstructing\r\n                if (currentBuilding) {\r\n                    let constrained = currentBuilding.constrainCursor(this.player.pos)\r\n                    this.player.pos = constrained\r\n\r\n                    currentBuilding.reshape(this.player.pos)\r\n                }\r\n            }\r\n        })\r\n\r\n        this.game.input.pointers.primary.on('up', (e: Input.PointerUpEvent) => {\r\n            if (this.dragging) { this.dragging = false; }\r\n        })\r\n\r\n        this.game.input.pointers.primary.on('down', (e: Input.PointerDownEvent) => {\r\n            if (e.button == Input.PointerButton.Left) {\r\n                const currentBuilding: Building = this.planet.currentlyConstructing\r\n                if (currentBuilding) {\r\n                    let placementValid = !currentBuilding.overlapsAny()\r\n                    if (currentBuilding && placementValid && currentBuilding.handleClick(e.pos)) {\r\n                        this.planet.placeBuilding(currentBuilding)\r\n                        this.planet.colony.currentlyConstructing = null\r\n                        this.prepareNextBuilding(e.pos)\r\n                        this.hud.updatePalette(this.planet.colony.buildings)\r\n                    }\r\n                }\r\n            } else if (e.button === Input.PointerButton.Middle) {\r\n                this.dragging = true;\r\n                this.dragOrigin = e.pos\r\n            }\r\n        })\r\n\r\n        this.game.input.pointers.primary.on('wheel', (e: Input.WheelEvent) => {\r\n            let z = this.camera.getZoom()\r\n            let step = 0.05\r\n            let min = 0.05, max = 8\r\n            if (e.deltaY < 0) {\r\n                this.camera.zoom(Math.min(z + step, max))\r\n            } else if (e.deltaY > 0) {\r\n                this.camera.zoom(Math.max(z - step, min))\r\n            }\r\n        })\r\n\r\n        this.game.input.keyboard.on('press', (e: Input.KeyEvent) => {\r\n            if (e.key === Input.Keys.H) {\r\n                if (this.buildings && this.buildings[0]) {\r\n                    this.camera.move(this.buildings[0].pos, 500)\r\n                    this.camera.zoom(0.5, 1000)\r\n                }\r\n            }\r\n        })\r\n    }\r\n\r\n    public onDeactivate() {\r\n        this.game.input.pointers.primary.off('move')\r\n        this.game.input.pointers.primary.off('down')\r\n        this.game.input.pointers.primary.off('up')\r\n        this.game.input.pointers.primary.off('wheel')\r\n    }\r\n\r\n\r\n    get buildings() { return this.planet.colony.buildings }\r\n\r\n\r\n    private nextMissingRequiredStructure(): Structure {\r\n        let requiredStructures: Structure[] = Construct.requiredStructureList.map(s => new s())\r\n        let actualStructureNames: string[] = this.buildings.map(building => building.structure.name)\r\n\r\n        return requiredStructures.find(structure => !actualStructureNames.includes(structure.name))\r\n    }\r\n\r\n    protected prepareNextBuilding(pos: Vector = new Vector(0,0)) {\r\n        let structure = null;\r\n        let nextMissing = this.nextMissingRequiredStructure();\r\n        if (nextMissing) { structure = nextMissing; }\r\n        if (structure) {\r\n            this.startConstructing(structure, pos)\r\n        } else {\r\n            this.hud.setMessage(`Welcome to OSIRIS!`)\r\n        }\r\n    }\r\n\r\n    startConstructing(structure: Structure, pos: Vector = new Vector(0, 0)) {\r\n        structure.origin = pos\r\n        this.hud.setMessage(`Place ${structure.name}`)\r\n        let theNextOne = this.spawnBuilding(structure)\r\n        this.planet.colony.currentlyConstructing = theNextOne\r\n        this.camera.pos = theNextOne.pos\r\n        this.camera.zoom(structure.zoom, 250)\r\n    }\r\n\r\n    protected spawnBuilding(structure: Structure): Building {\r\n        let anotherBuilding = this.assembleBuildingFromStructure(structure)\r\n        anotherBuilding.reshape(anotherBuilding.constrainCursor(anotherBuilding.pos))\r\n        return anotherBuilding\r\n    }\r\n    \r\n    private assembleBuildingFromStructure(structure: Structure): Building {\r\n        let View = Construct.structureViews[structure.view]\r\n        let building = new View(structure, this.planet)\r\n        return building;\r\n    }\r\n} \r\n","import { Color } from 'excalibur';\r\nimport { Structure } from './Structure';\r\nimport { sample } from '../Util';\r\nimport { Planet } from '../actors/Planet/Planet';\r\n\r\n\r\nexport class World {\r\n  static colors = [Color.Red, Color.Blue, Color.Green] // Color.Viridian, Color.Magenta, Color.Chartreuse];\r\n\r\n  color: Color = sample(World.colors).\r\n      darken(0.1).\r\n      desaturate(0.8);\r\n  skyColor: Color = sample([ Color.Cyan, Color.Vermillion ] ). // Color.Rose //World.colors).\r\n        lighten(0.15).\r\n        desaturate(0.65) // sample([Color.Blue, Color.Rose,Color.Blue]).lighten(0.1).desaturate(0.8)\r\n//   colony: Colony = new Colony()\r\n\r\n  \r\n}","module.exports = __webpack_public_path__ + \"0f6ac78b40c6bc151aee01b517f49ca1.png\";","module.exports = __webpack_public_path__ + \"94754f62e0ae4d23d386e246f5e0cb6e.png\";","import * as ex from 'excalibur';\r\nconst sword = require('./images/sword.png');\r\nconst bookshelf = require('./images/bookshelf.png');\r\n// const bookshelfSvg = require('./images/bookshelf-plain.svg');\r\n\r\nlet Resources = {\r\n    Sword: new ex.Texture(sword),\r\n\r\n    Bookshelf: new ex.Texture(bookshelf),\r\n\r\n    // BookshelfSVG: new ex.Texture(bookshelfSvg)\r\n}\r\n\r\nexport { Resources }\r\n","import { Game } from './Game';\r\nimport { World } from './models/World';\r\nimport { Construct } from './scenes/Construct';\r\n\r\nconst theWorld = new World();\r\nconst game = new Game(theWorld);\r\n\r\n// scenes\r\nconst construct = new Construct(game);\r\ngame.add('construct', construct);\r\n\r\ngame.start().then(() => {\r\n  game.goToScene('construct');\r\n});\r\n"],"sourceRoot":""}