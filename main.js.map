{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/Util.ts","webpack:///./src/Game.ts","webpack:///./src/values/DeviceSize.ts","webpack:///./src/actors/Building/index.ts","webpack:///./src/models/Machine.ts","webpack:///./src/models/Economy.ts","webpack:///./src/values/Orientation.ts","webpack:///./src/actors/Building/Building.ts","webpack:///./src/Painting.ts","webpack:///./src/strategies/Strategy.ts","webpack:///./src/Elemental.ts","webpack:///./src/actors/Hud/Pane.ts","webpack:///./src/actors/Device.ts","webpack:///./src/models/Structure.ts","webpack:///./src/models/RoomRecipe.ts","webpack:///./src/actors/Citizen.ts","webpack:///./src/actors/Building/BackgroundPatterns.ts","webpack:///./src/values/Scale.ts","webpack:///./src/GameController.ts","webpack:///./src/models/World.ts","webpack:///./src/actors/Planet/MountainLayers.ts","webpack:///./src/actors/Planet/PlanetBackground.ts","webpack:///./src/actors/Planet/Planet.ts","webpack:///./src/strategies/CombatStrategy.ts","webpack:///./src/actors/Hud/Hud.ts","webpack:///./src/values/Graph.ts","webpack:///./src/Resources.ts","webpack:///./src/scenes/Menu.ts","webpack:///./src/scenes/Arena.ts","webpack:///./src/models/TechnologyRank.ts","webpack:///./src/models/TechTree.ts","webpack:///./src/actors/player.ts","webpack:///./src/actors/Planet/Mountains.ts","webpack:///./src/actors/Planet/SkyLayer.ts","webpack:///./src/actors/Planet/SkyLayers.ts","webpack:///./src/actors/LaserBeam.ts","webpack:///./src/strategies/AttackNearestHostileStrategy.ts","webpack:///./src/strategies/EatingStrategy.ts","webpack:///./src/strategies/WhenHungryEatingStrategy.ts","webpack:///./src/strategies/SleepingStrategy.ts","webpack:///./src/strategies/AnyBedSleepingStrategy.ts","webpack:///./src/strategies/ConstructionStrategy.ts","webpack:///./src/strategies/ProximityBasedConstruction.ts","webpack:///./src/strategies/ProductionStrategy.ts","webpack:///./src/strategies/CapacityBasedProduction.ts","webpack:///./src/actors/Planet/Population.ts","webpack:///./src/actors/Planet/NavigationTree.ts","webpack:///./src/actors/Planet/Colony.ts","webpack:///./src/values/InteractionRequest.ts","webpack:///./src/actors/Hud/CitizenList.ts","webpack:///./src/actors/Hud/Modal.ts","webpack:///./src/actors/Hud/Palette.ts","webpack:///./src/actors/Hud/CardBody.ts","webpack:///./src/actors/Hud/CardTitle.ts","webpack:///./src/actors/Hud/Card.ts","webpack:///./src/actors/Hud/MusicPlayer.ts","webpack:///./src/actors/Hud/EconomicValue.ts","webpack:///./src/actors/Hud/EconomyView.ts","webpack:///./src/actors/Hud/ResourceListEntry.ts","webpack:///./src/actors/Hud/ResourcesList.ts","webpack:///./src/actors/Hud/StatusAnalysisView.ts","webpack:///./src/actors/Building/GroundVehiclePoolView.ts","webpack:///./src/actors/Building/MediumSurfaceRoomView.ts","webpack:///./src/actors/Building/MediumRoomThreeView.ts","webpack:///./src/actors/Building/HugeRoomView.ts","webpack:///./src/actors/Building/LargeRoomView.ts","webpack:///./src/actors/Building/MediumRoomView.ts","webpack:///./src/actors/Building/SmallRoomThreeView.ts","webpack:///./src/actors/Building/BigDomeView.ts","webpack:///./src/actors/Building/MidDomeView.ts","webpack:///./src/actors/Building/SmallDomeThreeView.ts","webpack:///./src/actors/Building/SurfaceRoadView.ts","webpack:///./src/actors/Building/LadderView.ts","webpack:///./src/actors/Building/ArcologyView.ts","webpack:///./src/actors/Building/TunnelView.ts","webpack:///./src/actors/Building/DomeView.ts","webpack:///./src/actors/Building/CommonAreaView.ts","webpack:///./src/actors/Building/CorridorView.ts","webpack:///./src/images/wood-panel-bg.png","webpack:///./src/images/ussf.png","webpack:///./src/images/window-bg.png","webpack:///./src/images/beige-bg.png","webpack:///./src/images/checker-bg.png","webpack:///./src/images/tech-bg.png","webpack:///./src/images/poster-wall-bg.png","webpack:///./src/images/books-bg.png","webpack:///./src/images/leafy-bg.png","webpack:///./src/images/raised-square-bg.png","webpack:///./src/images/mineral-processor-plain.svg","webpack:///./src/images/water-condenser-plain.svg","webpack:///./src/images/oxygen-extractor-plain.svg","webpack:///./src/images/greenhouse-plain.svg","webpack:///./src/images/books-plain.svg","webpack:///./src/images/telescope-plain.svg","webpack:///./src/images/orrery-plain.svg","webpack:///./src/images/lava-lamp-plain.svg","webpack:///./src/images/codex-plain.svg","webpack:///./src/images/statue-plain.svg","webpack:///./src/images/miner-plain.svg","webpack:///./src/images/solar-collector-plain.svg","webpack:///./src/images/couch-plain.svg","webpack:///./src/images/fabricator-plain.svg","webpack:///./src/images/mega-console-plain.svg","webpack:///./src/images/console-red-plain.svg","webpack:///./src/images/console-green-plain.svg","webpack:///./src/images/console-purple-plain.svg","webpack:///./src/images/console-plain.svg","webpack:///./src/images/workstation-plain.svg","webpack:///./src/images/houseplant-plain.svg","webpack:///./src/images/research-server-plain.svg","webpack:///./src/images/fridge-plain.svg","webpack:///./src/images/bed-plain.svg","webpack:///./src/images/cooking-fire-plain.svg","webpack:///./src/images/cabin-plain.svg","webpack:///./src/images/stove-plain.svg","webpack:///./src/images/bench-simple-plain.svg","webpack:///./src/images/vat-plain.svg","webpack:///./src/images/bookshelf-plain.svg","webpack:///./src/models/MechanicalOperation.ts","webpack:///./src/scenes/Construct.ts","webpack:///./src/sounds/future tense.mp3","webpack:///./src/sounds/understanding.mp3","webpack:///./src/sounds/indivision.mp3","webpack:///./src/sounds/assembler.mp3","webpack:///./src/sounds/crater-rock.mp3","webpack:///./src/images/sword.png","webpack:///./src/index.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","1","exports","module","l","m","c","d","name","getter","o","defineProperty","configurable","enumerable","get","r","value","n","__esModule","default","object","property","p","jsonpArray","window","webpackJsonp","oldJsonpFunction","bind","slice","excalibur_1","extremumBy","arr","pluck","extremum","reduce","best","next","pair","_ecRange","a","minBy","fn","Math","min","maxBy","max","sample","floor","random","range","Array","fill","map","_val","idx","closest","cursor","getVector","predicate","matching","filter","elem","distance","flatSingle","concat","deleteByValue","e","deleteByValueOnce","index","indexOf","eachCons","eachChunk","array","measureDistance","b","sleep","ms","Promise","resolve","setTimeout","shuffle","sort","zip","countOccurrences","counts","forEach","containsUniq","testElems","doesContain","arrCopy","missingItem_1","testElem","find","mixColors","factor","aFactor","bFactor","Color","g","onlyUnique","self","Resources_1","Game","_super","world","_this","this","displayMode","DisplayMode","FullScreen","backgroundColor","Black","__extends","start","loader","Loader","key","Resources","addResource","logo","logoWidth","logoHeight","startButtonFactory","myButton","document","createElement","textContent","style","border","display","padding","fontFamily","font","color","fontSize","fontWeight","onmouseenter","Red","darken","toRGBA","onmouseleave","then","console","log","citizenSpeed","debugPath","startHour","bulletSpeed","raidingPartyFrequency","minuteTickMillis","title","Engine","DeviceSize","Scale_1","major","Scale","minor","Tiny","Small","Medium","Large","Huge","getVisibleDeviceSize","size","sz","third","fourth","eighth","second","Building_1","Building","CorridorView_1","CorridorView","CommonAreaView_1","CommonAreaView","DomeView_1","DomeView","TunnelView_1","TunnelView","ArcologyView_1","ArcologyView","LadderView_1","LadderView","SurfaceRoadView_1","SurfaceRoadView","SmallDomeThreeView_1","SmallDomeThreeView","MidDomeView_1","MidDomeView","BigDomeView_1","BigDomeView","SmallRoomThreeView_1","SmallRoomThreeView","MediumRoomView_1","MediumRoomView","LargeRoomView_1","LargeRoomView","HugeRoomView_1","HugeRoomView","MediumRoomThreeView_1","MediumRoomThreeView","MediumSurfaceRoomView_1","MediumSurfaceRoomView","GroundVehiclePoolView_1","structureViews","GroundVehiclePoolView","Economy_1","DeviceSize_1","MechanicalOperation_1","Util_1","images","bookshelf","vat","bench","stove","cabin","fire","bed","fridge","server","plant","workstation","consolePurple","consoleGreen","consoleRed","megaconsole","fabricator","couch","solar","miner","statue","codex","lavaLamp","orrery","telescope","books","greenhouse","o2","h20","minProcessor","Green","Blue","Orange","Violet","Yellow","store","mechanicalOperations","generate","recipe","spawn","accelerateTime","explore","Machine","description","LightGray","cost","ResourceBlock","Mineral","operation","type","image","prereqs","economy","emptyMarket","forDome","hide","isVehicle","tinySlots","isEatingSurface","concretize","onPlacement","device","CommandCenter","arguments","Ore","__assign","Power","supply","demand","Oxygen","Water","Hope","Shelter","t","built","produceResource","building","populate","pos","add","MissionLog","Data","LavaLamp","Table","Joy","Figurine","Beauty","Orrery","Wonder","Books","Idea","Wisdom","OxygenExtractor","WaterCondensingMachine","SolarCell","Bed","Telescope","Statue","StudyMachine","Workstation","Codex","Bookshelf","Couch","Fridge","Meal","Stove","Biomass","Houseplant","Botany","PersonnelRegistry","CloningVat","OrientationConsole","productionTime","AlgaeVat","DissolutionVat","Bioplasma","PlasmaBank","Fabricator","Alloy","LifeSciencesConsole","Miner","MineralProcessor","MiningDrill","MetalStorage","ResearchServer","Algorithm","Greenhouse","Cabin","Orchard","Arbor","ThinkingFountain","Mainframe","Megafabricator","MolecularEngine","fromHex","Aurum","SilverForest","Argent","TimeCrystal","Omnium","HoloProjector","SacredGrove","AtomicCompiler","Preserve","LogicPool","Cathedral","Microcity","LogicCrystal","allMachines","PureValue","availableCapacity","market","Wealth","allValues","sumMarkets","ea","eb","newMarket","_a","sa","da","_b","equilibrium","every","blockColors","lighten","cStep","Viridian","DarkGray","Gray","White","blockColor","block","desaturate","Orientation","Left","Up","Right","Down","compass","flip","orientation","Error","Orientation_1","Game_1","Graph_1","RoomRecipe_1","Machine_1","BackgroundPatterns_1","Painting_1","DevicePlace","structure","planet","x","y","width","height","infra","Transparent","edgeWidth","placed","hover","showLabel","facing","hideBox","childrenBuildings","devices","active","step","anchor","Vector","setup","traits","trait","Traits","OffscreenCulling","on","some","currentlyViewing","toggleActive","collisionType","CollisionType","PreventCollision","nameLabel","Label","draw","ctx","delta","drawRect","aabb","processedColor","spaceFunction","slots","slot","rect","nodes","node","update","engine","tryProduce","tinyDevices","tinyDevice","poly","aabbPoly","getHeight","emptyUnlessActive","isActive","machineEconomies","buildingEconomy","inUse","wasEquil","_i","allValues_1","localCap","globalCap","agg","constrainCursor","clone","reshape","alignToSlot","afterConstruct","handleClick","_pos","getWidth","devicePlaces","deviceInteractionPlaces","place","position","visibleSize","graph","supergraph","Graph","rootNode","findOrCreate","child","parentSlot","edge","childNode","redeem","res","gather","debit","spend","elite","pathFromRect","angledRoofPoly","angleStartY","overlaps","other","rect1","rect2","overlapsAny","colony","buildings","bldg","edgeColor","mainColor","colorBase","clr","connections","findSlot","validConnections","slotList","dir","validStructures","flipped","closestBuildingByType","matchingSlot","compass_1","theSlot","offset","sub","addEqual","buildSlot","parent","addDevice","subEqual","updateFunction","machine","hasPlaceForDevice","nextDevicePlace","getDevices","allTheMachines","machines","allSpaceFunctions","spaceFn","sf","text","background","BackgroundPattern","Grid","Actor","drawPatternedPoly","path","pattern","gridPattern","getBackgroundPattern","save","translate","beginPath","moveTo","pt","lineTo","closePath","fillStyle","strokeStyle","stroke","restore","drawLine","lineWidth","drawPatternedRect","rectangle","filled","dashed","main","fillRect","setLineDash","strokeRect","drawPoly","drawStar","cx","cy","outerRadius","innerRadius","spikes","rot","PI","cos","sin","drawCircle","radius","hemi","theta","arc","drawEllipse","radiusX","radiusY","ellipse","drawText","msg","tx","ty","fillText","InteractionRequest_1","Strategy","pawn","sleepInterval","currentPlanet","findPoweredDevices","recipes","operations","op","explores","attempt","label","sent","pause","gatherBlock","gathered","generatesDesiredBlock","product","stored","gen","closestDeviceByType","storesDesiredBlock","visitDevice","waitTimes","interact","retrieveResource","warn","visit","workExploration","exploring","knowsHow","reserved","vehicle","explored","drive","driven","gathers","workRecipe","debug","produces","knowsRecipe","maker","made","gatherIngredients","consumes","performRecipeTask","blocks","isCarryingUnique","blocks_1","ingredient","tries","timesToAttempt","worked","assembleButton","bg","fg","theButton","textTransform","onmouseover","saturate","Pane","dragging","xOff","yOff","dragStart","target","initialX","clientX","initialY","clientY","drag","preventDefault","currentX","currentY","dragEnd","makeRootElement","_element","show","parentElement","removeChild","flexWrap","body","appendChild","container","margin","addEventListener","left","canvas","offsetLeft","top_1","offsetTop","top","Structure_1","Device","initialPos","imageLoaded","parentDevice","Image","onload","src","Active","computeEconomy","globalAlpha","imageX","imageY","vel","scale","drawImage","iv","bx","by","produced","blockSize","assemble","citizen","drop","progressBar","request","recipe_1","carrying","it","includes","consumed","workTime","getEffectiveWorkTime","carry","requires","has","storeOrExplore","dispense","store_1","stores","getEffectiveOperationalCapacity","res_1","origX","groundSpeed","actions","asPromise","stopDriving","bonus","bonuses","capacity","workSpeed","round","resource","generationTime","generates","snap","snapTiny","allStructures","snapped","halfSize","spot","getCenter","abs","gridGrain","floorY","findAllDevices","hasTinyPlace","nextTinyPlace","tx0","ndx","addTinyDevice","smallMachines","mediumMachines","largeMachines","hugeMachines","smallDome","smallBelow","midDome","midBelow","largeDome","largeBelow","hugeDome","hugeBelow","medGroundVehicles","Structure","view","zoom","Corridor","Ladder","MainTunnel","fifth","MediumSurfaceRoom","SurfaceRoad","first","Dome","seventh","CommonArea","SmallRoomThree","sixth","SmallRoomTwo","SmallDome","MediumRoom","MediumRoomThree","LargeRoom","HugeRoom","SmallDomeThree","MidDome","LargeDome","Arcology","GroundVehiclePool","RoomRecipe","Beige","MissionControl","Window","LivingQuarters","Barracks","Kitchen","Checker","LifeSupportPod","Retreat","CloneMatrix","CloneReception","ReadingRoom","Library","Study","Wood","ComputerLab","Archive","Arboretum","AlgaeFarm","SolarArray","Workshop","Nursery","Leafy","Farm","Factory","ComputerCore","Tech","LifeSciencesLab","Refinery","Mine","HoloMatrix","TimeChamber","LivingRoom","Statuary","CapacityBasedProduction_1","ProximityBasedConstruction_1","AnyBedSleepingStrategy_1","WhenHungryEatingStrategy_1","AttackNearestHostileStrategy_1","LaserBeam_1","Citizen","home","evil","alive","isPlanning","workInProgress","sleeping","hunger","energy","health","driving","currentBuilding","lastChoice","combatting","paceUnit","combatMovementUnit","firingRangeBuffer","firing","guarding","productionStrategy","CapacityBasedProduction","constructionStrategy","ProxmityBasedConstruction","sleepingStrategy","AnyBedSleepingStrategy","eatingStrategy","WhenHungryEatingStrategy","fightingStrategy","AttackNearestHostileStrategy","shirtColor","skinColor","weight","w","Passive","bloodEmitter","makeBloodEmitter","ParticleEmitter","emitterType","EmitterType","Circle","minVel","maxVel","minAngle","maxAngle","emitRate","opacity","fadeFlag","particleLife","maxSize","minSize","beginColor","endColor","isEmitting","speedMultiplier","timeFactor","now","Date","getTime","progress","workStarted","workDuration","fatigue","work","isTired","sleepingInBed","healthColor","drawBar","Cyan","rotate","drawSelf","carried","pw","px","py","c_1","ph","duration","reject","resources","targetForDevice","pathTo","glideTo","pathBetweenPoints","followPath","walkSpeed","all","choice","strategies","strat","canApply","takeRest","eat","thirtyMinuteTimer","engageHostile","hostile","distanceToHostile","getWorldPos","enemy","self_1","tooCloseToEnemyLine","enemyPosition","idealCombatRange","tooFarFromEnemyLine","withinFiringRange","advanceTowardsEnemy","nextGoal","unit","hostileDirectionSign","advanceTowards","goal","u","numTimes","times","this_1","bullet_1","assembleBullet","scene","addTimer","Timer","kill","_c","guard","length_1","hostileDir","LaserBeam","injure","amt","attacker","die","bleed","actionQueue","clearActions","raisedSquare","leafy","bookish","posters","tech","checker","beige","ussf","wood","loadBg","loading","Poster","USSF","backgroundPatterns","matrix","DOMMatrix","createPattern","setTransform","majorUnit","minorUnit","minorScale","GameController","game","camera","pointerMoveCallback","leftClickCallback","cameraPanCallback","keyPressCallback","onMove","cb","onLeftClick","onCameraPan","onKeyPress","activate","input","pointers","primary","dragOrigin","button","Input","PointerButton","keyboard","isHeld","Keys","Shift","Middle","z","getZoom","deltaY","moveCam","direction","camMoveSpeed","dv","move","W","A","S","D","deactivate","off","World","nameCitizen","pickColor","colors","pickSkyColor","skyColors","MountainLayers","layers","skyColor","peakCount","onInitialize","layerCount","layerIndex","unshift","baseY","layerHeight","deltas","genPeaks","wc","sc","ls_1","layer","drawLayer","ox","oy","peakWidth","h","dMax","last","maxDiff","curr","pick","PlanetBackground","ex","Colony_1","Population_1","Device_1","World_1","SkyLayers_1","Citizen_1","Planet","hud","onBuildingHover","onDeviceHover","depth","hostiles","threatLevel","baseSkyColor","sky","yBase","createLayer","skyLayers","SkyLayers","buildColonyAndPopulation","tearDown","remove","Colony","population","Population","currentHour","hour","setTime","time","nextHour","inc","oldC","skyColorForHour","newC","mixC","assignColors","setHi","colorMap","night","dawn","morning","afternoon","evening","set","buildingOrDevice","theLayer","currentlyConstructing","theEconomy","popularDemand","citizens","resourceGathered","resourceExpended","placeBuilding","maxPop","increase","theEconomyWithoutPeople","values","val","structureTypes","closestDevice","machineTypes","pathBetween","origin","destination","acc","hasMachineKind","kind","sendRaidingParty","maxPartySize","partySize","sendRaider","getTop","raider","raiders","CombatStrategy","describe","StatusAnalysisView_1","Card_1","Palette_1","Modal_1","CitizenList_1","Elemental_1","ActionList","btns","btn","onclick","action","Hud","onBuildingSelect","onMachineSelect","onFunctionSelect","onCitizenSelect","canvasWidth","canvasHeight","hidePalettes","showCitizenList","modal","devicePixelRatio","status","StatusAnalysisView","displayInfo","showCard","machinePalette","Palette","structurePalette","structuresForPalette","functionPalette","functionsForPalette","citizenList","CitizenList","card","Card","actionList","goToScene","systemMessage","message","buttons","Modal","addButtons","closeSystemMessage","teardown","showPalettes","setStatus","setMessage","comprehended","incrementResource","decrementResource","updateDetails","techTree","following","rebuildPalettes","updatePalettes","updateEconomy","updateMaxPop","setClock","updateRoster","entity","present","cap","showPopCap","showEconomy","updateBuildingPalette","updateMachinePalette","updateFunctionPalette","builtStructures","updateBuilt","builtMachines","machinesForPalette","allUnlockedMachines","builtReifiedFunctions","builtFunctions","rf","UIActor","empty","edges","edgesInverse","isEmpty","newNode","contains","testNode","measure","tolerance","dfs","dst","union","otherGraph","edgeList","theEdges","otherIndex","otherNode","adjacent","adjacentIndices","testNodeIndex","es","esInv","root","visited","rIndex","dfsIndex","rootIndex","childIndex","bfs","bfsIndex","halt","visited_1","visitedNode","adj_1","adjacentNode","shortestPath","maxStep","prevStep","dstIndex","prev","steps","srcIndex","reverse","sword","assembler","futureTense","Sword","Texture","Assembler","Sound","FutureTense","Pane_1","GameController_1","SceneList","Menu","halfHeight","halfWidth","sceneList","emitter","makeBigBangEmitter","controller","onActivate","onDeactivate","Scene","Planet_1","Hud_1","noop","SpawnPalette","Arena","friendlySpawnX","hostileSpawnY","spawnDrift","spawnFriendlyCommander","cmdrName","friendly","spawnFriendly","pawnName","spawnHostile","spawnHostileCommander","spawnPalette","Discipline","Survival","Agriculture","LibraryScience","Cooking","MineralProduction","disciplineTree","level","unlocks","TechnologyRank_1","TechTree","currentLevels","findDisciplineToRankUp","keys","disciplineName","discipline","canRankUp","rankUp","currentRank","nextLevel","unlocked","unlockedMachinesFor","tree","Player","setWidth","setHeight","Mountains","peaks","peakDistance","drift","baseColor","brightColor","peak","y0","mtnWidth","Mountains_1","MountainLayers_1","SkyLayer","lo","hi","mid","buffer","ht","backMountainLayers","mountains","mountainLayers","setLoHi","SkyLayer_1","c0","c1","source","targetDirectionSign","handleCollision","collision","isEvil","CombatStrategy_1","vigilanceRange","isDriving","enemyCombatant","cmdCenter","attack","defensePoint","EatingStrategy","EatingStrategy_1","isHungry","storedResources","desk","SleepingStrategy","SleepingStrategy_1","Strategy_1","ConstructionStrategy","unbuiltDevice","constructDevice","ProductionStrategy","storeBlock","tryStoreBlock","openStore","findRecipe","explorer","findExplorer","findStore","storage_1","storage_2","explorers","notKilled","NavigationTree","seekPath","dest","closestNode","closestNodeAtSameYCoordinate","tol","NavigationTree_1","debugTree","navTree","gradient","createLinearGradient","addColorStop","buildNavTree","st","srcNode","destNode","constrainSourceY","ctrl","activeBuildings","setPrototypeOf","__proto__","constructor","create","CitizenLine","onSelect","followed","buildLine","_line","isFollowed","hungry","tired","makeButton","sleepy","task","justifyContent","paddingLeft","join","alignSelf","busyRow","flexDirection","citizenLines","Map","missingCitizens","doesRosterInclude","lostCitizens","makeRoster","updateRosterDetails","makeCitizenLine","line","makeDialog","clientHeight","buttonMap","entries","intent","buttonFactory","_footer","textAlign","_header","_body","paddingBottom","addHeading","heading","headerMessage","addIconMatrix","iconSet","img","lbl","icon","modalButton","onButtonClick","onButtonEnter","comprehend","makePalette","nowComprehended","prereq","CardBody","describeResources","freqs","notes","fontStyle","FontStyle","Italic","footer","describeEconomy","resourceDescription","domeStatus","bonusMessages","econ","toFixed","CardTitle","announce","CardTitle_1","CardBody_1","x0","cardBody","ix","iy","MusicPlayer","playlist","paused","makePlayer","startMusic","_titleElem","currentTrack","_wrapper","play","advancePlaylist","maxHeight","overflow","inlineBlock","iconFactory","handleAction","song","stop","trackNames","append","iconContent","innerHTML","EconomicValue","valueLabel","setCount","count","EconomicValue_1","EconomyView","valueLabels","val1","val2","addValue","updateView","updatedEconomy","Tooltip","messageLabel","ResourceListEntry","resourceBlock","hovering","tooltip","visible","credit","ResourceListEntry_1","ResourcesList","res1","res2","rx","ry","addEntry","entry","increment","decrement","ResourcesList_1","EconomyView_1","MusicPlayer_1","brand","version","clock","popLabel","musicPlayer","Future Tense","days","toString","hh","hours","minutes","ampm","padStart","_1","deviceSize","theSlots","slotY","devicePlaceSize","devicePlaceCount","floorHeight","sg","right","isGroundFloor","leftSlot","rightSlot","topSlot","backgroundPattern","floorColor","floorEdgeHeight","flagX","flagY","flagpoleHeight","originSlot","slotSize","pickingOrigin","drawShape","xoff","yoff","bezierCurveTo","slotHeights","heights","y1","btm","lst","slotCount","originX","newCursor","output","player_1","TechTree_1","ConstructionEngine","firstBuilding","placingFunction","Construct","defaultMessage","hasActiveModal","followedCitizen","lost","showTutorial","timeStepIntervalMillis","rank","construction","askYesNo","welcome","buildIt","startConstructing","toggleFollowing","player","stepTime","infoMessage","prepareNextBuilding","setupControls","stopFollowing","currentlyBuilding","constrained","buildingUnderConstruction_1","placementValid","deviceUnderConstruction","H","Esc","onComplete","continue","onYes","onNo","yes","no","tutorialMessage","i got this","okay","nextMissingStructureOrFunction","reqs","requiredStructuresAndFunctions","req","actualStructureNames","actualFunctionNames","actualNames","nextMissing","congrats","nextUp","startFollowing","cameraStrategy","LockCameraToActorStrategy","addStrategy","resetZoom","removeStrategy","structureOrMachine","theNextOne","spawnBuilding","spawnDevice","spawnFunction","anotherBuilding","assembleBuildingFromStructure","theStructure","Construct_1","Arena_1","Menu_1","theWorld","construct","arena","menu"],"mappings":"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QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyN,EAAA1Q,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyN,EAAA1Q,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyN,EAAA1Q,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyN,EAAA1Q,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyN,EAAA1Q,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyN,EAAA1Q,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyN,EAAA1Q,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyN,EAAA1Q,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyN,EAAA1Q,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyN,EAAA1Q,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyN,EAAA1Q,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyN,EAAA1Q,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyN,EAAA1Q,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyN,EAAA1Q,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyN,EAAA1Q,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyN,EAAA1Q,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyN,EAAA1Q,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyN,EAAA1Q,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyN,EAAA1Q,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyN,EAAA1Q,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyN,EAAA1Q,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyN,EAAA1Q,GCA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","file":"main.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t1: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([127,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import { Vector, Color } from \"excalibur\";\r\nimport { Rectangle } from \"./values/Rectangle\";\r\nimport { getBackgroundPattern, BackgroundPattern } from \"./actors/Building/BackgroundPatterns\";\r\n\r\nconst extremumBy = (arr, pluck, extremum) => {\r\n  return arr.reduce(function(best, next) {\r\n    var pair = [ pluck(next), next ];\r\n    if (!best) {\r\n       return pair;\r\n    } else if (extremum.apply(null, [ best[0], pair[0] ]) == best[0]) {\r\n       return best;\r\n    } else {\r\n       return pair;\r\n    }\r\n  },null)[1];\r\n}\r\n\r\nexport const minBy = (arr, fn) => extremumBy(arr, fn, Math.min)\r\nexport const maxBy = (arr, fn) => extremumBy(arr, fn, Math.max)\r\n\r\n\r\nexport const sample = (arr) => arr[Math.floor(Math.random() * arr.length)]\r\n\r\nexport const range = (n) => Array(n).fill(0).map((_val,idx) => idx)\r\n\r\nexport function closest<T>(cursor: Vector, arr: Array<T>, getVector: (elem: T) => Vector, predicate?: (elem: T) => boolean) {\r\n   let matching: Array<T> = arr;\r\n   if (predicate) { arr = arr.filter(predicate) }\r\n   if (matching) {\r\n      let distanceToCursor = (elem: T) => cursor.distance(getVector(elem))\r\n      return minBy(matching, distanceToCursor)\r\n   }\r\n}\r\n\r\nexport const flatSingle = arr => [].concat(...arr);\r\n\r\nexport const deleteByValue = (arr, elem) => arr.filter(e => e !== elem)\r\n\r\nexport const deleteByValueOnce = (arr, elem) => {\r\n  let index = arr.indexOf(elem);\r\n  if (index !== -1) arr.splice(index, 1);\r\n}\r\n\r\nexport function eachCons(a, n) {\r\n  var r = []\r\n  for (var i = 0; i < a.length - n + 1; i++) {\r\n    r.push(_ecRange(a, i, n))\r\n  }\r\n  return r\r\n}\r\n\r\nfunction _ecRange (a, i, n) {\r\n  var r = []\r\n  for (var j = 0; j < n; j++) {\r\n    r.push(a[i + j])\r\n  }\r\n  return r\r\n}\r\n\r\nexport function eachChunk(a, n) {\r\n  return a.reduce(function (result, value, index, array) {\r\n    if (index % n === 0)\r\n      result.push(array.slice(index, index + n));\r\n    return result;\r\n  }, []);\r\n}\r\n\r\nexport const measureDistance = (a: Vector, b: Vector) => a.distance(b)\r\n\r\n\r\nexport function sleep(ms) {\r\n  return new Promise(resolve => setTimeout(resolve, ms));\r\n}\r\n\r\nexport function shuffle(arr) {\r\n  return arr.sort(() => Math.random() > 0.5 ? 1 : -1)\r\n}\r\n\r\nexport const zip = (a, b) => a.map((e, i) => [e, b[i]])\r\n\r\nexport const countOccurrences = (arr) => {\r\n  let counts = {}\r\n  arr.forEach((elem) => {\r\n    counts[elem] = counts[elem] || 0\r\n    counts[elem] += 1\r\n  })\r\n  return counts\r\n}\r\n\r\nexport function containsUniq<T>(arr: T[], testElems: T[]) {\r\n  let doesContain = false\r\n  let arrCopy = arr.slice()\r\n  if (arr.length > 0) {\r\n    let missingItem = false\r\n    testElems.forEach(testElem => {\r\n      if (arrCopy.find(e => e === testElem)) {\r\n        deleteByValueOnce(arrCopy, testElem)\r\n      } else {\r\n        missingItem = true\r\n      }\r\n    })\r\n    doesContain = !missingItem\r\n  }\r\n  return doesContain\r\n}\r\n\r\n\r\nexport function mixColors(a: Color, b: Color, factor: number = 0.5): Color {\r\n  let aFactor = factor, bFactor = (1-factor)\r\n  return new Color(\r\n    (a.r * aFactor) + (b.r * bFactor),\r\n    (a.g * aFactor) + (b.g * bFactor),\r\n    (a.b * aFactor) + (b.b * bFactor),\r\n    255\r\n  )\r\n}\r\n\r\nexport function onlyUnique(value, index, self) { \r\n    return self.indexOf(value) === index;\r\n}","import { Engine, DisplayMode, Loader, Timer, Color } from 'excalibur';\r\nimport { World } from './models/World';\r\nimport { Resources } from './Resources';\r\n\r\nexport class Game extends Engine {\r\n  static citizenSpeed: number = 150\r\n  static debugPath: boolean = false\r\n  static startHour: number = 10\r\n\r\n  // combat knobs\r\n  static bulletSpeed: number = 650\r\n  static raidingPartyFrequency: number = 120000\r\n\r\n  // 10000 = 1 min / 10 sec\r\n  // 1000 = 1 min / second\r\n  // 100 = 10 min / second\r\n  static minuteTickMillis: number = 850\r\n\r\n  static font = 'Helvetica'\r\n  static title: string = 'ASTRA';\r\n\r\n  constructor(public world: World) {\r\n    super({\r\n      // width: 800,\r\n      // height: 600,\r\n      displayMode: DisplayMode.FullScreen,\r\n      backgroundColor: Color.Black //world.skyColor\r\n    });\r\n  }\r\n\r\n  public start() {\r\n    let loader = new Loader();\r\n    for (let key in Resources) {\r\n      loader.addResource(Resources[key]);\r\n    }\r\n    loader.backgroundColor = '#0a0e0c'\r\n    // loader.logo = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAABACAYAAAD1Xam+AAACwklEQVR4nO3dQXKbMBQAULvTbXYe1u30fln0IF3kfp1mzXjnA7grMoRxDBISSOi9VSYBPsrw/xdg8OkEAAAAAAAAAAAAAAAAAAAAABTjvPcOHEXfX+/P/t51l6z/61zx+/56n647Fys27qNYIeum2o+WfN97B2o2Puj+/Pq5eNlUB2PINlPHX7qNIW6OBNxz/EehAETq++t9LunHxsuu6XSx2xgvmyJ+aNzUMWsZf+kUgEBDJwlJ/qnX7hLdGVN01K67nHN25mcxUxS+YXtr92Xtdo5AAQgQ2vWfee0uH9sMmU6nOmBzdea5mGvP82sef4m+7b0DtUiZ/D9eXj5+Hs8G5uLnOFDH3bBkrY8/FwWATbWecKVRABZI2f0fmZsF5J6mlp6UrY8/JwVgRu7kH3xVBLY6Ry01CVoff24KADRMAYCGKQBP5Jr+v99uD38/PQ3Y+hbVFtPgvW57LtHiaYACAA1TAPgkZ8et4UM3pe9fagrAxr6a/h9dDcnfIh8F3lBM8u9xTpr6oZ0126x9/KVTADYSk/x7HIhLE27pcmsf2oldN1ZrFwEVgA0ccdq/5Pn7ljpprVwDyGxN8tfcjVLcUqt5/LVQAJ7ousv5999/Ueu+327Byf/WXz911q3vS5fWtVsf/xYUgAyOOOWP0eIHa2rjGkAikv6xVG8CIg8FYMZwAA9v8MllOv2fxt/ircIlJmnr48/NKcACXXc5v/XXbNv/KvnH8XNOpUt/3r728ZdMAWATrgeUSQFYKNcsYK77j+PnSKBaul/r48/FNYAA44Nw7TWBoZiEvts+1eus93gt9trz+drHXyIFIND4ddKxRWBp15+LX8LrtUOlKAKnU73jL40CEGk6JZ0rBuPTh1RfzdXyV2O1Pv5UFIAVpl83tXTZo8SPlerWXq3jBwAAAAAAAAAAAAAAAAAAAAB46D+AUA+q0Ax9RQAAAABJRU5ErkJggg=='\r\n    loader.logo = 'data:image/png;base64,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'\r\n    // loader.logo = 'data:image/png;base64,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'\r\n    // loader.logo = 'data:image/png;base64,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'\r\n    loader.logoWidth = 3 * 256\r\n    loader.logoHeight = 3 * 64\r\n\r\n    // loader.playButtonText = 'make planetfall'\r\n    loader.startButtonFactory = () => {\r\n      let myButton = document.createElement('button');\r\n      myButton.textContent = 'Make Planetfall';\r\n      myButton.style.border = 'none'\r\n      myButton.style.display = 'block'\r\n      myButton.style.padding = '24px'\r\n      myButton.style.fontFamily = Game.font //'Helvetica'\r\n      myButton.style.color = 'white'\r\n      myButton.style.fontSize = '20pt'\r\n      myButton.style.fontWeight = '300'\r\n\r\n      myButton.style.backgroundColor = '#9a5e5c'\r\n\r\n\r\n      myButton.onmouseenter = () => {\r\n        myButton.style.backgroundColor = Color.Red.darken(0.5).toRGBA()\r\n      }\r\n      myButton.onmouseleave = () => { myButton.style.backgroundColor = '#9a5e5c' }\r\n      return myButton;\r\n    };\r\n\r\n    return super.start(loader).then(() => {\r\n      console.log(\"Osiris running.\")\r\n    });\r\n  }\r\n}","import { Scale } from \"./Scale\";\r\nlet { major, minor } = Scale\r\n\r\nexport enum DeviceSize {\r\n    Tiny,\r\n    Small,\r\n    Medium,\r\n    Large,\r\n    Huge,\r\n}\r\n\r\n\r\nexport function getVisibleDeviceSize(size: DeviceSize): number {\r\n    let sz = 10;\r\n    switch (size) {\r\n        case DeviceSize.Tiny: sz = minor.third; break;\r\n        case DeviceSize.Small: sz = major.third; break;\r\n        case DeviceSize.Medium: sz = major.fourth; break;\r\n        case DeviceSize.Large: sz = major.eighth + major.second; break;\r\n        case DeviceSize.Huge: sz = 6 * major.eighth; break;\r\n    }\r\n    return sz;\r\n}","import { Building } from './Building';\r\n\r\nimport { CorridorView } from './CorridorView';\r\nimport { CommonAreaView } from './CommonAreaView';\r\nimport { DomeView } from './DomeView';\r\nimport { TunnelView } from './TunnelView';\r\nimport { ArcologyView } from './ArcologyView';\r\nimport { LadderView } from './LadderView';\r\nimport { SurfaceRoadView } from './SurfaceRoadView';\r\nimport { SmallDomeThreeView } from './SmallDomeThreeView';\r\nimport { MidDomeView } from './MidDomeView';\r\nimport { BigDomeView } from './BigDomeView';\r\nimport { SmallRoomThreeView } from './SmallRoomThreeView';\r\nimport { MediumRoomView } from './MediumRoomView';\r\nimport { LargeRoomView } from './LargeRoomView';\r\nimport { HugeRoomView } from './HugeRoomView';\r\nimport { MediumRoomThreeView } from './MediumRoomThreeView';\r\nimport { MediumSurfaceRoomView } from './MediumSurfaceRoomView';\r\nimport { GroundVehiclePoolView } from './GroundVehiclePoolView';\r\n\r\n\r\nconst structureViews: { [key: string]: typeof Building } = {\r\n    CorridorView,\r\n    LadderView,\r\n    TunnelView,\r\n    SurfaceRoadView,\r\n\r\n    DomeView, // small dome 2\r\n    SmallDomeThreeView,\r\n    MidDomeView,\r\n    BigDomeView,\r\n\r\n    SmallRoomThreeView,\r\n\r\n    CommonAreaView,\r\n    MediumRoomView,\r\n    MediumRoomThreeView,\r\n    LargeRoomView,\r\n    HugeRoomView,\r\n\r\n    ArcologyView,\r\n    MediumSurfaceRoomView,\r\n\r\n    GroundVehiclePoolView,\r\n}\r\n\r\nexport {\r\n    Building,\r\n\r\n    CorridorView,\r\n    LadderView,\r\n    TunnelView,\r\n    SurfaceRoadView,\r\n\r\n    DomeView, // small dome 2\r\n    SmallDomeThreeView,\r\n    MidDomeView,\r\n    BigDomeView,\r\n\r\n    SmallRoomThreeView,\r\n\r\n    CommonAreaView,\r\n    MediumRoomView,\r\n    MediumRoomThreeView,\r\n\r\n    LargeRoomView,\r\n    HugeRoomView,\r\n\r\n    ArcologyView,\r\n\r\n    MediumSurfaceRoomView,\r\n\r\n\r\n    structureViews\r\n\r\n}","import { ResourceBlock, Economy, emptyMarket } from \"./Economy\";\r\nimport { Color, FontStyle, Resource } from \"excalibur\";\r\nimport { DeviceSize } from \"../values/DeviceSize\";\r\nimport { MechanicalOperation, mechanicalOperations } from \"./MechanicalOperation\";\r\nimport { shuffle, range, sample } from \"../Util\";\r\nimport { Device } from \"../actors/Device\";\r\nimport { doesNotReject } from \"assert\";\r\n\r\nconst bookshelfSvg = require('../images/bookshelf-plain.svg');\r\nconst vatSvg = require('../images/vat-plain.svg');\r\nconst benchSimple = require('../images/bench-simple-plain.svg');\r\nconst stove = require('../images/stove-plain.svg');\r\nconst cabin = require('../images/cabin-plain.svg');\r\nconst fire = require('../images/cooking-fire-plain.svg')\r\nconst bed = require('../images/bed-plain.svg')\r\nconst fridge = require('../images/fridge-plain.svg')\r\nconst server = require('../images/research-server-plain.svg')\r\nconst plant = require('../images/houseplant-plain.svg')\r\nconst workstation = require('../images/workstation-plain.svg')\r\n\r\nconst console = require('../images/console-plain.svg')\r\nconst consolePurple = require('../images/console-purple-plain.svg')\r\nconst consoleGreen = require('../images/console-green-plain.svg')\r\nconst consoleRed = require('../images/console-red-plain.svg')\r\nconst megaconsole = require('../images/mega-console-plain.svg')\r\n\r\nconst fabricator = require('../images/fabricator-plain.svg')\r\n\r\nconst couch = require('../images/couch-plain.svg')\r\nconst solar = require('../images/solar-collector-plain.svg')\r\nconst miner = require('../images/miner-plain.svg')\r\n\r\nconst statue = require('../images/statue-plain.svg')\r\nconst codex = require('../images/codex-plain.svg')\r\n\r\nconst lavaLamp = require('../images/lava-lamp-plain.svg')\r\nconst orrery = require('../images/orrery-plain.svg')\r\nconst telescope = require('../images/telescope-plain.svg')\r\nconst books = require('../images/books-plain.svg')\r\n\r\nconst greenhouse = require('../images/greenhouse-plain.svg')\r\nconst o2 = require('../images/oxygen-extractor-plain.svg')\r\nconst h20 = require('../images/water-condenser-plain.svg')\r\n\r\nconst minProcessor = require('../images/mineral-processor-plain.svg')\r\n\r\nconst images = {\r\n    bookshelf: bookshelfSvg,\r\n    vat: vatSvg,\r\n    bench: benchSimple,\r\n    stove,\r\n    cabin,\r\n    fire,\r\n    bed,\r\n    fridge,\r\n    server,\r\n    plant,\r\n    workstation,\r\n\r\n    console,\r\n    consolePurple,\r\n    consoleGreen,\r\n    consoleRed,\r\n    megaconsole,\r\n\r\n    fabricator,\r\n\r\n    couch,\r\n    solar,\r\n    miner,\r\n    statue,\r\n\r\n    codex,\r\n    lavaLamp,\r\n    orrery,\r\n    telescope,\r\n    books,\r\n    greenhouse,\r\n\r\n    o2,\r\n    h20,\r\n\r\n    minProcessor,\r\n\r\n}\r\n\r\n\r\nconst { Red, Green, Blue, Orange, Violet, Yellow } = Color;\r\n\r\nlet { store, generate, recipe, spawn, accelerateTime, explore } = mechanicalOperations\r\n\r\nexport class Machine {\r\n    name: string = '(machine name)'\r\n    description: string = '(machine description)'\r\n    color: Color = Color.LightGray\r\n\r\n    cost: ResourceBlock[] = [ResourceBlock.Mineral]\r\n\r\n    size: DeviceSize = DeviceSize.Small\r\n    operation: MechanicalOperation = { type: 'noop' }\r\n    image = images.vat\r\n    prereqs: (typeof Machine)[] = []\r\n    economy: Economy = emptyMarket()\r\n    forDome: boolean = false\r\n    hide: boolean = false\r\n\r\n    capacity: boolean\r\n\r\n    isVehicle: boolean = false\r\n\r\n    tinySlots: boolean = false\r\n    isEatingSurface: boolean = false\r\n\r\n    concretize(): Machine { return this; } \r\n\r\n    onPlacement(device: Device) {\r\n        // ...whatever we need to script here?\r\n    }\r\n}\r\n\r\nexport class CommandCenter extends Machine {\r\n    name = 'Command Console'\r\n    description = 'commander, we need your help'\r\n    operation = store(\r\n        [ResourceBlock.Mineral, ResourceBlock.Ore], //,ResourceBlock.Biomass],\r\n        24\r\n    )\r\n    image = images.megaconsole\r\n    size = DeviceSize.Medium\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 1, demand: 0 },\r\n        Oxygen: { supply: 20, demand: 0 },\r\n        Water: { supply: 3, demand: 0 },\r\n        Hope: { supply: 1, demand: 0 },\r\n        Shelter: { supply: 3, demand: 0}\r\n    }\r\n\r\n    onPlacement(device: Device) {\r\n        device.built = true\r\n        for (let i in range(20)) {\r\n            device.produceResource(ResourceBlock.Mineral)\r\n        }\r\n        let { building } = device\r\n        building.populate(device.pos.add(building.pos), true)\r\n        building.populate(device.pos.add(building.pos), false)\r\n        building.populate(device.pos.add(building.pos), false)\r\n    }\r\n}\r\n\r\nexport class MissionLog extends Machine {\r\n    name = 'Mission Log'\r\n    description = 'gather data'\r\n    operation = store(\r\n        [ResourceBlock.Data],\r\n        8\r\n    )\r\n    image = images.consolePurple\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 0.1 },\r\n        Hope: { supply: 1, demand: 0 }\r\n    }\r\n}\r\n\r\n//export class Energon extends Machine {\r\n//    name = 'Energon'\r\n//    description = 'food paste'\r\n//}\r\n\r\n// tiny\r\nexport class LavaLamp extends Machine {\r\n    name = 'Lava Lamp'\r\n    description = 'mesmerizing'\r\n    size = DeviceSize.Tiny\r\n    prereqs = [ Table ]\r\n    image  = images.lavaLamp\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Joy: { supply: 1, demand: 0 },\r\n        Power: { supply: 0, demand: 0.1 },\r\n    }\r\n}\r\n\r\nexport class Figurine extends Machine {\r\n    name = 'Figurine'\r\n    description = 'not an action figure'\r\n    size = DeviceSize.Tiny\r\n    prereqs = [ Table ]\r\n    image = images.statue   \r\n    economy = {\r\n        ...emptyMarket(),\r\n        Beauty: { supply: 0.1, demand: 0 },\r\n    }\r\n}\r\n\r\nexport class Orrery extends Machine {\r\n    name = 'Orrery'\r\n    description = 'to the stars'\r\n    size = DeviceSize.Tiny\r\n    prereqs = [ Table ]\r\n    image = images.orrery\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Wonder: { supply: 0.1, demand: 0 },\r\n    }\r\n}\r\n\r\nexport class Books extends Machine {\r\n    name = 'Books'\r\n    description = 'all there in black and white'\r\n    operation = generate(ResourceBlock.Idea, 2)\r\n    size = DeviceSize.Tiny\r\n    prereqs = [ Table ]\r\n    image = images.books\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Wisdom: { supply: 0.1, demand: 0 },\r\n    }\r\n}\r\n\r\n// small\r\n/// small surface\r\n\r\nexport class OxygenExtractor extends Machine {\r\n    name = 'O2 Extractor'\r\n    description = 'breathe deep'\r\n    image = images.o2\r\n    prereqs = [ WaterCondensingMachine, SolarCell ]\r\n    forDome = true\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Oxygen: { supply: 6, demand: 0 },\r\n        Power: { supply: 0, demand: 1 },\r\n    }\r\n}\r\n\r\nexport class SolarCell extends Machine {\r\n    name = 'Solar Cell'\r\n    description = 'feel the warmth'\r\n    image = images.solar\r\n    prereqs = [ Bed ] \r\n\r\n    forDome = true\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 10, demand: 0 },\r\n    }\r\n}\r\n\r\n\r\nexport class WaterCondensingMachine extends Machine {\r\n    name = 'H2O Condenser'\r\n    description = 'have a drink'\r\n// setup a loop here so we have to get survival I?\r\n    prereqs = [ SolarCell, OxygenExtractor ]\r\n    image = images.h20\r\n\r\n    forDome = true\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Water: { supply: 5, demand: 0 },\r\n        Power: { supply: 0, demand: 1 },\r\n    }\r\n}\r\n\r\nexport class Telescope extends Machine {\r\n    name = 'Telescope'\r\n    description = 'look to the stars'\r\n    prereqs = [ Orrery ]\r\n    forDome = true\r\n    image = images.telescope\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Wisdom: { supply: 1, demand: 0 },\r\n    } \r\n}\r\n\r\n\r\n// /// small subsurface\r\n\r\nexport class Table extends Machine {\r\n    name = 'Table'\r\n    description = 'a simple table'\r\n    image = images.bench\r\n    isEatingSurface = true\r\n    // this device provides slots for tiny-sized deviecs\r\n    tinySlots = true\r\n}\r\n\r\nexport class Statue extends Machine {\r\n    name = 'Statue'\r\n    description = 'for honor'\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Hope: { supply: 0.1, demand: 0 },\r\n        Beauty: { supply: 1, demand: 0 },\r\n    }\r\n    image = images.statue\r\n    prereqs = [ Figurine ]\r\n}\r\n\r\nexport class StudyMachine extends Machine {\r\n    operation = recipe(\r\n        [ ResourceBlock.Idea, ResourceBlock.Idea, ResourceBlock.Idea ],\r\n        ResourceBlock.Data\r\n    )\r\n    color = Blue\r\n    concretize(): Machine { return new Workstation() } //(sample([Workstation, Desk]))() }\r\n}\r\n\r\n// export class Desk extends StudyMachine {\r\n//     name = 'Desk'\r\n//     description = 'get to work'\r\n//     image = images.bench\r\n//     prereqs = [ OxygenExtractor ]\r\n//     concretize() { return this }\r\n// }\r\n\r\nexport class Codex extends Machine {\r\n    name = 'Codex'\r\n    description = 'read it closely'\r\n    image = images.codex\r\n    prereqs = [ Bookshelf ]\r\n    operation = store([ResourceBlock.Data], 3)\r\n    color = Blue\r\n    // concretize() { return this }\r\n}\r\n\r\nexport class Workstation extends StudyMachine {\r\n    name = 'Workstation'\r\n    description = 'hackety hack'\r\n    prereqs = [ Bookshelf ]\r\n    image = images.workstation\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 1 },\r\n    }\r\n    concretize() { return this }\r\n}\r\n\r\nexport class Couch extends Machine {\r\n    name = 'Couch'\r\n    description = 'take it easy'\r\n    prereqs = []\r\n    image = images.couch\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Joy: { supply: 0.1, demand: 0 },\r\n    }\r\n}\r\n\r\n\r\n\r\nexport class Bookshelf extends Machine {\r\n    name = 'Shelf'\r\n    description = 'brainstorm'\r\n    operation = generate(ResourceBlock.Idea)\r\n    image = images.bookshelf\r\n    prereqs = [ Books, Codex ] // setup a loop...\r\n    color = Blue\r\n}\r\n\r\n\r\nexport class Fridge extends Machine {\r\n    name = 'Fridge'\r\n    description = 'store meals'\r\n    operation = store([ResourceBlock.Meal], 6)\r\n    image = images.fridge\r\n    prereqs = [Bookshelf]\r\n    color = Yellow\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 1 },\r\n    }\r\n}\r\n\r\nexport class Stove extends Machine {\r\n    name = 'Stove'\r\n    description = 'make a meal'\r\n    operation = recipe(\r\n        [ResourceBlock.Biomass, ResourceBlock.Biomass],\r\n        ResourceBlock.Meal\r\n    )\r\n    image = images.stove\r\n\r\n    prereqs = [Bookshelf, Fridge]\r\n    color = Yellow\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 1 },\r\n    }\r\n}\r\n\r\nexport class Bed extends Machine {\r\n    name = 'Bed'\r\n    description = 'sweet dreams'\r\n    image = images.bed\r\n    prereqs = [ OxygenExtractor ]\r\n    color = Orange\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Shelter: { supply: 1, demand: 0 },\r\n    }\r\n}\r\n\r\nexport class Houseplant extends Machine {\r\n    name = 'House Plant'\r\n    description = 'so nice'\r\n    prereqs = [ Botany, Bed ]\r\n    // produces = ResourceBlock.Food\r\n    cost = [ ResourceBlock.Biomass ]\r\n    operation = generate(ResourceBlock.Biomass, 1)\r\n    color = Green\r\n    image = images.plant\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Oxygen: { supply: 1, demand: 0 },\r\n        Water: { supply: 0, demand: 0.1 },\r\n    }\r\n}\r\n\r\nexport class PersonnelRegistry extends Machine {\r\n    name = 'Personnel Registry'\r\n    description = 'track everybody'\r\n    prereqs = [ CloningVat ]\r\n    operation = store([ResourceBlock.Data], 4)\r\n    color = Yellow\r\n    image = images.console\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 0.1 },\r\n        Wisdom: { supply: 1, demand: 0 },\r\n    }\r\n\r\n    // onPlacement(device: Device) {\r\n    //     device.building.planet\r\n    // }\r\n}\r\n\r\nexport class OrientationConsole extends Machine {\r\n    name = 'Orientation Console'\r\n    description = 'welcome to the colony'\r\n    prereqs = [CloningVat]\r\n    operation = generate(ResourceBlock.Data, 1)\r\n    image = images.consoleRed\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 0.1 },\r\n        Hope: { supply: 1, demand: 0 },\r\n    }\r\n}\r\n\r\nexport class CloningVat extends Machine {\r\n    name = 'Cloning Vat'\r\n    description = 'we all grow'\r\n    // behavior = MachineOperation.SpawnCitizen \r\n    operation = spawn()\r\n    productionTime = 1500\r\n    image = images.vat\r\n    prereqs = [AlgaeVat]\r\n    size = DeviceSize.Small\r\n    color = Violet\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 2 },\r\n    }\r\n}\r\n\r\nexport class DissolutionVat extends Machine {\r\n    name = 'Dissolution Vat'\r\n    description = 'back to basics'\r\n    // behavior = MachineOperation.SpawnCitizen \r\n    operation = recipe(\r\n        [ ResourceBlock.Biomass, ResourceBlock.Biomass ],\r\n        ResourceBlock.Bioplasma\r\n    )\r\n    productionTime = 1500\r\n    image = images.vat\r\n    prereqs = [PlasmaBank]\r\n    size = DeviceSize.Small\r\n    color = Violet\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 1 },\r\n    }\r\n}\r\n\r\nexport class PlasmaBank extends Machine {\r\n    name = 'Bioplasm Bank'\r\n    description = 'hold on'\r\n    operation = store([ ResourceBlock.Bioplasma ])\r\n    prereqs = [AlgaeVat]\r\n    color = Green\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 1 },\r\n    }\r\n}\r\n\r\n    \r\nexport class Fabricator extends Machine {\r\n    name = 'Fabricator'\r\n    description = 'you made that'\r\n    operation = recipe(\r\n        [ResourceBlock.Mineral, ResourceBlock.Mineral],\r\n         ResourceBlock.Alloy\r\n    )\r\n    size = DeviceSize.Small\r\n    color = Red\r\n    prereqs = [Workstation]\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 3 },\r\n    }\r\n    image = images.fabricator\r\n}\r\n\r\nexport class AlgaeVat extends Machine {\r\n    name = 'Algae Vat'\r\n    description = 'where there is a will'\r\n    operation = generate(ResourceBlock.Biomass)\r\n    prereqs = [ OxygenExtractor, Bookshelf, Fridge ]\r\n    size = DeviceSize.Small\r\n    color = Violet\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 2 },\r\n    }\r\n}\r\n\r\nexport class LifeSciencesConsole extends Machine {\r\n    name = 'Life Sciences Console'\r\n    description = 'mind and body together'\r\n    operation = store([ResourceBlock.Biomass, ResourceBlock.Data], 5)\r\n    prereqs = [Houseplant, Botany]\r\n    color = Green\r\n    image = images.consoleGreen\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 0.2 },\r\n    }\r\n}\r\n\r\n// medium\r\n\r\nexport class Miner extends Machine {\r\n    name = 'Miner (Rover)'\r\n    description = 'mobile drill unit'\r\n\r\n    // gather actually takes the machine/citizen around?\r\n    operation = explore(ResourceBlock.Ore, 2)\r\n\r\n    prereqs = [MineralProcessor, MiningDrill]\r\n    color = Red\r\n    size = DeviceSize.Medium\r\n    isVehicle = true\r\n    image = images.miner\r\n}\r\n\r\nexport class MetalStorage extends Machine {\r\n    name = 'Metal Storage'\r\n    description = 'contain minerals and alloys?'\r\n    operation = store([ResourceBlock.Mineral, ResourceBlock.Alloy], 8)\r\n    prereqs = [Bookshelf]\r\n    color = Red\r\n    size = DeviceSize.Medium\r\n}\r\n\r\nexport class ResearchServer extends Machine {\r\n    name = 'Research Server'\r\n    description = 'hold data'\r\n    operation = store([ResourceBlock.Data, ResourceBlock.Algorithm], 10)\r\n    image = images.server\r\n    prereqs = [Bookshelf, Workstation]\r\n    size = DeviceSize.Medium\r\n    color = Blue\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 4 },\r\n    }\r\n}\r\n\r\nexport class Greenhouse extends Machine {\r\n   name = 'Greenhouse'\r\n   description = 'grow some food'\r\n   operation = generate(ResourceBlock.Biomass)\r\n   size = DeviceSize.Medium\r\n   prereqs = [AlgaeVat]\r\n   color = Green\r\n    forDome = true\r\n    image = images.greenhouse\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 1 },\r\n        Water: { supply: 0, demand: 1 },\r\n        Oxygen: { supply: 4, demand: 0 },\r\n    }\r\n}\r\n\r\n\r\nexport class Cabin extends Machine {\r\n   name = 'Cabin'\r\n   description = 'home on the plains'\r\n   operation = recipe(\r\n       [ ResourceBlock.Biomass, ResourceBlock.Biomass ],\r\n       ResourceBlock.Meal\r\n   )\r\n   image = images.cabin\r\n   prereqs = [Orchard]\r\n   size = DeviceSize.Medium\r\n   color = Orange\r\n    forDome = true\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 1 },\r\n        Water: { supply: 0, demand: 1 },\r\n        Shelter: { supply: 4, demand: 0 },\r\n    }\r\n}\r\n\r\nexport class Arbor extends Machine {\r\n    name = 'Arbor'\r\n    description = 'arbor around the clock'\r\n    operation = generate(ResourceBlock.Biomass)\r\n    prereqs = [Orchard]\r\n    size = DeviceSize.Medium\r\n    color = Green\r\n    forDome = true\r\n}\r\n\r\n\r\nexport class Botany extends Machine {\r\n    name = 'Botany'\r\n    description = 'plant lab'\r\n    operation = generate(ResourceBlock.Biomass)\r\n    prereqs = [ OxygenExtractor, Bookshelf ]\r\n    size = DeviceSize.Medium\r\n    color = Green\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 1 },\r\n    }\r\n}\r\n\r\n\r\nexport class MineralProcessor extends Machine {\r\n    name = 'Mineral Processor'\r\n    description = 'wheat from the chaff'\r\n    operation = recipe(\r\n        [ResourceBlock.Ore, ResourceBlock.Ore, ResourceBlock.Ore],\r\n         ResourceBlock.Mineral\r\n    )\r\n    size = DeviceSize.Medium\r\n    color = Red\r\n    image = images.minProcessor\r\n    prereqs = [Workstation, Fabricator]\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 2 },\r\n    }\r\n}\r\n\r\nexport class ThinkingFountain extends Machine {\r\n    name = 'Thinking Fountain'\r\n    description = 'slowly growing'\r\n    size = DeviceSize.Medium\r\n    prereqs = [ Mainframe, Megafabricator, MolecularEngine ]\r\n    color = Color.fromHex('daa520')\r\n    operation = generate(ResourceBlock.Aurum, 8)\r\n    cost = [ResourceBlock.Aurum]\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Wisdom: { supply: 2, demand: 0 },\r\n        Wonder: { supply: 1, demand: 0 }\r\n    }\r\n}\r\n\r\nexport class SilverForest extends Machine {\r\n    name = 'Silver Forest'\r\n    description = 'immense serenity'\r\n    size = DeviceSize.Medium\r\n    prereqs = [ Megafabricator, Mainframe ]\r\n    color = Color.fromHex('c0c0c0')\r\n    operation = store([ResourceBlock.Argent], 12)\r\n    cost = [ResourceBlock.Alloy, ResourceBlock.Algorithm]\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Beauty: { supply: 2, demand: 0 },\r\n        Wonder: { supply: 1, demand: 0 }\r\n    }\r\n    forDome = true\r\n}\r\n\r\nexport class TimeCrystal extends Machine {\r\n    name = 'Time Crystal'\r\n    description = 'xlr8'\r\n    size = DeviceSize.Medium\r\n    color = Color.fromHex('e5e4e2')\r\n    operation = accelerateTime()\r\n    cost = [ResourceBlock.Omnium]\r\n    prereqs = [ Megafabricator, SilverForest ]\r\n}\r\n\r\nexport class HoloProjector extends Machine {\r\n    name = 'Holo Projector'\r\n    description = 'whatever your heart desires'\r\n    size = DeviceSize.Medium\r\n    color = Blue\r\n    operation = generate(ResourceBlock.Data, 3)\r\n    cost = [ResourceBlock.Algorithm, ResourceBlock.Mineral]\r\n    prereqs = [ Mainframe ]\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 2 },\r\n        Joy: { supply: 3, demand: 0 },\r\n    }\r\n}\r\n\r\nexport class SacredGrove extends Machine {\r\n    name = 'Sacred Grove'\r\n    description = 'where the furies play'\r\n    size = DeviceSize.Medium\r\n    forDome = true\r\n    cost = [ ResourceBlock.Omnium ]\r\n    prereqs = [ AtomicCompiler ]\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Oxygen: { supply: 4, demand: 0 },\r\n        Wonder: { supply: 1, demand: 0 },\r\n    }\r\n}\r\n\r\nexport class AtomicCompiler extends Machine {\r\n    name = 'Atomic Compiler'\r\n    description = 'super position'\r\n    operation = recipe(\r\n        [ ResourceBlock.Aurum, ResourceBlock.Argent ],\r\n        ResourceBlock.Omnium\r\n    )\r\n    cost = [ ResourceBlock.Argent, ResourceBlock.Algorithm ]\r\n    prereqs = [ ThinkingFountain, SilverForest ]\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 3 },\r\n    }\r\n}\r\n\r\n\r\n// large devices!\r\n\r\nexport class Orchard extends Machine {\r\n   name = 'Orchard'\r\n   description = 'grow some food'\r\n   operation = generate(ResourceBlock.Biomass, 10)\r\n   size = DeviceSize.Large\r\n   prereqs = [AlgaeVat]\r\n   color = Green\r\n    forDome = true\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 1 },\r\n        Water: { supply: 0, demand: 1 },\r\n        Oxygen: { supply: 2, demand: 0 },\r\n    }\r\n}\r\n\r\n\r\nexport class MiningDrill extends Machine {\r\n    name = 'Mining Drill'\r\n    description = 'ore away'\r\n    operation = generate(ResourceBlock.Ore)\r\n    size = DeviceSize.Large\r\n    prereqs = [ Fabricator ]\r\n    image = images.miner\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 5 },\r\n    }\r\n}    \r\n\r\nexport class Megafabricator extends Machine {\r\n    name = 'Mega-Fabricator'\r\n    size = DeviceSize.Large\r\n    prereqs = [ Fabricator ]\r\n    color = Red\r\n    operation = recipe(\r\n        [ResourceBlock.Alloy, ResourceBlock.Algorithm],\r\n        ResourceBlock.Argent\r\n    )\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 8 },\r\n    }\r\n}\r\n\r\nexport class MolecularEngine extends Machine {\r\n    name = 'Molecular Engine'\r\n    size = DeviceSize.Large\r\n    prereqs = [ Megafabricator ]\r\n    color = Violet\r\n    operation = recipe(\r\n        [ResourceBlock.Bioplasma, ResourceBlock.Algorithm],\r\n        ResourceBlock.Aurum\r\n    )\r\n    image = images.megaconsole\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 3 },\r\n        Water: { supply: 0, demand: 1 },\r\n    }\r\n}\r\n\r\nexport class Mainframe extends Machine {\r\n    name = 'Mainframe'\r\n    size = DeviceSize.Large\r\n    color = Blue\r\n    prereqs = [ResearchServer]\r\n    cost = [ ResourceBlock.Mineral, ResourceBlock.Mineral ]\r\n    operation = recipe(\r\n        [ ResourceBlock.Data, ResourceBlock.Data ],\r\n        ResourceBlock.Algorithm\r\n    )\r\n    image = images.server\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 6 },\r\n    }\r\n}\r\n\r\nexport class Preserve extends Machine {\r\n    name = 'Nature Preserve'\r\n    size = DeviceSize.Large\r\n    prereqs = [ Arbor ]\r\n    color = Green\r\n    forDome = true\r\n    operation = generate(ResourceBlock.Biomass, 12)\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Water: { supply: 0, demand: 4 },\r\n        Oxygen: { supply: 12, demand: 0 },\r\n    }\r\n}\r\n\r\nexport class LogicPool extends Machine {\r\n    name = 'Logic Pool'\r\n    size = DeviceSize.Large\r\n    prereqs = [ MolecularEngine ]\r\n    color = Color.fromHex('daa520')\r\n    operation = store([ResourceBlock.Aurum], 12)\r\n    cost = [ResourceBlock.Algorithm, ResourceBlock.Bioplasma]\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Wisdom: { supply: 2, demand: 0 },\r\n        Wonder: { supply: 1, demand: 0 }\r\n    }\r\n}\r\n\r\nexport class Cathedral extends Machine {\r\n    name = 'Cathedral'\r\n    description = 'first ultrahumanist'\r\n    size = DeviceSize.Large\r\n    prereqs = [ SacredGrove ]\r\n}\r\n\r\n\r\n/// huge devices\r\n\r\nexport class Microcity extends Machine {\r\n    name = 'Microcity'\r\n    size = DeviceSize.Huge\r\n    prereqs = [ Megafabricator ]\r\n    color = Orange\r\n    forDome = true\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Water: { supply: 0, demand: 2 },\r\n        Power: { supply: 0, demand: 2 },\r\n        Joy: { supply: 5, demand: 0 },\r\n        Hope: { supply: 5, demand: 0 },\r\n        Beauty: { supply: 1, demand: 0 },\r\n        Wonder: { supply: 1, demand: 0 },\r\n    }\r\n}\r\n\r\nexport class LogicCrystal extends Machine {\r\n    name = 'Logic Crystal'\r\n    size = DeviceSize.Huge\r\n    prereqs = [ Megafabricator ]\r\n    color = Blue\r\n}\r\n\r\n// export class MiniSun extends Machine {}\r\n\r\nexport const allMachines: (typeof Machine)[] = [\r\n    AlgaeVat,\r\n    Arbor,\r\n    Bed,\r\n    Bookshelf,\r\n    Cabin,\r\n    CloningVat,\r\n    // Desk,\r\n    Fabricator,\r\n    Fridge,\r\n    Houseplant,\r\n    Megafabricator,\r\n    MiningDrill,\r\n    Orchard,\r\n    OxygenExtractor,\r\n    Preserve,\r\n    ResearchServer,\r\n    SolarCell,\r\n    Stove,\r\n    WaterCondensingMachine,\r\n    Workstation,\r\n    Microcity,\r\n    LogicCrystal,\r\n    Botany,\r\n\r\n    MineralProcessor,\r\n    PlasmaBank,\r\n    DissolutionVat,\r\n    MetalStorage,\r\n    Mainframe,\r\n\r\n    PersonnelRegistry,\r\n    MolecularEngine,\r\n    ThinkingFountain,\r\n    SilverForest,\r\n\r\n    OrientationConsole,\r\n    LifeSciencesConsole,\r\n\r\n    TimeCrystal,\r\n    LogicPool,\r\n    HoloProjector,\r\n    Cathedral,\r\n    SacredGrove,\r\n    AtomicCompiler,\r\n\r\n    Couch,\r\n    Statue,\r\n    Codex,\r\n\r\n    Table,\r\n    LavaLamp,\r\n\r\n    Figurine,\r\n\r\n    Miner,\r\n    Orrery,\r\n    Telescope,\r\n    Books,\r\n]","import { Color } from \"excalibur\";\r\n\r\n// an abstract/intangible thing (or at least something we don't represent)\r\nexport enum PureValue {\r\n    Power = 'Power',\r\n    Oxygen = 'Oxygen',\r\n    Water = 'Water',\r\n    Shelter = 'Shelter',\r\n    Hope = 'Hope',\r\n    Joy = 'Joy',\r\n    Wisdom = 'Wisdom',\r\n    Wealth = 'Wealth',\r\n    Beauty = 'Beauty',\r\n    Wonder = 'Wonder'\r\n}\r\n\r\nexport const allValues: PureValue[] = [\r\n    PureValue.Power,\r\n    PureValue.Oxygen,\r\n    PureValue.Water,\r\n    PureValue.Shelter,\r\n    PureValue.Hope,\r\n    PureValue.Joy,\r\n    PureValue.Wisdom,\r\n    PureValue.Wealth,\r\n    PureValue.Beauty,\r\n    PureValue.Wonder\r\n]\r\n\r\nexport type Economy = { [key in PureValue]: {\r\n    supply: number,\r\n    demand: number\r\n} }\r\n\r\nexport function emptyMarket() : Economy {\r\n    return {\r\n        Power: { supply: 0, demand: 0 },\r\n        Oxygen: { supply: 0, demand: 0 },\r\n        Water: { supply: 0, demand: 0 },\r\n        Shelter: { supply: 0, demand: 0 },\r\n        Hope: { supply: 0, demand: 0 },\r\n        Joy: { supply: 0, demand: 0 },\r\n        Wealth: { supply: 0, demand: 0 },\r\n        Wisdom: { supply: 0, demand: 0 },\r\n        Beauty: { supply: 0, demand: 0 },\r\n        Wonder: { supply: 0, demand: 0 },\r\n    }\r\n}\r\n\r\nexport function availableCapacity(market: Economy, value: PureValue) {\r\n    return Math.floor(market[value].supply - market[value].demand)\r\n}\r\n\r\nexport const sumMarkets: (ea: Economy, eb: Economy) => Economy = (ea, eb) => {\r\n    let newMarket = emptyMarket();\r\n    for (let value in PureValue) {\r\n        let { supply: sa, demand: da } = ea[value]\r\n        let { supply: sb, demand: db } = eb[value]\r\n        let supply = sa + sb\r\n        let demand = da + db\r\n        newMarket[value] = {\r\n            supply,\r\n            demand,\r\n        }\r\n    }\r\n    return newMarket\r\n}\r\n\r\nexport const equilibrium: (e: Economy) => boolean = (e) => {\r\n    return allValues.every(value => availableCapacity(e, value) >= 0)\r\n}\r\n\r\nexport enum ResourceBlock {\r\n    // base\r\n    Biomass = 'Biomass',\r\n    Ore = 'Ore',\r\n    Idea = 'Idea',\r\n\r\n    // derived\r\n    Meal = 'Meal',\r\n    Data = 'Data',\r\n    Mineral = 'Mineral',\r\n    Bioplasma = 'Bioplasma',\r\n\r\n    // higher-order\r\n    Alloy = \"Alloy\",\r\n    Algorithm = \"Algorithm\",\r\n\r\n    // superb\r\n    Argent = \"Argent\",\r\n    Aurum = \"Aurum\",\r\n\r\n    // hyperbolic\r\n    Omnium = \"Omnium\",\r\n}\r\n\r\nlet cStep = 0.3\r\nconst blockColors: { [key in ResourceBlock]: Color } = {\r\n    Biomass: Color.Green,\r\n    Data: Color.Blue.lighten(cStep),\r\n    Mineral: Color.Red,\r\n\r\n    Meal: Color.Yellow.darken(cStep),\r\n    Idea: Color.Blue.lighten(cStep*2), //.desaturate(cStep),\r\n    Ore: Color.Red.darken(cStep),\r\n\r\n    Bioplasma: Color.Viridian,\r\n\r\n    Alloy: Color.DarkGray.darken(cStep), //(cStep),\r\n    Algorithm: Color.Blue.darken(cStep), //.desaturate(cStep),\r\n\r\n    Argent: Color.Gray.lighten(cStep),\r\n    Aurum: Color.Orange.lighten(cStep),\r\n\r\n    Omnium: Color.White,\r\n}\r\n\r\nexport function blockColor(block: ResourceBlock) {\r\n    let baseColor = blockColors[block]\r\n    return baseColor.desaturate(0.1) //.lighten(0.1) //.desaturate(0.25).lighten(0.125)\r\n}\r\n\r\n","\r\nexport enum Orientation { Left, Up, Right, Down } //, Angle }\r\n\r\nexport const compass = [\r\n    Orientation.Left,\r\n    Orientation.Right,\r\n    Orientation.Up,\r\n    Orientation.Down,\r\n]\r\n\r\n\r\nexport function flip(orientation: Orientation): Orientation {\r\n    switch (orientation) {\r\n        case Orientation.Left: return Orientation.Right\r\n        case Orientation.Right: return Orientation.Left\r\n        case Orientation.Up: return Orientation.Down\r\n        case Orientation.Down: return Orientation.Up\r\n    }\r\n    throw new Error(`Don't know orientation ${ orientation }`)\r\n}","import { Actor, Vector, CollisionType, Color, Label, Traits, FontStyle } from \"excalibur\";\r\nimport { Planet } from \"../Planet/Planet\";\r\nimport { Structure, } from \"../../models/Structure\";\r\nimport { Slot } from \"../../values/Slot\";\r\nimport { Orientation, flip, compass } from \"../../values/Orientation\";\r\nimport { Game } from \"../../Game\";\r\nimport { Rectangle } from \"../../values/Rectangle\";\r\nimport { closest, measureDistance, deleteByValue, containsUniq, flatSingle } from \"../../Util\";\r\nimport { Graph } from \"../../values/Graph\";\r\nimport { ResourceBlock, emptyMarket, Economy, sumMarkets, equilibrium, allValues, availableCapacity } from \"../../models/Economy\";\r\nimport { Device } from \"../Device\";\r\nimport { allSpaceFunctions, RoomRecipe } from \"../../models/RoomRecipe\";\r\nimport { DeviceSize, getVisibleDeviceSize } from \"../../values/DeviceSize\";\r\nimport { World } from \"../../models/World\";\r\nimport { Machine, allMachines, CommandCenter, MissionLog, StudyMachine } from \"../../models/Machine\";\r\nimport { BackgroundPattern } from \"./BackgroundPatterns\";\r\nimport { EconomicValue } from \"../Hud/EconomicValue\";\r\nimport { drawRect, pathFromRect } from \"../../Painting\";\r\n\r\nexport class DevicePlace {\r\n    constructor(private pos: Vector, private size: DeviceSize) {}\r\n    get position() { return this.pos }\r\n    get visibleSize() { return getVisibleDeviceSize(this.size) }\r\n\r\n}\r\n\r\nexport class Building extends Actor {\r\n    edgeWidth: number = 0\r\n\r\n    nameLabel: Label\r\n\r\n    placed: boolean = false\r\n    hover: boolean = false\r\n    showLabel: boolean = false\r\n    facing: Orientation = Orientation.Right\r\n    hideBox: boolean = false\r\n    parentSlot: Slot\r\n    childrenBuildings: Building[] = []\r\n\r\n    spaceFunction: RoomRecipe\r\n\r\n    private devices: Device[] = []\r\n    givenName: string\r\n\r\n\r\n    private active: boolean = true\r\n    // private built: boolean = false\r\n\r\n    constructor(pos: Vector, public structure: Structure, public planet: Planet) {\r\n        super(\r\n          pos.x,\r\n          pos.y,\r\n          structure.width,\r\n          structure.height,\r\n          structure.infra ? planet.color.darken(0.3) : Color.Transparent\r\n        )\r\n        this.anchor = new Vector(0,0)\r\n\r\n        this.setup();\r\n        this.traits = this.traits.filter(trait => !(trait instanceof Traits.OffscreenCulling))\r\n\r\n        this.on('pointerenter', () => {\r\n            this.hover = true\r\n            if (!this.devices.some(d => d.hover)) {\r\n                this.planet.currentlyViewing = this\r\n            }\r\n        })\r\n\r\n\r\n        this.on('pointerdown', () => {\r\n            // console.log(\"CLICKED BUILDING\", { building: this })\r\n            this.toggleActive();\r\n        })\r\n\r\n        this.on('pointerleave', () => {\r\n            this.hover = false\r\n        })\r\n\r\n        this.collisionType = CollisionType.PreventCollision\r\n\r\n        this.nameLabel = new Label(this.structure.name, 0, 0, Game.font) // 'Helvetica')\r\n        this.nameLabel.fontSize = 9\r\n        // this.nameLabel.fontStyle = FontStyle.Italic\r\n        this.nameLabel.color = Color.White\r\n\r\n        if (this.structure.infra) { this.active = true }\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        if (!this.hideBox) {\r\n            drawRect(ctx, this.aabb(), this.edgeWidth, this.processedColor())\r\n        }\r\n        // this.devices.forEach(device => device.draw(ctx, delta))\r\n        super.draw(ctx, delta)\r\n\r\n        if (this.showLabel && this.spaceFunction) {\r\n            this.nameLabel.pos = this.pos.add(new Vector(28, 24)) //get getCenter().\r\n            // this.nameLabel.color = Color.White\r\n            // this.nameLabel.pos.x = this.getCenter().x //ctx.measureText(this.structure.name).width / 2\r\n            // this.nameLabel.pos.x -= ctx.measureText(this.structure.name).width / 2\r\n            this.nameLabel.draw(ctx, delta)\r\n\r\n        }\r\n\r\n        // let debug = true;\r\n        if (Game.debugPath) {\r\n            if (this.slots().length > 0) {\r\n                // draw slots\r\n                this.slots().forEach((slot: Slot) => {\r\n                    let rect: Rectangle = { x: slot.pos.x, y: slot.pos.y, width: 3, height: 3 }\r\n                    drawRect(ctx, rect, 1, Color.Gray.lighten(0.5))\r\n                })\r\n            }\r\n         if (this.nodes().length > 0) {\r\n                // draw nodes\r\n                this.nodes().forEach((node: Vector) => {\r\n                    let rect: Rectangle = { x: node.x, y: node.y, width: 4, height: 4 }\r\n                    drawRect(ctx, rect, 1, Color.Yellow.lighten(0.5))\r\n                })\r\n            }\r\n\r\n        }\r\n\r\n        let showDevicePlaces = false\r\n        if (showDevicePlaces && this.devicePlaces().length > 0 && this.devices.length < this.devicePlaces().length) {\r\n            this.devicePlaces().forEach(p => {\r\n                let place = p.position\r\n                let sz = p.visibleSize\r\n                drawRect(ctx,\r\n                    { x: place.x - sz/2, y: place.y - sz/2, width: sz, height: sz },\r\n                    0.1,\r\n                    Color.White,\r\n                    false,\r\n                    true\r\n                )\r\n            })\r\n        }\r\n    }\r\n\r\n\r\n    step: number = 0\r\n    update(engine: Game, delta: number) {\r\n        super.update(engine, delta)\r\n\r\n        let tryProduce = this.placed;\r\n        if (tryProduce) {\r\n            this.devices.forEach(device => {\r\n                device.tryProduce(this.step)\r\n                if(device.tinyDevices.length > 0) {\r\n                    device.tinyDevices.forEach(tinyDevice => tinyDevice.tryProduce(this.step))\r\n                }\r\n            });\r\n\r\n        }\r\n\r\n        // this.devices.forEach(d => d.update(engine, delta))\r\n\r\n        this.step += 1\r\n    }\r\n\r\n\r\n    poly() { return this.aabbPoly() }\r\n\r\n\r\n    get name() {\r\n        if (this.spaceFunction) {\r\n            return this.spaceFunction.name\r\n        } else {\r\n            return this.structure.name\r\n        }\r\n    }\r\n\r\n    get description() {\r\n        if (this.spaceFunction) {\r\n            return this.spaceFunction.description\r\n        } else {\r\n            return this.structure.description\r\n        }\r\n    }\r\n\r\n    get floorY() {\r\n        return this.pos.y + this.getHeight() //().y\r\n    }\r\n\r\n    economy(emptyUnlessActive: boolean = true): Economy {\r\n        if (emptyUnlessActive && !this.isActive) {\r\n            return emptyMarket()\r\n        } else {\r\n            let machineEconomies = this.devices.map(d => d.economy)\r\n            //machine.economy)\r\n\r\n            let buildingEconomy = {\r\n                ...emptyMarket(),\r\n                Oxygen: { demand: 1, supply: 0 }, // structural demand\r\n                // Water: { demand: 0.1, supply: 0 },\r\n            }\r\n\r\n            let aggregate = [...machineEconomies, buildingEconomy]\r\n                .reduce(sumMarkets, emptyMarket())\r\n\r\n            return aggregate\r\n        }\r\n    }\r\n\r\n    private toggleActive() {\r\n        if (!this.structure.infra) {\r\n            if (this.active) {\r\n                if (this.devices.some(d => d.inUse)) { return }\r\n                let wasEquil = equilibrium(this.planet.economy)\r\n                this.active = false\r\n                if (wasEquil) {\r\n                    if (!equilibrium(this.planet.economy)) {\r\n                        this.active = true\r\n                        // return\r\n                    }\r\n                    // this.active = true\r\n                } else {\r\n                    // we weren't at equilibrium previously\r\n                    // permit it, if we don't have any supply that would go negative without us?\r\n                    // console.log(\"can we toggle?\")\r\n                    for (let value of allValues) {\r\n                        let localCap = availableCapacity(this.economy(false), value)\r\n                        let globalCap = availableCapacity(this.planet.economy, value)\r\n                        // console.log(\"value\", { value, localCap, globalCap})\r\n                        if (localCap > 0 && globalCap < 0) {\r\n                            // don't permit it to be turned off\r\n                            this.active = true\r\n                        }\r\n                    }\r\n                }\r\n            } else { // this.active is false now\r\n                let agg = [\r\n                    this.planet.economy,\r\n                    this.economy(false)\r\n                ].reduce(sumMarkets, emptyMarket())\r\n\r\n                if (equilibrium(agg)) {\r\n                    this.active = true\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    get isActive() { return !!this.active }\r\n\r\n\r\n    setup(): void { }\r\n\r\n    constrainCursor(cursor: Vector): Vector {\r\n        return cursor.clone();\r\n    }\r\n    reshape(cursor: Vector): void {\r\n        // this.pos = cursor.clone()\r\n        this.alignToSlot(cursor)\r\n    }\r\n\r\n    afterConstruct(): void {}\r\n\r\n    handleClick(_pos): boolean { return true; }\r\n\r\n    slots(): Slot[] {\r\n        return []\r\n    }\r\n\r\n    nodes(): Vector[] {\r\n        let x = this.pos.x + this.getWidth()/2;\r\n        let y = this.pos.y + this.getHeight()\r\n        return [\r\n            new Vector(Math.floor(x), Math.floor(y))\r\n        ];\r\n    }\r\n\r\n    devicePlaces(): DevicePlace[] {\r\n        return []; //this.nodes();\r\n    }\r\n\r\n    deviceInteractionPlaces(): Vector[] {\r\n        return this.devicePlaces().map(place => {\r\n            place.position.y += (place.visibleSize/2)\r\n            return place.position\r\n        })\r\n    }\r\n\r\n    graph(supergraph: Graph<Vector> = new Graph()): Graph<Vector> {\r\n        let g = supergraph\r\n        // assemble subgraph\r\n        let nodes = this.nodes()\r\n        let rootNode = g.findOrCreate(nodes[0], measureDistance)\r\n        for (let child of this.childrenBuildings) {\r\n            let slot = g.findOrCreate(child.parentSlot.pos, measureDistance)\r\n            g.edge(rootNode, slot)\r\n\r\n            let childNode = g.findOrCreate(child.nodes()[0], measureDistance)\r\n            g.edge(slot, childNode)\r\n\r\n            child.graph(g)\r\n        }\r\n        return g\r\n    }\r\n\r\n    // just a patch through to planet -- but could animate something here?\r\n    public redeem(res: ResourceBlock) {\r\n        this.planet.gather(res)\r\n    }\r\n\r\n    public debit(res: ResourceBlock) {\r\n        this.planet.spend(res)\r\n    }\r\n\r\n    public populate(pos: Vector, elite: boolean = false) {\r\n        this.planet.populate(pos, elite) //this.pos)\r\n    }\r\n\r\n    protected aabb(): Rectangle {\r\n        return {\r\n            x: this.pos.x,\r\n            y: this.pos.y,\r\n            width: this.getWidth(),\r\n            height: this.getHeight()\r\n        }\r\n    }\r\n\r\n    protected aabbPoly(): {x:number,y:number}[] {\r\n        return pathFromRect(this.aabb());\r\n\r\n    }\r\n\r\n    protected angledRoofPoly(): {x: number, y: number}[] {\r\n        let angleStartY = 1 * (this.getHeight() / 3) - 3\r\n        let angleStartX = 20 // 1 * (this.getWidth() / 10)\r\n        return [\r\n            // bottom-left\r\n            { x: this.pos.x, y: this.pos.y + this.getHeight() },\r\n\r\n            // upper-left\r\n            { x: this.pos.x, y: this.pos.y + angleStartY },\r\n            { x: this.pos.x + angleStartX, y: this.pos.y },\r\n\r\n            // upper-right\r\n            { x: this.pos.x + this.getWidth() - angleStartX, y: this.pos.y },\r\n            { x: this.pos.x + this.getWidth(), y: this.pos.y + angleStartY },\r\n\r\n            // bottom-right\r\n            { x: this.pos.x + this.getWidth(), y: this.pos.y + this.getHeight() },\r\n        ]\r\n            \r\n    }\r\n\r\n    protected overlaps(other: Building): boolean {\r\n        let rect1 = this.aabb(), rect2 = other.aabb();\r\n        let doesOverlap = (\r\n            rect1.x < rect2.x + rect2.width &&\r\n            rect1.x + rect1.width > rect2.x &&\r\n            rect1.y < rect2.y + rect2.height &&\r\n            rect1.y + rect1.height > rect2.y\r\n        )\r\n        return(!!doesOverlap);\r\n    }\r\n\r\n    public overlapsAny(): boolean {\r\n        return !!this.planet.colony.buildings.find(bldg => bldg !== this && this.overlaps(bldg))\r\n    }\r\n\r\n    protected edgeColor(): Color {\r\n        let edge = this.processedColor().lighten(0.85);\r\n        return edge;\r\n    }\r\n\r\n    protected mainColor(): Color {\r\n        let main = this.processedColor().darken(0.08);\r\n        return main;\r\n    }\r\n\r\n    protected colorBase(): Color {\r\n        return this.color;\r\n    }\r\n\r\n    protected processedColor(): Color {\r\n        let clr = this.colorBase().clone();\r\n        if (!this.placed)  { \r\n            if (this.overlapsAny()) { clr = Color.Red }\r\n            clr.a = 0.8\r\n        }\r\n        if (!this.active) {\r\n            clr = clr.darken(0.8)\r\n        }\r\n\r\n        if (this.hover) { clr.a = 0.5 }\r\n        return clr;\r\n    }\r\n\r\n    get connections() {\r\n        return this.structure.connections;\r\n    }\r\n\r\n\r\n    protected findSlot(\r\n        pos: Vector,\r\n        validConnections: { [key in Orientation]: (typeof Structure)[] } = this.connections\r\n    ): Slot {\r\n        let slotList = []\r\n            for (let dir of compass) {\r\n                const validStructures = validConnections[dir];\r\n                let flipped = flip(dir)\r\n                const buildings = validStructures.map(structure =>\r\n                    this.planet.closestBuildingByType(pos, [structure])\r\n                )\r\n                buildings.forEach(building => {\r\n                    if (building) {\r\n                        let neighborSlots = building.slots()\r\n                        neighborSlots.filter(slot => slot.facing === flipped)\r\n                        .forEach(matchingSlot => {\r\n                            slotList.push(matchingSlot)\r\n                        })\r\n                    }\r\n                })\r\n            }\r\n\r\n        if (slotList.length > 0) {\r\n            return closest(pos, slotList, (slot) => slot.pos)\r\n        } else {\r\n            // console.warn('no conecting structures found')\r\n        }\r\n    }\r\n\r\n    protected alignToSlot(\r\n        cursor: Vector,\r\n        validConnections: { [key in Orientation]: (typeof Structure)[] } = this.connections\r\n    ) {\r\n        let theSlot = this.findSlot(cursor, validConnections)\r\n        if (theSlot) {\r\n            let matchingSlot = this.slots()\r\n                .find(s => s.facing == flip(theSlot.facing))\r\n            if (matchingSlot) {\r\n                let offset = theSlot.pos.sub(matchingSlot.pos)\r\n                this.pos.addEqual(offset)\r\n\r\n                this.parentSlot = theSlot;\r\n                return theSlot;\r\n            }\r\n        }\r\n    }\r\n\r\n    protected buildSlot(x: number, y: number, facing: Orientation = Orientation.Right): Slot {\r\n        return {\r\n            pos: new Vector(x,y),\r\n            facing,\r\n            parent: this\r\n        }\r\n    }\r\n\r\n    public addDevice(device: Device) {\r\n        // device.finalize()\r\n        if (device.building !== this) {\r\n            device.building = this\r\n        }\r\n        this.devices.push(device)\r\n        device.pos.subEqual(this.pos) // = this.devicePlaces()[0].position\r\n        // console.log(\"DEVICE IS AT\", { pos: device.pos })\r\n        this.add(device)\r\n        this.updateFunction()\r\n        device.machine.onPlacement(device)\r\n        this.toggleActive()\r\n\r\n        device.placed = true\r\n    }\r\n\r\n    public hasPlaceForDevice() {\r\n        return this.devices.length < this.devicePlaces().length\r\n    }\r\n\r\n    public nextDevicePlace(): DevicePlace {\r\n        // could throw an err if we have no place\r\n        return this.devicePlaces()[\r\n            this.devices.length\r\n        ]\r\n    }\r\n\r\n    public getDevices() {\r\n        return [ ...this.devices, ...flatSingle(this.devices.map(d => d.tinyDevices)) ]\r\n    }\r\n\r\n    public updateFunction() {\r\n        let allTheMachines = [ StudyMachine, ...allMachines, CommandCenter, MissionLog ]\r\n        let machines = this.devices.map(\r\n            d => allTheMachines.find((m: typeof Machine) => d.machine instanceof m)\r\n        )\r\n        let fn = allSpaceFunctions.find(spaceFn => {\r\n            let sf = new spaceFn()\r\n\r\n            return containsUniq(\r\n              machines,\r\n              sf.machines\r\n            );\r\n        })\r\n        if (fn) {\r\n            // console.log(\"Determined building function\", { fn })\r\n            let sf = new fn()\r\n            this.spaceFunction = sf\r\n            this.nameLabel.text = sf.name\r\n        } else {\r\n            // console.warn(\"Could not identify function!\")\r\n        }\r\n    }\r\n\r\n    get backgroundPattern() {\r\n        if (this.spaceFunction) {\r\n            return this.spaceFunction.background\r\n        } else {\r\n            return BackgroundPattern.Grid\r\n        }\r\n    }\r\n}","import { Vector, Color } from \"excalibur\";\r\nimport { Rectangle } from \"./values/Rectangle\";\r\nimport { BackgroundPattern, getBackgroundPattern } from \"./actors/Building/BackgroundPatterns\";\r\nimport { Game } from \"./Game\";\r\n\r\ntype PaintingPath = { x: number, y: number }[]\r\n\r\nexport function pathFromRect(rect: Rectangle): PaintingPath {\r\n  let pos = { x: rect.x, y: rect.y }\r\n  let path = [\r\n            // bottom-left\r\n            { x: pos.x, y: pos.y + rect.height }, // this.getHeight() },\r\n\r\n            // upper-left\r\n            { x: pos.x, y: pos.y },\r\n\r\n            // upper-right\r\n            { x: pos.x + rect.width, y: pos.y },\r\n\r\n            // bottom-right\r\n            { x: pos.x + rect.width, y: pos.y + rect.height },\r\n        ];\r\n\r\n  return path\r\n}\r\n\r\n// tiny rendering lib\r\nexport function drawLine(ctx: CanvasRenderingContext2D, a: Vector, b: Vector, clr: Color = Color.White, lineWidth: number = 1) {\r\n  let c = clr.clone()\r\n  // c.a = 0.5\r\n  ctx.beginPath()\r\n  ctx.moveTo(a.x, a.y)\r\n  ctx.lineTo(b.x, b.y)\r\n  ctx.strokeStyle = c.toRGBA()\r\n  ctx.lineWidth = lineWidth\r\n  ctx.stroke()\r\n  ctx.lineWidth = 1\r\n}\r\n\r\nexport function drawPatternedRect(\r\n  ctx: CanvasRenderingContext2D,\r\n  rect: Rectangle,\r\n  pattern: BackgroundPattern = BackgroundPattern.Grid\r\n) {\r\n  const gridPattern = getBackgroundPattern(ctx, pattern)\r\n  if (gridPattern) {\r\n    drawPatternedPoly(ctx, pathFromRect(rect), pattern)\r\n\r\n  }\r\n}\r\n\r\nexport function drawPatternedPoly(\r\n  ctx: CanvasRenderingContext2D,\r\n  path: {x:number, y:number}[],\r\n  // rect: Rectangle,\r\n  pattern: BackgroundPattern = BackgroundPattern.Grid,\r\n  edgeColor: Color = Color.Black\r\n) {\r\n  const gridPattern = getBackgroundPattern(ctx, pattern)\r\n  if (gridPattern) {\r\n    ctx.save()\r\n    ctx.translate(path[0].x, path[0].y)\r\n    // ctx.moveTo(0, 0)\r\n    ctx.beginPath()\r\n    ctx.moveTo(0,0) //path[0].x, path[0].y)\r\n    path.forEach(pt => ctx.lineTo(pt.x - path[0].x, pt.y-path[0].y))\r\n    ctx.lineTo(0,0) // path[0].x, path[0].y)\r\n    ctx.closePath()\r\n    // let { x, y, width, height } = rect;\r\n    ctx.fillStyle = gridPattern\r\n    ctx.fill()\r\n\r\n\r\n    ctx.strokeStyle = edgeColor.fillStyle()\r\n    ctx.stroke()\r\n    ctx.restore()\r\n    // ctx.fillRect(x,y,width,height)\r\n\r\n    // ctx.lineWidth = 2\r\n    // ctx.setLineDash([])\r\n    // ctx.strokeStyle = Color.White.toRGBA()\r\n    // ctx.strokeRect(x,y,width,height)\r\n  }\r\n}\r\n\r\nexport function drawRect(\r\n  ctx: CanvasRenderingContext2D,\r\n  rectangle: Rectangle,\r\n  edgeWidth: number = 0,\r\n  color: Color = Color.White,\r\n  filled: boolean = true,\r\n  dashed: boolean = false\r\n) {\r\n  let { x, y, width, height } = rectangle;\r\n\r\n  if (filled) {\r\n    let main = color.clone();\r\n    // main.a = 1\r\n    ctx.fillStyle = main.toRGBA();\r\n    ctx.fillRect(\r\n      x,\r\n      y,\r\n      width,\r\n      height\r\n    )\r\n  }\r\n\r\n  if (edgeWidth > 0) {\r\n    let edge = Color.White.clone();\r\n    ctx.strokeStyle = edge.toRGBA();\r\n    ctx.lineWidth=edgeWidth\r\n    if (dashed) { ctx.setLineDash([5, 10]) }\r\n    else { ctx.setLineDash([]) }\r\n    ctx.strokeRect(\r\n      x, y, width, height\r\n    )\r\n  }\r\n}\r\n\r\nexport function drawPoly(\r\n  ctx: CanvasRenderingContext2D,\r\n  path: {x:number, y:number}[],\r\n  color: Color\r\n  // rect: Rectangle,\r\n  // pattern: BackgroundPattern = BackgroundPattern.Grid\r\n) {\r\n  // const gridPattern = getBackgroundPattern(ctx, pattern)\r\n  // if (gridPattern) {\r\n    ctx.beginPath()\r\n    ctx.moveTo(path[0].x, path[0].y)\r\n    path.forEach(pt => ctx.lineTo(pt.x, pt.y))\r\n    ctx.lineTo(path[0].x, path[0].y)\r\n    ctx.closePath()\r\n    // let { x, y, width, height } = rect;\r\n    ctx.fillStyle = color.fillStyle()\r\n    ctx.fill()\r\n    // ctx.fillRect(x,y,width,height)\r\n\r\n    // ctx.lineWidth = 2\r\n    // ctx.setLineDash([])\r\n    // ctx.strokeStyle = Color.White.toRGBA()\r\n    // ctx.strokeRect(x,y,width,height)\r\n  // }\r\n}\r\n\r\nexport function drawStar(ctx, cx, cy, outerRadius=3.6, innerRadius=1.4, spikes=5, ) {\r\n    var rot = Math.PI / 2 * 3;\r\n    var x = cx;\r\n    var y = cy;\r\n    var step = Math.PI / spikes;\r\n\r\n    ctx.beginPath();\r\n    ctx.moveTo(cx, cy - outerRadius)\r\n    for (let i = 0; i < spikes; i++) {\r\n        x = cx + Math.cos(rot) * outerRadius;\r\n        y = cy + Math.sin(rot) * outerRadius;\r\n        ctx.lineTo(x, y)\r\n        rot += step\r\n\r\n        x = cx + Math.cos(rot) * innerRadius;\r\n        y = cy + Math.sin(rot) * innerRadius;\r\n        ctx.lineTo(x, y)\r\n        rot += step\r\n    }\r\n    ctx.lineTo(cx, cy - outerRadius);\r\n    ctx.closePath();\r\n    ctx.lineWidth = 1;\r\n    ctx.strokeStyle = 'yellow';\r\n    ctx.stroke();\r\n    ctx.fillStyle = 'yellow';\r\n    ctx.fill();\r\n}\r\n\r\nexport function drawCircle(ctx, cx, cy: number, radius: number, color: Color, hemi=false) {\r\n  let theta = hemi ? Math.PI : (2 * Math.PI)\r\n  ctx.beginPath()\r\n\r\n  ctx.arc(\r\n    cx,\r\n    cy, //this.getHeight(),\r\n    radius,\r\n    0,\r\n    theta,\r\n    true\r\n  )\r\n  ctx.closePath()\r\n\r\n  ctx.fillStyle = color.toRGBA()\r\n  ctx.fill()\r\n}\r\n\r\nexport function drawEllipse(ctx: CanvasRenderingContext2D, cx, cy, radiusX: number, radiusY: number, color: Color, hemi=false) {\r\n  let theta = hemi ? Math.PI : (2 * Math.PI)\r\n  ctx.beginPath()\r\n\r\n  ctx.ellipse(\r\n    cx,\r\n    cy, //this.getHeight(),\r\n    radiusX,\r\n    radiusY,\r\n    0,\r\n    0,\r\n    theta,\r\n    // true\r\n  )\r\n  ctx.closePath()\r\n\r\n  ctx.fillStyle = color.toRGBA()\r\n  ctx.fill()\r\n}\r\n\r\nexport function drawText(ctx: CanvasRenderingContext2D, msg: string, tx: number, ty: number) {\r\n  ctx.font = `5pt ${Game.font}`\r\n  ctx.fillStyle = Color.White.toRGBA()\r\n  ctx.fillText(msg, tx, ty)\r\n}","import { Citizen } from \"../actors/Citizen\";\r\nimport { Planet } from \"../actors/Planet/Planet\";\r\nimport { Device } from \"../actors/Device\";\r\nimport { sleep } from \"../Util\";\r\nimport { ResourceBlock } from \"../models/Economy\";\r\nimport { retrieveResource, drive } from \"../values/InteractionRequest\";\r\nimport { Recipe, MechanicalOperation, ExploreForResource } from \"../models/MechanicalOperation\";\r\n\r\nexport abstract class Strategy {\r\n    private sleepInterval: number = 150\r\n    protected isActive: boolean = false;\r\n    constructor(protected pawn: Citizen) { }\r\n\r\n    protected abstract async apply();\r\n    abstract canApply(): boolean;\r\n    abstract describe(): string\r\n\r\n    protected get planet(): Planet { return this.pawn.currentPlanet; }\r\n    protected get devices(): Device[] { return this.planet.colony.findPoweredDevices(); }\r\n    protected get operations(): MechanicalOperation[] { return this.devices.map(d => d.operation); }\r\n    protected get recipes(): Recipe[] {\r\n        let recipes: Recipe[] = [];\r\n        this.operations.forEach(op => {\r\n            if (op.type === 'recipe') {\r\n                recipes.push(op);\r\n            }\r\n        });\r\n        return recipes;\r\n    }\r\n\r\n    protected get explorers(): ExploreForResource[] {\r\n        let explores: ExploreForResource[] = []\r\n        this.operations.forEach(op => {\r\n            if (op.type === 'explore') {\r\n                explores.push(op)\r\n            }\r\n        })\r\n        return explores;\r\n    }\r\n\r\n\r\n    async attempt(): Promise<void> {\r\n        if (this.isActive) {\r\n            return;\r\n        }\r\n        if (!this.isActive) {\r\n            this.isActive = true\r\n            // note apply will need to set this.isActive around its critical section\r\n            await this.apply();\r\n            this.isActive = false\r\n        }\r\n\r\n        // await this.pause()\r\n        // setInterval(() => { this.attempt() }, this.sleepInterval)\r\n    }\r\n\r\n    protected async pause() {\r\n        await sleep(this.sleepInterval)\r\n    }\r\n\r\n    protected async gatherBlock(res: ResourceBlock): Promise<boolean> {\r\n        let gathered = false\r\n        let generatesDesiredBlock = (d: Device) => (d.operation.type === 'generator') &&\r\n            d.product.some(stored => res === stored) //&& !d.inUse\r\n        let gen: Device = this.planet.colony.closestDeviceByType(this.pawn.pos, [], generatesDesiredBlock)\r\n\r\n        let storesDesiredBlock = (d: Device) => (d.operation.type === 'store') &&\r\n              d.product.some(stored => res === stored) //&& !d.inUse\r\n        let store: Device = this.planet.colony.closestDeviceByType(this.pawn.pos, [], storesDesiredBlock)\r\n\r\n        let device: Device = gen || store\r\n\r\n        if (device) {\r\n            // device.inUse = true\r\n            await this.visitDevice(device)\r\n\r\n            if (device.inUse) {\r\n                // at least wait a bit and try again?\r\n                let waitTimes = 0\r\n                while (device.inUse) {\r\n                    await this.pause() //sleep(5000) //this.pause()\r\n                    if (waitTimes++ > 10) {\r\n                        return false \r\n                    }\r\n                }\r\n            }\r\n\r\n            if (await device.interact(this.pawn, retrieveResource(res))) {\r\n                gathered = true\r\n            }\r\n        } else {\r\n            console.warn(\"Didn't gather...\")\r\n            // don't work sub-recipes??\r\n            // let recipe = this.recipes.find(recipe => recipe.produces === res);\r\n            // if (recipe) {\r\n                // gathered = await this.workRecipe(recipe);\r\n                // gathered = true\r\n            // }\r\n        }\r\n\r\n        return gathered\r\n    }\r\n\r\n    protected async visitDevice(device: Device) {\r\n        await this.pawn.visit(device)\r\n    }\r\n\r\n    protected async workExploration(exploring: ExploreForResource): Promise<boolean> {\r\n        let knowsHow = (d: Device) => d.operation === exploring && !d.reserved\r\n        let vehicle = this.planet.colony.closestDeviceByType(this.pawn.pos, [], knowsHow)\r\n        let explored = false\r\n        if (vehicle) {\r\n            vehicle.reserved = true\r\n            if (await this.drive(vehicle, exploring)) {\r\n                explored = true\r\n            }\r\n\r\n            vehicle.reserved = false\r\n        }\r\n        return explored\r\n    }\r\n\r\n    private async drive(vehicle: Device, exploring: ExploreForResource) {\r\n        let driven = false\r\n        if (!vehicle.machine.isVehicle) {\r\n            throw new Error(\"Tried to drive a device that wasn't a vehicle!\")\r\n        } else {\r\n            await this.visitDevice(vehicle)\r\n            if (await vehicle.interact(this.pawn, drive())) {\r\n                if (await vehicle.interact(this.pawn, retrieveResource(exploring.gathers))) {\r\n                    driven = true\r\n                }\r\n            }\r\n        }\r\n        return driven\r\n    }\r\n\r\n    protected async workRecipe(recipe: Recipe): Promise<boolean> {\r\n        console.debug(\"Working recipe\", { product: recipe.produces })\r\n        let knowsRecipe = (d: Device) => d.operation === recipe && !d.reserved\r\n        let maker = this.planet.colony.closestDeviceByType(this.pawn.pos, [], knowsRecipe)\r\n        let made = false\r\n        if (maker) {\r\n            maker.reserved = true\r\n            // maker.inUse = true\r\n            if (await this.gatherIngredients(recipe.consumes)) {\r\n                await this.visitDevice(maker)\r\n                if (await this.performRecipeTask(maker, recipe)) {\r\n                    made = true\r\n                }\r\n            }\r\n            maker.reserved = false\r\n            // maker.inUse = false\r\n        }\r\n        // await this.pause()\r\n        // await this.workRecipe(recipe);\r\n        return made\r\n    }\r\n\r\n    protected async gatherIngredients(blocks: ResourceBlock[]): Promise<boolean> {\r\n        if (!this.pawn.isCarryingUnique(blocks)) {\r\n            console.debug(\"Gathering blocks...\")\r\n            for (let ingredient of blocks) {\r\n                let tries = 0\r\n                let gathered = false\r\n                while (!gathered && tries < 20) {\r\n                    tries += 1\r\n                    if (await this.gatherBlock(ingredient)) {\r\n                        gathered = true\r\n                    } else {\r\n                        await this.pause()\r\n                    }\r\n                }\r\n\r\n                if (!gathered) {\r\n                    console.warn(\"couldn't gather one of the ingredients!!\")\r\n                    return false\r\n                }\r\n                //else {\r\n                //    console.warn(\"didn't gather it!\")\r\n                //    return false\r\n                //}\r\n            }\r\n        }\r\n        return true\r\n    }\r\n\r\n    protected async performRecipeTask(maker: Device, recipe: Recipe, timesToAttempt: number = 5) {\r\n        console.debug(\"Try to perform recipe task...\", { produces: recipe.produces })\r\n        let worked = await maker.interact(this.pawn, { type: 'work', recipe })\r\n        if (!worked) {\r\n            // await this.pause()\r\n            console.warn(\"waiting for machine to become available...\")\r\n            for (let i = 0; i < timesToAttempt; i ++) {\r\n                await this.pause()\r\n                if (await this.performRecipeTask(maker, recipe)) {\r\n                    worked = true\r\n                    break\r\n                }\r\n            }\r\n        }\r\n        return worked\r\n    }\r\n}","import { Color } from \"excalibur\";\r\nimport { Game } from \"./Game\";\r\n\r\nexport function assembleButton(label: string, color: Color = Color.LightGray) {\r\n    let c = color.clone()\r\n    let bg = c.darken(0.5).desaturate(0.5).clone();\r\n    bg.a = 0.8;\r\n    let fg = c.lighten(0.8).desaturate(0.4).clone();\r\n    let theButton = document.createElement('button');\r\n    theButton.textContent = label;\r\n\r\n    theButton.style.display = 'block';\r\n    theButton.style.fontSize = '6pt';\r\n    theButton.style.fontFamily = Game.font // 'Verdana';\r\n    theButton.style.fontWeight = '500';\r\n    theButton.style.padding = '2px';\r\n    theButton.style.width = '100px';\r\n    // theButton.style.height = '100px';\r\n    theButton.style.textTransform = 'uppercase';\r\n    theButton.style.border = 'none' //1px solid rgba(255,255,255,0.08)';\r\n    theButton.style.background = bg.toRGBA();\r\n    theButton.style.color = fg.toRGBA();\r\n    theButton.onmouseover = () => {\r\n        theButton.style.background = bg.saturate(0.5).lighten(0.95).toRGBA();\r\n        theButton.style.color = fg.lighten(0.9).toRGBA();\r\n    };\r\n    theButton.onmouseleave = () => {\r\n        theButton.style.background = bg.toRGBA();\r\n        theButton.style.color = fg.toRGBA();\r\n    };\r\n    return theButton;\r\n}","import { Color } from \"excalibur\";\r\nimport { Game } from \"../../Game\";\r\n\r\nexport class Pane {\r\n    protected _element: HTMLDivElement;\r\n    title: HTMLDivElement\r\n    dragging: boolean = false\r\n    xOff: number = 0\r\n    yOff: number = 0\r\n    initialX: number\r\n    initialY: number\r\n\r\n\r\n    constructor(protected name: string, private x: number, private y: number) {\r\n        this.makeRootElement()\r\n\r\n    }\r\n\r\n    hide() {\r\n        this._element.style.display = 'none'\r\n    }\r\n\r\n    show() {\r\n        this._element.style.display = 'flex'\r\n    }\r\n\r\n    protected makeRootElement() {\r\n        if (this._element) {\r\n            this._element.parentElement.removeChild(this._element);\r\n        }\r\n        // if (!(this.comprehended.length > 0)) { return }\r\n\r\n        this._element = document.createElement('div');\r\n        this._element.style.position = 'absolute';\r\n        this._element.style.display = 'flex';\r\n        this._element.style.flexWrap = 'wrap';\r\n        this._element.style.width = '200px';\r\n        this._element.style.border = 'none'; //1px solid black'; //0.5px solid white';\r\n        // this._element.style.zIndex = '1'; //1px solid black'; //0.5px solid white';\r\n\r\n\r\n        document.body.appendChild(this._element);\r\n\r\n        // make title...\r\n        if (this.name) {\r\n            let container = document.createElement('div')\r\n            container.style.width = '200px'\r\n            // container.draggable = true\r\n            // container.position = 'absolute'\r\n            container.style.backgroundColor = Color.Violet.darken(0.92).toRGBA()\r\n\r\n            this.title = document.createElement('div')\r\n            this.title.textContent = this.name\r\n            this.title.style.fontFamily = Game.font //'Verdana'\r\n            this.title.style.border = 'none'\r\n            this.title.style.fontSize = '8pt'\r\n            this.title.style.fontWeight = '600'\r\n            this.title.style.color = Color.White.toRGBA()\r\n            this.title.style.padding = '4px'\r\n            this.title.style.margin = '0px'\r\n\r\n            container.appendChild(this.title)\r\n            this._element.appendChild(\r\n                container\r\n            )\r\n\r\n            /// hmmmm\r\n            document.addEventListener(\"pointerdown\", (e) => { this.dragStart(e) }, false);\r\n            document.addEventListener(\"pointerup\", (e) => { this.dragEnd(e) }, false);\r\n            document.addEventListener(\"pointermove\", (e) => { this.drag(e) }, false);\r\n\r\n        }\r\n\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D): any {\r\n        if (this._element) {\r\n            let left = ctx.canvas.offsetLeft;\r\n            let top = ctx.canvas.offsetTop;\r\n            this._element.style.left = `${left + this.x + this.xOff}px`;\r\n            this._element.style.top = `${top + this.y + this.yOff}px`;\r\n        }\r\n    }\r\n    private dragStart = (e) => {\r\n        if (e.target === this.title) {\r\n            // console.log(\"drag start\")\r\n            this.initialX = e.clientX - this.xOff;\r\n            this.initialY = e.clientY - this.yOff;\r\n            this.dragging = true\r\n        }\r\n    }\r\n\r\n    private drag = (e) => {\r\n        if (this.dragging) {\r\n            e.preventDefault()\r\n            // console.log(\"drag\")\r\n            let currentX = e.clientX - this.initialX;\r\n            let currentY = e.clientY - this.initialY;\r\n            this.xOff = currentX\r\n            this.yOff = currentY\r\n        }\r\n\r\n    }\r\n\r\n    private dragEnd = (e) => {\r\n        if (this.dragging) {\r\n            // console.log(\"drag end\")\r\n            this.dragging = false\r\n        }\r\n\r\n    }\r\n\r\n    // protected buttonFactory\r\n}","import { Actor, Label, Color, Vector, CollisionType } from \"excalibur\";\r\nimport { Machine } from \"../models/Machine\";\r\nimport { Building } from \"./Building\";\r\nimport { ResourceBlock, blockColor, emptyMarket, sumMarkets } from \"../models/Economy\";\r\nimport { Citizen } from \"./Citizen\";\r\nimport { Planet } from \"./Planet/Planet\";\r\nimport { allStructures } from \"../models/Structure\";\r\nimport { getVisibleDeviceSize, DeviceSize } from \"../values/DeviceSize\";\r\nimport { Recipe, ResourceStorage, MechanicalOperation, ResourceGenerator, ExploreForResource } from \"../models/MechanicalOperation\";\r\nimport { range, deleteByValueOnce, closest } from \"../Util\";\r\nimport { drawRect } from \"../Painting\";\r\nimport { InteractionRequest, retrieveResource } from \"../values/InteractionRequest\";\r\nimport { Game } from \"../Game\";\r\nimport { Rectangle } from \"../values/Rectangle\";\r\n\r\nexport class Device extends Actor {\r\n    // constructionMaterials: ResourceBlock[] = []\r\n\r\n    // could also use for storage?\r\n    product: ResourceBlock[] = []\r\n    nameLabel: Label\r\n    image: HTMLImageElement\r\n    building: Building\r\n    inUse: boolean = false\r\n    hover: boolean = false\r\n\r\n    imageLoaded: boolean = false\r\n\r\n    built: boolean = false\r\n    reserved: boolean = false\r\n\r\n    constructor(\r\n        public machine: Machine,\r\n        initialPos: Vector\r\n    ) {\r\n        super(\r\n            initialPos.x,\r\n            initialPos.y,\r\n            getVisibleDeviceSize(machine.size),\r\n            getVisibleDeviceSize(machine.size),\r\n            Color.Transparent\r\n            // machine.color\r\n        )\r\n\r\n        this.nameLabel = new Label(this.machine.name, 0, 0, Game.font) // 'Helvetica')\r\n        this.nameLabel.fontSize = this.machine.size === DeviceSize.Tiny ? 2 : 6\r\n        this.nameLabel.color = Color.White\r\n\r\n        this.image = new Image();\r\n        this.image.onload = () => { this.imageLoaded = true }\r\n        this.image.src = machine.image\r\n\r\n        this.on('pointerenter', () => {\r\n            // console.log(\"HOVER OVER\", { machine: this.machine })\r\n            this.hover = true\r\n            let tinyDevices = this.tinyDevices.length > 0 &&\r\n              this.tinyDevices.some(d => d.hover)\r\n            if (this.building && !tinyDevices) {\r\n                this.building.planet.currentlyViewing = this\r\n            }\r\n        })\r\n\r\n        this.on('pointerleave', () => {\r\n            this.hover = false\r\n            if (this.building && this.building.planet.currentlyViewing === this) {\r\n                this.building.planet.currentlyViewing = null\r\n            }\r\n        })\r\n\r\n        this.collisionType = CollisionType.Active\r\n    }\r\n\r\n    get imageX() { return this.pos.x - this.getWidth() / 2 }\r\n    get imageY() { return this.pos.y - this.getHeight() / 2 } //- 10 }\r\n\r\n    get economy() { return this.built ? this.computeEconomy() : emptyMarket() }\r\n\r\n    private computeEconomy() {\r\n        let econs = [ this.machine.economy, ...this.tinyDevices.map(d => d.economy) ]\r\n        return econs.reduce(sumMarkets, emptyMarket())\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        if (this.imageLoaded) {\r\n            ctx.save()\r\n            if (!this.built) { ctx.globalAlpha = 0.5 }\r\n            ctx.translate(this.imageX, this.imageY)\r\n            if (this.vel.x > 0) {\r\n                // flip? (assume we're drawn facing left)\r\n                ctx.translate(this.getWidth(), 0)\r\n                ctx.scale(-1,1)\r\n            }\r\n            ctx.drawImage(\r\n                this.image,\r\n                0,\r\n                0, //this.imageY,\r\n\r\n                this.getWidth(),\r\n                this.getHeight()\r\n            )\r\n            // if (!this.built) { ctx.globalAlpha = 1.0 }\r\n\r\n            let c = Color.Transparent.clone()\r\n            if (this.hover) {\r\n                c = Color.White.clone()\r\n                c.a = 0.5\r\n            }\r\n            if (!(this.size === DeviceSize.Tiny || this.placed) && this.overlapsAny()) {\r\n                c = Color.Red.clone()\r\n                c.a = 0.3\r\n            }\r\n\r\n            // if (this.hover || this.overlapsAny()) {\r\n                // let c = Color.White.clone()\r\n                // c.a = 0.6\r\n                drawRect(\r\n                    ctx,\r\n                    { x: 0, y: 0, width: this.getWidth(), height: this.getHeight() },\r\n                    0,\r\n                    c\r\n                )\r\n            // }\r\n            ctx.restore()\r\n        }\r\n\r\n        let iv = new Vector(this.imageX, this.imageY + this.getHeight() / 8)\r\n\r\n        let showLabel = true\r\n        if (showLabel) {\r\n            this.nameLabel.pos = iv\r\n            this.nameLabel.draw(ctx, delta)\r\n        }\r\n\r\n        let { x: bx, y: by } = iv\r\n        let blockSize = 5\r\n        let yOff = this.nameLabel.fontSize\r\n        this.product.forEach((produced, index) => {\r\n            ctx.fillStyle = blockColor(produced).toRGBA()\r\n            ctx.fillRect(bx + blockSize * index, by - blockSize + yOff, blockSize-1, blockSize-1)\r\n        })\r\n\r\n        super.draw(ctx ,delta)\r\n        // this.tinyDevices.forEach(d => d.draw(ctx, delta))\r\n    }\r\n\r\n    get name() { return this.machine.name }\r\n    get description() { return this.machine.description }\r\n    get size() { return this.machine.size }\r\n    get operation() { return this.machine.operation }\r\n\r\n    async assemble(citizen: Citizen) {\r\n        if (citizen.isCarryingUnique(this.machine.cost)) {\r\n            for (let res of this.machine.cost) {\r\n                citizen.drop(res)\r\n                await citizen.progressBar(3000)\r\n            }\r\n            this.built = true\r\n        }\r\n    }\r\n\r\n    async interact(citizen: Citizen, request: InteractionRequest): Promise<boolean> {\r\n        if (this.inUse || !this.built) {\r\n            return false\r\n        }\r\n\r\n        let worked = false\r\n        let op = this.operation\r\n        if (op.type === 'recipe' && request.type === 'work') {\r\n            let recipe: Recipe = op\r\n            // do we have all the things?\r\n            if (citizen.carrying.some(it => recipe.consumes.includes(it))) {\r\n                this.inUse = true\r\n                if (citizen.isCarryingUnique(recipe.consumes)) {\r\n                    recipe.consumes.forEach(consumed => citizen.drop(consumed))\r\n                    let workTime = this.getEffectiveWorkTime(recipe)\r\n                    await citizen.progressBar(workTime) // recipe.workTime)\r\n                    citizen.carry(recipe.produces)\r\n\r\n                    worked = true\r\n                } else {\r\n                    console.warn(\"not carrying all requirements?\", { requires: recipe.consumes, has: citizen.carrying })\r\n                }\r\n                this.inUse = false\r\n            }\r\n        } else if ((op.type === 'store' || op.type === 'explore') && (request.type === 'retrieve' || request.type === 'store')) {\r\n            // accept it! (whatever you have that matches...?)\r\n            let storeOrExplore: ResourceStorage | ExploreForResource = op\r\n            if (request && request.type === 'retrieve') { // assume dispense request for now?\r\n                this.inUse = true\r\n                await citizen.progressBar(1000)\r\n                worked = this.dispense(citizen, request)\r\n                //if (worked) {\r\n                //    await citizen.progressBar(500)\r\n                //}\r\n                this.inUse = false\r\n            } else {\r\n                if (storeOrExplore.type === 'store') {\r\n                    let store: ResourceStorage = storeOrExplore\r\n                    if (request.type === 'store' &&\r\n                        citizen.carrying.some(it => store.stores.includes(it))) { // maybe trying to store?\r\n                        if (this.product.length < this.getEffectiveOperationalCapacity(store)) { // store.capacity) {\r\n                            let res = null\r\n                            if (store.stores.some(stored => { res = citizen.drop(stored); return res })) {\r\n                                if (res) {\r\n                                    this.produceResource(res)\r\n                                    // this.product.push(res)\r\n                                    // this.building.redeem(res)\r\n                                    worked = true\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                } else {\r\n                    console.warn(\"no capacity in this store!!\")\r\n                    worked = false\r\n                }\r\n            }\r\n        } else if (op.type === 'generator') {\r\n            this.inUse = true\r\n            worked = this.dispense(citizen, request)\r\n            if (worked) {\r\n                await citizen.progressBar(500)\r\n            }\r\n            this.inUse = false\r\n        } else if (op.type === 'explore') {\r\n            this.inUse = true\r\n            let origX = this.pos.x\r\n            let groundSpeed = Game.citizenSpeed * 3\r\n            citizen.drive(this)\r\n            let xOff = 25000 * (Math.random() > 0.5 ? -1 : 1)\r\n            await this.actions.moveTo(this.pos.x + xOff, this.pos.y, groundSpeed).asPromise()\r\n            await citizen.progressBar(5000)\r\n            this.produceResource(op.gathers)\r\n            await this.actions.moveTo(origX, this.pos.y, groundSpeed).asPromise()\r\n            worked = true\r\n            citizen.stopDriving()\r\n            this.inUse = false\r\n        }\r\n\r\n        return worked\r\n    }\r\n\r\n\r\n\r\n    getEffectiveOperationalCapacity(op: ResourceGenerator | ResourceStorage | ExploreForResource) {\r\n        let bonus = this.building.spaceFunction\r\n            ? this.building.spaceFunction.bonuses.capacity \r\n        : 0\r\n        return op.capacity + bonus\r\n    }\r\n\r\n    getEffectiveWorkTime(op: Recipe) {\r\n        let bonus = this.building.spaceFunction \r\n         ? this.building.spaceFunction.bonuses.workSpeed\r\n         : 1\r\n\r\n        return Math.round(op.workTime * (1/bonus))\r\n    } \r\n\r\n\r\n    private dispense(citizen: Citizen, request: InteractionRequest) {\r\n        if (request && request.type === 'retrieve') {\r\n            let canFulfill = this.product.find(p => p === request.resource)\r\n            if (canFulfill) {\r\n                deleteByValueOnce(this.product, request.resource)\r\n                citizen.carry(request.resource)\r\n                this.building.debit(request.resource)\r\n                return true\r\n            }\r\n        }\r\n        return false\r\n    }\r\n\r\n    public tryProduce(step: number) {\r\n        if (this.building.isActive && this.built) {\r\n            if (this.machine.operation.type === 'generator') {\r\n                if (step % this.machine.operation.generationTime === 0) {\r\n                    if (this.product.length < this.machine.operation.capacity) {\r\n                        this.produceResource(this.machine.operation.generates)\r\n                    }\r\n                }\r\n\r\n            } else if (this.machine.operation.type === 'spawn') {\r\n                if (step % 1000 == 0) {\r\n                    // console.log(\"WOULD SPAWN\")\r\n                    setTimeout(() => this.building.populate(this.pos.add(this.building.pos)), 100)\r\n                }\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    public produceResource(res: ResourceBlock) {\r\n        this.product.push(res)\r\n        this.building.redeem(res)\r\n    }\r\n\r\n    snap(planet: Planet, pos: Vector = this.pos) {\r\n        if (this.size === DeviceSize.Tiny) { // or large...\r\n            return this.snapTiny(planet, pos)\r\n        } else {\r\n            console.log(\"attempt to snap device...\")\r\n            let bldg = planet.colony.closestBuildingByType(pos,\r\n                allStructures,\r\n                (bldg: Building) => {\r\n                    // let hasSpace = bldg.hasPlaceForDevice()\r\n                    let compatible = bldg.structure.machines.some(Machine => this.machine instanceof Machine)\r\n                    return compatible\r\n\r\n                }\r\n            )\r\n\r\n            let snapped = false\r\n            let halfSize = getVisibleDeviceSize(this.size) / 2\r\n            if (bldg) {\r\n                // console.log(\"we have a building!\", { bldg })\r\n                let spot = bldg.getCenter()\r\n                let d = spot.distance(pos)\r\n                snapped = d < (bldg.getWidth()/2 - halfSize) && (Math.abs(spot.y - pos.y) < 80)\r\n            } else {\r\n                // console.log(\"no bldg found\")\r\n            }\r\n\r\n            if (snapped) {\r\n                this.building = bldg;\r\n                this.pos = pos //.x //this.building.nextDevicePlace().position\r\n                let gridGrain = halfSize\r\n                this.pos.x += bldg.x\r\n                this.pos.x = Math.floor(this.pos.x / gridGrain) * gridGrain\r\n                this.pos.x -= bldg.x\r\n                this.pos.x = Math.max(\r\n                    bldg.x,\r\n                    this.pos.x\r\n                )\r\n                this.pos.x = Math.min(\r\n                    bldg.x + bldg.getWidth() - halfSize,\r\n                    this.pos.x\r\n                )\r\n                this.pos.y = bldg.floorY - getVisibleDeviceSize(this.size)/2 //getCenter().y + (bldg.getHeight()/8)\r\n            } else {\r\n                this.pos = pos\r\n            }\r\n\r\n            // let overlapping = !this.overlapsAny()\r\n\r\n            return snapped // && !overlapping\r\n        }\r\n    }\r\n\r\n    public overlapsAny(): boolean {\r\n        if (this.building) {\r\n            return !!this.building.planet.colony.findAllDevices().find(device => device !== this && this.overlaps(device))\r\n        } else {\r\n            return true\r\n        }\r\n    }\r\n\r\n    private overlaps(other: Device): boolean {\r\n        let rect1 = this.aabb(), rect2 = other.aabb();\r\n        let doesOverlap = (\r\n            rect1.x < rect2.x + rect2.width &&\r\n            rect1.x + rect1.width > rect2.x &&\r\n            rect1.y < rect2.y + rect2.height &&\r\n            rect1.y + rect1.height > rect2.y\r\n        )\r\n        return(!!doesOverlap);\r\n    }\r\n\r\n    placed: boolean = false\r\n    private aabb(): Rectangle {\r\n        let pos = this.pos.clone()\r\n        if (this.placed) {\r\n            pos.addEqual(this.building.pos)\r\n        }\r\n        return {\r\n            x: pos.x,\r\n            y: pos.y,\r\n            width: this.getWidth(),\r\n            height: this.getHeight()\r\n        }\r\n    }\r\n    // private overlapsAny()\r\n\r\n    private snapTiny(planet: Planet, pos: Vector) {\r\n        // okay, we need the closest building with any built machine that HAS a tiny slot\r\n        let bldg = planet.colony.closestBuildingByType(pos,\r\n            allStructures,\r\n            (bldg: Building) => bldg.getDevices().some(\r\n                (device: Device) => device.built && device.hasTinyPlace()\r\n            )\r\n        )\r\n\r\n        if (!bldg) {\r\n            return false\r\n        }\r\n\r\n        // todo look at all devices? (closest bldg may not house closest device!!)\r\n        let device: Device = closest(\r\n            pos,\r\n            bldg.getDevices().filter((d: Device) => d.built && d.hasTinyPlace()),\r\n            (d: Device) => d.pos,\r\n        )\r\n\r\n        this.pos = pos\r\n        let snapped = false\r\n        if (device) {\r\n            let spot = device.nextTinyPlace().add(device.pos).add(device.building.pos)\r\n            let d = spot.distance(pos)\r\n            snapped = d < 50\r\n\r\n            if (snapped) {\r\n                this.building = device.building\r\n                this.parentDevice = device\r\n                this.pos = spot\r\n            }\r\n        }\r\n\r\n        return snapped\r\n    }\r\n\r\n    public parentDevice: Device = null\r\n    tinyDevices: Device[] = []\r\n    private hasTinyPlace() {\r\n        if (!this.machine.tinySlots) {\r\n            return false\r\n        } else {\r\n            return this.tinyDevices.length < 3\r\n        }\r\n    }\r\n\r\n    private nextTinyPlace() {\r\n        let tx0 = -this.getWidth()/3, ty0 = -3\r\n        let ndx = this.tinyDevices.length\r\n        return new Vector(tx0 + (ndx * 14), ty0)\r\n    }\r\n\r\n    public addTinyDevice(device: Device) {\r\n        // console.log(\"ADD TINY DEVICE\", { device: device.machine })\r\n        device.pos = this.nextTinyPlace() //.add(this.pos)\r\n        // device.pos.addEqual(this.pos.add(this.nextTinyPlace()))\r\n        this.tinyDevices.push(device)\r\n        this.add(device)\r\n    }\r\n}","import { Color } from 'excalibur';\r\nimport { Scale } from '../values/Scale';\r\nimport { Orientation } from '../values/Orientation';\r\nimport { Machine, OxygenExtractor, WaterCondensingMachine, SolarCell, allMachines } from './Machine';\r\nimport { DeviceSize } from '../values/DeviceSize';\r\n\r\nconst { major, minor } = Scale\r\n\r\nconst smallMachines = allMachines.filter(machine => (new machine()).size === DeviceSize.Small)\r\nconst mediumMachines = allMachines.filter(machine => (new machine()).size === DeviceSize.Medium)\r\nconst largeMachines = allMachines.filter(machine => (new machine()).size === DeviceSize.Large)\r\nconst hugeMachines = allMachines.filter(machine => (new machine()).size === DeviceSize.Huge)\r\n\r\nconst smallDome = smallMachines.filter(machine => (new machine()).forDome)\r\nconst smallBelow = smallMachines.filter(machine => !(new machine()).forDome)\r\n\r\nconst midDome = mediumMachines.filter(machine => (new machine()).forDome)\r\nconst midBelow = mediumMachines.filter(machine => !(new machine()).forDome && !(new machine()).isVehicle)\r\n\r\nconst largeDome = largeMachines.filter(machine => (new machine()).forDome)\r\nconst largeBelow = largeMachines.filter(machine => !(new machine()).forDome)\r\n\r\nconst hugeDome = hugeMachines.filter(machine => (new machine()).forDome)\r\nconst hugeBelow = hugeMachines.filter(machine => !(new machine()).forDome)\r\n\r\nconst medGroundVehicles = mediumMachines.filter(machine => (new machine()).isVehicle)\r\n\r\nexport class Structure {\r\n    name: string = '(structure name)';\r\n    description: string = '(structure description)';\r\n    view: string = '<structure (room) view>';\r\n    width: number = 10\r\n    height: number = 10\r\n    zoom: number = 1\r\n    color: Color = Color.Gray\r\n    infra: boolean = false\r\n\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Left]: [ Corridor ],\r\n        [Orientation.Right]: [ Corridor ],\r\n        [Orientation.Up]: [ Ladder ],\r\n        [Orientation.Down]: [ Ladder ],\r\n    }\r\n\r\n    machines: (typeof Machine)[] = []\r\n    prereqs: (typeof Structure)[] = []\r\n\r\n\r\n    hide: boolean = false\r\n}\r\n\r\n\r\nexport class MainTunnel extends Structure {\r\n    name: string = 'Main Tunnel';\r\n    description: string = 'Elevating';\r\n    view: string = 'TunnelView';\r\n    width: number = major.fifth\r\n    height: number = major.eighth\r\n    zoom = 0.25\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Left]: [ Corridor ],\r\n        [Orientation.Right]: [ Corridor ],\r\n        [Orientation.Up]: [ MediumSurfaceRoom ],\r\n        [Orientation.Down]: [ ],\r\n    }\r\n    infra = true\r\n}\r\n\r\n\r\nexport class SurfaceRoad extends Structure {\r\n    name: string = 'Road'\r\n    description: string = 'go for a walk'\r\n    view: string = 'SurfaceRoadView'\r\n    width: number = minor.fifth\r\n    height: number = minor.first\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Left]: [ Dome, MediumSurfaceRoom ],\r\n        [Orientation.Right]: [  Dome, MediumSurfaceRoom ],\r\n        [Orientation.Up]: [ ],\r\n        [Orientation.Down]: [ ],\r\n    }\r\n    infra = true\r\n}\r\n\r\nexport class Corridor extends Structure {\r\n    name: string = 'Corridor'\r\n    description: string = 'in the hallway'\r\n    view: string = 'CorridorView'\r\n    width: number = minor.fifth\r\n    height: number = minor.seventh\r\n    zoom = 0.5\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Left]: [\r\n            MainTunnel,\r\n            CommonArea,\r\n            Ladder,\r\n        ],\r\n        [Orientation.Right]: [\r\n            MainTunnel,\r\n            CommonArea,\r\n            Ladder,\r\n        ],\r\n        [Orientation.Up]: [ ],\r\n        [Orientation.Down]: [ ],\r\n    }\r\n    prereqs = [SurfaceRoad] //MainTunnel]\r\n    infra = true\r\n}\r\n\r\nexport class Ladder extends Structure {\r\n    name = 'Ladder'\r\n    description = 'connect vertically'\r\n    view = 'LadderView'\r\n    width = major.second\r\n    height = major.third\r\n    zoom = 0.5\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Up]: [ CommonArea ],\r\n        [Orientation.Down]: [ CommonArea ],\r\n        [Orientation.Left]: [ ],\r\n        [Orientation.Right]: [ ],\r\n    }\r\n    prereqs = [Corridor, SmallRoomThree]\r\n    infra = true\r\n}\r\n\r\n// 'abstract' structure...\r\n\r\nclass Dome extends Structure {\r\n    description: string = 'Biome sweet biome';\r\n\r\n    view: string = 'DomeView';\r\n    width: number  = 2 * major.sixth\r\n    height: number = major.fifth\r\n    zoom = 0.2\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Left]: [ SurfaceRoad ],\r\n        [Orientation.Right]: [ SurfaceRoad ],\r\n        [Orientation.Up]: [ ],\r\n        [Orientation.Down]: [ ],\r\n    }\r\n\r\n    machines = [\r\n        SolarCell,\r\n        OxygenExtractor, WaterCondensingMachine,\r\n    ]\r\n}\r\n\r\n// common subsurface room...\r\nclass CommonArea extends Structure {\r\n    name: string = 'Commons'\r\n    description: string = 'hallway cap'\r\n    view: string = 'CommonAreaView'\r\n    width: number = major.eighth\r\n    height: number = major.fifth\r\n\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Left]: [\r\n            Corridor, CommonArea\r\n            ],\r\n        [Orientation.Right]: [\r\n            Corridor,\r\n            CommonArea,\r\n        ],\r\n        [Orientation.Up]: [ Ladder ],\r\n        [Orientation.Down]: [ Ladder ],\r\n    }\r\n\r\n    machines = []\r\n\r\n    prereqs = [\r\n    ]\r\n}\r\n\r\nexport class SmallRoomTwo extends CommonArea {\r\n    name = 'Sm. Room (2)'\r\n    width = major.eighth\r\n    height = major.fifth\r\n    prereqs = [ SmallDome ]\r\n    machines = smallBelow\r\n}\r\n\r\nexport class SmallRoomThree extends CommonArea {\r\n    name = 'Sm. Room (3)'\r\n    prereqs = [SmallRoomTwo]\r\n    view = 'SmallRoomThreeView'\r\n    width = 2 * major.eighth\r\n    height = major.eighth\r\n    machines = smallBelow\r\n}\r\n\r\nexport class MediumRoom extends CommonArea {\r\n    name = 'Mid Room'\r\n    prereqs = [ SmallRoomThree ]\r\n    view = 'MediumRoomView'\r\n    width = 2 * major.eighth\r\n    machines = [ ...midBelow, ...smallBelow ]\r\n}\r\n\r\nexport class MediumRoomThree extends CommonArea {\r\n    name = 'Mid Room (3)'\r\n    prereqs = [ MediumRoom ]\r\n    view = 'MediumRoomThreeView'\r\n    width = 3 * major.eighth\r\n    height = major.eighth\r\n\r\n    machines = [ ...midBelow, ...smallBelow ]\r\n}\r\n\r\nexport class LargeRoom extends CommonArea {\r\n    name = 'Lg. Room'\r\n    view = 'LargeRoomView'\r\n    prereqs = [ MediumRoom ]\r\n    width = 4 * major.eighth\r\n    height = 2*major.eighth\r\n    machines = [ ...largeBelow, ...midBelow, ...smallBelow ]\r\n}\r\n\r\nexport class HugeRoom extends CommonArea {\r\n    name = 'Huge Room'\r\n    view = 'HugeRoomView'\r\n    width = 10 * major.eighth\r\n    height = 8 * major.eighth\r\n\r\n    prereqs = [LargeRoom]\r\n    machines = hugeBelow\r\n}\r\n\r\n// export class Octagon extends CommonArea {\r\n//     // ...\r\n//     name = 'Octagon'\r\n//     view = 'OctagonView'\r\n// }\r\n\r\n/// surface bldgs\r\n\r\nexport class MediumSurfaceRoom extends Dome {\r\n    name = 'Mid Surf Bldg'\r\n    description = 'home away from home';\r\n\r\n    view: string = 'MediumSurfaceRoomView';\r\n\r\n    width: number = 4 * major.eighth\r\n    height: number = major.seventh\r\n\r\n    zoom = 0.1\r\n\r\n    prereqs = [ SmallDome ]\r\n\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Left]: [ SurfaceRoad ],\r\n        [Orientation.Right]: [ SurfaceRoad ],\r\n        [Orientation.Up]: [ MainTunnel, MediumSurfaceRoom ],\r\n        [Orientation.Down]: [ MainTunnel, MediumSurfaceRoom ],\r\n    }\r\n\r\n    machines = [ ...midBelow, ...smallBelow ]\r\n\r\n    // hide = false // need another one which cares about connecting to roads...\r\n}\r\n\r\nexport class SmallDome extends Dome {\r\n    name = 'Sm. Dome'\r\n    width = 2 * major.fifth\r\n    // height = major.seventh\r\n    machines = smallDome\r\n}\r\n\r\nexport class SmallDomeThree extends Dome {\r\n    name = 'Sm. Dome (3)'\r\n    view = 'SmallDomeThreeView'\r\n    width = 3 * major.fifth\r\n    // height = 2*major.fifth\r\n    machines = smallDome\r\n}\r\n\r\nexport class MidDome extends Dome {\r\n    name = 'Mid Dome'\r\n    view = 'MidDomeView'\r\n    width = 3 * major.seventh\r\n    // height = 2 * major.seventh\r\n    prereqs = [ SmallDome, MediumRoom ]\r\n    machines = [ ...midDome, ...smallDome ]\r\n}\r\n\r\nexport class LargeDome extends Dome {\r\n    name = 'Lg. Dome'\r\n    view = 'BigDomeView'\r\n    width = 4 * major.eighth\r\n    // height = 3 * major.eighth\r\n    prereqs = [MidDome, LargeRoom]\r\n    machines = [ ...largeDome, ...midDome, ...smallDome ]\r\n}\r\n\r\nexport class Arcology extends Dome {\r\n    name = 'Arcology'\r\n    view = 'ArcologyView'\r\n    width = 12 * major.eighth\r\n    height = 36 * major.eighth\r\n    prereqs = [LargeDome, HugeRoom]\r\n    machines = hugeDome\r\n\r\n}\r\n\r\n/// vehicles...!\r\n\r\nexport class GroundVehiclePool extends Dome {\r\n    name = 'Veh. Pool'\r\n    description = 'ground transit hub'\r\n    view = 'GroundVehiclePoolView'\r\n    width = 2 * major.eighth\r\n    height = minor.second\r\n    machines = medGroundVehicles\r\n}\r\n\r\n\r\nexport const allStructures =\r\n    [\r\n        SmallDome,\r\n        SmallDomeThree,\r\n        MidDome,\r\n        LargeDome,\r\n        Arcology,\r\n        MediumSurfaceRoom,\r\n\r\n        SmallRoomTwo,\r\n        SmallRoomThree,\r\n        MediumRoom,\r\n        MediumRoomThree,\r\n        LargeRoom,\r\n        HugeRoom,\r\n\r\n        GroundVehiclePool,\r\n    ]\r\n\r\n\r\n","import { Machine, OxygenExtractor, WaterCondensingMachine, CloningVat, Bookshelf, Bed, Stove, AlgaeVat, ResearchServer, Fridge, SolarCell, Arbor, Cabin, Workstation, Fabricator, Houseplant, Orchard, Megafabricator, StudyMachine, Mainframe, CommandCenter, MissionLog, Botany, OrientationConsole, PersonnelRegistry, MineralProcessor, MiningDrill, HoloProjector, TimeCrystal, Couch, Statue } from './Machine';\r\nimport { Color } from 'excalibur';\r\nimport { Structure, MediumSurfaceRoom } from './Structure';\r\nimport { BackgroundPattern } from '../actors/Building/BackgroundPatterns';\r\n\r\nexport class RoomRecipe {\r\n     name: string = '(generic)'\r\n     description: string = '(generic description)'\r\n     machines: (typeof Machine)[] = []\r\n     color: Color = Color.Gray\r\n\r\n     prereqs: (typeof RoomRecipe)[] =  [] \r\n\r\n     structure: typeof Structure = null\r\n     hide: boolean = false\r\n     background: BackgroundPattern = BackgroundPattern.Beige\r\n\r\n     bonuses: {\r\n          capacity: number, // every store/generator gets this??\r\n          workSpeed: number, // 2 should double work speed (dur *= 1/multiplier)\r\n     } = {\r\n          capacity: 0, // boost cap by one\r\n          workSpeed: 1.00 // 20% bonus to work speed\r\n     }\r\n}\r\n\r\nexport class MissionControl extends RoomRecipe {\r\n     hide = true\r\n     name = 'Mission Control'\r\n     description = 'keeping everything on track'\r\n     structure = MediumSurfaceRoom\r\n     prereqs = [] //ComputerCore, Factory, Farm ]\r\n     machines = [ CommandCenter, MissionLog ]\r\n     background = BackgroundPattern.Window\r\n}\r\n\r\nexport class LivingQuarters extends RoomRecipe {\r\n     name = 'Living Quarters'\r\n     description = 'good night'\r\n     machines = [ Bed ]\r\n}\r\n\r\nclass Barracks extends RoomRecipe {\r\n     name = 'Barracks'\r\n     description = 'sleep tight'\r\n     machines = [ Bed, Bed, Bed ]\r\n}\r\n\r\nexport class Kitchen extends RoomRecipe {\r\n     name = 'Kitchen'\r\n     description = 'stay together'\r\n     machines = [ Stove, Fridge ]\r\n     bonuses = {\r\n          capacity: 2,\r\n          workSpeed: 1.1\r\n     }\r\n     background = BackgroundPattern.Checker\r\n}\r\n\r\nexport class LifeSupportPod extends RoomRecipe {\r\n     name = 'Life Support'\r\n     description = 'keep it going'\r\n     machines = [ OxygenExtractor, WaterCondensingMachine ]\r\n}\r\n\r\nclass Retreat extends RoomRecipe {\r\n     name = 'Retreat'\r\n     description = 'take it easy'\r\n     machines = [ Cabin, Cabin ]\r\n}\r\n\r\nexport class CloneMatrix extends RoomRecipe {\r\n     name = 'Clone Matrix'\r\n     description = 'clone home'\r\n     machines = [ CloningVat, CloningVat ]\r\n}\r\n\r\nexport class CloneReception extends RoomRecipe {\r\n     name = 'Clone Reception'\r\n     description = 'welcome clone'\r\n     machines = [ CloningVat, OrientationConsole, PersonnelRegistry ]\r\n}\r\n\r\nclass ReadingRoom extends RoomRecipe {\r\n     name = 'Reading Room'\r\n     description = 'butterflies in the sky'\r\n     machines = [ Bookshelf, Bookshelf ]\r\n}\r\n\r\nexport class Library extends RoomRecipe {\r\n     name = 'Library'\r\n     description = 'take a look'\r\n     machines = [ Bookshelf, Bookshelf, Bookshelf ]\r\n     background = BackgroundPattern.Books\r\n}\r\n\r\nexport class Study extends RoomRecipe {\r\n     name = 'Study'\r\n     description = 'plan it out'\r\n     machines = [ StudyMachine, Bookshelf ]\r\n     background = BackgroundPattern.Wood\r\n}\r\n\r\nclass ComputerLab extends RoomRecipe {\r\n     name = 'Computer Lab'\r\n     description = 'make it happen'\r\n     machines = [ Workstation, Workstation, Workstation ]\r\n}\r\n\r\nexport class Archive extends RoomRecipe {\r\n     name = 'Archive'\r\n     description = 'write it down'\r\n     machines = [ ResearchServer, ResearchServer ]\r\n}\r\n\r\nclass Arboretum extends RoomRecipe {\r\n     name = 'Arboretum'\r\n     description = 'walk it out'\r\n     machines = [ Arbor, Arbor ]\r\n}\r\n\r\nclass AlgaeFarm extends RoomRecipe {\r\n     name = 'Algae Farm'\r\n     description = 'make do'\r\n     machines = [ AlgaeVat, AlgaeVat ]\r\n}\r\n\r\nexport class SolarArray extends RoomRecipe {\r\n     name = 'Solar Array'\r\n     description = 'warm up'\r\n     machines = [ SolarCell, SolarCell ]\r\n}\r\n\r\nexport class Workshop extends RoomRecipe {\r\n     name = 'Workshop'\r\n     description = 'take form'\r\n     machines = [ Fabricator, Fabricator ]\r\n}\r\n\r\nclass Nursery extends RoomRecipe {\r\n     name = 'Nursery'\r\n     description = 'quiet please'\r\n     machines = [ Houseplant, Houseplant, Houseplant ]\r\n     background = BackgroundPattern.Leafy\r\n}\r\n\r\nclass Farm extends RoomRecipe {\r\n     name = 'Farm'\r\n     description = 'food for the masses'\r\n     machines = [ Orchard, Orchard ]\r\n}\r\n\r\nclass Factory extends RoomRecipe {\r\n     name = 'Factory'\r\n     description = 'production lines'\r\n     machines = [ Megafabricator, Megafabricator ]\r\n}\r\n\r\n\r\nexport class ComputerCore extends RoomRecipe {\r\n     name = 'Computer Core'\r\n     description = 'let us calculate'\r\n     machines = [ Mainframe, Mainframe ]\r\n     background = BackgroundPattern.Tech\r\n}\r\n\r\nexport class LifeSciencesLab extends RoomRecipe {\r\n     name = 'Life Sciences Lab'\r\n     description = 'where do i come from'\r\n     machines = [ Botany, Botany ]\r\n}\r\n\r\nexport class Refinery extends RoomRecipe {\r\n     name = 'Refinery'\r\n     description = 'separation'\r\n     machines = [ MineralProcessor ]\r\n}\r\n\r\nexport class Mine extends RoomRecipe {\r\n     name = 'Mine'\r\n     description = 'ore from the stone'\r\n     machines = [ MiningDrill ]\r\n}\r\n\r\nexport class HoloMatrix extends RoomRecipe {\r\n     name = 'Hologram Matrix'\r\n     description = 'dream it'\r\n     machines = [ HoloProjector, HoloProjector ]\r\n}\r\n\r\nexport class TimeChamber extends RoomRecipe {\r\n     name = 'Time Chamber'\r\n     description = 'believe it'\r\n     machines = [ TimeCrystal, TimeCrystal ]\r\n}\r\n\r\n// export class DreamMatrix extends \r\n\r\nexport class LivingRoom extends RoomRecipe {\r\n     name = 'Living Room'\r\n     description = 'just relax'\r\n     machines = [ Couch, Couch ]\r\n}\r\n\r\nexport class Statuary extends RoomRecipe {\r\n     name = 'Statuary'\r\n     description = 'to remember'\r\n     machines = [ Statue, Statue, Statue ]\r\n}\r\n\r\nexport const allSpaceFunctions = [\r\n    MissionControl,\r\n\r\n    Library,\r\n    Barracks,\r\n    LifeSupportPod,\r\n    CloneMatrix,\r\n    LivingQuarters,\r\n    Kitchen,\r\n    AlgaeFarm,\r\n    Archive,\r\n    Arboretum,\r\n    SolarArray,\r\n    Retreat,\r\n    Study,\r\n    Workshop,\r\n    ReadingRoom,\r\n    Nursery,\r\n    Farm,\r\n    Factory,\r\n    ComputerLab,\r\n\r\n    ComputerCore,\r\n\r\n    LifeSciencesLab,\r\n\r\n    CloneReception,\r\n    \r\n    Refinery,\r\n    Mine,\r\n    HoloMatrix,\r\n    TimeChamber,\r\n\r\n    LivingRoom,\r\n    Statuary,\r\n]","import { Actor, Color, Traits, Vector, VisibleEvent, Label, CollisionType, Timer, EmitterType, ParticleEmitter } from \"excalibur\";\r\nimport { Building } from \"./Building\";\r\nimport { Planet } from \"./Planet/Planet\";\r\nimport { ResourceBlock, blockColor } from \"../models/Economy\";\r\nimport { Game } from \"../Game\";\r\nimport { eachCons, deleteByValueOnce, sleep, containsUniq, deleteByValue, sample, range } from \"../Util\";\r\nimport { Device } from \"./Device\";\r\nimport { Scale } from \"../values/Scale\";\r\nimport { ProductionStrategy } from \"../strategies/ProductionStrategy\";\r\nimport { CapacityBasedProduction } from \"../strategies/CapacityBasedProduction\";\r\nimport { drawStar, drawRect, drawCircle, drawEllipse, drawText, drawLine } from \"../Painting\";\r\nimport { ConstructionStrategy } from \"../strategies/ConstructionStrategy\";\r\nimport { ProxmityBasedConstruction } from \"../strategies/ProximityBasedConstruction\";\r\nimport { SleepingStrategy } from \"../strategies/SleepingStrategy\";\r\nimport { AnyBedSleepingStrategy } from \"../strategies/AnyBedSleepingStrategy\";\r\nimport { EatingStrategy } from \"../strategies/EatingStrategy\";\r\nimport { WhenHungryEatingStrategy } from \"../strategies/WhenHungryEatingStrategy\";\r\nimport { DeviceSize, getVisibleDeviceSize } from \"../values/DeviceSize\";\r\nimport { CombatStrategy } from \"../strategies/CombatStrategy\";\r\nimport { AttackNearestHostileStrategy } from \"../strategies/AttackNearestHostileStrategy\";\r\nimport { randomBytes } from \"crypto\";\r\nimport { LaserBeam } from \"./LaserBeam\";\r\nimport { CommandCenter } from \"../models/Machine\";\r\nimport { Strategy } from \"../strategies/Strategy\";\r\n\r\nexport class Citizen extends Actor {\r\n    alive: boolean = true\r\n    isPlanning: boolean = false\r\n    carrying: ResourceBlock[] = []\r\n    path: Vector[] = []\r\n\r\n    private workInProgress: boolean = false\r\n    private workStarted: number\r\n    private workDuration: number\r\n    private progress: number\r\n    private sleeping: boolean = false\r\n\r\n    private productionStrategy: ProductionStrategy\r\n    private constructionStrategy: ConstructionStrategy\r\n    private sleepingStrategy: SleepingStrategy\r\n    private eatingStrategy: EatingStrategy\r\n    private fightingStrategy: CombatStrategy\r\n\r\n    hunger: number = 0.0;\r\n    energy: number = 100\r\n    health: number = 100\r\n\r\n    private driving: Device = null\r\n\r\n    private shirtColor: Color\r\n    private skinColor: Color\r\n    private weight: number\r\n\r\n    private bloodEmitter: ParticleEmitter\r\n\r\n    sleepingInBed: Device\r\n\r\n    hover: boolean = false\r\n\r\n    constructor(public name: string, private home: Vector, protected planet: Planet, private elite: boolean = false, private evil: boolean = false) {\r\n        super(\r\n            home.x, home.y,\r\n            18,20,\r\n            Color.White.clone()\r\n        )\r\n\r\n        this.traits = this.traits.filter(trait => !(trait instanceof Traits.OffscreenCulling))\r\n\r\n        this.productionStrategy = new CapacityBasedProduction(this)\r\n        this.constructionStrategy = new ProxmityBasedConstruction(this)\r\n        this.sleepingStrategy = new AnyBedSleepingStrategy(this)\r\n        this.eatingStrategy = new WhenHungryEatingStrategy(this)\r\n        this.fightingStrategy = new AttackNearestHostileStrategy(this)\r\n\r\n        this.shirtColor = (this.elite ? Color.Red : sample([\r\n            Color.Green,\r\n            Color.Blue,\r\n            Color.Orange,\r\n            Color.Yellow,\r\n        ])).clone()\r\n\r\n        if (this.evil) {\r\n            this.shirtColor = Color.Black.clone()\r\n        }\r\n\r\n        this.skinColor = sample([\r\n            Color.Orange.lighten(0.5),\r\n            Color.Orange.lighten(0.6),\r\n            Color.Orange.lighten(0.7),\r\n            Color.Orange.lighten(0.8),\r\n        ])\r\n\r\n        this.weight = sample(range(7).map(w => w + 4))\r\n\r\n        this.collisionType = CollisionType.Passive\r\n        this.bloodEmitter = this.makeBloodEmitter()\r\n        this.add(this.bloodEmitter)\r\n    }\r\n\r\n\r\n    private makeBloodEmitter() {\r\n        let bloodEmitter = new ParticleEmitter()\r\n        bloodEmitter.emitterType = EmitterType.Circle\r\n        bloodEmitter.radius = 7\r\n        bloodEmitter.minVel = 10\r\n        bloodEmitter.maxVel = 30\r\n        bloodEmitter.minAngle = 0\r\n        bloodEmitter.maxAngle = Math.PI * 2\r\n        bloodEmitter.emitRate = 350\r\n        bloodEmitter.opacity = 0.5\r\n        bloodEmitter.fadeFlag = true\r\n        bloodEmitter.particleLife = 500\r\n        bloodEmitter.maxSize = 2\r\n        bloodEmitter.minSize = 1\r\n        bloodEmitter.beginColor = Color.Red.darken(0.12)\r\n        bloodEmitter.endColor = Color.Red.darken(0.36)\r\n        bloodEmitter.isEmitting = false\r\n        return bloodEmitter\r\n    }\r\n\r\n    get title() {\r\n        let title = this.elite ? 'Cmdr. ' : ''\r\n        return title\r\n    }\r\n\r\n    get isHungry() { return this.hunger > 60 }\r\n    get isTired()  { return this.energy < 90 }\r\n\r\n    // get isWorking() { return this.isWorking }\r\n    get currentPlanet() { return this.planet }\r\n\r\n    get walkSpeed() {\r\n        let speedMultiplier = this.planet.timeFactor * (this.elite ? 1.6 : 1)\r\n        return Game.citizenSpeed * speedMultiplier\r\n    }\r\n\r\n    get isEvil(): boolean { return !!this.evil }\r\n\r\n    update(engine, delta) {\r\n        super.update(engine, delta)\r\n\r\n        if (this.workInProgress) {\r\n            let now = (new Date()).getTime()\r\n            this.progress = \r\n              Math.min(\r\n                  (now - this.workStarted) / this.workDuration,\r\n                  1\r\n              )\r\n\r\n            this.fatigue()\r\n        } else if (this.path.length > 0) {\r\n            // we have a non-empty path (so just follow it!)\r\n        } else {\r\n            this.work()\r\n        }\r\n\r\n        if (this.driving) {\r\n            this.pos = this.driving.pos.add(this.driving.building.pos)\r\n        }\r\n\r\n        if (this.combatting && !this.combatting.alive) {\r\n            this.combatting = null\r\n        }\r\n\r\n        if (this.sleeping) {\r\n            this.health = Math.min(100, this.health+0.1)\r\n            this.energy = Math.min(100, this.energy+0.1)\r\n            if (this.health === 100 && !this.isTired) {\r\n                // this.log(\"Try to awaken early!! (We are healed, not tired...)\")\r\n                this.sleeping = false\r\n                this.isPlanning = false\r\n                this.sleepingInBed.inUse = false\r\n                this.sleepingInBed = null\r\n                this.workInProgress = false\r\n                // this.actionQueue.clearActions()\r\n                // this.abortProgressBar()\r\n                this.work()\r\n            }\r\n        }\r\n\r\n        if (this.hover) {\r\n            this.log(`working? ${this.isPlanning ? 'yes' : 'no'}`)\r\n        }\r\n    }\r\n\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n\r\n        let { x, y } = this\r\n        ctx.save()\r\n        ctx.translate(x, y - this.getHeight()/2) // - 5)\r\n\r\n        if (this.alive) {\r\n            drawText(ctx, this.name, -14, -22)\r\n\r\n            if (this.health < 100) {\r\n                let healthColor = this.health > 60 ? Color.Green : Color.Yellow\r\n                if (this.health < 10) { healthColor = Color.Red }\r\n                this.drawBar(ctx, -13, -18, 32, 4, (this.health / 100), healthColor)\r\n            }\r\n\r\n            if (this.guarding) {\r\n                let c = Color.Cyan.clone()\r\n                c.a = 0.3\r\n                drawCircle(ctx, 2, 2, 24, c) //Color.Cyan)\r\n            }\r\n        }\r\n\r\n        if (this.sleeping || !this.alive) {\r\n            ctx.rotate(-Math.PI / 2);\r\n            if (this.sleeping) {\r\n                ctx.translate(5, -10)\r\n            } else {\r\n                ctx.translate(-5, 0)\r\n            }\r\n        }\r\n        this.drawSelf(ctx)\r\n        if (this.carrying) {\r\n            let dx = 5\r\n            this.carrying.forEach((carried, idx) => {\r\n                ctx.fillStyle = blockColor(carried).clone().saturate(0.2).toRGBA()\r\n                ctx.fillRect(dx, 2 - 4 * idx, 5, 5)\r\n            })\r\n        }\r\n        ctx.restore()\r\n\r\n        if (this.workInProgress) {\r\n            ctx.lineWidth = 1\r\n            let pw = 10 + Math.floor(this.workDuration / 10000), ph = 3\r\n            let px = this.x - pw/2, py = this.y - 10;\r\n            this.drawBar(ctx, px, py, pw, ph, this.progress)\r\n        }\r\n\r\n        if (this.path && Game.debugPath) {\r\n            let c = Color.White.clone()\r\n            // c.a = 0.5\r\n            eachCons(this.path, 2).forEach(([a,b]) => {\r\n                drawLine(ctx, a,b,c,10)\r\n\r\n            })\r\n        }\r\n\r\n        if (this.combatting) {\r\n            // draw weapon?\r\n            // drawLine(ctx, this.combatting.pos, this.pos.add(new Vector(0,-12)), Color.Red, 1)\r\n        }\r\n\r\n\r\n        this.color = this.hover ? Color.White : Color.Transparent\r\n        super.draw(ctx, delta)\r\n    }\r\n\r\n    private drawBar(ctx: CanvasRenderingContext2D, px: number, py: number, pw: number, ph: number, progress: number, color: Color = Color.Violet) {\r\n        let c = color.clone()\r\n        ctx.strokeStyle = Color.White.toRGBA()\r\n        ctx.strokeRect(px, py, pw, ph)\r\n        ctx.fillStyle = c.darken(0.9).toRGBA()\r\n        ctx.fillRect(px, py, pw, ph)\r\n        ctx.fillStyle = c.toRGBA()\r\n        ctx.fillRect(px, py, progress * pw, ph)\r\n    }\r\n\r\n\r\n    private drawSelf(ctx: CanvasRenderingContext2D) {\r\n        drawEllipse(ctx, 2, 8,\r\n            this.weight, 9,\r\n            this.shirtColor.desaturate(0.1).lighten(0.1))\r\n        drawCircle(ctx, 2, -3,\r\n            4.5, this.skinColor.desaturate(0.2))\r\n        if (this.elite) {\r\n            drawStar(ctx, 12, -8)\r\n        }\r\n\r\n    }\r\n\r\n    async progressBar(duration: number) {\r\n        this.workInProgress = true\r\n        this.workStarted = (new Date()).getTime()\r\n        this.workDuration = duration\r\n        await new Promise((resolve, reject) => setTimeout(resolve, duration));\r\n        this.workInProgress = false\r\n    }\r\n\r\n    // abortProgressBar() {\r\n    //     this.log(\"work in progress aborted...!\")\r\n    //     this.workInProgress = false\r\n    // }\r\n\r\n    drive(d: Device) {\r\n        this.driving = d\r\n    }\r\n\r\n    stopDriving() {\r\n        this.driving = null\r\n    }\r\n\r\n    get isDriving(): boolean { return !!this.driving }\r\n\r\n    carry(c: ResourceBlock) {\r\n        this.carrying.push(c);\r\n    }\r\n\r\n    isCarryingUnique(resources: ResourceBlock[]): boolean {\r\n        let isCarrying = containsUniq(this.carrying, resources)\r\n        return isCarrying\r\n    }\r\n\r\n    drop(res: ResourceBlock): ResourceBlock {\r\n        if (this.carrying.length > 0) {\r\n            if (this.carrying.find(r => r === res)) {\r\n                deleteByValueOnce(this.carrying, res)\r\n                return res\r\n            }\r\n        }\r\n        return null\r\n    }\r\n\r\n    currentBuilding: Building = null\r\n    async visit(device: Device) {\r\n        let target = this.targetForDevice(device)\r\n        await this.pathTo(target)\r\n        await this.glideTo(target)\r\n        this.currentBuilding = device.building\r\n    }\r\n\r\n    async pathTo(pos: Vector) {\r\n        const path = this.planet.pathBetweenPoints(this.pos.clone(), pos)\r\n        // path.pop()\r\n        await this.followPath(path)\r\n    }\r\n\r\n    private targetForDevice(device: Device) {\r\n        let target = device.pos.add(device.building.pos)\r\n        if (device.parentDevice) {\r\n            target = (device.parentDevice.pos).add(device.building.pos)\r\n            target.x += device.pos.x\r\n            target.y += getVisibleDeviceSize(device.parentDevice.size) / 2\r\n        } else {\r\n            target.y += getVisibleDeviceSize(device.size) / 2\r\n        }\r\n        return target\r\n    }\r\n\r\n    glideTo(pos: Vector) {\r\n        if (pos) {\r\n            return this.actions.moveTo(pos.x, pos.y, this.walkSpeed).asPromise()\r\n        }\r\n    }\r\n\r\n    async followPath(path: Vector[]) {\r\n        if (path.length > 0) {\r\n            console.log(`${this.name} following path`, { path })\r\n            this.path = path\r\n            await Promise.all(\r\n                path.map(step => {\r\n                    this.log(\"glide to next step\")\r\n                    this.glideTo(step)\r\n                })\r\n            )\r\n            this.path = []\r\n        }\r\n    }\r\n    \r\n    protected get strategies() {\r\n        return [\r\n            this.fightingStrategy,\r\n            ...(this.evil ? [] : [this.sleepingStrategy]),\r\n            ...(this.evil ? [] : [this.eatingStrategy]),\r\n            ...(this.evil ? [] : [this.constructionStrategy]),\r\n            ...(this.evil ? [] : [this.productionStrategy])\r\n        ]\r\n    }\r\n\r\n    lastChoice: Strategy = null\r\n    async work() {\r\n        if (this.isPlanning || this.sleeping || !this.alive) { return }\r\n        this.isPlanning = true\r\n        if (this.carrying.length > 0) { this.carrying = [] }\r\n        let choice = this.strategies.find(strat => strat.canApply())\r\n        if (choice) {\r\n            this.lastChoice = choice\r\n            await choice.attempt()\r\n        }\r\n        this.isPlanning = false\r\n    }\r\n\r\n    async takeRest(duration: number = 8 * 60 * Game.minuteTickMillis) {\r\n        this.sleeping = true\r\n        await this.progressBar(duration)\r\n        this.sleeping = false\r\n\r\n    }\r\n\r\n    async eat() {\r\n        let thirtyMinuteTimer = 30 * Game.minuteTickMillis\r\n        await this.progressBar(thirtyMinuteTimer)\r\n        deleteByValueOnce(this.carrying, ResourceBlock.Meal)\r\n        this.hunger = 0\r\n    }\r\n\r\n    private combatting: Citizen = null\r\n\r\n    engageHostile(hostile: Citizen) {\r\n        this.combatting = hostile\r\n    }\r\n\r\n    get enemyCombatant() { return this.combatting }\r\n\r\n    get engagedInCombat() {\r\n        return this.combatting !== null\r\n    }\r\n\r\n    distanceToHostile(): number { \r\n        if (this.combatting) {\r\n            return this.combatting.getWorldPos().distance(this.getWorldPos())\r\n        } else {\r\n            return 0\r\n        }\r\n    }\r\n\r\n    private paceUnit: number = 20\r\n    get idealCombatRange() {\r\n        let idealDistance = 20 * this.paceUnit\r\n        return idealDistance\r\n    }\r\n\r\n    get hostileDirectionSign() {\r\n        if (this.combatting) {\r\n            let enemy = this.combatting.getWorldPos()\r\n            let self = this.getWorldPos()\r\n            if (enemy.x > self.x) {\r\n                return 1\r\n            } else {\r\n                return -1\r\n            }\r\n        } else {\r\n            return 0\r\n        }\r\n    }\r\n\r\n    get enemyPosition() { return this.combatting.getWorldPos().clone() }\r\n\r\n    combatMovementUnit: number = this.paceUnit * 5\r\n    firingRangeBuffer: number = this.combatMovementUnit * 2\r\n\r\n    tooCloseToEnemyLine(): boolean {\r\n        let dx = Math.abs(this.enemyPosition.x - this.x)\r\n        return dx < this.idealCombatRange - this.firingRangeBuffer\r\n    }\r\n\r\n    tooFarFromEnemyLine(): boolean {\r\n        let dx = Math.abs(this.enemyPosition.x - this.x)\r\n        return dx > this.idealCombatRange + this.firingRangeBuffer\r\n    }\r\n\r\n    withinFiringRange(): boolean {\r\n        return !(this.tooCloseToEnemyLine() || this.tooFarFromEnemyLine())\r\n    }\r\n\r\n    async advanceTowardsEnemy() {\r\n        let nextGoal = this.getWorldPos().clone()\r\n        let unit = this.combatMovementUnit\r\n        if (this.tooFarFromEnemyLine()) {\r\n            unit *= this.hostileDirectionSign\r\n            // this.log(`ADVANCE TOWARD ENEMY LINE`)\r\n            nextGoal.x += unit\r\n            await this.glideTo(nextGoal)\r\n        } else if (this.tooCloseToEnemyLine()) {\r\n            unit *= -this.hostileDirectionSign\r\n            // this.log(`RETREAT FROM ENEMY LINE`)\r\n            nextGoal.x += unit\r\n            await this.glideTo(nextGoal)\r\n        }\r\n    }\r\n\r\n    async advanceTowards(target: Vector) {\r\n        let goal = target.clone()\r\n        goal.y = this.pos.y\r\n        let unit = this.combatMovementUnit\r\n        if (target.x > this.pos.x) {\r\n            goal.x = this.pos.x + unit\r\n        } else {\r\n            goal.x = this.pos.x - unit\r\n        }\r\n        await this.glideTo(goal)\r\n    }\r\n\r\n    // bullets: Actor[]\r\n    firing: boolean = false\r\n    async fire() {\r\n        if (!this.firing) {\r\n            // console.log(\"FIRE!!!\")\r\n            // launch a (few) projectile(s)!!!\r\n\r\n            let numTimes = range(sample(range(4)))\r\n            for (let times in numTimes) {\r\n                await this.progressBar(350)\r\n                if (this.alive && this.combatting && this.combatting.alive) {\r\n                    this.firing = true\r\n                    let bullet = this.assembleBullet()\r\n                    this.scene.add(bullet)\r\n                    this.scene.addTimer(new Timer(() => { bullet.kill() }, 2200))\r\n                    this.firing = false\r\n                }\r\n            }\r\n            await sleep(800)\r\n            // await sleep(250) //this.progressBar(250)\r\n        }\r\n    }\r\n\r\n    guarding: boolean = false\r\n    async guard() {\r\n        if (!this.guarding) {\r\n            // this.guarding = true\r\n            if (this.alive && this.combatting) {\r\n                this.guarding = true\r\n                // sometimes a short guard\r\n                let length = Math.random() > 0.2 ? 4000 : 1600\r\n                await sleep(length)\r\n                this.guarding = false\r\n            }\r\n        }\r\n    }\r\n\r\n    private assembleBullet() {\r\n        let hostileDir = this.hostileDirectionSign\r\n        let bullet = new LaserBeam(this, hostileDir)\r\n        return bullet\r\n    }\r\n\r\n    injure(amt: number, attacker: Citizen) {\r\n        if (this.elite) {\r\n            amt = amt * 0.3\r\n        }\r\n        this.health -= amt\r\n        if (this.health <= 0) {\r\n            this.die()\r\n        }\r\n        this.bleed()\r\n        // await sleep(150)\r\n        this.engageHostile(attacker)\r\n    }\r\n\r\n    die() {\r\n        this.actionQueue.clearActions()\r\n        this.path = []\r\n        this.alive = false\r\n        this.guarding = false\r\n        this.sleeping = false\r\n        this.collisionType = CollisionType.Passive\r\n        this.scene.addTimer(new Timer(() => { this.kill() }, 5000))\r\n    }\r\n\r\n    bleed() {\r\n\r\n        this.bloodEmitter.isEmitting = true\r\n        this.scene.addTimer(new Timer(() => { this.bloodEmitter.isEmitting = false }, 50))\r\n\r\n    }\r\n\r\n    private fatigue() {\r\n        let unit = 1e-4;\r\n        this.energy -= unit;\r\n        this.hunger += unit;\r\n    }\r\n\r\n    log(msg) {\r\n        console.debug(`${this.name}: ${msg}`)\r\n    }\r\n}","const raisedSquare = require('../../images/raised-square-bg.png')\r\nconst leafy = require('../../images/leafy-bg.png')\r\nconst bookish = require('../../images/books-bg.png')\r\nconst posters = require('../../images/poster-wall-bg.png')\r\nconst tech = require('../../images/tech-bg.png')\r\nconst checker = require('../../images/checker-bg.png')\r\nconst beige = require('../../images/beige-bg.png')\r\nconst window = require('../../images/window-bg.png')\r\nconst ussf = require('../../images/ussf.png')\r\nconst wood = require('../../images/wood-panel-bg.png')\r\n\r\ninterface Background {\r\n    image: HTMLImageElement\r\n    pattern: CanvasPattern\r\n    loading: boolean\r\n}\r\n\r\nconst loadBg = (path, scale = 1) => {\r\n    let background: Background = { image: null, pattern: null, loading: true }\r\n    background.image = new Image();\r\n    background.image.src = path\r\n    background.image.onload = function () {\r\n      background.loading = false\r\n    }\r\n    return { background, scale }\r\n}\r\n\r\nexport enum BackgroundPattern {\r\n    Leafy = 'Leafy',\r\n    Grid = 'Grid',\r\n    Books = 'Books',\r\n    Poster = 'Poster',\r\n    Tech = 'Tech',\r\n    Checker = 'Checker',\r\n    Beige = 'Beige',\r\n    Window = 'Window',\r\n    USSF = 'USSF',\r\n    Wood = 'Wood',\r\n}\r\n\r\nconst backgroundPatterns: { [ key in BackgroundPattern ]: { background: Background, scale: number } } = {\r\n    Leafy: loadBg(leafy),\r\n    Grid: loadBg(raisedSquare),\r\n    Books: loadBg(bookish),\r\n    Poster: loadBg(posters),\r\n    Tech: loadBg(tech),\r\n    Checker: loadBg(checker),\r\n    Beige: loadBg(beige),\r\n    Window: loadBg(window),\r\n    USSF: loadBg(ussf, 0.5),\r\n    Wood: loadBg(wood),\r\n}\r\n\r\nexport const getBackgroundPattern = (ctx: CanvasRenderingContext2D, p: BackgroundPattern) => {\r\n    let pattern = backgroundPatterns[p]\r\n    let bg = pattern.background\r\n    if (!bg.loading) {\r\n        if (!bg.pattern) {\r\n            let matrix = new DOMMatrix() //bg.pattern.cre //ctx. // new SVGMatrix()\r\n\r\n            // bg.image.scal\r\n            // bg.image.scale\r\n            bg.pattern = ctx.createPattern(bg.image, 'repeat');\r\n            bg.pattern.setTransform(matrix.scale(pattern.scale)) //0.5))\r\n\r\n        }\r\n        return bg.pattern\r\n    }\r\n}","const majorUnit = 16\r\nconst minorUnit = 4\r\n\r\nconst majorScale = {\r\n    first: majorUnit,\r\n    second: majorUnit * 2,\r\n    third: majorUnit * 3,\r\n    fourth: majorUnit * 4,\r\n    fifth: majorUnit * 5,\r\n    sixth: majorUnit * 6,\r\n    seventh: majorUnit * 7,\r\n    eighth: majorUnit * 8,\r\n}\r\n\r\nconst minorScale = {\r\n    first:   minorUnit,\r\n    second:  minorUnit * 2,\r\n    third:   minorUnit * 3,\r\n    fourth:  minorUnit * 4,\r\n    fifth:   minorUnit * 5,\r\n    sixth:   minorUnit * 6,\r\n    seventh: minorUnit * 7,\r\n    eighth:  minorUnit * 8,\r\n}\r\n\r\nexport const Scale = {\r\n    major: majorScale,\r\n    minor: minorScale\r\n}","import { Game } from \"./Game\";\r\nimport { BaseCamera, Vector, Input, Engine } from \"excalibur\";\r\nimport { Orientation } from \"./values/Orientation\";\r\n\r\nexport class GameController {\r\n\r\n    private dragging: boolean = false\r\n    private dragOrigin: Vector\r\n    pointerMoveCallback: (pos: Vector) => any = null\r\n    leftClickCallback: (pos: Vector, holdingShift: boolean) => any = null\r\n    cameraPanCallback: () => any = null\r\n    keyPressCallback: (key) => any = null\r\n\r\n    constructor(private game: Engine, private camera: BaseCamera) {\r\n        \r\n    }\r\n\r\n    onMove(cb: (pos: Vector) => any) {\r\n        this.pointerMoveCallback = cb\r\n    }\r\n\r\n    onLeftClick(cb: (pos: Vector, holdingShift: boolean) => any) {\r\n        this.leftClickCallback = cb\r\n    }\r\n\r\n    onCameraPan(cb: () => any) {\r\n        this.cameraPanCallback = cb\r\n    }\r\n\r\n    onKeyPress(cb: (key) => any) {\r\n        this.keyPressCallback = cb\r\n\r\n    }\r\n\r\n    activate() {\r\n        this.game.input.pointers.primary.on('move', (e: Input.PointerMoveEvent) => {\r\n\r\n            if (this.dragging) {\r\n                this.camera.pos = this.camera.pos.add(\r\n                    this.dragOrigin.sub(e.pos)\r\n                )\r\n            } else {\r\n                if (this.pointerMoveCallback) {\r\n                    this.pointerMoveCallback(e.pos)\r\n                }\r\n\r\n            }\r\n        })\r\n\r\n        this.game.input.pointers.primary.on('up', () => {\r\n            if (this.dragging) { this.dragging = false; }\r\n        })\r\n\r\n        this.game.input.pointers.primary.on('down', (e: Input.PointerDownEvent) => {\r\n            if (e.button == Input.PointerButton.Left) {\r\n                if (this.leftClickCallback) {\r\n                    this.leftClickCallback(\r\n                        e.pos,\r\n                        this.game.input.keyboard.isHeld(Input.Keys.Shift)\r\n                    )\r\n                }\r\n\r\n            } else if (e.button === Input.PointerButton.Middle) {\r\n                this.dragging = true;\r\n                this.dragOrigin = e.pos\r\n            }\r\n        })\r\n\r\n        this.game.input.pointers.primary.on('wheel', (e: Input.WheelEvent) => {\r\n            let z = this.camera.getZoom()\r\n            let step = 0.05\r\n            let min = 0.05, max = 8\r\n            if (e.deltaY < 0) {\r\n                this.camera.zoom(Math.min(z + step, max))\r\n            } else if (e.deltaY > 0) {\r\n                this.camera.zoom(Math.max(z - step, min))\r\n            }\r\n        })\r\n\r\n        let { Up, Down, Left, Right } = Orientation;\r\n        let moveCam = (direction: Orientation) => {\r\n            if (this.cameraPanCallback) {\r\n                this.cameraPanCallback()\r\n            }\r\n            let camMoveSpeed = 10 * (1 / this.camera.getZoom())\r\n            let dv = new Vector(0, 0)\r\n            switch (direction) {\r\n                case Left: dv.x = -camMoveSpeed; break\r\n                case Right: dv.x = camMoveSpeed; break\r\n                case Up: dv.y = -camMoveSpeed; break\r\n                case Down: dv.y = camMoveSpeed; break\r\n            }\r\n            this.camera.move(this.camera.pos.add(dv), 0)\r\n        }\r\n\r\n\r\n        this.game.input.keyboard.on('press', (e: Input.KeyEvent) => {\r\n            if (e.key === Input.Keys.Up || e.key === Input.Keys.W) {\r\n                moveCam(Up)\r\n            } else if (e.key === Input.Keys.Left || e.key === Input.Keys.A) {\r\n                moveCam(Left)\r\n            } else if (e.key === Input.Keys.Down || e.key === Input.Keys.S) {\r\n                moveCam(Down)\r\n            } else if (e.key === Input.Keys.Right || e.key === Input.Keys.D) {\r\n                moveCam(Right)\r\n            } else {\r\n                if (this.keyPressCallback) {\r\n                    this.keyPressCallback(e.key)\r\n                }\r\n            }\r\n        })\r\n        this.game.input.keyboard.on('hold', (e: Input.KeyEvent) => {\r\n            if (e.key === Input.Keys.Up || e.key === Input.Keys.W) {\r\n                moveCam(Up)\r\n            } else if (e.key === Input.Keys.Left || e.key === Input.Keys.A) {\r\n                moveCam(Left)\r\n            } else if (e.key === Input.Keys.Down || e.key === Input.Keys.S) {\r\n                moveCam(Down)\r\n            } else if (e.key === Input.Keys.Right || e.key === Input.Keys.D) {\r\n                moveCam(Right)\r\n            }\r\n        })\r\n    }\r\n\r\n    deactivate(): any {\r\n        this.game.input.keyboard.off('press')\r\n        this.game.input.keyboard.off('hold')\r\n        this.game.input.pointers.primary.off('wheel') //, (e: Input.WheelEvent) => {\r\n        this.game.input.pointers.primary.off('down') //, (e: Input.WheelEvent) => {\r\n        this.game.input.pointers.primary.off('up') //, (e: Input.WheelEvent) => {\r\n    }\r\n}","import { Color } from 'excalibur';\r\nimport { sample } from '../Util';\r\n\r\nexport class World {\r\n    static nameCitizen(): string {\r\n      return sample([\r\n        // first-gen names\r\n        'Parthas', 'Athos', 'Karzak', 'Echo', 'Jaen', 'Xavier', 'Mante', 'Ern', 'Leor', 'Exiel', 'Tomlien', 'Amriel', 'Sariel', 'Arthax', 'Avalon',\r\n        'Kor', 'Exelon', 'Dominel', 'Prinz', 'Etsa', 'Corinth', 'Coade', 'Exter', 'Domnek', 'Tahm', 'Esk', 'Ith', 'Torl', 'Klapaucius', 'Antonidus',\r\n        'Exeleron', 'Moab', 'Thim', 'Pol', 'Maigel',\r\n\r\n        // second-gen\r\n        \"Abalone\", \"Exton\", \"Mauritius\", \"Elenorg\", \"Miga\", \"Elph\", \"Jame\", \"Eln\", \"Corax\", \"Thoeam\", \"Spoob\", \"Morna\", \"Elia\", \"Iatia\", \"Manea\",\r\n        \"Elphenor\", \"Morican\", \"Neutron\", \"Codeman\", \"Alphegor\", \"Belfast\", \"Minah\", \"Alcahtrazz\", \"Miskadew\", \"Erlangjag\", \"Manling\", \"Hopeful\",\r\n        \"Noman\", \"Nohbdy\", \"Elseone\", \"Othera\", \"Selene\", \"Maytrix\", \"Damsehl\", \"Allegore\", \"Samilie\", \"Phonolia\", \"Philia\", \"Dippides\", \"Euripimus\",\r\n        \"D'arcy\", \"Noname\", \"Sig\", \"Gil\", \"Felix\",  \"Ertrude\", \"Imitos\", \"Exitos\", \"Xenia\", \"Corelia\", \"Lineament\", \"Fundament\", \"Hyperion\", \"Nonce\",\r\n        \"Eris\", \"Nael\", \"Gronthax\", \"Sparerib\", \"Carhorn\", \"Doorknot\", \"Careful\", \"Sadusee\", \"Alright\", \"Kevim\", \"Elador\", \"Elabor\", \"Elgar\", \"Elbow\",\r\n        \"Nell\", \"Kell\", \"Tell\", \"Pell\", \"Jell\", \"Xell\", \"Zell\", \"Zil\", \"Zok\", \"Zog\", \"Mog\", \"Moog\", \"Mogue\", \"Rogue\", \"Boog\", \"Dude\", \"Aesthyr\", \"Kerax\",\r\n        \"Norman\", \"Gordon\", \"Gordax\", \"Gornoth\", \"Torgon\", \"Zorgax\", \"Zarnath\", \"Sarnox\", \"Porkath\", \"Esperil\", \"Ythr\", \"Dream\", \"Fever\", \"Spite\", \"Coreheart\",\r\n        \"Darkfire\", \"Lost\", \"Found\", \"Norm\", \"Korm\", \"Dorm\", \"Lorm\", \"Form\", \"Sorm\", \"Roam\", \"Nome\", \"Tome\", \"Bore\", \"Nore\", \"Kore\", \"Dorling\", \"Norlath\",\r\n        \"Natling\", \"Dathron\", \"Dathlax\", \"Kargill\", \"Nomandy\", \"Exactlee\", \"Terminax\", \"Exlith\", \"Lisztia\", \"Zed\", \"Alphus\", \"Quatlewis\", \"Serenado\", \"Imma\", \r\n\r\n\r\n        // very long names\r\n        // \"Turbinaceous\", \"Etceteron\", \"Domicilian\", \"Colphraginate\",\"Malfeagarance\", \"Fintupulate\", \r\n        // \"Explenador\", \"Sedmonicker\", \"Diphtongidus\", \"Temperance\", \"Templexity\", \"Excapital\", \r\n        // \"Amtrack\", \"Coalescent\", \"Coagulant\", \"Tertullius\",  \"Imaginandum\", \"Terrycotta\",\r\n        // \"Aristotle\", \"Maximilien\",\r\n      ])\r\n    }\r\n\r\n  static colors = [Color.Orange] // Color.Azure], // Color.Red, Color.Blue, Color.Green, Color.Magenta]\r\n  static skyColors = [Color.Cyan] //b, Color.Vermillion], // Color.Violet, Color.Chartreuse, Color.Orange, Color.Rose]\r\n\r\n  static pickColor() {\r\n    return sample(World.colors).\r\n      clone().\r\n      darken(0.1).\r\n      desaturate(0.8);\r\n  }\r\n\r\n  static pickSkyColor() {\r\n    return sample(World.skyColors).\r\n      clone().\r\n      desaturate(0.74).\r\n      lighten(0.18)\r\n  }\r\n\r\n}","import { Color } from 'excalibur';\r\nimport { range, mixColors } from '../../Util';\r\nimport { PlanetBackground } from './PlanetBackground';\r\nexport class MountainLayers extends PlanetBackground {\r\n    layers: {\r\n        baseY: number;\r\n        deltas: number[];\r\n    }[] = [];\r\n    skyColor: Color = Color.Blue.clone();\r\n    static layerHeight: number = 14;\r\n    static layerCount = 1;\r\n    peakCount = 560;\r\n    get peakWidth() {\r\n        return Math.floor(this.getWidth() / this.peakCount);\r\n    }\r\n    onInitialize() {\r\n        let c = MountainLayers.layerCount\r\n        for (let layerIndex of range(c)) {\r\n            this.layers.unshift({\r\n                baseY: (layerIndex + 1) * (-MountainLayers.layerHeight+4),\r\n                deltas: this.genPeaks(layerIndex)\r\n            });\r\n        }\r\n    }\r\n    draw(ctx, delta) {\r\n        let wc = this.color.clone();\r\n        let sc = this.skyColor.clone().lighten(0.1);\r\n        let ndx = 1;\r\n        let ls = this.layers.slice();\r\n        for (let layer of ls) {\r\n            let c = mixColors(wc, sc, (ndx / (this.layers.length)));\r\n            this.drawLayer(ctx, layer, c);\r\n            ndx += 1;\r\n        }\r\n    }\r\n    private drawLayer(ctx, layer, color) {\r\n        let ox = -this.getWidth() / 2, oy = this.pos.y + layer.baseY;\r\n        let c = color.clone();\r\n        ctx.beginPath();\r\n        ctx.moveTo(ox, oy);\r\n        let ndx = 0;\r\n        for (let delta of layer.deltas) {\r\n            ctx.lineTo(ox + (ndx * this.peakWidth), oy + delta);\r\n            ndx += 1;\r\n        }\r\n        ctx.lineTo(ox + (this.peakCount * this.peakWidth), oy);\r\n        let h = MountainLayers.layerHeight\r\n        ctx.lineTo(ox + (this.peakCount * this.peakWidth), oy + h) //this.layerHeight);\r\n        ctx.lineTo(ox, oy + h) //this.layerHeight);\r\n        ctx.closePath();\r\n        c.a = 1;\r\n        ctx.fillStyle = c.toRGBA();\r\n        ctx.fill();\r\n    }\r\n    private genPeaks(n) {\r\n        let h = MountainLayers.layerHeight\r\n        let dMax = 1 * (h / 3);\r\n        let deltas = [];\r\n        let randomDelta = () => (Math.random() * (dMax)) - (dMax / 2);\r\n        let last = 0;\r\n        let maxDiff = (h/5);\r\n        for (let times in range(this.peakCount)) {\r\n            let curr = randomDelta();\r\n            let pick = Math.max(last - maxDiff, Math.min(curr, last + maxDiff));\r\n            deltas.push(pick);\r\n            last = pick;\r\n        }\r\n        return deltas;\r\n    }\r\n}\r\n","import { Actor, Color } from 'excalibur';\r\n\r\nexport class PlanetBackground extends Actor {\r\n    constructor(y: number, width: number, color: Color) {\r\n        super(0, y, width, 1500, color)\r\n    }\r\n}\r\n\r\n","import * as ex from 'excalibur';\r\nimport { Actor, Color, Vector, Scene } from 'excalibur';\r\nimport { Building } from '../Building';\r\nimport { range, flatSingle, mixColors, sample, closest, sleep } from '../../Util';\r\nimport { Structure } from '../../models/Structure';\r\nimport { Hud } from '../Hud/Hud';\r\nimport { ResourceBlock, Economy, sumMarkets, emptyMarket, availableCapacity, PureValue } from '../../models/Economy';\r\nimport { Colony } from './Colony';\r\nimport { Population } from './Population';\r\nimport { Machine } from '../../models/Machine';\r\nimport { Device } from '../Device';\r\nimport { MechanicalOperation } from '../../models/MechanicalOperation';\r\nimport { World } from '../../models/World';\r\nimport { SkyLayers } from './SkyLayers';\r\nimport { Citizen } from '../Citizen';\r\n\r\nexport class Planet extends Actor {\r\n    colony: Colony\r\n    population: Population\r\n    hostiles: Citizen[] = []\r\n\r\n    baseSkyColor: Color\r\n    sky: Actor\r\n    skyLayers: SkyLayers\r\n\r\n    constructor(\r\n        public hud: Hud,\r\n        private onBuildingHover: (b: Building) => any,\r\n        private onDeviceHover: (d: Device) => any,\r\n        private w: number = 200000,\r\n        private depth: number = 40000,\r\n        public scene: Scene\r\n    ) {\r\n        super(0, depth / 2, w, depth, World.pickColor())\r\n        this.traits = this.traits.filter(trait => !(trait instanceof ex.Traits.OffscreenCulling))\r\n\r\n        this.baseSkyColor = World.pickSkyColor()\r\n        this.sky = new Actor(0, -depth, w, depth, this.baseSkyColor) //World.pickSkyColor())\r\n        this.add(this.sky)\r\n\r\n        let yBase = -depth / 2\r\n        let crustHeight = 40\r\n        this.createLayer(yBase, crustHeight, this.color.lighten(0.45))\r\n\r\n\r\n        let layerCount = 10\r\n        let layerHeight = depth / layerCount\r\n        for (let i of range(layerCount)) {\r\n            this.createLayer(\r\n                yBase + crustHeight + (layerHeight / 2) + (layerHeight * (i + 1)),\r\n                layerHeight,\r\n                this.color.darken(0.05 + 0.01 * i)\r\n            )\r\n        }\r\n        let c = this.color.clone()\r\n\r\n        this.skyLayers =new SkyLayers(\r\n           -depth/2, // - 20,\r\n           this.getWidth(),\r\n           this.color.lighten(0.04),\r\n           this.baseSkyColor.lighten(0.15),\r\n        //    3\r\n        )\r\n        this.add(this.skyLayers)\r\n\r\n        // this.depth = depth\r\n        this.buildColonyAndPopulation()\r\n    }\r\n\r\n    // depth: number\r\n    buildColonyAndPopulation() {\r\n        if (this.colony) {\r\n            this.colony.tearDown()\r\n            // this.colony.kill()\r\n            this.remove(this.colony)\r\n        }\r\n\r\n        this.colony = new Colony(0, -this.depth / 2)\r\n        this.add(this.colony)\r\n\r\n        if (this.population) {\r\n            this.population.tearDown()\r\n            // this.population.kill()\r\n            this.remove(this.population)\r\n        }\r\n\r\n        // console.log(\"in planet, scene is: \", { scene: this.scene })\r\n        this.population = new Population(this, this.scene)\r\n        this.add(this.population)\r\n\r\n    }\r\n\r\n\r\n    private currentHour: number\r\n    get hour() { return this.currentHour }\r\n\r\n    setTime(time: number) {\r\n        this.hour = (Math.floor(time / 60)) % 24\r\n\r\n        let nextHour = this.hour + 1\r\n\r\n        let minute = Math.floor(time % 60)\r\n        let inc = (minute / 60)\r\n        // console.log({ hour: this.hour, nextHour: nextHour, minute, inc })\r\n\r\n        let oldC = this.skyColorForHour(this.hour),\r\n            newC = this.skyColorForHour(nextHour)\r\n        let mixC = mixColors(newC, oldC, inc)\r\n        this.assignColors(mixC)\r\n    }\r\n\r\n    private assignColors(skyColor: Color) {\r\n        this.sky.color = skyColor\r\n        // let inc = 0.02\r\n        let c = //mixColors(\r\n            this.sky.color.lighten(0.05) //.lighten(5 * inc) //,\r\n            // this.color.darken(5 * inc),\r\n            // 0.7\r\n        // )\r\n        this.skyLayers.setHi(c)\r\n    }\r\n\r\n    skyColorForHour(hour: number) {\r\n        let c = this.baseSkyColor.clone()\r\n        let colorMap = {\r\n            night: c.darken(0.7),\r\n            dawn: c.darken(0.2),\r\n            morning: c.lighten(0.1),\r\n            afternoon: c.lighten(0.2).desaturate(0.1),\r\n            evening: c,\r\n        }\r\n        let result: Color = null\r\n        if (hour >= 5 && hour < 8) { // dawn\r\n            let inc = (hour - 6) / 5\r\n            result = colorMap.dawn.lighten(inc)\r\n        } else if (hour >= 8 && hour < 12) { // morning\r\n            let inc = (hour - 8) / 24\r\n            result = colorMap.morning.lighten(inc)\r\n        } else if (hour >= 12 && hour < 14) { // early afternoon\r\n            result = colorMap.afternoon //.darken(inc)\r\n        } else if (hour >= 14 && hour < 18) {  // late afternoon\r\n            let inc = (hour - 14) / 16\r\n            result = colorMap.afternoon.darken(inc)\r\n        } else if (hour >= 18 && hour < 23) { // evening\r\n            let inc = (hour - 18) / 10\r\n            result = colorMap.evening.darken(inc)\r\n        } else if (hour >= 23) { // late night\r\n            result = colorMap.night\r\n        } else if (hour < 5) { // early morning\r\n            result = colorMap.night\r\n        }\r\n        return result\r\n    }\r\n\r\n    set hour(hour: number) {\r\n        this.currentHour = hour\r\n    }\r\n\r\n    set currentlyViewing(buildingOrDevice: Building | Device) {\r\n        if (buildingOrDevice instanceof Building) {\r\n            let b: Building = buildingOrDevice\r\n            this.onBuildingHover(b)\r\n        } else if (buildingOrDevice instanceof Device) {\r\n            let d: Device = buildingOrDevice\r\n            this.onDeviceHover(d)\r\n        }\r\n    }\r\n\r\n    private createLayer(y: number, size: number, color: Color) {\r\n        let theLayer = new Actor(0, y, this.getWidth(), size, color);\r\n        this.add(theLayer);\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta) {\r\n        super.draw(ctx, delta)\r\n\r\n        if (this.currentlyConstructing) {\r\n            this.currentlyConstructing.draw(ctx, delta)\r\n        }\r\n    }\r\n\r\n    get economy(): Economy {\r\n        // let devices = this.colony.findPoweredDevices()\r\n        // let economies = devices.map((d: Device) => d.machine.economy)\r\n\r\n        let buildings = this.colony.buildings\r\n        let economies = buildings.map(b => b.economy())\r\n        let theEconomy = economies.reduce(sumMarkets, emptyMarket())\r\n\r\n        let popularDemand = this.population.citizens.length\r\n        theEconomy['Shelter'].demand = popularDemand\r\n        theEconomy['Oxygen'].demand += popularDemand\r\n        theEconomy['Water'].demand += popularDemand\r\n        return theEconomy\r\n    }\r\n\r\n    update(engine, delta) {\r\n        super.update(engine, delta)\r\n\r\n        this.colony.buildings.forEach(building => building.update(engine, delta))\r\n        this.population.citizens.forEach(citizen => citizen.update(engine, delta))\r\n    }\r\n\r\n    get currentlyConstructing() {\r\n        return this.colony.currentlyConstructing\r\n    }\r\n\r\n    gather(resource: ResourceBlock): any {\r\n        this.hud.resourceGathered(resource)\r\n    }\r\n\r\n    spend(resource: ResourceBlock): any {\r\n        this.hud.resourceExpended(resource)\r\n    }\r\n\r\n    placeBuilding(building: Building) {\r\n        this.colony.placeBuilding(building)\r\n    }\r\n\r\n    populate(pos: Vector, elite: boolean = false) {\r\n        if (this.population.citizens.length < this.maxPop) {\r\n            // console.log(\"POPULATIN'!\")\r\n            // let home = this.closestDevice(pos, [CloningVat])\r\n            this.population.increase(pos, elite) //home)\r\n        } else {\r\n            console.warn(\"too many citizens already to populate more!\")\r\n        }\r\n    }\r\n\r\n    get maxPop() {\r\n        let devices = this.colony.findPoweredDevices()\r\n        let economies = devices.map((d: Device) => d.machine.economy)\r\n        let theEconomyWithoutPeople = economies.reduce(sumMarkets, emptyMarket())\r\n\r\n        let values = [PureValue.Shelter, PureValue.Water, PureValue.Oxygen]\r\n        return Math.max(0, Math.min(\r\n            ...values.map(val => availableCapacity(theEconomyWithoutPeople, val))\r\n        ))\r\n    }\r\n\r\n    closestBuildingByType(cursor: Vector, structureTypes: (typeof Structure)[], predicate: (Building) => boolean = () => true): Building {\r\n        return this.colony.closestBuildingByType(cursor, structureTypes, predicate)\r\n    }\r\n\r\n    closestDevice(cursor: Vector, machineTypes: (typeof Machine)[] = [], predicate: (Device) => boolean = () => true) {\r\n        return this.colony.closestDeviceByType(cursor, machineTypes, predicate);\r\n    }\r\n\r\n    pathBetween(origin: Vector, destination: Building): Vector[] {\r\n        return this.colony.pathBetween(origin, destination)\r\n    }\r\n\r\n    pathBetweenPoints(origin: Vector, destination: Vector): Vector[] {\r\n        return this.colony.pathBetweenPoints(origin, destination)\r\n    }\r\n\r\n    get timeFactor() {\r\n        let devices = this.colony.findPoweredDevices()\r\n        let ops: MechanicalOperation[] = devices.map(d => d.operation) //.filter(op => op.type === 'accelerate')\r\n        return ops\r\n            .map(op => op.type === 'accelerate' ? op.factor : 1)\r\n            .reduce((acc, val) => val * acc, 1.0)\r\n    }\r\n\r\n    get storedResources(): ResourceBlock[] {\r\n        let devices = this.colony.findAllDevices()\r\n        return flatSingle(devices.map(d => d.product))\r\n    }\r\n\r\n    hasMachineKind(kind: typeof Machine) {\r\n        return this.colony.findPoweredDevices().find(d => d.machine instanceof kind);\r\n    }\r\n\r\n    threatLevel: number = 0\r\n    async sendRaidingParty() {\r\n        if (this.threatLevel === 0) {\r\n            await sleep(10000) // wait for game to bootstrap (the first time)...\r\n        }\r\n        if (this.population && this.population.citizens && this.population.citizens.length > 0) {\r\n            this.threatLevel += 1\r\n            let maxPartySize = 1 + Math.floor(this.threatLevel / 3)\r\n            let partySize = 1 + sample(range(maxPartySize))\r\n            for (let times in range(partySize)) {\r\n                this.sendRaider()\r\n            }\r\n            console.warn(`Sent ${partySize} raiders!`)\r\n        }\r\n    }\r\n\r\n    private async sendRaider() {\r\n        let origin = this.colony.origin.clone()\r\n        origin.y = this.getTop() + 5\r\n        let xOff = Math.random() * 50\r\n        let raider =\r\n            new Citizen('Raider', origin.add(new Vector(5000 + xOff, 0)), this, false, true)\r\n\r\n        this.population.raiders.push(\r\n            raider\r\n        )\r\n\r\n        this.scene.add(raider)\r\n        let target = closest(raider.pos, this.population.citizens, (c) => c.pos)\r\n        raider.engageHostile(target) //sample(this.population.citizens))\r\n    }\r\n}","import { Strategy } from \"./Strategy\";\r\n\r\nexport abstract class CombatStrategy extends Strategy {\r\n    describe() { return 'fighting' }\r\n}","import { UIActor, Label, Engine, Color } from \"excalibur\";\r\nimport { Structure, Corridor, SurfaceRoad, Ladder, allStructures } from \"../../models/Structure\";\r\nimport { Game } from \"../../Game\";\r\nimport { ResourceBlock, emptyMarket, PureValue } from \"../../models/Economy\";\r\nimport { Machine, allMachines, PersonnelRegistry } from \"../../models/Machine\";\r\nimport { flatSingle } from \"../../Util\";\r\nimport { Colony } from \"../Planet/Colony\";\r\nimport { StatusAnalysisView } from \"./StatusAnalysisView\";\r\nimport { Device } from \"../Device\";\r\nimport { Planet } from \"../Planet/Planet\";\r\nimport { Card } from \"./Card\";\r\nimport { allSpaceFunctions, RoomRecipe } from \"../../models/RoomRecipe\";\r\nimport { Palette } from \"./Palette\";\r\nimport { Building } from \"../Building\";\r\nimport { Modal } from \"./Modal\";\r\nimport { TechTree } from \"../../models/TechTree\";\r\nimport { CitizenList } from \"./CitizenList\";\r\nimport { Citizen } from \"../Citizen\";\r\nimport { assembleButton } from \"../../Elemental\";\r\nimport { Pane } from \"./Pane\";\r\n\r\nclass ActionList extends Pane {\r\n\r\n    setup(btns: { label: string, action: () => any }[]) { //}, engine: Engine) {\r\n        btns.forEach(btn => {\r\n            let theButton = assembleButton(btn.label, Color.White)\r\n            theButton.onclick = () => {\r\n                btn.action()\r\n                // engine.goToScene(btn.scene)\r\n            }\r\n            this._element.appendChild(theButton)\r\n        })\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\nexport class Hud extends UIActor {\r\n\r\n    private hidePalettes: boolean = true\r\n    private structurePalette: Palette\r\n    private machinePalette: Palette\r\n    private functionPalette: Palette\r\n\r\n    private showCitizenList: boolean = true\r\n    private citizenList: CitizenList\r\n    private actionList: ActionList\r\n\r\n\r\n    private card: Card\r\n    private status: StatusAnalysisView\r\n\r\n    private modal: Modal = null\r\n\r\n    static structuresForPalette = [\r\n        SurfaceRoad,\r\n        Corridor,\r\n        Ladder,\r\n        ...allStructures\r\n    ];\r\n    static machinesForPalette = allMachines\r\n    static functionsForPalette = allSpaceFunctions\r\n\r\n\r\n    constructor(\r\n        private game: Engine,\r\n        private onBuildingSelect = null,\r\n        private onMachineSelect = null,\r\n        private onFunctionSelect = null,\r\n        private onCitizenSelect = null,\r\n    ) {\r\n        super(0, 0, game.canvasWidth, game.canvasHeight);\r\n        let canvasHeight = game.canvasHeight / window.devicePixelRatio;\r\n        let canvasWidth = game.canvasWidth / window.devicePixelRatio;\r\n\r\n        this.status = new StatusAnalysisView(emptyMarket(), game.canvasWidth, 64);\r\n        this.add(this.status)\r\n\r\n        let displayInfo = (e) => this.showCard(e)\r\n        this.machinePalette = new Palette('Machine', 20, 55, allMachines, onMachineSelect, displayInfo) // (e) => this.showCard(e))\r\n        this.structurePalette = new Palette('Structure', 20, 300, Hud.structuresForPalette, onBuildingSelect, displayInfo)\r\n        this.functionPalette = new Palette('Room Recipe', 20, 435, Hud.functionsForPalette, onFunctionSelect, displayInfo, false)\r\n\r\n        this.citizenList = new CitizenList(canvasWidth - 220, 55, onCitizenSelect) //, (citizen) => {})\r\n\r\n        this.card = new Card(null, 20, canvasHeight - 200)\r\n        this.add(this.card)\r\n\r\n        this.actionList = new ActionList('Actions', canvasWidth - 220, canvasHeight - 100)\r\n        this.actionList.setup([\r\n            { label: 'Main Menu', action: () => {game.goToScene('menu')} },\r\n            // { label: 'Main Menu', action: () => {game.goToScene('menu')} }\r\n        ])\r\n    }\r\n\r\n    hide() {\r\n        this.machinePalette.hide()\r\n        this.structurePalette.hide()\r\n        this.functionPalette.hide()\r\n        this.citizenList.hide()\r\n        this.actionList.hide()\r\n\r\n        this.status.hide()\r\n    }\r\n\r\n    show() {\r\n        this.machinePalette.show()\r\n        this.structurePalette.show()\r\n        this.functionPalette.show()\r\n        this.citizenList.show()\r\n        this.actionList.show()\r\n    }\r\n\r\n    systemMessage(\r\n        message: string,\r\n        title: string = 'Commander...',\r\n        buttons: { [intent: string]: () => any },\r\n    ): Modal {\r\n\r\n        let canvasHeight = this.game.canvasHeight / window.devicePixelRatio;\r\n        let canvasWidth = this.game.canvasWidth / window.devicePixelRatio;\r\n        this.modal = new Modal(\r\n            title,\r\n            message,\r\n            canvasWidth/2,\r\n            canvasHeight/2,\r\n        ) \r\n        this.modal.addButtons(buttons)\r\n        return this.modal\r\n    }\r\n\r\n\r\n    closeSystemMessage() {\r\n        console.log(\"hide system message\")\r\n        if (this.modal) {\r\n            this.modal.teardown()\r\n            this.modal = null\r\n        }\r\n    }\r\n\r\n\r\n    showPalettes() {\r\n        this.hidePalettes = false\r\n    }\r\n\r\n    setStatus(text: string) { this.status.setMessage(text) }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        super.draw(ctx, delta)\r\n        if (!this.hidePalettes) {\r\n            this.structurePalette.draw(ctx)\r\n            this.functionPalette.draw(ctx)\r\n\r\n            if (this.machinePalette.comprehended.length > 0) {\r\n                this.machinePalette.draw(ctx)\r\n            }\r\n        }\r\n\r\n        if (this.modal) {\r\n            this.modal.draw(ctx)\r\n        }\r\n\r\n        if (this.showCitizenList) {\r\n            this.citizenList.draw(ctx)\r\n        }\r\n\r\n        this.actionList.draw(ctx)\r\n    }\r\n\r\n    update(game: Game, delta: number) {\r\n        super.update(game, delta)\r\n    }\r\n\r\n    resourceGathered(resource: ResourceBlock) {\r\n        this.status.incrementResource(resource)\r\n    }\r\n\r\n    resourceExpended(resource: ResourceBlock) {\r\n        this.status.decrementResource(resource)\r\n    }\r\n\r\n    updateDetails(planet: Planet, techTree: TechTree, following: Citizen, rebuildPalettes: boolean = true, time: number = 0) {\r\n        if (!planet) { return }\r\n        if (rebuildPalettes) {\r\n            this.updatePalettes(planet.colony, techTree)\r\n        }\r\n        this.updateEconomy(planet)\r\n        this.updateMaxPop(planet.economy[PureValue.Shelter].demand, planet.maxPop)\r\n\r\n        this.status.setClock(time)\r\n\r\n        // let missingCitizens = planet.population.citizens.some(c => !this.citizenList.doesRosterInclude(c))\r\n        // let followedChanged = following !== this.citizenList.following\r\n        // if (missingCitizens || followedChanged) {\r\n        this.citizenList.updateRoster(planet.population.citizens.filter(c => c.alive), following)\r\n        // }\r\n\r\n        if (!this.showCitizenList && planet.hasMachineKind(PersonnelRegistry)) {\r\n            this.showCitizenList = true\r\n        }\r\n    }\r\n\r\n    showCard(entity: Machine | Structure | RoomRecipe | Building | Device) {\r\n        this.card.present(entity)\r\n    }\r\n\r\n    private updateMaxPop(curr, cap) {\r\n        this.status.showPopCap(curr, cap)\r\n    }\r\n\r\n    private updateEconomy(planet: Planet) {\r\n        this.status.showEconomy(planet.economy)\r\n    }\r\n\r\n    private updatePalettes(colony: Colony, techTree: TechTree) {\r\n        this.updateBuildingPalette(colony)\r\n        this.updateMachinePalette(colony, techTree)\r\n        this.updateFunctionPalette(colony)\r\n    }\r\n\r\n    private updateBuildingPalette(colony: Colony) {\r\n        let builtStructures =\r\n            Hud.structuresForPalette.filter((structure) => colony.buildings.some(b => b.structure instanceof structure))\r\n        if (!builtStructures.every(s => this.structurePalette.built.includes(s))) {\r\n            this.structurePalette.updateBuilt(builtStructures)\r\n        }\r\n    }\r\n\r\n    private updateMachinePalette(colony: Colony, techTree: TechTree) {\r\n        let devices = colony.findAllDevices()\r\n        let builtMachines = [\r\n            ...Hud.machinesForPalette.filter((machine) => devices.some(d => d.machine instanceof machine && d.built)),\r\n            // ...techTree.allUnlockedMachines()\r\n        ]\r\n        if (!builtMachines.every(machine => this.machinePalette.built.includes(machine))) {\r\n            this.machinePalette.updateBuilt(builtMachines, techTree.allUnlockedMachines())\r\n        }\r\n    }\r\n\r\n    private updateFunctionPalette(colony: Colony) {\r\n        let builtReifiedFunctions = flatSingle(colony.buildings.map(b => b.spaceFunction))\r\n        let builtFunctions = Hud.functionsForPalette.filter((fn) => builtReifiedFunctions.some(rf => rf instanceof fn))\r\n        if (!builtFunctions.every(fn => this.functionPalette.built.includes(fn))) {\r\n            this.functionPalette.updateBuilt(builtFunctions)\r\n        }\r\n    }\r\n\r\n}","import { minBy } from \"../Util\";\r\n\r\nexport class Graph<T> {\r\n    private empty: boolean = true\r\n    public nodes: T[] = []\r\n    private edges: { [key: number]: number[] } = {}\r\n    private edgesInverse: { [key: number]: number[] } = {}\r\n\r\n    public isEmpty(): boolean {\r\n        return this.empty;\r\n    }\r\n\r\n    public get size() { return this.nodes.length }\r\n\r\n    public node(newNode: T) {\r\n        this.empty = false;\r\n        if (!this.contains(newNode)) {\r\n            this.nodes.push(newNode)\r\n        }\r\n    }\r\n\r\n    public contains(testNode: T) {\r\n        return this.nodes.includes(testNode)\r\n    }\r\n\r\n    public findOrCreate(testNode: T, measure: (a: T, b: T) => number, tolerance: number = 5): T {\r\n        let nodes = this.dfs();\r\n        let closest = minBy(nodes, (node: T) => measure(testNode, node))\r\n        if (closest && measure(closest, testNode) < tolerance) {\r\n            return closest;\r\n        }\r\n        return testNode;\r\n    }\r\n\r\n    public edge(src: T, dst: T) {\r\n        this.node(src)\r\n        this.node(dst)\r\n\r\n        let s = this.indexOf(src), d = this.indexOf(dst)\r\n        this.edges[s] = this.edges[s] || []\r\n        this.edges[s].push(d)\r\n\r\n        this.edgesInverse[d] = this.edgesInverse[d] || []\r\n        this.edgesInverse[d].push(s)\r\n    }\r\n\r\n    public union(otherGraph: Graph<T>) {\r\n       otherGraph.edgeList().forEach(([a,b]) => this.edge(a,b))\r\n    }\r\n\r\n    public edgeList(): [T,T][] {\r\n        let theEdges = []\r\n        for (let node of this.nodes) {\r\n            let index = this.indexOf(node)\r\n            if (this.edges[index]) {\r\n                for (let otherIndex of this.edges[index]) {\r\n                    let otherNode = this.nodes[otherIndex]\r\n                    if (!theEdges.includes([otherNode, node])) {\r\n                        theEdges.push([node, otherNode])\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return theEdges\r\n    }\r\n\r\n    public adjacent(testNode: T): T[] {\r\n        let index = this.indexOf(testNode)\r\n        let vertex = this.adjacentIndices(index)\r\n        return vertex.map((n) => this.nodes[n])\r\n    }\r\n\r\n    private adjacentIndices(testNodeIndex: number): number[] {\r\n        let es = this.edges[testNodeIndex] || []\r\n        let esInv = this.edgesInverse[testNodeIndex] || []\r\n        let vertex = [...es, ...esInv ]\r\n        return vertex\r\n    }\r\n\r\n    public dfs(root:T=null, visited=[]): T[] {\r\n        let rIndex = root ? this.indexOf(root) : 0\r\n        return this.dfsIndex(rIndex).map(n => this.nodes[n])\r\n    }\r\n\r\n    private dfsIndex(rootIndex:number=0, visited:number[]=[]) {\r\n        visited.push(rootIndex)\r\n        let children = this.adjacentIndices(rootIndex)\r\n        children.forEach((childIndex: number) => {\r\n            if (!visited.includes(childIndex)) {\r\n                this.dfsIndex(childIndex, visited)\r\n            }\r\n        })\r\n\r\n        return visited\r\n    }\r\n\r\n    public bfs(root:T=null, cb: (x: number,y: number)=>boolean = ()=>true): T[] {\r\n        let rIndex = root ? this.indexOf(root) : 0\r\n        return this.bfsIndex(rIndex, cb).map(n => this.nodes[n])\r\n    }\r\n\r\n    private bfsIndex(rootIndex:number=null, cb: (x: number, y: number) => boolean = () => true): number[] {\r\n        let halt = false;\r\n        let visited: number[] = []\r\n        visited.push(rootIndex)\r\n        let tries = 0\r\n        while (visited.length < this.nodes.length && tries++ < this.nodes.length * 20) {\r\n            for (let visitedNode of visited) {\r\n                let adj: number[] = this.adjacentIndices(visitedNode)\r\n                for (let adjacentNode of adj) {\r\n                    if (!visited.includes(adjacentNode)) {\r\n                        if (!cb(visitedNode, adjacentNode)) {\r\n                            halt = true;\r\n                            break;\r\n                        }\r\n                        visited.push(adjacentNode)\r\n                    }\r\n                }\r\n                if (halt) break;\r\n            }\r\n            if (halt) break;\r\n        }\r\n        return visited\r\n    }\r\n\r\n    public shortestPath(src: T, dst: T, maxStep: number = 256): T[] {\r\n        let prevStep = {}\r\n        let dstIndex = this.indexOf(dst)\r\n        this.bfs(src, (prev, curr) => {\r\n            prevStep[curr] = prev;\r\n            return curr !== dstIndex\r\n        })\r\n        let path = []\r\n        let curr = dstIndex\r\n        let steps = 0\r\n        let srcIndex = this.indexOf(src)\r\n        while (!path.includes(srcIndex) && steps < maxStep) {\r\n            path.push(curr)\r\n            curr = prevStep[curr]\r\n            steps += 1\r\n        }\r\n        let pathNodes = path.map(n => this.nodes[n])\r\n        return pathNodes.reverse()\r\n    }\r\n\r\n    private indexOf(node: T) {\r\n        return this.nodes.indexOf(node)\r\n    }\r\n\r\n}","import { Texture, Sound } from 'excalibur';\r\nconst sword = require('./images/sword.png');\r\nconst craterRock = require('./sounds/crater-rock.mp3')\r\nconst assembler = require('./sounds/assembler.mp3')\r\nconst indivision = require('./sounds/indivision.mp3')\r\nconst understanding = require('./sounds/understanding.mp3')\r\nconst futureTense = require('./sounds/future tense.mp3')\r\n// const isomer = require('./sounds/isomer.mp3')\r\n// const outbound = require('./sounds/outbound.mp3')\r\n\r\nlet Resources = {\r\n    Sword: new Texture(sword),\r\n\r\n    // CraterRock: new Sound(craterRock),\r\n    Assembler: new Sound(assembler),\r\n    // Indivision: new Sound(indivision),\r\n    // Understanding: new Sound(understanding),\r\n    FutureTense: new Sound(futureTense),\r\n    // Isomer: new Sound(isomer),\r\n    // Outbound: new Sound(outbound),\r\n\r\n\r\n}\r\n\r\nexport { Resources }\r\n","import { Pane } from \"../actors/Hud/Pane\";\r\nimport { Scene, Color, Engine, ParticleEmitter, Vector } from \"excalibur\";\r\nimport { assembleButton } from \"../Elemental\";\r\nimport { GameController } from \"../GameController\";\r\nimport { drawText } from \"../Painting\";\r\nimport { Game } from \"../Game\";\r\n\r\nclass SceneList extends Pane {\r\n\r\n    setup(btns: { label: string, scene: string }[], engine: Engine) {\r\n        btns.forEach(btn => {\r\n            let theButton = assembleButton(btn.label, Color.Blue)\r\n            theButton.onclick = () => {\r\n                engine.goToScene(btn.scene)\r\n            }\r\n            this._element.appendChild(theButton)\r\n        })\r\n    }\r\n\r\n}\r\n\r\nexport class Menu extends Scene {\r\n    controller: GameController\r\n\r\n    sceneList: SceneList\r\n    emitter: ParticleEmitter\r\n\r\n    onInitialize() {\r\n        let canvasHeight = this.engine.canvasHeight / window.devicePixelRatio;\r\n        let canvasWidth = this.engine.canvasWidth / window.devicePixelRatio;\r\n\r\n        let halfHeight = Math.floor(canvasHeight/2)\r\n        let halfWidth = Math.floor(canvasWidth/2)\r\n\r\n        this.sceneList = new SceneList(\r\n            'AD ASTRA: OSIRIS CONTINGENCY',\r\n            halfWidth /2,\r\n            halfHeight - 50,\r\n        )\r\n        this.sceneList.setup([\r\n            { label: 'Play', scene: 'construct' },\r\n            { label: 'Arena', scene: 'arena' },\r\n        ], this.engine)\r\n\r\n        this.emitter = this.makeBigBangEmitter(\r\n            halfWidth + (halfWidth/2),\r\n            halfHeight - 50\r\n        )\r\n        this.add(this.emitter)\r\n\r\n        this.controller = new GameController(this.engine, this.camera)\r\n    }\r\n\r\n    onActivate() {\r\n\r\n        this.sceneList.show()\r\n\r\n        let canvasHeight = this.engine.canvasHeight / window.devicePixelRatio;\r\n\r\n        this.camera.zoom(2.25)\r\n        this.emitter.isEmitting = true\r\n\r\n        this.controller = new GameController(this.engine, this.camera)\r\n        this.controller.activate()\r\n    }\r\n\r\n    onDeactivate() {\r\n        this.emitter.isEmitting = false\r\n        this.controller.deactivate()\r\n        this.sceneList.hide()\r\n    }\r\n\r\n    draw(ctx, delta) {\r\n        let canvasHeight = this.engine.canvasHeight / window.devicePixelRatio;\r\n        let canvasWidth = this.engine.canvasWidth / window.devicePixelRatio;\r\n        super.draw(ctx, delta)\r\n        this.sceneList.draw(ctx)\r\n        drawText(ctx,\r\n            `${Game.title} (prealpha build.)`,\r\n            canvasWidth - 100, canvasHeight - 20)\r\n        drawText(ctx,\r\n            `Zoom: ${this.camera.getZoom()} / Pos: ${this.camera.pos.x}, ${this.camera.pos.y}`,\r\n            1000, 1000)\r\n    }\r\n\r\n    private makeBigBangEmitter(x,y) {\r\n        let emitter = new ParticleEmitter(\r\n            x,\r\n            y\r\n        )\r\n        emitter.endColor = Color.Blue\r\n        emitter.beginColor = Color.White.darken(0.18)\r\n        emitter.radius = 10\r\n        emitter.minVel = 10\r\n        emitter.maxVel = 160\r\n        emitter.minAngle = 0 //3 * (Math.PI / 2) //0\r\n        emitter.maxAngle = Math.PI * 2\r\n        emitter.emitRate = 200 // 300 particles/second\r\n        emitter.opacity = 0.5\r\n        emitter.fadeFlag = true\r\n        emitter.particleLife = 4500 // in milliseconds = 1 sec\r\n        emitter.maxSize = 50 // in pixels\r\n        emitter.minSize = 2\r\n        // emitter.beginColor = Color.Red.darken(0.12);\r\n        emitter.isEmitting = false;\r\n        return emitter\r\n    }\r\n}","import { Scene, Vector, LockCameraToActorStrategy, Color } from \"excalibur\";\r\nimport { Citizen } from \"../actors/Citizen\";\r\nimport { Game } from \"../Game\";\r\nimport { Planet } from \"../actors/Planet/Planet\";\r\nimport { World } from \"../models/World\";\r\nimport { Hud } from \"../actors/Hud/Hud\";\r\nimport { Pane } from \"../actors/Hud/Pane\";\r\nimport { assembleButton } from \"../Elemental\";\r\nimport { ENOTEMPTY } from \"constants\";\r\nimport { sample } from \"../Util\";\r\nimport { GameController } from \"../GameController\";\r\n\r\nconst noop = () => { }\r\n\r\nclass SpawnPalette extends Pane {\r\n    constructor(x: number, y: number, buttons: { label: string, color: Color, cb: () => any }[]) {\r\n        super(\"Summon\", x, y)\r\n        this.makeRootElement()\r\n        buttons.forEach(btn => {\r\n            let { label, color, cb } = btn\r\n            let theButton = assembleButton(label, color)\r\n            theButton.onclick = cb\r\n            this._element.appendChild(theButton)\r\n        })\r\n    }\r\n}\r\n\r\nexport class Arena extends Scene {\r\n    planet: Planet\r\n    spawnPalette: SpawnPalette\r\n    floorY: number\r\n\r\n    controller: GameController\r\n\r\n    public onInitialize(game: Game) {\r\n        let hud = new Hud(game)\r\n        this.planet = new Planet(hud, noop, noop, 200000, 40000, this)\r\n        this.add(this.planet)\r\n        this.floorY = this.planet.getTop()\r\n        this.spawnPalette = new SpawnPalette(100,100,[\r\n            { label: 'Raider', color: Color.Red, cb: this.spawnHostile }, \r\n            { label: 'Citizen', color: Color.Green, cb: this.spawnFriendly }, \r\n            { label: 'Elite Raider', color: Color.Red, cb: this.spawnHostileCommander }, \r\n            { label: 'Commander', color: Color.Green, cb: this.spawnFriendlyCommander }, \r\n            { label: 'Main Menu', color: Color.White, cb: () => {\r\n                game.goToScene('menu')\r\n            }}, \r\n        ])\r\n    }\r\n\r\n    onActivate() {\r\n        this.controller = new GameController(this.engine, this.camera)\r\n        this.controller.activate()\r\n        this.spawnPalette.show()\r\n        if (this.planet.population.citizens.length === 0) {\r\n            this.spawnFriendly()\r\n        }\r\n        if (this.planet.population.raiders.length === 0) {\r\n            this.spawnHostile()\r\n        }\r\n        this.camera.move(this.planet.population.citizens[0].pos, 0)\r\n    }\r\n\r\n    onDeactivate() {\r\n        this.spawnPalette.hide()\r\n        this.controller.deactivate()\r\n    }\r\n\r\n    draw(ctx, delta) {\r\n        super.draw(ctx,delta)\r\n        this.spawnPalette.draw(ctx)\r\n    }\r\n\r\n    friendlySpawnX: number = 1000\r\n    hostileSpawnY: number = -1000\r\n\r\n    spawnDrift: number = 500\r\n\r\n    spawnFriendlyCommander = () => {\r\n        let cmdrName = sample(['Spork', 'Kierkegon', 'Bolnes', 'Pickhard', 'Rilker', 'Krusha', 'Forage', 'Scorch', 'Hula', 'Checkmate', 'Gorf', 'Helen', 'Arg'])\r\n        let friendly = new Citizen(cmdrName, new Vector((Math.random() * this.spawnDrift) + this.friendlySpawnX, this.floorY), this.planet, true)\r\n        this.planet.population.citizens.push(friendly)\r\n        this.add(friendly)\r\n    }\r\n\r\n    spawnFriendly = () => {\r\n        let pawnName = sample(['Jones', 'Smith', 'Ford', 'Abel', 'Thomas'])\r\n        let friendly = new Citizen(pawnName, new Vector((Math.random() * this.spawnDrift) + this.friendlySpawnX, this.floorY), this.planet, false)\r\n        this.planet.population.citizens.push(friendly)\r\n        this.add(friendly)\r\n    }\r\n\r\n    spawnHostile = () => {\r\n        let hostile = new Citizen('Raider', new Vector((Math.random() * this.spawnDrift) + this.hostileSpawnY, this.floorY), this.planet, false, true)\r\n        this.planet.population.raiders.push(hostile)\r\n        this.add(hostile)\r\n    }\r\n\r\n    spawnHostileCommander = () => {\r\n        let cmdrName = sample([ 'Conn', 'Drak', 'Tanoz', 'Queue', 'Morgoth'])\r\n        let hostile = new Citizen(cmdrName, new Vector((Math.random() * this.spawnDrift) + this.hostileSpawnY, this.floorY), this.planet, true, true)\r\n        this.planet.population.raiders.push(hostile)\r\n        this.add(hostile)\r\n    }\r\n}","import { Machine, Houseplant, Orchard, Bed, OxygenExtractor, WaterCondensingMachine, Codex, Bookshelf, SolarCell, Fridge, Stove, Books, Workstation, Greenhouse, Botany, MineralProcessor, Miner, Table } from \"./Machine\";\r\n\r\nexport enum Discipline {\r\n    Survival = 'Environmental Control',\r\n    Agriculture = 'Food Production',\r\n    LibraryScience = 'Library Science',\r\n    Cooking = 'Food Preparation',\r\n    // PowerGeneration = 'Power Generation',\r\n    // LifeScience = 'Life Sciences',\r\n    // PlasticArts = 'Plastic Arts',\r\n    MineralProduction = 'Mineral Production',\r\n}\r\n\r\nexport interface TechnologyRank {\r\n    name: string\r\n    level: number\r\n    description: string\r\n    prereqs: (typeof Machine)[]\r\n    unlocks: (typeof Machine)[]\r\n}\r\n\r\nexport const disciplineTree: { [key in Discipline]: TechnologyRank[] } = {\r\n    [Discipline.Survival]: [\r\n        { \r\n            name: \"Survival I\",\r\n            level: 1,\r\n            description: \"staying alive\",\r\n            prereqs: [ Bed, SolarCell ],\r\n            unlocks: [ OxygenExtractor, WaterCondensingMachine ]\r\n        },\r\n    ],\r\n\r\n    [Discipline.Agriculture]: [\r\n        // small planter?\r\n        {\r\n            name: 'Food Prod. I',\r\n            level: 1,\r\n            description: \"watch the calories\",\r\n            prereqs: [Botany],\r\n            unlocks: [Houseplant, Greenhouse, Orchard],\r\n        } // Greenhouse...? ] }\r\n    ],\r\n\r\n    [Discipline.Cooking]: [\r\n        {\r\n            name: 'Food Prep. I',\r\n            level: 1,\r\n            description: \"bam\",\r\n            prereqs: [Fridge],\r\n            unlocks: [Stove],\r\n        }\r\n    ],\r\n\r\n    [Discipline.LibraryScience]: [\r\n        {\r\n            name: \"Library Science I\",\r\n            level: 1,\r\n            description: \"try to understand\",\r\n            prereqs: [ Books ],\r\n            unlocks: [ Bookshelf, Workstation, Codex ],\r\n        }\r\n    ],\r\n\r\n    [Discipline.MineralProduction]: [\r\n        {\r\n            name: 'Mineral Production I',\r\n            level: 1,\r\n            description: 'make it work',\r\n            prereqs: [ Table ],\r\n            unlocks: [ Miner, MineralProcessor ],\r\n        }\r\n    ]\r\n\r\n    // [Discipline.LifeScience]: [ \r\n    //     { prereqs: [], unlocks: [ Botany, AlgaeVat ]}\r\n    // ],\r\n\r\n    // [Discipline.PlasticArts]: [\r\n    //     { prereqs: [ Figurine ], unlocks: [ Statue ] }\r\n\r\n    // ],\r\n}\r\n\r\n","import { Machine } from \"./Machine\";\r\nimport { range } from \"../Util\";\r\nimport { Discipline, TechnologyRank, disciplineTree } from \"./TechnologyRank\";\r\n\r\nexport class TechTree {\r\n    currentLevels: {\r\n        [key in Discipline]: number;\r\n    } = {\r\n            [Discipline.Survival]: -1,\r\n            [Discipline.LibraryScience]: -1,\r\n            [Discipline.Agriculture]: -1,\r\n            [Discipline.Cooking]: -1,\r\n            [Discipline.MineralProduction]: -1,\r\n        };\r\n\r\n    findDisciplineToRankUp(machines: (typeof Machine)[]): Discipline {\r\n        for (let disciplineName of Object.keys(Discipline)) {\r\n            let discipline: Discipline = Discipline[disciplineName];\r\n            if (this.canRankUp(discipline, machines)) {\r\n                return discipline;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    rankUp(discipline: Discipline): TechnologyRank {\r\n        this.currentLevels[discipline] += 1;\r\n        return this.currentRank(discipline);\r\n    }\r\n\r\n    private currentRank(discipline: Discipline): TechnologyRank {\r\n        return disciplineTree[discipline][this.currentLevels[discipline]];\r\n    }\r\n\r\n    private canRankUp(discipline: Discipline, machines: (typeof Machine)[]): boolean {\r\n        let level = this.currentLevels[discipline];\r\n        let nextLevel: TechnologyRank = disciplineTree[discipline][level + 1];\r\n        if (nextLevel) {\r\n            if (nextLevel.prereqs.every(machine => machines.includes(machine))) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    allUnlockedMachines(): (typeof Machine)[] {\r\n        let unlocked = [];\r\n        for (let disciplineName of Object.keys(Discipline)) {\r\n            unlocked.push(...this.unlockedMachinesFor(Discipline[disciplineName]));\r\n        }\r\n        return unlocked;\r\n    }\r\n\r\n    private unlockedMachinesFor(discipline: Discipline) {\r\n        let tree = disciplineTree[discipline];\r\n        let unlocked = [];\r\n        let level = this.currentLevels[discipline] + 1;\r\n        for (let i in range(level)) {\r\n            unlocked.push(...tree[i].unlocks);\r\n        }\r\n        return unlocked;\r\n    }\r\n}\r\n","import * as ex from 'excalibur';\r\n\r\nexport class Player extends ex.Actor {\r\n  constructor() {\r\n    super();\r\n    this.setWidth(5);\r\n    this.setHeight(5);\r\n    this.x = 5;\r\n    this.y = 5;\r\n    this.color = new ex.Color(255, 255, 255);\r\n  }\r\n}\r\n","import { range } from '../../Util';\r\nimport { PlanetBackground } from './PlanetBackground';\r\nexport class Mountains extends PlanetBackground {\r\n    peaks: {\r\n        x: number;\r\n        height: number;\r\n    }[] = [];\r\n    onInitialize() {\r\n        let peakCount = 14;\r\n        let peakHeight = 1500;\r\n        let xOff = this.getWidth() / 2;\r\n        let peakDistance = this.getWidth() / peakCount;\r\n        // for (let times of range(2)) {\r\n        let heightRange = 100;\r\n        let drift = 3 * (peakDistance / 2);\r\n        for (let i of range(peakCount)) {\r\n            let h = \r\n                (Math.random() * peakHeight) + ((Math.random() * heightRange) - (heightRange / 2))\r\n            this.peaks.push({\r\n                x: Math.min(this.getWidth() / 2 - h / 2, -xOff + i * peakDistance + ((Math.random() * drift))),\r\n                height: h\r\n            });\r\n        }\r\n        // }\r\n    }\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        let baseColor = this.color.desaturate(0.35);\r\n        let brightColor = baseColor.lighten(0.1);\r\n        ctx.fillStyle = baseColor.toRGBA();\r\n        let yBase = this.pos.y - 3;\r\n        this.peaks.forEach(peak => {\r\n            let y0 = yBase - peak.height;\r\n            let mtnWidth = peak.height * 3.4;\r\n            ctx.beginPath();\r\n            ctx.moveTo(peak.x, y0);\r\n            ctx.lineTo(peak.x - mtnWidth, yBase);\r\n            ctx.lineTo(peak.x + mtnWidth, yBase);\r\n            ctx.fillStyle = baseColor.toRGBA();\r\n            ctx.fill();\r\n            ctx.beginPath();\r\n            ctx.moveTo(peak.x, y0);\r\n            ctx.lineTo(peak.x + 3 * (mtnWidth / 4), yBase);\r\n            ctx.lineTo(peak.x + mtnWidth, yBase);\r\n            ctx.fillStyle = brightColor.toRGBA();\r\n            ctx.fill();\r\n        });\r\n    }\r\n}\r\n","import { Actor, Color } from 'excalibur';\r\nimport { mixColors } from '../../Util';\r\nimport { Mountains } from \"./Mountains\";\r\nimport { MountainLayers } from \"./MountainLayers\";\r\nexport class SkyLayer extends Actor {\r\n    mountains: Mountains;\r\n    mountainLayers: MountainLayers;\r\n    backMountainLayers: MountainLayers;\r\n    constructor(y: number, width: number, lo: Color, hi: Color) {\r\n        super(0, y, width, 1500); //width,1500) //height)\r\n        let mid = mixColors(lo, hi);\r\n        let buffer = MountainLayers.layerHeight / 3\r\n        let ht = (MountainLayers.layerHeight - buffer) * MountainLayers.layerCount\r\n        this.backMountainLayers = new MountainLayers(-ht, width, mid);\r\n        this.backMountainLayers.skyColor = hi;\r\n        this.add(this.backMountainLayers);\r\n        this.mountains = new Mountains(0, width, mid);\r\n        this.add(this.mountains);\r\n        this.mountainLayers = new MountainLayers(0, this.getWidth(), lo);\r\n        this.mountainLayers.skyColor = mid;\r\n        this.add(this.mountainLayers);\r\n    }\r\n    setLoHi(lo: Color, hi: Color) {\r\n        let mid = mixColors(lo, hi);\r\n        this.backMountainLayers.color = mid;\r\n        this.backMountainLayers.skyColor = hi;\r\n        this.mountains.color = mid;\r\n        this.mountainLayers.color = lo;\r\n        this.mountainLayers.skyColor = mid;\r\n    }\r\n}\r\n","import { Actor, Color } from 'excalibur';\r\nimport { range, mixColors } from '../../Util';\r\nimport { SkyLayer } from \"./SkyLayer\";\r\nimport { MountainLayers } from './MountainLayers';\r\nexport class SkyLayers extends Actor {\r\n    layers: SkyLayer[] = [];\r\n    constructor(y: number, width: number, private lo: Color, hi: Color, private layerCount: number = 4) {\r\n        super(0, y, width, 1500);\r\n        let h = MountainLayers.layerHeight * MountainLayers.layerCount\r\n        for (let i of range(layerCount)) {\r\n            let c0 = mixColors(lo, hi, (i / (layerCount + 1)));\r\n            let c1 = mixColors(lo, hi, ((i + 1) / (layerCount + 1)));\r\n            let layer = new SkyLayer(-20 - ((h) * (layerCount - i - 1)), this.getWidth(), c1, c0);\r\n            this.layers.push(layer);\r\n            this.add(layer);\r\n        }\r\n    }\r\n    setHi(hi: Color) {\r\n        let lo = this.lo;\r\n        for (let i of range(this.layerCount)) {\r\n            let c0 = mixColors(lo, hi, (i / (this.layerCount + 1)));\r\n            let c1 = mixColors(lo, hi, ((i + 1) / (this.layerCount + 1)));\r\n            this.layers[i].setLoHi(c1, c0);\r\n            // let layer = new SkyLayer(-100 * (layerCount-i-1), this.getWidth(), c1, c0)\r\n        }\r\n    }\r\n}\r\n","import { Actor, Color, CollisionType, Traits } from \"excalibur\";\r\nimport { Game } from \"../Game\";\r\nimport { Citizen } from \"./Citizen\";\r\n\r\nexport class LaserBeam extends Actor {\r\n    private evil: boolean\r\n    constructor(private source: Citizen, private targetDirectionSign: number) {\r\n        super(\r\n            source.pos.x + 42 * targetDirectionSign,\r\n            source.pos.y - 10,\r\n            12,\r\n            1 //0.8\r\n        )\r\n\r\n        this.evil = source.isEvil\r\n\r\n        this.color = (this.evil ? Color.Green : Color.Cyan).clone().lighten(0.3)\r\n        this.vel.x = Game.bulletSpeed * targetDirectionSign\r\n\r\n        let drift = 24\r\n        this.vel.y = (Math.random() * drift) - (drift/2)\r\n        this.on('collisionstart', this.handleCollision) \r\n        this.collisionType = CollisionType.Passive\r\n        this.traits = this.traits.filter(trait => !(trait instanceof Traits.OffscreenCulling))\r\n    }\r\n\r\n    handleCollision = (collision) => {\r\n        let validTarget = collision.other instanceof Citizen &&\r\n            collision.other.alive &&\r\n            this.evil !== collision.other.isEvil\r\n        if (!validTarget) { return }\r\n\r\n        if (collision.other.guarding) {\r\n            // 60% chance to reflect\r\n            if (Math.random() > 0.4) {\r\n                this.vel.x = -this.vel.x\r\n                this.evil = !this.evil\r\n                // 10% chance to alter y-vel\r\n                if (Math.random() > 0.9) {\r\n                    this.vel.y += (Math.random() * 60) - 30\r\n                }\r\n            } else if (Math.random() > 0.4) {\r\n                // if didn't reflect, 60% to absorb\r\n                this.kill()\r\n            }\r\n        } else if (Math.random() > 0.4) {\r\n            this.kill()\r\n            collision.other.injure(5 + (Math.random() * 2), this.source)\r\n        }\r\n    }\r\n}","import { CombatStrategy } from \"./CombatStrategy\";\r\nimport { minBy, closest, sleep } from \"../Util\";\r\nimport { Citizen } from \"../actors/Citizen\";\r\nimport { CommandCenter } from \"../models/Machine\";\r\n\r\nexport class AttackNearestHostileStrategy extends CombatStrategy {\r\n    vigilanceRange: number = 2000\r\n\r\n        // ideas -- if not on surface, get to surface?\r\n        // if evil, advance towards mission control, fight anything in the way\r\n        // if not, get to surface/ctrl and fight anything\r\n    protected async apply() {\r\n        let target = closest(\r\n            this.pawn.pos,\r\n            this.hostiles.filter(h => h.alive && !h.isDriving),\r\n            (h) => h.pos\r\n        )\r\n        if (target) {\r\n            // this.pawn.log(\"found new target\")\r\n            this.pawn.engageHostile(target)\r\n        } else {\r\n            this.pawn.log(\"no new targets?\")\r\n        }\r\n\r\n        let enemy = this.pawn.enemyCombatant\r\n        let dy = Math.abs(this.pawn.pos.y - enemy.y)\r\n        if (dy > 40) {\r\n            this.pawn.log(\"head to mission ctrl...\")\r\n            if (this.pawn.isEvil) {\r\n                this.pawn.log(\"to attack it!\")\r\n                await this.pawn.advanceTowards(this.planet.colony.origin)\r\n            } else {\r\n                this.pawn.log(\"to defend it!\")\r\n                let cmdCenter = this.planet.colony.findAllDevices().find(device => device.machine instanceof CommandCenter)\r\n                await this.pawn.visit(cmdCenter)\r\n            }\r\n        } else { \r\n            if (this.pawn.withinFiringRange()) {\r\n                await this.attack()\r\n            } else {\r\n                await this.pawn.advanceTowardsEnemy()\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    async attack() {\r\n        this.pawn.y = this.pawn.enemyCombatant.y\r\n        if (!(this.pawn.guarding || this.pawn.firing)) {\r\n            if (this.pawn.isEvil || this.pawn.health > 95) {\r\n                await this.pawn.fire()\r\n            } else {\r\n                if ((this.pawn.health < 50 && Math.random() < 0.05) || Math.random() < 0.01) {\r\n                    await this.pawn.guard()\r\n                } else {\r\n                    await this.pawn.fire()\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    canApply(): boolean {\r\n        let defensePoint = this.planet.colony.origin ? this.planet.colony.origin : this.pawn.pos\r\n        let timeToPlay = this.hostiles.some(hostile => hostile.alive &&\r\n            (this.pawn.isEvil ? true : defensePoint.distance(hostile.pos) < this.vigilanceRange) \r\n            && !hostile.isDriving\r\n        )\r\n        return timeToPlay\r\n\r\n    }\r\n\r\n    get hostiles() {\r\n        return this.pawn.isEvil\r\n            ? this.planet.population.citizens\r\n            : this.planet.population.raiders\r\n    }\r\n}","import { Strategy } from \"./Strategy\";\r\n\r\nexport abstract class EatingStrategy extends Strategy {\r\n    describe() { return 'eating' }\r\n}","import { EatingStrategy } from \"./EatingStrategy\";\r\nimport { ResourceBlock } from \"../models/Economy\";\r\n\r\nexport class WhenHungryEatingStrategy extends EatingStrategy {\r\n    canApply(): boolean {\r\n        return this.pawn.isHungry &&\r\n            this.planet.storedResources.includes(ResourceBlock.Meal)\r\n        // hunger > 0.6\r\n        // throw new Error(\"Method not implemented.\");\r\n    }\r\n\r\n    protected async apply() {\r\n        // find the store with the food! reserve it maybe?\r\n        let fridge = this.devices.find(d => d.machine.operation.type === 'store' &&\r\n          d.machine.operation.stores.includes(ResourceBlock.Meal) &&\r\n          d.product.includes(ResourceBlock.Meal) &&\r\n          !d.reserved\r\n        )\r\n\r\n        if (fridge) {\r\n            fridge.reserved = true\r\n            // take the meal to a desk? (maybe need table here... or eatingSurface aspect?)\r\n            await this.visitDevice(fridge)\r\n            await fridge.interact(this.pawn, { type: 'retrieve', resource: ResourceBlock.Meal })\r\n            fridge.reserved = false\r\n\r\n            let desk = this.devices.find(d => d.machine.isEatingSurface) // instanceof Desk)\r\n            if (desk) {\r\n                await this.visitDevice(desk)\r\n            }\r\n            await this.pawn.eat()\r\n            // fridge.interac\r\n            // this.pawn.interact()\r\n        }\r\n    }\r\n    \r\n    \r\n}","import { Strategy } from \"./Strategy\";\r\n\r\nexport abstract class SleepingStrategy extends Strategy {\r\n    describe() { return 'sleeping' }\r\n}","import { SleepingStrategy } from \"./SleepingStrategy\";\r\nimport { Bed } from \"../models/Machine\";\r\nimport { shuffle } from \"../Util\";\r\n\r\nexport class AnyBedSleepingStrategy extends SleepingStrategy {\r\n    canApply(): boolean {\r\n        if (!this.bed) {\r\n            // no available beds..\r\n            return false\r\n        }\r\n\r\n        if (this.planet.population.raiders.some(raider => raider.pos.distance(this.pawn.pos) < 1000)) {\r\n            // you can't sleep now!\r\n            return false\r\n        }\r\n\r\n        if (this.pawn.health < 100) {\r\n            return true\r\n        }\r\n\r\n        if (!this.pawn.isTired) {\r\n            return false\r\n        }\r\n\r\n        let bedtime = this.planet.hour > 21 || this.planet.hour < 4\r\n        return bedtime\r\n    }\r\n\r\n    protected async apply() {\r\n        this.pawn.log(\"try to sleep!\")\r\n        // find a bed\r\n        // let bed = shuffle(this.devices).find(d => d.machine instanceof Bed && !d.inUse)\r\n        let bed = this.bed\r\n        if (bed) {\r\n            this.pawn.log(\"found a bed!\")\r\n            bed.inUse = true\r\n            this.pawn.sleepingInBed = bed\r\n            this.pawn.log(\"going to bed!\")\r\n            await this.visitDevice(bed)\r\n            this.pawn.log(\"taking a rest!\")\r\n            await this.pawn.takeRest()\r\n            this.pawn.log(\"done resting!\")\r\n            bed.inUse = false\r\n        }\r\n        return true\r\n    }\r\n\r\n\r\n    private get bed() {\r\n        return shuffle(this.devices).find(d => d.machine instanceof Bed && !d.inUse )\r\n    }\r\n}","import { Strategy } from \"./Strategy\";\r\nimport { Device } from \"../actors/Device\";\r\nimport { containsUniq } from \"../Util\";\r\n\r\nexport abstract class ConstructionStrategy extends Strategy {\r\n    describe() { return 'building' }\r\n\r\n    canApply(): boolean {\r\n        return !!this.unbuiltDevice\r\n    }\r\n\r\n    get unbuiltDevice() {\r\n        const isUnbuilt = (d: Device) => !d.built && !d.inUse && d.building.isActive &&\r\n          // the player can TRY to build it, we don't have to hang forever on it though\r\n          containsUniq(this.planet.storedResources, d.machine.cost)\r\n        return this.planet.colony.findAllDevices().find(isUnbuilt)\r\n    }\r\n}","import { ConstructionStrategy } from \"./ConstructionStrategy\";\r\nimport { Device } from \"../actors/Device\";\r\n\r\nexport class ProxmityBasedConstruction extends ConstructionStrategy {\r\n    async apply() {\r\n        if (this.unbuiltDevice && this.unbuiltDevice.building) {\r\n            await this.constructDevice(this.unbuiltDevice)\r\n        }\r\n        await this.pause()\r\n    }\r\n\r\n    private async constructDevice(device: Device) {\r\n        device.inUse = true\r\n        let resources = device.machine.cost\r\n        if (await this.gatherIngredients(resources)) {\r\n            await this.visitDevice(device)\r\n            await device.assemble(this.pawn)\r\n        } \r\n\r\n        device.inUse = false\r\n    }\r\n}","import { Device } from \"../actors/Device\";\r\nimport { MechanicalOperation, Recipe } from \"../models/MechanicalOperation\";\r\nimport { ResourceBlock } from \"../models/Economy\";\r\nimport { retrieveResource } from \"../values/InteractionRequest\";\r\nimport { Strategy } from \"./Strategy\";\r\n\r\nexport abstract class ProductionStrategy extends Strategy {\r\n    describe() { return 'making' }\r\n\r\n    protected async storeBlock(res: ResourceBlock) {\r\n        let stored = false\r\n        let tries = 0\r\n        while (!stored && tries < 30) {\r\n            tries++\r\n            if (await this.tryStoreBlock(res)) {\r\n                stored = true\r\n            } else {\r\n                await this.pause()\r\n            }\r\n        }\r\n    }\r\n\r\n    private async tryStoreBlock(res: ResourceBlock): Promise<boolean> {\r\n        let storesDesiredBlock = (d: Device) => d.operation.type === 'store' &&\r\n            d.product.length < d.getEffectiveOperationalCapacity(d.operation) && //operation.capacity &&\r\n            d.operation.stores.includes(res)\r\n        let openStore = this.planet.colony.closestDeviceByType(this.pawn.pos, [], storesDesiredBlock)\r\n        let stored = false\r\n        if (openStore) {\r\n            await this.visitDevice(openStore)\r\n            if (await openStore.interact(this.pawn, { type: 'store', resource: res })) {\r\n                stored = true\r\n            }\r\n        }\r\n\r\n        //if (!stored) {\r\n        //    await this.pause()\r\n        //    // should try agi\r\n        //    // await this.storeBlock(res)\r\n        //}\r\n\r\n        return stored\r\n    }\r\n\r\n}\r\n","import { shuffle, containsUniq } from \"../Util\";\r\nimport { Device } from \"../actors/Device\";\r\nimport { Recipe, ResourceStorage, ExploreForResource } from \"../models/MechanicalOperation\";\r\nimport { ProductionStrategy } from \"./ProductionStrategy\";\r\nimport { Resource } from \"excalibur\";\r\n\r\nexport class CapacityBasedProduction extends ProductionStrategy {\r\n    canApply(): boolean {\r\n\r\n        const storeWithCapacity = (d: Device) => d.operation.type === 'store' &&\r\n            d.product.length < d.getEffectiveOperationalCapacity(d.operation) //&&\r\n\r\n        let stores = this.devices.filter(storeWithCapacity)\r\n        let workable = stores.some((d: Device) => {\r\n            let recipe = this.findRecipe(d)\r\n            let explorer = this.findExplorer(d)\r\n            return !!(recipe || explorer)\r\n        })\r\n\r\n        return workable\r\n    }\r\n\r\n    async apply() {\r\n        let store = this.findStore()\r\n        let recipe = this.findRecipe(store)\r\n        let explorer = this.findExplorer(store)\r\n\r\n\r\n        if (recipe && containsUniq(this.planet.storedResources, recipe.consumes)) {\r\n            if (await this.workRecipe(recipe)) {\r\n                await this.storeBlock(recipe.produces)\r\n            }\r\n        } else if (explorer) {\r\n            if (await this.workExploration(explorer)) {\r\n                await this.storeBlock(explorer.gathers)\r\n            }\r\n        } else {\r\n            // console.warn(\"No recipe or explorer!\")\r\n        }\r\n    }\r\n\r\n    private findStore() {\r\n        const storeWithCapacity = (d: Device) => d.operation.type === 'store' &&\r\n            d.product.length < d.getEffectiveOperationalCapacity(d.operation) //&&\r\n        let store: Device = shuffle(this.devices).find(storeWithCapacity)\r\n        return store\r\n    }\r\n\r\n\r\n    private findRecipe(store: Device): Recipe {\r\n        if (store && store.operation.type === 'store') {\r\n            const storage: ResourceStorage = store.operation\r\n            const recipeForStoredResource = (r: Recipe) => storage.stores.some(stored => r.produces === stored)\r\n            let recipe: Recipe = shuffle(this.recipes).find(recipeForStoredResource)\r\n            return recipe\r\n        }\r\n    }\r\n\r\n    private findExplorer(store: Device): ExploreForResource {\r\n        if (store && store.operation.type === 'store') {\r\n            const storage: ResourceStorage = store.operation\r\n            // console.log(\"Looking for explorer for\", { stored: storage.stores })\r\n            const explorerForStored = (e: ExploreForResource) => storage.stores.some(stored => e.gathers === stored)\r\n            let explorer: ExploreForResource = shuffle(this.explorers).find(explorerForStored)\r\n            // console.log(\"Looked for explorer, found: \", { explorer })\r\n            return explorer\r\n        }\r\n    }\r\n}\r\n","import { Actor, Traits, Scene } from 'excalibur';\r\nimport { Citizen } from '../Citizen';\r\nimport { Planet } from './Planet';\r\nimport { Device } from '../Device';\r\nimport { World } from '../../models/World';\r\n\r\nexport class Population extends Actor {\r\n    citizens: Citizen[] = []\r\n    raiders: Citizen[] = []\r\n\r\n    constructor(private planet: Planet, public scene: Scene) {\r\n        super(0, -planet.getHeight() / 2, 0, 0);\r\n        this.traits = this.traits.filter(trait => !(trait instanceof Traits.OffscreenCulling));\r\n        console.log(\"in pop ctor, scene is: \", { scene: this.scene })\r\n    }\r\n\r\n    update(engine, delta) {\r\n        let notKilled = c => c.alive // && !c.isKilled()\r\n        this.citizens = this.citizens.filter(notKilled)\r\n        this.raiders = this.raiders.filter(notKilled)\r\n    }\r\n\r\n    increase(pos, elite: boolean = false) {\r\n        let citizen = new Citizen(World.nameCitizen(), pos, this.planet, elite);\r\n        citizen.work();\r\n        this.citizens.push(citizen);\r\n        // scene.add?\r\n        if (this.scene) {\r\n            this.scene.add(citizen);\r\n        } else {\r\n            console.warn(\"no scene to add citizen to!?!?\")\r\n        }\r\n    }\r\n\r\n    tearDown() {\r\n        this.citizens.forEach((c) => this.scene.remove(c))\r\n        this.raiders.forEach((c) => this.scene.remove(c))\r\n    }\r\n}\r\n","import { Graph } from \"../../values/Graph\";\r\nimport { Vector } from \"excalibur\";\r\nimport { Building } from \"../Building\";\r\nimport { minBy } from \"../../Util\";\r\n\r\nexport class NavigationTree {\r\n   graph: Graph<Vector>\r\n\r\n   constructor(root: Building) {\r\n       this.graph = root.graph()\r\n   }\r\n\r\n   seekPath(origin: Vector, dest: Vector): Vector[] {\r\n      return this.graph.shortestPath(origin, dest)\r\n   }\r\n\r\n   closestNode(testNode: Vector) {\r\n       let nodes = this.graph.dfs()\r\n       let closest = minBy(nodes,\r\n           (node: Vector) => Math.abs(testNode.distance(node))\r\n       )\r\n       if (closest) {\r\n           return closest\r\n       }\r\n       return false\r\n   }\r\n\r\n   closestNodeAtSameYCoordinate(testNode: Vector, tol: number = 50) {\r\n       let nodes = this.graph.dfs()\r\n       let closest = minBy(\r\n           nodes.filter((node: Vector) => Math.abs(node.y - testNode.y) < tol),\r\n           (node: Vector) => Math.abs(testNode.distance(node)),\r\n       )\r\n       if (closest) {\r\n           return closest\r\n       }\r\n       return false\r\n   }\r\n}","import { Actor, Vector, Traits, Color } from 'excalibur';\r\nimport { Building } from '../Building';\r\nimport { minBy, flatSingle } from '../../Util';\r\nimport { Structure } from '../../models/Structure';\r\nimport { NavigationTree } from './NavigationTree';\r\nimport { Machine } from '../../models/Machine';\r\nimport { Device } from '../Device';\r\nimport { Game } from '../../Game';\r\n\r\nexport class Colony extends Actor {\r\n    navTree: NavigationTree;\r\n    buildings: Building[] = [];\r\n    currentlyConstructing: Building | Device = null;\r\n\r\n    constructor(x: number, y: number) {\r\n        super(x, y, 0, 0); // 1000, 1000);\r\n        this.traits = this.traits.filter(trait => !(trait instanceof Traits.OffscreenCulling));\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        super.draw(ctx, delta);\r\n\r\n        let debugTree = Game.debugPath\r\n        if (this.navTree && debugTree) {\r\n            let edges = this.navTree.graph.edgeList();\r\n            edges.forEach((edge) => {\r\n                let [a,b] = edge;\r\n                var gradient = ctx.createLinearGradient(a.x,a.y+this.pos.y,b.x,b.y+this.pos.y);\r\n\r\n                gradient.addColorStop(0, 'green');\r\n                gradient.addColorStop(1, 'blue');\r\n\r\n                ctx.beginPath()\r\n                ctx.moveTo(a.x, a.y + this.pos.y)\r\n                ctx.lineTo(b.x, b.y + this.pos.y)\r\n                ctx.closePath()\r\n                ctx.strokeStyle = gradient\r\n                ctx.lineWidth = 0.5\r\n                ctx.stroke()\r\n            })\r\n        }\r\n\r\n    }\r\n\r\n    tearDown() {\r\n        this.navTree = null\r\n        this.currentlyConstructing = null\r\n        this.buildings.forEach(b => this.remove(b))\r\n    }\r\n\r\n    placeBuilding(building: Building) {\r\n        building.placed = true;\r\n        if (building.parentSlot) {\r\n            building.parentSlot.parent.childrenBuildings.push(building);\r\n            this.buildNavTree();\r\n        }\r\n        this.buildings.push(building);\r\n        building.afterConstruct();\r\n        this.add(building);\r\n    }\r\n\r\n    closestBuildingByType(cursor: Vector, structureTypes: (typeof Structure)[] = [], predicate: (Building) => boolean = () => true): Building {\r\n        let matching = this.buildings\r\n        .filter(building => //predicate(building) &&\r\n            (structureTypes.length > 0\r\n            ? structureTypes.some(st => building.structure instanceof st)\r\n            : true)\r\n             && predicate(building)\r\n        )\r\n\r\n        if (matching && matching.length > 0) {\r\n            let distanceToCursor = (building) => cursor.distance(building.nodes()[0]);\r\n            return minBy(matching, distanceToCursor);\r\n        }\r\n    }\r\n\r\n    pathBetween(origin: Vector, destination: Building): Vector[] {\r\n        if (!this.navTree) {\r\n            this.buildNavTree();\r\n        }\r\n        let srcNode = this.navTree.closestNode(origin);\r\n        let dest = destination.nodes()[0] //.length > 1 ? destination.nodes()[1] : destination.nodes()[0];\r\n        let destNode = this.navTree.closestNode(dest);\r\n        let path = this.navTree.seekPath(srcNode, destNode);\r\n        return path;\r\n    }\r\n\r\n    pathBetweenPoints(origin: Vector, destination: Vector, constrainSourceY: boolean = true): Vector[] {\r\n        if (!this.navTree) {\r\n            this.buildNavTree();\r\n        }\r\n        let srcNode = constrainSourceY ? this.navTree.closestNodeAtSameYCoordinate(origin) : this.navTree.closestNode(origin);\r\n        let dest = destination; //.nodes()[0];\r\n        let destNode = this.navTree.closestNode(dest);\r\n        let path = this.navTree.seekPath(srcNode, destNode);\r\n        // console.log(\"PATH FOUND BTWN POINTS\", { srcNode, destNode, path })\r\n        return path;\r\n    }\r\n\r\n\r\n\r\n    closestDeviceByType(cursor: Vector, machineTypes: (typeof Machine)[] = [], predicate: (Device) => boolean = () => true) {\r\n        let devices = this.findPoweredDevices()\r\n        devices = devices.filter(d => \r\n            (machineTypes.length > 0 ? machineTypes.some(machine => d.machine instanceof machine) : true)\r\n             && predicate(d)\r\n        )\r\n\r\n        if (devices && devices.length > 0) {\r\n            let proximity = (d) => cursor.distance(d.pos.add(d.building.pos))\r\n            return minBy(devices, proximity)\r\n        }\r\n    }\r\n\r\n    get origin() {\r\n        return this.buildings[0] ? this.buildings[0].pos : null\r\n    }\r\n\r\n    private buildNavTree() {\r\n        let ctrl = this.buildings[0] //.find(building => building.structure instanceof MissionControl);\r\n        if (ctrl) {\r\n            this.navTree = new NavigationTree(ctrl);\r\n        }\r\n    }\r\n\r\n    findAllDevices(): Device[] {\r\n        return flatSingle(this.buildings.map(b => b.getDevices()))\r\n    }\r\n\r\n    findPoweredDevices(): Device[] {\r\n        return flatSingle(this.activeBuildings.map(b => b.getDevices()))\r\n            .filter(d => d.built) /// ....\r\n    }\r\n\r\n    protected get activeBuildings() {\r\n        return this.buildings.filter(b => b.isActive)\r\n    }\r\n}\r\n","import { ResourceBlock } from \"../models/Economy\";\r\n\r\nimport { Recipe } from \"../models/MechanicalOperation\";\r\n\r\nexport interface RetrieveResource {\r\n    type: 'retrieve'\r\n    resource: ResourceBlock\r\n    // count: number\r\n}\r\n\r\nexport interface WorkRecipe {\r\n    type: 'work'\r\n    recipe: Recipe\r\n}\r\n\r\nexport interface StoreResource {\r\n    type: 'store'\r\n    resource: ResourceBlock\r\n}\r\n\r\nexport interface DriveAround {\r\n    type: 'drive'\r\n}\r\n\r\nexport function retrieveResource(res: ResourceBlock): RetrieveResource {\r\n    return {\r\n        type: 'retrieve',\r\n        resource: res,\r\n        // count: 1\r\n    }\r\n}\r\n\r\nexport function drive(): DriveAround {\r\n    return { type: 'drive' }\r\n}\r\n\r\nexport type InteractionRequest = StoreResource | RetrieveResource | WorkRecipe | DriveAround\r\n\r\n","import { Color } from \"excalibur\";\r\nimport { Pane } from \"./Pane\";\r\nimport { Citizen } from \"../Citizen\";\r\nimport { Game } from \"../../Game\";\r\nimport { assembleButton } from \"../../Elemental\";\r\nimport { CombatStrategy } from \"../../strategies/CombatStrategy\";\r\n\r\nclass CitizenLine {\r\n    private _line: HTMLDivElement\r\n    private button: HTMLButtonElement\r\n    private task: HTMLSpanElement\r\n    private sleepy: HTMLSpanElement\r\n    private hunger: HTMLSpanElement\r\n    // private fighting: HTMLSpanElement\r\n    private busyRow: HTMLDivElement\r\n    private followed: boolean = false\r\n    // ...\r\n    constructor(private citizen: Citizen, private onSelect: (Citizen) => any) {\r\n        this.buildLine()\r\n    }\r\n\r\n    get root() { return this._line }\r\n\r\n    update(isFollowed: boolean, hungry: boolean, tired: boolean) {\r\n        if (isFollowed !== this.followed) {\r\n            this.followed = isFollowed\r\n            // rebuild button\r\n            this._line.removeChild(this.button)\r\n            this.button = this.makeButton()\r\n            this._line.appendChild(this.button)\r\n        // this.button.textContent = isFollowed ? 'Following' : 'Follow'\r\n        // this.button.backg clr = Color.DarkGray // followed ? Color.Violet : Color.DarkGray\r\n        }\r\n\r\n\r\n        this.sleepy.style.display = tired || this.citizen.sleepingInBed ? 'inline' : 'none'\r\n        if (this.citizen.sleepingInBed) {\r\n            this.sleepy.textContent = 'SLEEPING'\r\n        } else {\r\n            this.sleepy.textContent = 'tired'\r\n        }\r\n\r\n        // this.sleepy.textContent = `tired (${this.citizen.energy.toFixed()})`\r\n        this.hunger.style.display = hungry ? 'inline' : 'none'\r\n        // this.hunger.textContent = `hungry (${this.citizen.hunger.toFixed()})`\r\n\r\n        // this.fighting.style.display = this.citizen.engagedInCombat ? 'inline' : 'none'\r\n\r\n        this.task.style.display = this.citizen.isPlanning ? 'inline' : 'none'\r\n        if (this.citizen.lastChoice) {\r\n            this.task.textContent = this.citizen.lastChoice.describe()\r\n            if (this.citizen.lastChoice instanceof CombatStrategy) {\r\n                this.task.style.color = Color.Red.toRGBA()\r\n            } else {\r\n                this.task.style.color = Color.LightGray.toRGBA()\r\n            }\r\n        }\r\n    }\r\n\r\n    buildLine() {\r\n        this._line = document.createElement('div')\r\n        this._line.style.fontFamily = Game.font\r\n        this._line.style.color = 'white'\r\n        this._line.style.backgroundColor = '#6a6a6a'\r\n        this._line.style.display = 'flex'\r\n        this._line.style.width = '100%'\r\n        this._line.style.justifyContent = 'space-between'\r\n        this._line.style.paddingLeft = '5px'\r\n        this._line.style.fontSize = '7pt'\r\n\r\n        let nameLabel = document.createElement('span')\r\n\r\n        nameLabel.textContent = [this.citizen.title, this.citizen.name].join(' ')\r\n        nameLabel.style.alignSelf = 'center'\r\n        this._line.appendChild(nameLabel)\r\n\r\n        this.busyRow = document.createElement('div')\r\n        this.busyRow.style.display = 'flex'\r\n        this.busyRow.style.flexDirection = 'column'\r\n        this._line.appendChild(this.busyRow)\r\n\r\n        this.task = document.createElement('span')\r\n        this.task.textContent = ''\r\n        this.task.style.color = 'white'\r\n        this.task.style.padding = '2px'\r\n        this.busyRow.appendChild(this.task)\r\n\r\n        this.hunger = document.createElement('span')\r\n        this.hunger.textContent = 'hungry'\r\n        this.hunger.style.color = 'yellow'\r\n        this.hunger.style.padding = '2px'\r\n        this.busyRow.appendChild(this.hunger)\r\n\r\n        this.sleepy = document.createElement('span')\r\n        this.sleepy.textContent = 'sleepy'\r\n        this.sleepy.style.color = 'blue'\r\n        this.sleepy.style.padding = '2px'\r\n        this.busyRow.appendChild(this.sleepy)\r\n\r\n        this.button = this.makeButton()\r\n        this._line.appendChild(this.button)\r\n    }\r\n\r\n    makeButton() {\r\n        let msg = this.followed ? \"Following\" : \"Follow\"\r\n        let clr = this.followed ? Color.Violet : Color.DarkGray\r\n        let button = assembleButton(msg, clr)\r\n        button.style.padding = '15px'\r\n        if (this.onSelect) {\r\n            button.onclick = () => {\r\n                this.onSelect(this.citizen)\r\n            }\r\n        }\r\n        return button\r\n    }\r\n}\r\n\r\nexport class CitizenList extends Pane {\r\n    private citizens: Citizen[] = []\r\n    following: Citizen = null\r\n    private citizenLines: Map<Citizen, CitizenLine> = new Map()\r\n\r\n    constructor(\r\n        x: number,\r\n        y: number,\r\n        private onCitizenSelect: (Citizen) => any = null\r\n    ) {\r\n        super(\"Colony Roster\", x, y);\r\n    }\r\n\r\n    updateRoster(citizens: Citizen[], following: Citizen): any {\r\n        let missingCitizens = citizens.some(c => !this.doesRosterInclude(c))\r\n        let lostCitizens = this.citizens.some(c => !citizens.includes(c))\r\n        if (missingCitizens || lostCitizens) { // rebuild\r\n            this.citizens = citizens\r\n            this.makeRoster()\r\n        }\r\n        // let followedChanged = following !== this.citizenList.following\r\n        this.following = following\r\n        this.updateRosterDetails()\r\n    }\r\n\r\n    updateRosterDetails() {\r\n        this.citizens.forEach(citizen => {\r\n            let line: CitizenLine = this.citizenLines.get(citizen)\r\n            line.update(this.following === citizen, citizen.isHungry, citizen.isTired)\r\n        })\r\n    }\r\n\r\n    doesRosterInclude(citizen) {\r\n        return this.citizens.includes(citizen)\r\n    }\r\n\r\n    private makeRoster() {\r\n        this.makeRootElement();\r\n        this.citizens.forEach(c => this.makeCitizenLine(c))\r\n        // citizen => \r\n        // });\r\n    }\r\n\r\n    private makeCitizenLine(citizen: Citizen) {\r\n        let line = new CitizenLine(citizen, this.onCitizenSelect)\r\n        this.citizenLines.set(citizen, line)\r\n        this._element.appendChild(line.root);\r\n    }\r\n}\r\n","import { Color } from \"excalibur\";\r\nimport { Game } from \"../../Game\";\r\nexport class Modal {\r\n    private _element: HTMLDivElement\r\n\r\n    private _header: HTMLDivElement\r\n    private _body: HTMLDivElement\r\n    private _footer: HTMLDivElement\r\n    // private titleLabel: Label\r\n    // private messageLabel: Label\r\n    constructor(private title: string, private message: string, private x: number, private y: number, private width: number = 500) {\r\n        this.makeDialog();\r\n        // super(x,y,200,200, Color.DarkGray)\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D): any {\r\n        // console.log(\"DRAW MODAL\")\r\n        if (this._element) {\r\n            let left = ctx.canvas.offsetLeft - this.width/2;\r\n            let top = ctx.canvas.offsetTop - this._element.clientHeight/2;\r\n            this._element.style.left = `${left + this.x}px`;\r\n            this._element.style.top = `${top + this.y}px`;\r\n        }\r\n    }\r\n\r\n    addButtons(buttonMap: {\r\n        [intent: string]: () => any;\r\n    }) {\r\n        // throw new Error(\"Method not implemented.\");\r\n        let buttons = Object.entries(buttonMap)\r\n        buttons.forEach(([intent, cb]) => {\r\n            let btn = this.buttonFactory(intent, Color.Gray, this.width/(buttons.length))\r\n            btn.onclick = cb\r\n            this._footer.appendChild(btn)\r\n        })\r\n    }\r\n\r\n    teardown() {\r\n        document.body.removeChild(this._element)\r\n        // throw new Error(\"Method not implemented.\");\r\n    }\r\n\r\n    private makeDialog() {\r\n        this._element = document.createElement('div');\r\n        this._element.style.position = 'absolute';\r\n        this._element.style.display = 'flex';\r\n        this._element.style.flexWrap = 'wrap';\r\n        this._element.style.width = `${this.width}px`;\r\n        this._element.style.border = 'none'; //1px solid black'; //0.5px solid white';\r\n        document.body.appendChild(this._element);\r\n\r\n        let bg = Color.Violet.clone().darken(0.92) //.clone..toRGBA()\r\n        bg.a = 0.92\r\n\r\n        let title = document.createElement('div');\r\n        title.textContent = this.title;\r\n        title.style.fontFamily = Game.font //'Verdana';\r\n        title.style.fontSize = '14pt';\r\n        title.style.fontWeight = '700';\r\n        title.style.textTransform = 'uppercase';\r\n        title.style.textAlign = 'center'\r\n        title.style.width = `${this.width}px`;\r\n        title.style.color = Color.White.toRGBA();\r\n        title.style.backgroundColor = bg.toRGBA() //Color.Violet.darken(0.92).toRGBA();\r\n        title.style.padding = '12px';\r\n        title.style.margin = '0px';\r\n        this._element.appendChild(title);\r\n\r\n        this._header = document.createElement('div')\r\n        this._header.style.width = `${this.width}px`;\r\n        this._header.style.backgroundColor = bg.toRGBA() // Color.Violet.darken(0.92).toRGBA();\r\n        this._element.appendChild(this._header)\r\n\r\n        this._body = document.createElement('div');\r\n        this._body.textContent = this.message;\r\n        this._body.style.fontFamily = Game.font //'Verdana';\r\n        this._body.style.fontSize = '9pt';\r\n        this._body.style.fontWeight = '400';\r\n        this._body.style.width = `${this.width}px`;\r\n        this._body.style.color = Color.White.toRGBA();\r\n        this._body.style.backgroundColor = bg.toRGBA() //Color.Violet.darken(0.92).toRGBA();\r\n        this._body.style.padding = '24px';\r\n        this._body.style.paddingBottom = '48px';\r\n        this._body.style.margin = '0px';\r\n        this._element.appendChild(this._body);\r\n\r\n        this._footer = document.createElement('div')\r\n        this._footer.style.width = `${this.width}px`\r\n        this._footer.style.display = 'flex';\r\n        this._footer.style.flexWrap = 'wrap';\r\n        this._element.appendChild(this._footer)\r\n    }\r\n\r\n    addHeading(heading: string, size: number = 24, color: Color = Color.White) {\r\n        let headerMessage = document.createElement('div');\r\n        headerMessage.textContent = heading;\r\n        headerMessage.style.fontFamily = Game.font // 'Helvetica';\r\n        headerMessage.style.fontSize = `${size}pt`;\r\n        headerMessage.style.fontWeight = '600';\r\n        headerMessage.style.textAlign = 'center';\r\n        headerMessage.style.width = `${this.width}px`;\r\n        headerMessage.style.color = color.clone().toRGBA();\r\n        // headerMessage.style.backgroundColor = Color.Violet.darken(0.8).toRGBA();\r\n        headerMessage.style.padding = '0px';\r\n        headerMessage.style.margin = '0px';\r\n        this._header.appendChild(headerMessage)\r\n    }\r\n\r\n    addIconMatrix(iconSet: { image: string, label: string }[] = []) {\r\n        // build a icon matrix\r\n        let matrix = document.createElement('div')\r\n        matrix.style.display = 'flex'\r\n        matrix.style.flexWrap = 'wrap'\r\n        matrix.style.padding = '15px'\r\n        matrix.style.width = `100%` //${this.width}px`\r\n\r\n        matrix.style.justifyContent = 'space-evenly'\r\n\r\n        iconSet.forEach(({ label, image }) => {\r\n            let img = new Image()\r\n            img.width = 64\r\n            img.height = 64\r\n            img.src = image\r\n            img.style.padding = '8px'\r\n\r\n            let lbl = document.createElement('span')\r\n            lbl.textContent = label\r\n            lbl.style.textAlign = 'center'\r\n            lbl.style.padding = '8px'\r\n            lbl.style.fontSize = '6pt'\r\n            lbl.style.fontFamily = Game.font\r\n\r\n            let icon = document.createElement('div')\r\n            icon.style.display = 'flex'\r\n            icon.style.flexDirection = 'column'\r\n            icon.style.padding = '4px'\r\n            icon.appendChild(img)\r\n            icon.appendChild(lbl)\r\n            \r\n            matrix.appendChild(icon)\r\n\r\n        })\r\n\r\n        this._body.appendChild(matrix)\r\n    }\r\n\r\n    private buttonFactory(label: string, color: Color = Color.DarkGray, width: number = this.width/2) {\r\n        let bg = color.darken(0.5).desaturate(0.5).clone();\r\n        bg.a = 0.8;\r\n        let fg = color.lighten(0.8).desaturate(0.4).clone();\r\n        let modalButton = document.createElement('button');\r\n        modalButton.textContent = label;\r\n        modalButton.style.display = 'block';\r\n        modalButton.style.fontSize = '7pt';\r\n        modalButton.style.fontFamily = Game.font //'Verdana';\r\n        modalButton.style.fontWeight = '500';\r\n        modalButton.style.padding = '20px';\r\n        modalButton.style.width = `${width}px`;\r\n        modalButton.style.textTransform = 'uppercase';\r\n        modalButton.style.border = 'none'; //1px solid rgba(255,255,255,0.08)';\r\n        modalButton.style.background = bg.toRGBA();\r\n        modalButton.style.color = fg.toRGBA();\r\n        modalButton.onmouseover = () => {\r\n            modalButton.style.background = bg.saturate(0.5).lighten(0.95).toRGBA();\r\n            modalButton.style.color = fg.lighten(0.9).toRGBA();\r\n        };\r\n        modalButton.onmouseleave = () => {\r\n            modalButton.style.background = bg.toRGBA();\r\n            modalButton.style.color = fg.toRGBA();\r\n        };\r\n        return modalButton;\r\n    }\r\n}\r\n","import { Color } from \"excalibur\";\r\nimport { EntityKind } from \"../../values/Entity\";\r\nimport { onlyUnique } from \"../../Util\";\r\nimport { Pane } from \"./Pane\";\r\nimport { assembleButton } from \"../../Elemental\";\r\n\r\nexport class Palette extends Pane {\r\n    built: EntityKind[] = [];\r\n    comprehended: EntityKind[] = [];\r\n\r\n    constructor(\r\n        name: string,\r\n        x: number,\r\n        y: number,\r\n        private all: EntityKind[],\r\n        private onButtonClick: (EntityKind) => any = null,\r\n        private onButtonEnter: (EntityKind) => any = null,\r\n        private comprehend = true \r\n    ) {\r\n        super(name, x, y)\r\n        this.makePalette();\r\n    }\r\n\r\n\r\n    updateBuilt(built: (EntityKind)[], unlocked: (EntityKind)[] = []) {\r\n        this.built = built;\r\n        if (this.comprehend) {\r\n            let nowComprehended = this.all.filter((e: EntityKind) => {\r\n                let s = new e();\r\n                let prereqs: (EntityKind)[] = s.prereqs;\r\n                return prereqs.every((prereq: EntityKind) => {\r\n                    let built = this.built.some((s: EntityKind) => s === prereq);\r\n                    return built;\r\n                });\r\n            });\r\n            this.comprehended = [\r\n                ...nowComprehended,\r\n                ...unlocked\r\n            ].filter(onlyUnique)\r\n        } else {\r\n            this.comprehended = [ ...this.built, ...unlocked ].filter(onlyUnique)\r\n        }\r\n        this.makePalette();\r\n    }\r\n\r\n    private makePalette() {\r\n\r\n        this.makeRootElement()\r\n\r\n\r\n        this.comprehended\r\n            .map((elem: EntityKind) => new elem())\r\n            .sort((a, b) => a.color > b.color ? -1 : 1)\r\n            .forEach(elem => {\r\n                if (elem.hide) { return }\r\n                let label = elem.name;\r\n                if (!this.built.map(m => new m().name).includes(elem.name)) {\r\n                    label += ' *';\r\n                }\r\n                let clr = elem.color;\r\n                let btn = assembleButton(label, clr);\r\n                this._element.appendChild(btn);\r\n                if (this.onButtonEnter) {\r\n                    btn.onmouseenter = () => { this.onButtonEnter(elem); };\r\n                }\r\n                if (this.onButtonClick) {\r\n                    btn.onclick = () => { this.onButtonClick(elem); };\r\n                }\r\n            });\r\n    }\r\n\r\n}\r\n","import { Label, Actor, FontStyle, Color } from \"excalibur\";\r\nimport { Structure } from \"../../models/Structure\";\r\nimport { Machine } from \"../../models/Machine\";\r\nimport { PureValue, Economy, ResourceBlock } from \"../../models/Economy\";\r\nimport { RoomRecipe } from \"../../models/RoomRecipe\";\r\nimport { Building } from \"../Building\";\r\nimport { Device } from \"../Device\";\r\nimport { countOccurrences, flatSingle } from \"../../Util\";\r\nimport { Game } from \"../../Game\";\r\n\r\nexport class CardBody extends Actor {\r\n    description: Label\r\n    values: Label\r\n    notes: Label\r\n    footer: Label\r\n\r\n    constructor(private entity: Machine | Structure | RoomRecipe | Building | Device, x: number, y: number) {\r\n        super(x, y, 0, 0)\r\n        // resources / recipes\r\n\r\n        this.values = new Label('', 0, 0, Game.font)\r\n        this.values.fontSize = 10\r\n        this.add(this.values)\r\n\r\n        this.notes = new Label('behavioral notes', 0, 30, Game.font)\r\n        this.notes.fontSize = 11\r\n        this.add(this.notes)\r\n\r\n        this.description = new Label('description', 0, 60, Game.font)\r\n        this.description.fontSize = 12\r\n        this.description.fontStyle = FontStyle.Italic\r\n        this.description.color = Color.DarkGray\r\n        this.add(this.description)\r\n\r\n        this.footer = new Label('footer', 20, 80, Game.font)\r\n        this.footer.fontSize = 10\r\n        this.footer.fontStyle = FontStyle.Italic\r\n        this.add(this.footer)\r\n\r\n        this.show(entity)\r\n    }\r\n\r\n    describeResources = (arr: ResourceBlock[]) => {\r\n        let freqs = countOccurrences(arr)\r\n        return Object.keys(freqs)\r\n            .map(elem => `${elem} x${freqs[elem]}`)\r\n            .join(' + ')\r\n    }\r\n\r\n    show(entity: Machine | Structure | RoomRecipe | Building | Device) {\r\n        if (entity) {\r\n            this.description.text = entity.description;\r\n\r\n            if (entity instanceof Machine || entity instanceof Device) {\r\n                this.values.text =  this.describeEconomy(entity.economy)\r\n                // let footerNotes = []\r\n                let resourceDescription = entity instanceof Machine\r\n                    ? `Cost: ${this.describeResources(entity.cost)}`\r\n                    : (entity.built ? this.describeResources(entity.product) : 'under construction')\r\n                let forDome = entity instanceof Machine ? entity.forDome : entity.machine.forDome\r\n                let domeStatus = `For Dome: ${forDome ? 'Yes' : 'No'}`\r\n                this.footer.text = resourceDescription === ''\r\n                    ? domeStatus\r\n                    : [resourceDescription, domeStatus].join(' | ') \r\n                this.notes.text = '' //\r\n                let op = entity.operation\r\n                if (op) {\r\n                    if (op.type === 'recipe') {\r\n                        this.notes.text = `Turns ${op.consumes.join(' + ')} -> ${op.produces}.`\r\n                    } else if (op.type === 'generator') {\r\n                        this.notes.text = `Generates ${op.generates}.`\r\n                    } else if (op.type === 'store') {\r\n                        this.notes.text = `Stores ${op.stores.join(' + ')}`\r\n                    } else if (op.type === 'spawn') {\r\n                        this.notes.text = 'Decants clones.'\r\n                    }\r\n                }\r\n                if (entity instanceof Device && entity.inUse) {\r\n                    this.notes.text += ' [IN USE]'\r\n                }\r\n            } else if (entity instanceof RoomRecipe) {\r\n                let { capacity, workSpeed } = entity.bonuses\r\n                let bonusMessages = [];\r\n                if (capacity > 0) {\r\n                    bonusMessages.push(`+${capacity} cap`)\r\n                }\r\n                if (workSpeed > 1.0) {\r\n                    bonusMessages.push(`+${Math.floor((workSpeed*100)-100)}% efficiency` )\r\n                }\r\n                this.values.text = bonusMessages.join('; ') \r\n                this.notes.text = entity.machines.map(m => (new m()).name).join(' + ')\r\n                this.footer.text = ''\r\n            } else if (entity instanceof Building) {\r\n                this.values.text =  this.describeEconomy(entity.economy(false))\r\n                this.notes.text = entity.getDevices().map(d => d.machine.name).join(' + ')\r\n\r\n                let product = entity.getDevices()\r\n                    .map(d => d.product)\r\n                    .reduce((a, b) => a.concat(b), [])\r\n                this.footer.text = product.length > 0\r\n                    ? \"Currently contains: \" + this.describeResources(product)\r\n                    : ''\r\n            } else {\r\n                this.values.text = ''\r\n                this.notes.text = ''\r\n                this.footer.text = ''\r\n            }\r\n\r\n        }\r\n        // other bonuses? behaviors?\r\n    }\r\n\r\n    private describeEconomy(e: Economy): string {\r\n        let values = []\r\n        let econ = e // entity.economy\r\n        for (let value in PureValue) {\r\n            let { supply, demand } = econ[value]\r\n            let delta = supply - demand\r\n            if (delta > 0) {\r\n                values.push(`+${delta.toFixed()} ${value}`)\r\n            } else if (delta < 0) {\r\n                values.push(`${delta.toFixed()} ${value}`)\r\n            }\r\n        }\r\n        return values.join(' | ')\r\n    }\r\n}\r\n","import { Label, Color, Actor, FontStyle } from \"excalibur\";\r\nimport { Structure } from \"../../models/Structure\";\r\nimport { Machine } from \"../../models/Machine\";\r\nimport { DeviceSize } from \"../../values/DeviceSize\";\r\nimport { RoomRecipe } from \"../../models/RoomRecipe\";\r\nimport { Building } from \"../Building\";\r\nimport { Device } from \"../Device\";\r\nimport { Game } from \"../../Game\";\r\nexport class CardTitle extends Actor {\r\n    \r\n    name: Label;\r\n    type: Label;\r\n    constructor(private entity: Machine | Structure | RoomRecipe | Building | Device, x: number, y: number) {\r\n        super(x, y, 14, 32, entity && entity.color || Color.Gray);\r\n        this.name = new Label(entity && entity.name || '..', 20, 16, Game.font)\r\n        this.name.fontSize = 28\r\n        this.name.color = Color.Black\r\n        this.add(this.name)\r\n\r\n        this.type = new Label('..', 220, 18, Game.font)\r\n        this.type.fontSize = 10\r\n        this.type.color = Color.Gray\r\n        this.type.fontStyle = FontStyle.Italic\r\n        this.add(this.type)\r\n\r\n        if (entity) {\r\n            this.announce(entity)\r\n        }\r\n    }\r\n\r\n    announce(entity: Machine | Structure | RoomRecipe | Building | Device): any {\r\n        this.name.text = entity.name\r\n        this.color = entity.color.desaturate(0.5).darken(0.2)\r\n        if (entity instanceof Machine) { this.type.text = `${DeviceSize[entity.size]} Machine Type` }\r\n        if (entity instanceof Structure) { this.type.text = 'Structure' }\r\n        if (entity instanceof RoomRecipe) { this.type.text = 'Function' }\r\n        if (entity instanceof Building) { this.type.text = 'Building' }\r\n        if (entity instanceof Device) { this.type.text = `${DeviceSize[entity.size]} Machine` }\r\n    }\r\n}\r\n","import { Color, Actor } from \"excalibur\";\r\nimport { Structure } from \"../../models/Structure\";\r\nimport { Machine } from \"../../models/Machine\";\r\nimport { CardTitle } from \"./CardTitle\";\r\nimport { CardBody } from \"./CardBody\";\r\nimport { RoomRecipe } from \"../../models/RoomRecipe\";\r\nimport { Building } from \"../Building\";\r\nimport { Device } from \"../Device\";\r\n\r\nexport class Card extends Actor {\r\n    title: CardTitle\r\n    cardBody: CardBody\r\n    image: HTMLImageElement\r\n\r\n    constructor(private entity: Machine | Structure | RoomRecipe | Building | Device, x: number, y: number) {\r\n        super(x + 160, y + 90, 320, 180, Color.White);\r\n        let x0 = -150, y0 = -50;\r\n        this.title = new CardTitle(entity, x0 - 3, y0); //x, y)\r\n        this.add(this.title);\r\n        this.cardBody = new CardBody(entity, x0 + 14, y0 + 40)\r\n        this.add(this.cardBody)\r\n\r\n        this.image = new Image();\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta) {\r\n        super.draw(ctx, delta)\r\n        if (this.entity) {\r\n            if (this.entity instanceof Machine || this.entity instanceof Device) {\r\n                // if (this.image.src !== null) {\r\n                    let ix = this.pos.x + 48, iy = this.pos.y - 16\r\n                    let isz = 92\r\n\r\n                    // maybe try-fail around this? something for painting?\r\n                    ctx.drawImage(this.image, ix, iy, isz, isz)\r\n                // }\r\n            }\r\n        }\r\n    }\r\n\r\n    present(entity: Machine | Structure | RoomRecipe | Building | Device): any {\r\n        this.title.announce(entity)\r\n        this.cardBody.show(entity)\r\n\r\n        this.entity = entity\r\n        let src = null\r\n        if (this.entity instanceof Machine) { //} || this.entity instanceof Device) {\r\n            src = this.entity.image\r\n        } else if (this.entity instanceof Device) {\r\n            src = this.entity.machine.image\r\n        }\r\n        // console.log(\"img src\", { src })\r\n        if (src) {\r\n            this.image.src = src\r\n        }\r\n    }\r\n\r\n}\r\n","import { Sound, Color } from \"excalibur\";\r\nimport { sample } from \"../../Util\";\r\nimport { Game } from \"../../Game\";\r\n\r\ninterface MusicPlayerPlay { type: 'play'}\r\ninterface MusicPlayerPause { type: 'pause'}\r\ninterface MusicPlayerStop { type: 'stop'}\r\ninterface MusicPlayerNext { type: 'next'}\r\ntype MusicPlayerAction = MusicPlayerPlay | MusicPlayerPause | MusicPlayerStop | MusicPlayerNext\r\n\r\nexport class MusicPlayer {\r\n    private _wrapper: HTMLDivElement;\r\n    private _element: HTMLDivElement;\r\n    private _titleElem: HTMLSpanElement;\r\n\r\n    currentTrack: string\r\n    paused: boolean = false\r\n\r\n    constructor(private x: number, private y: number, private playlist: {\r\n        [track: string]: Sound;\r\n    }) {\r\n        this.makePlayer();\r\n        setTimeout(() => { this.startMusic() }, 3000)\r\n        this._titleElem.textContent = `Getting ready...`;\r\n        this.currentTrack = sample(Object.keys(this.playlist)); //[0];\r\n    }\r\n\r\n    hide() {\r\n        this._wrapper.style.display = 'none'\r\n    }\r\n\r\n    startMusic() {\r\n        this._titleElem.textContent = `Playing: ${this.currentTrack}`;\r\n        this.playlist[this.currentTrack].play()\r\n        .then(() => {\r\n                this.advancePlaylist()\r\n        })\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D) {\r\n        if (this._element) {\r\n            let left = ctx.canvas.offsetLeft;\r\n            let top = ctx.canvas.offsetTop;\r\n            this._wrapper.style.left = `${left + this.x}px`;\r\n            this._wrapper.style.top = `${top + this.y}px`;\r\n        }\r\n    }\r\n\r\n    private makePlayer() {\r\n        this._wrapper = document.createElement('div')\r\n        this._wrapper.style.position = 'absolute'\r\n        this._wrapper.style.width = '20%'\r\n        this._wrapper.style.maxHeight = '20px'\r\n        this._wrapper.style.textAlign = 'left'\r\n        this._wrapper.style.border = 'none';\r\n        this._wrapper.style.overflow = 'hidden';\r\n        document.body.appendChild(this._wrapper);\r\n\r\n        this._element = document.createElement('div');\r\n        this._element.style.display = 'inline-block';\r\n        this._element.style.border = 'none';\r\n        this._wrapper.appendChild(this._element)\r\n\r\n        this._titleElem = document.createElement('span');\r\n        this._titleElem.style.fontFamily = Game.font //'Verdana';\r\n        this._titleElem.style.fontSize = '7pt';\r\n        this._titleElem.style.padding = '24px'\r\n        this._titleElem.style.color = 'white';\r\n        this._wrapper.appendChild(this.inlineBlock(this._titleElem));\r\n\r\n        let play = this.iconFactory({ type: 'play' }, '&#9655;')\r\n        this._wrapper.appendChild(this.inlineBlock(play));\r\n\r\n        let pause = this.iconFactory({ type: 'pause' }, '&#10072; &#10072;')\r\n        this._wrapper.appendChild(this.inlineBlock(pause))\r\n\r\n        let next = this.iconFactory({ type: 'next' }, '&rarr;')\r\n        this._wrapper.appendChild(this.inlineBlock(next))\r\n\r\n    }\r\n\r\n    handleAction(action: MusicPlayerAction) {\r\n        if (action.type === 'pause') {\r\n            this.song.pause()\r\n            this.paused = true\r\n            this._titleElem.textContent = `Paused: ${this.currentTrack}`;\r\n        } else if (action.type === 'play') {\r\n            this.song.play()\r\n            this.paused = false\r\n            this._titleElem.textContent = `Playing: ${this.currentTrack}`;\r\n        } else if (action.type === 'next') {\r\n            if (this.paused) {\r\n                this.song.play()\r\n                this.paused = false\r\n            }\r\n            this.song.stop()\r\n        }\r\n    }\r\n\r\n    advancePlaylist() {\r\n        let ndx = this.trackNames.indexOf(this.currentTrack)\r\n        ndx = (ndx + 1) % this.trackNames.length\r\n        this.currentTrack = this.trackNames[ndx]\r\n        this.startMusic()\r\n    }\r\n\r\n    get trackNames() { return Object.keys(this.playlist) }\r\n    get song() { return this.playlist[this.currentTrack] }\r\n\r\n    private inlineBlock(elem) {\r\n        let block = document.createElement('div');\r\n        block.style.display = 'inline-block';\r\n        block.style.border = 'none';\r\n        block.append(elem)\r\n        return block\r\n    }\r\n\r\n    private iconFactory(\r\n        action: MusicPlayerAction,\r\n        iconContent: string,\r\n    ) {\r\n        let bg = Color.Transparent\r\n        let fg = Color.White\r\n        let icon = document.createElement('button')\r\n        icon.innerHTML = iconContent\r\n        icon.style.display = 'block';\r\n        icon.style.fontSize = '7pt';\r\n        icon.style.fontFamily = Game.font //'Verdana';\r\n        icon.style.border = 'none'\r\n        icon.style.padding = '4px'\r\n        icon.style.background = bg.toRGBA();\r\n        icon.style.color = fg.toRGBA();\r\n        icon.onclick = () => { this.handleAction(action) }\r\n        return icon\r\n    }\r\n\r\n}\r\n","import { Label, Color, Actor } from \"excalibur\";\r\nimport { Game } from \"../../Game\";\r\nexport class EconomicValue extends Actor {\r\n    private nameLabel: Label;\r\n    private valueLabel: Label;\r\n    constructor(name: string, x: number, y: number) {\r\n        super(x, y, 0, 0);\r\n        this.nameLabel = new Label(name, x, y, Game.font);\r\n        this.nameLabel.fontSize = 10;\r\n        this.nameLabel.color = Color.White.darken(0.2);\r\n        this.add(this.nameLabel);\r\n        this.valueLabel = new Label('0', x + 40, y, Game.font);\r\n        this.valueLabel.fontSize = 10;\r\n        this.valueLabel.color = Color.White.darken(0.2);\r\n        this.add(this.valueLabel);\r\n    }\r\n    setCount(count: number) {\r\n        this.valueLabel.text = `${count}`;\r\n        let c = Color.Gray;\r\n        if (count > 0) {\r\n            c = Color.Green;\r\n        }\r\n        else if (count < 0) {\r\n            c = Color.Red;\r\n        }\r\n        this.valueLabel.color = c;\r\n    }\r\n}\r\n","import { Actor, Color } from \"excalibur\";\r\nimport { Economy, PureValue, availableCapacity, allValues } from \"../../models/Economy\";\r\nimport { EconomicValue } from \"./EconomicValue\";\r\nimport { eachChunk } from \"../../Util\";\r\n\r\nexport class EconomyView extends Actor {\r\n    private valueLabels: { [key in PureValue]: EconomicValue } = {\r\n        Power: null,\r\n        Oxygen: null,\r\n        Water: null,\r\n        Shelter: null,\r\n        Hope: null,\r\n        Joy: null,\r\n        Wisdom: null,\r\n        Wealth: null,\r\n        Beauty: null,\r\n        Wonder: null\r\n    }\r\n\r\n    constructor(market: Economy, x: number, y: number) {\r\n        super(x, y, 0, 0) //Color.DarkGray.clone().darken(0.5));\r\n\r\n        let index = 0\r\n        for (let [val1, val2] of eachChunk(allValues, 2)) {\r\n            this.addValue(index * 32, 0, val1)\r\n            this.addValue(index * 32, 7, val2)\r\n            index += 1\r\n        }\r\n\r\n        this.updateView(market);\r\n    }\r\n\r\n    private addValue(x: number, y: number, value: PureValue) {\r\n        let valueLabel: EconomicValue = new EconomicValue(value, x, y)\r\n        this.valueLabels[value] = valueLabel\r\n        this.add(valueLabel)\r\n    }\r\n\r\n    updateView(updatedEconomy: Economy): void {\r\n        let market = updatedEconomy;\r\n\r\n        for (let value of allValues) {\r\n            this.valueLabels[value].setCount(\r\n                availableCapacity(market, value)\r\n            )\r\n        }\r\n\r\n    }\r\n}\r\n","import { Label, Color, Actor, UIActor } from \"excalibur\";\r\nimport { ResourceBlock, blockColor } from \"../../models/Economy\";\r\nimport { Game } from \"../../Game\";\r\nclass Tooltip extends Actor {\r\n    messageLabel: Label\r\n    constructor(x: number, y: number, message: string) {\r\n        super(x, y, 60, 16, Color.Black)\r\n        this.messageLabel = new Label(message, -16, 6, Game.font) //'Verdana')\r\n        this.messageLabel.color = Color.White\r\n        this.add(this.messageLabel)\r\n    }\r\n}\r\n\r\nexport class ResourceListEntry extends UIActor {\r\n    icon: Actor;\r\n    count: Label;\r\n    hovering: boolean = false\r\n    tooltip: Tooltip\r\n\r\n    constructor(x: number, y: number, resourceBlock: ResourceBlock, protected value: number) {\r\n        super(x-5, y-5, 20, 10)\r\n        let icon = new Actor(5, 5, 10, 10, blockColor(resourceBlock));\r\n        this.add(icon);\r\n        this.count = new Label(`x${value}`, 15, 10, Game.font) //'Helvetica');\r\n        this.count.fontSize = 10;\r\n        this.count.color = Color.White;\r\n        this.add(this.count);\r\n\r\n        this.tooltip = new Tooltip(0, 5, ResourceBlock[resourceBlock])\r\n        this.tooltip.visible = false\r\n        this.add(this.tooltip)\r\n\r\n\r\n        this.on('pointerenter', () => {\r\n            this.tooltip.visible = true\r\n        })\r\n\r\n        this.on('pointerleave', () => {\r\n            this.tooltip.visible = false\r\n        })\r\n    }\r\n\r\n\r\n    credit(amt: number) {\r\n        this.value += amt;\r\n        this.count.text = `x${this.value}`;\r\n    }\r\n\r\n    debit(amt: number) {\r\n        this.value -= amt\r\n        this.count.text = `x${this.value}`\r\n    }\r\n}\r\n","import { Color, Actor } from \"excalibur\";\r\nimport { ResourceBlock } from \"../../models/Economy\";\r\nimport { ResourceListEntry } from \"./ResourceListEntry\";\r\nimport { eachCons, eachChunk } from \"../../Util\";\r\nexport class ResourcesList extends Actor {\r\n    entries: {\r\n        [block in ResourceBlock]: ResourceListEntry;\r\n    } = {\r\n            [ResourceBlock.Biomass]: null,\r\n            [ResourceBlock.Idea]: null,\r\n            [ResourceBlock.Ore]: null,\r\n            [ResourceBlock.Meal]: null,\r\n            [ResourceBlock.Mineral]: null,\r\n            [ResourceBlock.Data]: null,\r\n            [ResourceBlock.Alloy]: null,\r\n            [ResourceBlock.Bioplasma]: null,\r\n            [ResourceBlock.Algorithm]: null,\r\n            [ResourceBlock.Argent]: null,\r\n            [ResourceBlock.Aurum]: null,\r\n            [ResourceBlock.Omnium]: null,\r\n        };\r\n\r\n    constructor(x: number, y: number) {\r\n        super(x,y,0,0); // 200, 60, Color.Green.clone().darken(0.8));\r\n        let rx0 = 0, ry0 = -5;\r\n        let resources = [\r\n            ResourceBlock.Meal,\r\n            ResourceBlock.Bioplasma,\r\n\r\n            ResourceBlock.Data,\r\n            ResourceBlock.Algorithm,\r\n\r\n            ResourceBlock.Mineral,\r\n            ResourceBlock.Alloy,\r\n\r\n            ResourceBlock.Argent,\r\n            ResourceBlock.Aurum,\r\n        ];\r\n\r\n        eachChunk(resources, 2).forEach(([res1, res2], index) => {\r\n            let rx = rx0 + index * 36, ry = ry0 + index * 0;\r\n            this.addEntry(rx, ry, res1)\r\n            this.addEntry(rx, ry + 14, res2)\r\n        });\r\n    }\r\n\r\n    private addEntry(x: number, y: number, res: ResourceBlock) {\r\n        let entry = new ResourceListEntry(x, y, res, 0);\r\n        this.add(entry);\r\n        this.entries[res] = entry;\r\n    }\r\n\r\n    increment(resource: ResourceBlock) {\r\n        let res = this.entries[resource]\r\n        if (res) {\r\n            res.credit(1);\r\n        }\r\n    }\r\n\r\n    decrement(resource: ResourceBlock) {\r\n        let res = this.entries[resource]\r\n        if (res) {\r\n            res.debit(1)\r\n        }\r\n    }\r\n}\r\n","import { Label, Color, Actor, FontStyle, FontUnit } from \"excalibur\";\r\nimport { Economy, ResourceBlock, PureValue } from \"../../models/Economy\";\r\nimport { ResourcesList } from \"./ResourcesList\";\r\nimport { EconomyView } from \"./EconomyView\";\r\nimport { MusicPlayer } from \"./MusicPlayer\";\r\nimport { Resources } from \"../../Resources\";\r\nimport { drawRect } from \"../../Painting\";\r\nimport { Game } from \"../../Game\";\r\n\r\nexport class StatusAnalysisView extends Actor {\r\n    private messageLabel: Label\r\n    private popLabel: Label\r\n\r\n    private resources: ResourcesList\r\n    private economy: EconomyView\r\n\r\n    private musicPlayer: MusicPlayer\r\n    private clock: Label\r\n\r\n    constructor(market: Economy, w: number, h: number) {\r\n        super(0,0, w*2,h, Color.DarkGray.clone().darken(0.92));\r\n\r\n        let ty = 14\r\n\r\n        let brand = new Label(Game.title, 5, ty+18, Game.font)\r\n        brand.fontSize = 28\r\n        brand.color = Color.Gray\r\n        brand.fontStyle = FontStyle.Italic\r\n        this.add(brand)\r\n\r\n        let version = new Label(\"v0.1\", 100, ty + 14, Game.font)\r\n        version.fontSize = 7\r\n        version.color = Color.Gray.darken(0.4)\r\n        this.add(version)\r\n\r\n\r\n        this.resources = new ResourcesList(130, ty)\r\n        this.add(this.resources)\r\n\r\n        this.economy = new EconomyView(market, 280, ty)\r\n        this.add(this.economy)\r\n\r\n        this.clock = new Label('current time', 600, ty, Game.font) // 'Verdana')\r\n        this.clock.color = Color.White // 'white'\r\n        this.add(this.clock)\r\n\r\n        this.popLabel = new Label(\"\", 600, ty + 14, Game.font) // 'Verdana')\r\n        this.popLabel.fontSize = 10\r\n        this.popLabel.color = Color.White\r\n        this.add(this.popLabel)\r\n\r\n        this.messageLabel = new Label('hi', 750, ty, Game.font) // 'Verdana')\r\n        this.messageLabel.fontSize = 10\r\n        this.messageLabel.color = Color.White\r\n        this.messageLabel.fontStyle = FontStyle.Italic\r\n        this.add(this.messageLabel)\r\n\r\n        this.musicPlayer = new MusicPlayer(726, 12, {\r\n            // 'Crater Rock': Resources.CraterRock,\r\n            // 'Indivision': Resources.Indivision,\r\n            'Future Tense': Resources.FutureTense,\r\n            // 'Isomer': Resources.Isomer,\r\n            // 'Understanding': Resources.Understanding,\r\n            // 'Outbound': Resources.Outbound,\r\n            'Assembler': Resources.Assembler,\r\n        })\r\n// // enable propagating pointer events\r\n// this.enableCapturePointer = true;\r\n// // // enable move events, warning: performance intensive!\r\n// this.capturePointer.captureMoveEvents = true;\r\n//         this.on('pointerenter', () => { alert('hover!')})\r\n    }\r\n\r\n    draw(ctx, delta) {\r\n        super.draw(ctx, delta)\r\n        this.musicPlayer.draw(ctx)\r\n        // drawRect(\r\n        //     ctx,\r\n        //     {x: this.x, y: this.y, width: this.getWidth(), height: this.getHeight() },\r\n        //     0,\r\n        //     Color.Magenta\r\n        // )\r\n    }\r\n\r\n    hide() {\r\n        this.musicPlayer.hide()\r\n    }\r\n\r\n    incrementResource(res: ResourceBlock) {\r\n        this.resources.increment(res)\r\n    }\r\n\r\n    decrementResource(res: ResourceBlock) {\r\n        this.resources.decrement(res)\r\n    }\r\n\r\n    setMessage(text: string) { this.messageLabel.text = text }\r\n\r\n    showEconomy(updatedEconomy: Economy): any {\r\n        this.economy.updateView(updatedEconomy)\r\n    }\r\n\r\n    showPopCap(curr: any, cap: any): any {\r\n        this.popLabel.text = `Pop: ${curr}/${cap}`\r\n    }\r\n\r\n    setClock(time: number = 0) {\r\n        let days = (Math.floor(time / (60 * 24))+1).toString()\r\n        let hh = Math.floor(time / 60) % 24\r\n        let hours = Math.floor((hh + 11) % 12 + 1).toString()\r\n        let minutes = Math.floor(time % 60).toString()\r\n        let ampm = hh < 12 ? 'AM' : 'PM'\r\n        this.clock.text = `Day ${days}. ${hours}:${minutes.padStart(2, '0')} ${ampm}`\r\n    }\r\n    \r\n}\r\n","import { drawRect } from \"../../Painting\";\r\nimport { DomeView, Building } from \".\";\r\nimport { Orientation } from \"../../values/Orientation\";\r\nimport { Color } from \"excalibur\";\r\nimport { DeviceSize } from \"../../values/DeviceSize\";\r\n\r\nexport class GroundVehiclePoolView extends Building {\r\n\r\n    deviceSize = DeviceSize.Small\r\n    colorBase() { return Color.Orange.clone().darken(0.05); } \r\n    draw(ctx, delta) {\r\n        // drawRect(ctx, this.aabb())\r\n       super.draw(ctx, delta)\r\n    }\r\n\r\n    slots() {\r\n        let theSlots = [];\r\n        let slotY = this.getHeight();\r\n\r\n        let buffer = this.getWidth() / 4\r\n\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x - buffer, this.pos.y + slotY,\r\n                Orientation.Left\r\n            )\r\n        )\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth() + buffer,\r\n                this.pos.y + slotY,\r\n                Orientation.Right\r\n            )\r\n        )\r\n\r\n        return theSlots;\r\n    } \r\n}","import { Color, Vector } from \"excalibur\";\r\nimport { Building, DevicePlace } from \"./Building\";\r\nimport { Orientation } from \"../../values/Orientation\";\r\nimport { Slot } from \"../../values/Slot\";\r\nimport { Device } from \"../Device\";\r\nimport { DeviceSize, getVisibleDeviceSize } from \"../../values/DeviceSize\";\r\nimport { drawPatternedRect, drawRect, drawPatternedPoly, drawPoly } from \"../../Painting\";\r\nimport { measureDistance, eachCons } from \"../../Util\";\r\nimport { BackgroundPattern } from \"./BackgroundPatterns\";\r\n// import { drawPatternedRect, drawRect } from \"../../Util\";\r\n\r\nexport class MediumSurfaceRoomView extends Building {\r\n    hideBox = true\r\n    showLabel = true\r\n    // hideLabe\r\n\r\n    devicePlaceSize = DeviceSize.Medium\r\n    devicePlaceCount = 3\r\n    get floorHeight() { return this.getHeight() / 6 }\r\n\r\n    get floorY() {\r\n        return this.pos.y + this.getHeight() - this.floorHeight\r\n    }\r\n\r\n   nodes(): Vector[] {\r\n        let x = this.pos.x + this.getWidth()/2;\r\n        let y = this.pos.y + this.getHeight() - 16\r\n        return [\r\n            new Vector(Math.floor(x), Math.floor(y))\r\n        ];\r\n    }\r\n    devicePlaces() {\r\n        let w = this.getWidth()/2\r\n        let x = this.pos.x + w;\r\n        let y = this.pos.y + this.getHeight() - this.floorHeight - 12 \r\n        y -= getVisibleDeviceSize(this.devicePlaceSize) / 3.5\r\n\r\n        let ds = [\r\n            new Vector(x - w/2, y),\r\n            ...(this.devicePlaceCount > 2 ? [new Vector(x,y)] : []),\r\n            new Vector(x + w/2, y),\r\n        ]\r\n\r\n        return ds.map(d => new DevicePlace(d, this.devicePlaceSize)) \r\n    }\r\n\r\n    //deviceInteractionPlaces() {\r\n\r\n    //}\r\n\r\n    graph(sg) {\r\n        let g = super.graph(sg)\r\n        let find = (s: Vector) => g.findOrCreate(s, measureDistance)\r\n        let slots: Vector[] = this.slots().map(s => s.pos)\r\n        // draw from left slot to each device place to right slot?\r\n        let devices = this.deviceInteractionPlaces().map(p => find(p)) //d.position))\r\n        eachCons(devices, 2).forEach(([left, right]) => g.edge(left, right))\r\n\r\n        if (this.isGroundFloor) {\r\n            let leftSlot = find(slots[0]), rightSlot = find(slots[slots.length - 1])\r\n            g.edge(leftSlot, devices[0])\r\n            g.edge(devices[devices.length - 1], rightSlot)\r\n        } else {\r\n            let topSlot = find(slots[1])\r\n            g.edge(devices[1], topSlot)\r\n        }\r\n\r\n        let node = this.nodes()[0]\r\n        devices.forEach(device => g.edge(device, find(node)))\r\n        // g.edge(devices[1], find(slots[1]))\r\n\r\n        return g\r\n    }\r\n\r\n\r\n    slots() {\r\n        let theSlots: Slot[] = []\r\n        let slotY = this.getHeight() - this.floorHeight;\r\n\r\n        if (this.isGroundFloor) {\r\n            theSlots.push(\r\n                this.buildSlot(\r\n                    this.pos.x, this.pos.y + slotY,\r\n                    Orientation.Left\r\n                )\r\n            )\r\n        }\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth() / 2,\r\n                this.pos.y + this.getHeight(), // + (2*this.floorHeight),\r\n                Orientation.Down\r\n            )\r\n        )\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth() / 2,\r\n                this.pos.y - 1, // + this.getHeight(),\r\n                Orientation.Up\r\n            )\r\n        )\r\n\r\n\r\n        if (this.isGroundFloor) {\r\n            theSlots.push(\r\n                this.buildSlot(\r\n                    this.pos.x + this.getWidth(),\r\n                    this.pos.y + slotY,\r\n                    Orientation.Right\r\n                )\r\n            )\r\n        }\r\n\r\n\r\n        return theSlots;\r\n    }\r\n\r\n    get isGroundFloor() {\r\n        return !this.parentSlot || !(this.parentSlot.parent instanceof MediumSurfaceRoomView)\r\n    }\r\n\r\n    constrainCursor(cursor: Vector): Vector {\r\n        if (this.planet.colony.buildings.length === 0) {\r\n            cursor.y = this.planet.getTop();\r\n        } // else {\r\n            // this.alignToSlot(cursor)\r\n        // }\r\n        return cursor;\r\n    }\r\n\r\n    reshape(cursor: Vector) {\r\n        if (this.planet.colony.buildings.length === 0) {\r\n            this.pos = cursor\r\n            this.pos.y -= this.getHeight() - 2 - this.floorHeight // hm\r\n        } else {\r\n            this.alignToSlot(cursor)\r\n\r\n        }\r\n    }\r\n\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        let color = this.mainColor()\r\n\r\n        ctx.fillStyle = color.toRGBA()\r\n\r\n        // ctx.fillRect(this.pos.x, this.pos.y, this.getWidth(), this.getHeight())\r\n        // let rect = \r\n            // { x: this.pos.x, y: this.pos.y, width: this.getWidth(), height: this.getHeight() };\r\n        drawPatternedPoly(\r\n            ctx,\r\n            this.angledRoofPoly(),\r\n            this.backgroundPattern,\r\n            this.mainColor()\r\n        )\r\n\r\n\r\n        if (!this.isActive) {\r\n            // draw overlay rect that darkens\r\n            let c = Color.Black.clone()\r\n            c.a = 0.6\r\n            drawPoly(ctx, this.angledRoofPoly(), c)\r\n        }\r\n\r\n        // floor\r\n        let floorColor = this.planet.color.darken(0.6)\r\n        let floorEdgeHeight = 12 // 6\r\n        let floorOff = -5\r\n        drawRect(\r\n            ctx,\r\n            { x: this.x, y: this.y + this.getHeight() - this.floorHeight - floorEdgeHeight,\r\n              width: this.getWidth(), height: floorEdgeHeight - floorOff },\r\n              0,\r\n              floorColor.lighten(0.4)\r\n        )\r\n\r\n        drawRect(\r\n            ctx,\r\n            { x: this.x, y: this.y + this.getHeight() - this.floorHeight - floorOff,\r\n              width: this.getWidth(), height: this.floorHeight + floorOff },\r\n              0,\r\n              floorColor\r\n        )\r\n\r\n        // a little flag :)\r\n        let flagpoleHeight = 18\r\n        let flagX = this.pos.x + 3 * (this.getWidth() / 4)\r\n        let flagY = this.pos.y - flagpoleHeight\r\n\r\n        ctx.fillStyle = Color.Black.fillStyle()\r\n        ctx.fillRect(flagX, flagY-1, 1, flagpoleHeight+1)\r\n        drawPatternedRect(\r\n            ctx,\r\n            { x: flagX, y: flagY, width: 10, height: 6 },\r\n            BackgroundPattern.USSF\r\n        )\r\n        // ctx.fillRect(flagX, flagY, 10, 5)\r\n\r\n        super.draw(ctx, delta)\r\n    }\r\n\r\n    colorBase() { return Color.White.clone(); }\r\n}","import { CommonAreaView } from \".\";\r\nimport { DeviceSize } from \"../../values/DeviceSize\";\r\n\r\nexport class MediumRoomThreeView extends CommonAreaView {\r\n    devicePlaceSize = DeviceSize.Medium\r\n    devicePlaceCount = 3\r\n\r\n    poly() { return this.angledRoofPoly() }\r\n\r\n    // devicePlaces() {\r\n    //     let w = this.getWidth()/2\r\n    //     let x = this.pos.x + w;\r\n    //     let y = this.pos.y + this.getHeight() - getVisibleDeviceSize(DeviceSize.Medium)/3\r\n    //     let ds = [\r\n    //         new Vector(x - w/3, y),\r\n    //         new Vector(x, y),\r\n    //         new Vector(x + w/3, y),\r\n    //     ]\r\n\r\n    //     return ds.map(d => new DevicePlace(d, DeviceSize.Medium))\r\n    // }\r\n}","import { CommonAreaView } from \".\";\r\nimport { Vector } from \"excalibur\";\r\nimport { DevicePlace } from \"./Building\";\r\nimport { DeviceSize, getVisibleDeviceSize } from \"../../values/DeviceSize\";\r\n\r\nexport class HugeRoomView extends CommonAreaView {\r\n    devicePlaceSize = DeviceSize.Huge\r\n    devicePlaces() {\r\n        let w = this.getWidth()/2\r\n        let x = this.pos.x + w;\r\n        let y = this.pos.y + this.getHeight() - this.floorHeight - getVisibleDeviceSize(DeviceSize.Huge)/2 \r\n        let ds = [\r\n            new Vector(x - w/3, y),\r\n            new Vector(x + w/3, y),\r\n        ]\r\n        return ds.map(d => new DevicePlace(d, DeviceSize.Huge))\r\n    }\r\n}","import { CommonAreaView } from \".\";\r\nimport { Vector } from \"excalibur\";\r\nimport { DevicePlace } from \"./Building\";\r\nimport { DeviceSize, getVisibleDeviceSize } from \"../../values/DeviceSize\";\r\n\r\nexport class LargeRoomView extends CommonAreaView {\r\n    devicePlaceSize = DeviceSize.Large\r\n    devicePlaces() {\r\n        let w = this.getWidth()/2\r\n        let x = this.pos.x + w;\r\n        let y = this.pos.y + this.getHeight() - getVisibleDeviceSize(DeviceSize.Large)/2 \r\n        let ds = [\r\n            new Vector(x - w/3, y),\r\n            new Vector(x + w/3, y),\r\n        ]\r\n\r\n        return ds.map(d => new DevicePlace(d, DeviceSize.Large))\r\n    }\r\n}","import { CommonAreaView } from \".\";\r\nimport { DeviceSize, getVisibleDeviceSize } from \"../../values/DeviceSize\";\r\nimport { DevicePlace } from \"./Building\";\r\nimport { Vector } from \"excalibur\";\r\n\r\nexport class MediumRoomView extends CommonAreaView {\r\n    devicePlaceSize = DeviceSize.Medium\r\n    devicePlaceCount = 2\r\n    // devicePlaces() {\r\n    //     let w = this.getWidth()/2\r\n    //     let x = this.pos.x + w;\r\n    //     let y = this.pos.y + this.getHeight() - this.floorHeight - getVisibleDeviceSize(DeviceSize.Medium)/3\r\n    //     let ds = [\r\n    //         new Vector(x - w/3, y),\r\n    //         new Vector(x + w/3, y),\r\n    //     ]\r\n\r\n    //     return ds.map(d => new DevicePlace(d, DeviceSize.Medium))\r\n    // }\r\n}","import { CommonAreaView } from \".\";\r\nimport { Vector } from \"excalibur\";\r\nimport { DevicePlace } from \"./Building\";\r\nimport { DeviceSize } from \"../../values/DeviceSize\";\r\n\r\nexport class SmallRoomThreeView extends CommonAreaView {\r\n    devicePlaceCount = 3\r\n    poly() { return this.angledRoofPoly() }\r\n    //devicePlaces() {\r\n    //    let w = this.getWidth()/2\r\n    //    let x = this.pos.x + w;\r\n    //    let y = this.pos.y + this.getHeight() - this.floorHeight - 10\r\n    //    let ds = [\r\n    //        new Vector(x - w / 2, y),\r\n    //        new Vector(x, y),\r\n    //        new Vector(x + w / 2, y),\r\n    //    ]\r\n\r\n    //    return ds.map(d => new DevicePlace(d, DeviceSize.Small))\r\n    //}\r\n}","import { DeviceSize } from \"../../values/DeviceSize\";\r\nimport { DevicePlace } from \"./Building\";\r\nimport { Vector } from \"excalibur\";\r\nimport { DomeView } from \".\";\r\n\r\nexport class BigDomeView extends DomeView {\r\n\r\n    devicePlaceCount = 3\r\n    // devicePlaces() {\r\n    //     let w = this.getWidth()/2\r\n    //     let x = this.pos.x + w;\r\n    //     let y = this.pos.y + this.getHeight() - 20\r\n    //     let ds = [\r\n    //         new Vector(x - w/3, y),\r\n    //         new Vector(x + w/3, y),\r\n    //     ]\r\n\r\n    //     return ds.map(d => new DevicePlace(d, DeviceSize.Large))\r\n    // }\r\n}","import { DomeView } from \".\";\r\nimport { Vector } from \"excalibur\";\r\nimport { DevicePlace } from \"./Building\";\r\nimport { DeviceSize } from \"../../values/DeviceSize\";\r\n\r\nexport class MidDomeView extends DomeView {\r\n\r\n    devicePlaceCount = 3\r\n    // devicePlaces() {\r\n    //     let w = this.getWidth()/2\r\n    //     let x = this.pos.x + w;\r\n    //     let y = this.pos.y + this.getHeight() - 20\r\n    //     let ds = [\r\n    //         new Vector(x - w/3, y),\r\n    //         new Vector(x + w/3, y),\r\n    //     ]\r\n\r\n    //     return ds.map(d => new DevicePlace(d, DeviceSize.Medium))\r\n    // }\r\n}","import { DomeView } from \".\";\r\nimport { Vector } from \"excalibur\";\r\nimport { DevicePlace } from \"./Building\";\r\nimport { DeviceSize } from \"../../values/DeviceSize\";\r\n\r\nexport class SmallDomeThreeView extends DomeView {\r\n\r\n    devicePlaceCount = 3\r\n    // devicePlaces() {\r\n    //     let w = this.getWidth()/2\r\n    //     let x = this.pos.x + w;\r\n    //     let y = this.pos.y + this.getHeight() - 6\r\n    //     let ds = [\r\n    //         new Vector(x - w/3, y),\r\n    //         new Vector(x, y),\r\n    //         new Vector(x + w/3, y),\r\n    //     ]\r\n\r\n    //     return ds.map(d => new DevicePlace(d, DeviceSize.Small))\r\n    // }\r\n}","import { CorridorView } from \".\";\r\n\r\nexport class SurfaceRoadView extends CorridorView {\r\n    edgeWidth: 0\r\n    colorBase() { return this.color.lighten(0.1); }\r\n\r\n}","import { TunnelView } from \".\";\r\nimport { Orientation } from \"../../values/Orientation\";\r\nimport { Slot } from \"../../values/Slot\";\r\nimport { Vector } from \"excalibur\";\r\nimport { Scale } from \"../../values/Scale\";\r\n\r\nexport class LadderView extends TunnelView {\r\n    originSlot: Slot = null\r\n    slotSize: number = Scale.major.third\r\n    constrainCursor(cursor: Vector): Vector {\r\n       if (this.pickingOrigin) {\r\n\r\n       } else {\r\n           cursor.x = this.pos.x\r\n       }\r\n       return cursor;\r\n    }\r\n\r\n    // minHeight: number = slt\r\n    reshape(cursor: Vector) {\r\n        if (this.pickingOrigin) { \r\n            let theSlot = this.alignToSlot(cursor)\r\n            if (theSlot) {\r\n                this.facing = theSlot.facing\r\n\r\n                if (theSlot) {\r\n                    this.originSlot = theSlot\r\n                }\r\n            }\r\n        } else {\r\n            if (this.facing === Orientation.Up) {\r\n                let maxHeight = this.originSlot.pos.y - this.planet.getTop() - 25\r\n\r\n                let h = Math.min(maxHeight, Math.max(this.slotSize, this.originSlot.pos.y - cursor.y))\r\n                this.setHeight((h/this.slotSize)*this.slotSize + 15)\r\n                this.pos.y = this.originSlot.pos.y - this.getHeight()\r\n            } else {\r\n                let h = Math.max(this.slotSize, cursor.y - this.originSlot.pos.y)\r\n                this.setHeight((h/this.slotSize)*this.slotSize + 15) // - cursor.y))\r\n            }\r\n        }\r\n    }\r\n}","import { DomeView } from \".\";\r\nimport { Color, Vector } from \"excalibur\";\r\nimport { DevicePlace } from \"./Building\";\r\nimport { DeviceSize } from \"../../values/DeviceSize\";\r\n\r\nexport class ArcologyView extends DomeView {\r\n\r\n    devicePlaces() {\r\n        let w = 3*this.getWidth()/5\r\n        let x = this.pos.x + w;\r\n        let y = this.pos.y + this.getHeight()/2\r\n        let ds = [\r\n            new Vector(x, y-800),\r\n            new Vector(x, y),\r\n            new Vector(x, y+800),\r\n        ]\r\n\r\n        return ds.map(d => new DevicePlace(d, DeviceSize.Huge))\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        this.drawShape(ctx, this.pos.x, this.pos.y)\r\n        this.getDevices().forEach(device => device.draw(ctx, delta))\r\n\r\n    }\r\n\r\n    private drawShape(ctx, xoff, yoff) {\r\n        let h = this.getHeight()\r\n        let w = this.getWidth()\r\n        ctx.beginPath();\r\n        ctx.moveTo(0 + xoff, h + yoff);\r\n        ctx.bezierCurveTo(1 + xoff, h - 150 + yoff, 121 + xoff, 70 + yoff, w - 80 + xoff, 8 + yoff);\r\n        ctx.bezierCurveTo(w - 40 + xoff, 2 + yoff, w - 5 + xoff, 11 + yoff, w - 10 + xoff, 25 + yoff);\r\n        ctx.bezierCurveTo(w - 5 + xoff, 10 + yoff, w + xoff, (h-10) + yoff, w + xoff, h + yoff);\r\n        ctx.lineTo(0 + xoff, h + yoff);\r\n        ctx.fillStyle = this.mainColor().toRGBA()\r\n        ctx.fill();\r\n    }\r\n}","import { Vector } from \"excalibur\";\r\nimport { Building } from \"./Building\";\r\nimport { range, eachCons, measureDistance } from \"../../Util\";\r\nimport { Slot } from \"../../values/Slot\";\r\nimport { Orientation, flip } from \"../../values/Orientation\";\r\nimport { Graph } from \"../../values/Graph\";\r\nimport { drawRect } from \"../../Painting\";\r\nimport { Scale } from \"../../values/Scale\";\r\n\r\nexport class TunnelView extends Building {\r\n    slotSize: number = Scale.major.eighth + 10\r\n    pickingOrigin: boolean = true\r\n    hideBox = true\r\n\r\n    colorBase() { return this.planet.color.darken(0.2); }\r\n\r\n    draw(ctx, delta) {\r\n        let rect = this.aabb()\r\n        drawRect(ctx, rect, 0, this.color.darken(0.1)) \r\n\r\n        let n = 5\r\n        rect.x = rect.x + this.getWidth() / n\r\n        rect.width -= (2) * (this.getWidth() / n)\r\n        drawRect(ctx, rect, 0, this.color.darken(0.2)) \r\n        // super.draw(ctx, delta)\r\n    }\r\n\r\n    nodes(): Vector[] {\r\n        let x = this.pos.x + this.getWidth()/2;\r\n        let y = this.pos.y\r\n        return [\r\n            new Vector(Math.floor(x), y)\r\n        ];\r\n    }\r\n\r\n    graph(supergraph: Graph<Vector> = new Graph()): Graph<Vector> {\r\n        let g = supergraph;\r\n\r\n        let halfWidth = this.getWidth()/2\r\n        let x = this.pos.x + halfWidth\r\n\r\n        let root = g.findOrCreate(this.nodes()[0], measureDistance)\r\n        let first = g.findOrCreate(new Vector(x,this.slotHeights()[0]), measureDistance)\r\n        g.edge(root,first)\r\n\r\n        let heights = this.slotHeights()\r\n\r\n        eachCons(heights, 2).forEach(([y0,y1]: [number,number]) => {\r\n            let top = g.findOrCreate(new Vector(x,y0), measureDistance)\r\n            let btm = g.findOrCreate(new Vector(x,y1), measureDistance)\r\n            g.edge(top, btm)\r\n        })\r\n\r\n        let btm = g.findOrCreate(new Vector(x, this.pos.y + this.getHeight()), measureDistance)\r\n        let lst = g.findOrCreate(new Vector(x, heights[heights.length-1]), measureDistance)\r\n        g.edge(btm,lst)\r\n\r\n        heights.forEach(y1 => {\r\n            let btm = g.findOrCreate(new Vector(x,y1), measureDistance)\r\n\r\n            let left = g.findOrCreate(new Vector(x-halfWidth,y1), measureDistance)\r\n            g.edge(left,btm)\r\n\r\n            let right = g.findOrCreate(new Vector(x+halfWidth,y1), measureDistance)\r\n            g.edge(btm,right)\r\n        });\r\n\r\n        for (let child of this.childrenBuildings) {\r\n            let slot = g.findOrCreate(child.parentSlot.pos, measureDistance)\r\n            let childNode = g.findOrCreate(child.nodes()[0], measureDistance)\r\n            g.edge(childNode, slot)\r\n            g.edge(slot, childNode)\r\n\r\n            child.graph(g)\r\n        }\r\n\r\n        return g;\r\n    }\r\n\r\n    private slotHeights() {\r\n            // let minDepth = Scale.major.eighth + 50\r\n            // let buffer = 20\r\n\r\n        // let slotSize = Scale.major.eighth + 5 //minDepth + buffer\r\n        let slotCount = Math.floor((this.getHeight()) / this.slotSize)\r\n        let heights = []\r\n\r\n        let y = this.pos.y // + minDepth + buffer\r\n\r\n        if (slotCount > 0) {\r\n            for (let i of range(slotCount)) {\r\n                heights.push(\r\n                    y + ((i+1) * this.slotSize),\r\n                )\r\n            }\r\n        } else {\r\n            heights.push(this.slotSize)\r\n        }\r\n        return heights\r\n    }\r\n\r\n    slots() {\r\n        let theSlots: Slot[] = []\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth()/2,\r\n                this.pos.y,\r\n                Orientation.Up\r\n            )\r\n        )\r\n\r\n        for (let y of this.slotHeights()) {\r\n            theSlots.push(\r\n                this.buildSlot(\r\n                    this.pos.x, y,\r\n                    Orientation.Left\r\n                )\r\n            )\r\n\r\n            theSlots.push(\r\n                this.buildSlot(\r\n                    this.pos.x + this.getWidth(),\r\n                    y,\r\n                    Orientation.Right,\r\n                )\r\n            )\r\n        }\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth()/2,\r\n                this.pos.y + this.getHeight(),\r\n                Orientation.Down\r\n            )\r\n        )\r\n        return theSlots;\r\n    } \r\n\r\n    handleClick(cursor: Vector) {\r\n        if (this.pickingOrigin) {\r\n            this.pickingOrigin = false;\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    constrainCursor(cursor: Vector): Vector {\r\n        if (this.pickingOrigin) {\r\n            // this.alignToSlot(cursor)\r\n        } else {\r\n            // cursor.y = Math.max(this.planet.getTop() + 100, cursor.y)\r\n        }\r\n        return cursor;\r\n    }\r\n\r\n    reshape(cursor: Vector) {\r\n        // this.pos.y = this.planet.getTop() + 2\r\n        if (this.pickingOrigin) {\r\n            this.alignToSlot(cursor)\r\n        } // else {\r\n            // min depth/height has to be at least \r\n            // let minDepth = Scale.major.eighth\r\n            // let buffer = 100\r\n\r\n            let depth = \r\n                (this.slotSize * Math.floor(Math.abs(cursor.y - this.planet.getTop()) / this.slotSize)) + 15\r\n\r\n          this.setHeight(\r\n              Math.max(depth, this.slotSize + 15)\r\n          )\r\n        // }\r\n    }\r\n\r\n}","import { Color, Vector } from \"excalibur\";\r\nimport { Building, DevicePlace } from \"./Building\";\r\nimport { Orientation } from \"../../values/Orientation\";\r\nimport { DeviceSize, getVisibleDeviceSize } from \"../../values/DeviceSize\";\r\nimport { Graph } from \"../../values/Graph\";\r\nimport { measureDistance, eachCons } from \"../../Util\";\r\n\r\nexport class DomeView extends Building {\r\n    hideBox = true\r\n    showLabel = true\r\n\r\n    graph(sg) {\r\n        let g = super.graph(sg)\r\n        let find = (s: Vector) => g.findOrCreate(s, measureDistance)\r\n\r\n        let slots: Vector[] = this.slots().map(s => s.pos)\r\n        let leftSlot = find(slots[0]), rightSlot = find(slots[slots.length-1])\r\n        let devices = this.deviceInteractionPlaces().map(position => find(position))\r\n        g.edge(leftSlot, devices[0])\r\n        eachCons(devices, 2).forEach(([left, right]) => g.edge(left, right))\r\n        g.edge(devices[devices.length-1], rightSlot)\r\n\r\n        let node = this.nodes()[0]\r\n        devices.forEach(device => g.edge(device, find(node)))\r\n\r\n        return g\r\n\r\n    }\r\n\r\n    slots() {\r\n        let theSlots = [];\r\n        let slotY = this.getHeight();\r\n\r\n        let buffer = this.getWidth() / 4\r\n\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x - buffer, this.pos.y + slotY,\r\n                Orientation.Left\r\n            )\r\n        )\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth() + buffer,\r\n                this.pos.y + slotY,\r\n                Orientation.Right\r\n            )\r\n        )\r\n\r\n        return theSlots;\r\n    } \r\n\r\n    //reshape(cursor: Vector) {\r\n    //    this.alignToSlot(cursor)\r\n    //}\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        let color: Color = this.mainColor()\r\n\r\n        let h = this.getHeight() //getWidth()/2\r\n\r\n        ctx.beginPath()\r\n        ctx.arc(\r\n            this.pos.x + this.getWidth()/2,\r\n            this.pos.y + h, //this.getHeight(),\r\n            this.getWidth()/1.5,\r\n            0,\r\n            Math.PI,\r\n            true\r\n        )\r\n        ctx.closePath()\r\n        ctx.fillStyle = color.toRGBA()\r\n        ctx.fill()\r\n\r\n        super.draw(ctx, delta)\r\n    }\r\n\r\n    colorBase() { return Color.White.clone().darken(0.05); } \r\n\r\n    deviceSize = DeviceSize.Small\r\n    devicePlaceCount = 2\r\n    devicePlaces() {\r\n        let w = this.getWidth()/2\r\n        let x = this.pos.x + w;\r\n        let y = this.pos.y + this.getHeight() - getVisibleDeviceSize(this.deviceSize)/3 // - 16\r\n        let ds = [\r\n            new Vector(x - w/3, y),\r\n            ...(this.devicePlaceCount === 3 ? [new Vector(x,y)] : []),\r\n            new Vector(x + w/3, y),\r\n        ]\r\n\r\n        return ds.map(d => new DevicePlace(d, this.deviceSize)) // DeviceSize.Small))\r\n    }\r\n}","import { Building, DevicePlace } from \"./Building\";\r\nimport { Orientation } from \"../../values/Orientation\";\r\nimport { Slot } from \"../../values/Slot\";\r\nimport { Vector, Color } from \"excalibur\";\r\nimport { DeviceSize, getVisibleDeviceSize } from \"../../values/DeviceSize\";\r\nimport { drawRect, drawPatternedPoly, drawPoly } from \"../../Painting\";\r\nimport { measureDistance, eachCons } from \"../../Util\";\r\n\r\nexport class CommonAreaView extends Building {\r\n    get floorHeight() { return this.getHeight() / 6 }\r\n    edgeWidth: number = 0\r\n    showLabel = true\r\n    hideBox = true\r\n\r\n    colorBase() { return this.color.darken(0.3); }\r\n\r\n    poly() { return this.aabbPoly() }\r\n\r\n    get floorY() {\r\n        return this.pos.y + this.getHeight() - this.floorHeight\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n\r\n\r\n        drawPatternedPoly(\r\n            ctx,\r\n            this.poly(),\r\n            this.backgroundPattern,\r\n            this.mainColor()\r\n        )\r\n\r\n        if (!this.isActive) {\r\n            let c = Color.Black.clone()\r\n            c.a = 0.6\r\n            drawPoly(ctx, this.poly(), c)\r\n        }\r\n\r\n        let floorEdgeHeight = 12 // 6\r\n        let floorColor = this.planet.color.darken(0.6)\r\n        let floorOff = -5\r\n        drawRect(\r\n            ctx,\r\n            { x: this.x, y: this.y + this.getHeight() - this.floorHeight - floorEdgeHeight,\r\n              width: this.getWidth(), height: floorEdgeHeight - floorOff },\r\n              0,\r\n              floorColor.lighten(0.4)\r\n        )\r\n\r\n        drawRect(\r\n            ctx,\r\n            { x: this.x, y: this.y + this.getHeight() - this.floorHeight - floorOff,\r\n              width: this.getWidth(), height: this.floorHeight + floorOff },\r\n              0,\r\n              floorColor\r\n        )\r\n\r\n        super.draw(ctx, delta)\r\n    }\r\n\r\n\r\n    slots() {\r\n        let theSlots = []\r\n        let slotY = this.getHeight() - this.floorHeight\r\n        let leftSlot: Slot = this.buildSlot(\r\n            this.pos.x,\r\n            this.pos.y + slotY,\r\n            Orientation.Left,\r\n        )\r\n        theSlots.push(leftSlot)\r\n\r\n        let rightSlot: Slot = this.buildSlot(\r\n            this.pos.x + this.getWidth(),\r\n            this.pos.y + slotY,\r\n            Orientation.Right,\r\n        )\r\n        theSlots.push(rightSlot)\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth()/2,\r\n                this.pos.y,\r\n                Orientation.Up\r\n            )\r\n        )\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth()/2,\r\n                this.pos.y + this.getHeight(),\r\n                Orientation.Down\r\n            )\r\n        )\r\n        return theSlots;\r\n    }\r\n\r\n    nodes(): Vector[] {\r\n        let x = this.pos.x + this.getWidth()/2;\r\n        let y = this.pos.y + this.getHeight()-this.floorHeight\r\n        return [\r\n            new Vector(Math.floor(x), Math.floor(y))\r\n        ];\r\n    }\r\n\r\n    graph(sg) {\r\n        let g = super.graph(sg)\r\n        let slots: Slot[] = this.slots()\r\n        let find = (s: Vector) => g.findOrCreate(s, measureDistance)\r\n        let leftSlot = find(slots[0].pos), rightSlot = find(slots[1].pos)\r\n        let devices = this.deviceInteractionPlaces().map(p => find(p))\r\n        g.edge(leftSlot, devices[0])\r\n        eachCons(devices, 2).forEach(([left, right]) => g.edge(left, right))\r\n        g.edge(devices[devices.length-1], rightSlot)\r\n\r\n        let node = this.nodes()[0]\r\n        devices.forEach(device => g.edge(device, find(node)))\r\n        return g\r\n    }\r\n  \r\n    reshape(cursor) {\r\n        this.alignToSlot(cursor);\r\n    }\r\n\r\n    devicePlaces() {\r\n        let w = this.getWidth()/2\r\n        let x = this.pos.x + w;\r\n        let y = this.pos.y + this.getHeight() - this.floorHeight - 10 \r\n        y -= getVisibleDeviceSize(this.devicePlaceSize) / 3.5 ///2\r\n\r\n        let ds = [\r\n            new Vector(x - w/2, y),\r\n            ...(this.devicePlaceCount > 2 ? [new Vector(x,y)] : []),\r\n            new Vector(x + w/2, y),\r\n        ]\r\n\r\n        return ds.map(d => new DevicePlace(d, this.devicePlaceSize)) \r\n        //DeviceSize.Small))\r\n    }\r\n\r\n    devicePlaceSize: DeviceSize = DeviceSize.Small\r\n    devicePlaceCount: number = 2\r\n}","import { Building } from \"./Building\";\r\nimport { Vector } from \"excalibur\";\r\nimport { Orientation } from \"../../values/Orientation\";\r\nimport { Slot } from \"../../values/Slot\";\r\n\r\nexport class CorridorView extends Building {\r\n    edgeWidth: number = 0\r\n\r\n    pickingOrigin: boolean = true\r\n    facing: Orientation = Orientation.Left\r\n\r\n   nodes(): Vector[] {\r\n        let x = this.pos.x + this.getWidth()/2;\r\n        let y = this.pos.y + this.getHeight()/2\r\n        return [\r\n            new Vector(Math.floor(x), Math.floor(y))\r\n        ];\r\n    }\r\n    colorBase() { return this.color.darken(0.2); }\r\n\r\n    slots() {\r\n        let theSlots: Slot[] = [];\r\n        let slotY = this.getHeight() / 2;\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x, this.pos.y + slotY,\r\n                Orientation.Left\r\n            )\r\n        )\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth(),\r\n                this.pos.y + slotY,\r\n                Orientation.Right\r\n            )\r\n        )\r\n\r\n        return theSlots;\r\n    } \r\n\r\n    \r\n    handleClick(cursor: Vector) {\r\n        if (this.pickingOrigin) {\r\n            this.pickingOrigin = false;\r\n            this.reshape(this.constrainCursor(cursor))\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    constrainCursor(cursor: Vector): Vector {\r\n        let newCursor = cursor.clone();\r\n        if (this.pickingOrigin) {\r\n        } else {\r\n            newCursor.y = this.pos.y\r\n        }\r\n\r\n        return newCursor;\r\n    }\r\n\r\n    originX: number = 0\r\n    reshape(cursor: Vector) {\r\n\r\n        if (this.pickingOrigin) {\r\n            let theSlot = this.alignToSlot(cursor)\r\n            if (theSlot) {\r\n                this.facing = theSlot.facing\r\n\r\n                if (theSlot && this.facing === Orientation.Left) {\r\n                    this.originX = theSlot.pos.x\r\n                }\r\n            }\r\n\r\n        } else {\r\n            if (this.facing === Orientation.Left) {\r\n                this.setWidth(Math.abs(this.originX - cursor.x))\r\n                this.pos.x = this.originX - this.getWidth()\r\n            } else {\r\n                this.setWidth(Math.abs(this.pos.x - cursor.x))\r\n            }\r\n        }\r\n    }\r\n}","module.exports = __webpack_public_path__ + \"0a266eded2bf27831b18735ffc081448.png\";","module.exports = __webpack_public_path__ + \"2475589a97ba4901bfa7ab53b5487778.png\";","module.exports = __webpack_public_path__ + \"98240dde9344ac8d071d076ac951e15d.png\";","module.exports = __webpack_public_path__ + \"da31cf43235263c1c3e0ad45a46360a1.png\";","module.exports = __webpack_public_path__ + \"a6a38278ac501400c6199e0df9e1bf84.png\";","module.exports = __webpack_public_path__ + \"ece1d5d5858bc048d2d949ecc3f5e9bc.png\";","module.exports = __webpack_public_path__ + \"3654f0489813e0668743efde017c9653.png\";","module.exports = __webpack_public_path__ + \"3abbdabf07943966f102ac7345a59986.png\";","module.exports = __webpack_public_path__ + \"d1b4690b9f5fa4957f98602afc8cfdb6.png\";","module.exports = __webpack_public_path__ + \"0eb7a15ea04678b14a2b88b5965aabeb.png\";","module.exports = __webpack_public_path__ + \"490d8337dc1436fdb073e0ce7c1aa4e2.svg\";","module.exports = __webpack_public_path__ + \"9a1897cb324167653e7d23e377df09f7.svg\";","module.exports = __webpack_public_path__ + \"f74ccf77b74f12d78334366e7365d1ee.svg\";","module.exports = __webpack_public_path__ + \"d754bb375d83b60c875254997ad378af.svg\";","module.exports = __webpack_public_path__ + \"48be2487ecb6d75a112437662b61e05d.svg\";","module.exports = __webpack_public_path__ + \"c39dae9d5741e8fcd6c6a812b599a99c.svg\";","module.exports = __webpack_public_path__ + \"f91c0d7d285b0686ece2084cc3640bce.svg\";","module.exports = __webpack_public_path__ + \"824e22e59890ae78258b54985e42ca6d.svg\";","module.exports = __webpack_public_path__ + \"dfe6e4db2f0c22d18befa85c1e163369.svg\";","module.exports = __webpack_public_path__ + \"9a947d50110c1d1db07c76a4bba2e653.svg\";","module.exports = __webpack_public_path__ + \"4976b6042ef557ca6085c8d0168251f4.svg\";","module.exports = __webpack_public_path__ + \"46418cf15643d9b1b171c1b64160a5af.svg\";","module.exports = __webpack_public_path__ + \"36a02c2483b688be86ce07bea4bd7295.svg\";","module.exports = __webpack_public_path__ + \"29c5f1be64c99bbc14d5063eea2f0953.svg\";","module.exports = __webpack_public_path__ + \"502f86b65239e20806bbae8bc77a6116.svg\";","module.exports = __webpack_public_path__ + \"5289b20985e3c3a98081267a2da1772e.svg\";","module.exports = __webpack_public_path__ + \"1d893905e4eea3bbc48b0e129e318ea6.svg\";","module.exports = __webpack_public_path__ + \"bd556d00e484db4e52d198d0bf39d0f2.svg\";","module.exports = __webpack_public_path__ + \"650cd431226df0755357c71d61bef1f2.svg\";","module.exports = __webpack_public_path__ + \"f12c591f538ab3026bf13e93f3fa9485.svg\";","module.exports = __webpack_public_path__ + \"3aeb9dd24809ba3fbd4eeb31a28c3b19.svg\";","module.exports = __webpack_public_path__ + \"6cc6f6773bb6eb26fcef87b9629f7b87.svg\";","module.exports = __webpack_public_path__ + \"43062e54318df93f49e2be9a4281eb4a.svg\";","module.exports = __webpack_public_path__ + \"24611230ec712ba7ee38b99561aedd87.svg\";","module.exports = __webpack_public_path__ + \"c4ab2ceb2f61e18493fc776770c65654.svg\";","module.exports = __webpack_public_path__ + \"bbd50a175546bd70d21c5eadbc30d479.svg\";","module.exports = __webpack_public_path__ + \"7441c2ab240d0f733451d75204ac0792.svg\";","module.exports = __webpack_public_path__ + \"91a8cce06c3c05ce6e4b176afafd7b0a.svg\";","module.exports = __webpack_public_path__ + \"0ce4f9c3384680565b6bb16495b64233.svg\";","module.exports = __webpack_public_path__ + \"1db542acabeb82ec8da785e77afd4dca.svg\";","import { ResourceBlock } from \"./Economy\";\r\n\r\nexport type MechanicalOperation =\r\n    Recipe |\r\n    ResourceGenerator |\r\n    ResourceStorage |\r\n    SpawnClone |\r\n    AccelerateTime |\r\n    ExploreForResource |\r\n    Noop\r\n\r\nexport interface Noop {\r\n    type: 'noop'\r\n}\r\n\r\nexport interface Recipe {\r\n    type: 'recipe'\r\n    consumes: ResourceBlock[]\r\n    produces: ResourceBlock\r\n    workTime: number\r\n}\r\n\r\nexport interface ResourceGenerator {\r\n    type: 'generator'\r\n    generates: ResourceBlock\r\n    generationTime: number\r\n    capacity: number\r\n}\r\n\r\nexport interface ResourceStorage {\r\n    type: 'store'\r\n    stores: ResourceBlock[]\r\n    capacity: number\r\n}\r\n\r\nexport interface SpawnClone {\r\n    type: 'spawn'\r\n}\r\n\r\nexport interface AccelerateTime {\r\n    type: 'accelerate'\r\n    factor: number\r\n}\r\n\r\nexport interface ExploreForResource {\r\n    type: 'explore'\r\n    gathers: ResourceBlock\r\n    capacity: number\r\n}\r\n\r\nfunction store(res: ResourceBlock[], capacity: number = 10): ResourceStorage {\r\n    return {\r\n        type: 'store',\r\n        stores: res,\r\n        capacity\r\n    }\r\n}\r\n\r\nfunction generate(res: ResourceBlock, cap: number = 4): ResourceGenerator {\r\n    return {\r\n        type: 'generator',\r\n        generates: res,\r\n        generationTime: 1000,\r\n        capacity: cap\r\n    }\r\n}\r\n\r\nfunction recipe(input: ResourceBlock[], output: ResourceBlock): Recipe {\r\n    return {\r\n        type: 'recipe',\r\n        consumes: input,\r\n        produces: output,\r\n        workTime: 1000,\r\n    }\r\n}\r\n\r\nfunction spawn(): SpawnClone {\r\n    return {\r\n        type: 'spawn',\r\n    }\r\n}\r\n\r\nfunction accelerateTime(): AccelerateTime {\r\n    return {\r\n        type: 'accelerate',\r\n        factor: 2\r\n    }\r\n}\r\n\r\nfunction explore(block: ResourceBlock, cap: number = 4): ExploreForResource {\r\n    return {\r\n        type: 'explore',\r\n        gathers: block,\r\n        capacity: cap\r\n    }\r\n}\r\n\r\nexport const mechanicalOperations = {\r\n    store,\r\n    generate,\r\n    recipe,\r\n    spawn,\r\n    accelerateTime,\r\n    explore,\r\n}","import { Input, Scene, Timer, Vector, LockCameraToActorStrategy, Color, Engine } from \"excalibur\";\r\nimport { Building, structureViews } from \"../actors/Building\";\r\nimport { DevicePlace } from \"../actors/Building/Building\";\r\nimport { Device } from \"../actors/Device\";\r\nimport { Hud } from \"../actors/Hud/Hud\";\r\nimport { Planet } from \"../actors/Planet/Planet\";\r\nimport { Player } from \"../actors/player\";\r\nimport { Game } from \"../Game\";\r\nimport { Machine, allMachines } from \"../models/Machine\";\r\nimport { LivingQuarters, MissionControl, SolarArray, RoomRecipe, CloneReception, Kitchen, Workshop, Archive, Refinery, Mine } from \"../models/RoomRecipe\";\r\nimport { Corridor, HugeRoom, LargeRoom, MainTunnel, MediumRoomThree, SmallDome, SmallRoomThree, Structure, SurfaceRoad } from \"../models/Structure\";\r\nimport { flatSingle, zip, sample } from \"../Util\";\r\nimport { DeviceSize } from \"../values/DeviceSize\";\r\nimport { Orientation } from \"../values/Orientation\";\r\nimport { TechnologyRank } from \"../models/TechnologyRank\";\r\nimport { TechTree } from \"../models/TechTree\";\r\nimport { Citizen } from \"../actors/Citizen\";\r\nimport { GameController } from \"../GameController\";\r\n\r\nclass ConstructionEngine {\r\n    // i.e. have we placed the first building yet\r\n    firstBuilding: boolean = true\r\n    placingFunction: RoomRecipe = null\r\n    // currentlyConstructing: Building | Device = null;\r\n\r\n    constructor() {}\r\n    activate(controller: GameController) {\r\n    }\r\n}\r\n\r\n\r\nexport class Construct extends Scene {\r\n    private controller: GameController\r\n    private techTree: TechTree = new TechTree()\r\n    // private game: Engine\r\n    private planet: Planet\r\n    private hud: Hud\r\n    private player: Player\r\n    private defaultMessage: string = 'Welcome to the Colony, Commander.'\r\n    private time: number = Game.startHour*60\r\n    private hasActiveModal: boolean = false\r\n    private followedCitizen: Citizen = null\r\n    private lost: boolean = false\r\n\r\n    private construction: ConstructionEngine\r\n\r\n    static requiredStructuresAndFunctions: (typeof RoomRecipe | typeof Structure)[] = [\r\n        MissionControl,\r\n        SurfaceRoad,\r\n        SolarArray,\r\n        MainTunnel,\r\n        Corridor,\r\n        LivingQuarters,\r\n    ]\r\n\r\n\r\n    update(engine, delta) {\r\n        super.update(engine, delta)\r\n\r\n\r\n        let devices = this.planet.colony.findPoweredDevices()\r\n        let machines = allMachines.filter(machine => devices.some(device => device.machine instanceof machine))\r\n\r\n        let discipline = this.techTree.findDisciplineToRankUp(machines)\r\n        if (discipline) {\r\n            let rank = this.techTree.rankUp(discipline)\r\n            this.rankUp(rank)\r\n        }\r\n\r\n        // hmm!\r\n        this.hud.updateDetails(this.planet, this.techTree, this.followedCitizen, true, this.time)\r\n\r\n        if (!this.lost && !this.construction.firstBuilding && this.planet.population.citizens.length === 0) {\r\n            this.lost = true\r\n            // alert('colony lost!')\r\n            this.askYesNo('The colony has perished! Try again?',\r\n                () => this.welcome(),\r\n                () => engine.goToScene('menu')\r\n            )\r\n        }\r\n    }\r\n\r\n    public onInitialize(engine: Engine) {\r\n        this.construction = new ConstructionEngine()\r\n\r\n        let buildIt = (e) => this.startConstructing(e)\r\n        let followIt = (c) => this.toggleFollowing(c)\r\n        this.hud = new Hud(this.engine, buildIt, buildIt, buildIt, followIt)\r\n        this.add(this.hud)\r\n\r\n        this.planet = new Planet(\r\n            this.hud,\r\n            (b) => this.hud.showCard(b),\r\n            (d) => this.hud.showCard(d),\r\n            200000,\r\n            40000,\r\n            this\r\n        )\r\n        this.add(this.planet)\r\n\r\n        this.player = new Player()\r\n        this.add(this.player)\r\n\r\n        this.addTimer(\r\n            new Timer(() => { this.stepTime() }, this.timeStepIntervalMillis, true)\r\n        )\r\n        this.addTimer(\r\n            new Timer(() => {\r\n                // this.infoMessage(\"perimeter alert! raiding party incoming\")\r\n                this.planet.sendRaidingParty()\r\n            }, Game.raidingPartyFrequency, true)\r\n        )\r\n\r\n        this.welcome()\r\n    }\r\n\r\n    welcome() {\r\n        this.planet.buildColonyAndPopulation()\r\n        this.lost  = false\r\n        this.construction.firstBuilding = true\r\n        this.infoMessage(\r\n            \"Welcome to the Colony, sir... \"\r\n            + \"We are what is left of the crew of the Osiris. \"\r\n            + \"Can you help us build a functioning society? \"\r\n            + \"First, choose a location for the Command post. \"\r\n            + \"Then we'll lay out some infrastructure.\",\r\n            () => this.prepareNextBuilding()\r\n        )\r\n        this.camera.zoom(0.25)\r\n    }\r\n\r\n    public onActivate() {\r\n\r\n        this.setupControls() \r\n        // this.prepareNextBuilding()\r\n        this.camera.zoom(0.25)\r\n\r\n        this.hud.show()\r\n\r\n        if (this.lost) { this.welcome() }\r\n    }\r\n\r\n    public onDeactivate() {\r\n        this.closeSystemMessage()\r\n        this.stopFollowing()\r\n        this.controller.deactivate()\r\n\r\n        this.hud.hide()\r\n    }\r\n\r\n    private setupControls() {\r\n        this.controller = new GameController(this.engine, this.camera)\r\n        this.controller.onCameraPan(() => this.stopFollowing())\r\n\r\n        this.controller.onMove((pos: Vector) => {\r\n            if (this.hasActiveModal) { return }\r\n            this.player.pos = pos\r\n\r\n            let currentlyBuilding = this.planet.currentlyConstructing\r\n            if (currentlyBuilding instanceof Building) {\r\n\r\n                let constrained = currentlyBuilding.constrainCursor(this.player.pos)\r\n                this.player.pos = constrained\r\n\r\n                currentlyBuilding.reshape(this.player.pos)\r\n            } else if (currentlyBuilding instanceof Device) {\r\n                currentlyBuilding.snap(this.planet, this.player.pos)\r\n            }\r\n        })\r\n\r\n        this.controller.onLeftClick((pos: Vector, shift: boolean) => {\r\n            if (this.hasActiveModal) { return }\r\n            const currentlyBuilding = this.planet.currentlyConstructing\r\n                if (currentlyBuilding) {\r\n                    if (currentlyBuilding instanceof Building) {\r\n                        let buildingUnderConstruction = currentlyBuilding\r\n                        let placementValid = !buildingUnderConstruction.overlapsAny()\r\n                        if (buildingUnderConstruction && placementValid && buildingUnderConstruction.handleClick(pos)) {\r\n                            this.planet.placeBuilding(buildingUnderConstruction)\r\n                            if (this.construction.firstBuilding){\r\n                                this.planet.sendRaidingParty()\r\n                            }\r\n\r\n                            if (this.construction.placingFunction) {\r\n                                let fn = this.construction.placingFunction\r\n                                zip(fn.machines, buildingUnderConstruction.devicePlaces()).forEach(([machine, place]: [typeof Machine, DevicePlace]) => {\r\n                                    let m = (new machine()).concretize()\r\n                                    let device = new Device(m, place.position)\r\n                                    buildingUnderConstruction.addDevice(device)\r\n                                })\r\n                                this.construction.placingFunction = null\r\n                            }\r\n\r\n                            this.hud.setStatus(this.defaultMessage)\r\n                            this.planet.colony.currentlyConstructing = null\r\n                            this.prepareNextBuilding(pos)\r\n                        }\r\n                    } else {\r\n                        let deviceUnderConstruction = currentlyBuilding\r\n                        let placementValid = (deviceUnderConstruction.size === DeviceSize.Tiny) ||\r\n                            !deviceUnderConstruction.overlapsAny()\r\n                        let snapped = deviceUnderConstruction.snap(this.planet)\r\n                        if (snapped && placementValid) {\r\n                            if (deviceUnderConstruction.size === DeviceSize.Tiny) {\r\n                                let parent = deviceUnderConstruction.parentDevice\r\n                                parent.addTinyDevice(deviceUnderConstruction)\r\n                            } else {\r\n                                let bldg = deviceUnderConstruction.building\r\n                                bldg.addDevice(deviceUnderConstruction)\r\n                            }\r\n                            this.planet.colony.currentlyConstructing = null\r\n                            this.hud.setStatus(this.defaultMessage)\r\n\r\n                            if (shift) {\r\n                                this.startConstructing(deviceUnderConstruction.machine)\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n        })\r\n\r\n        this.controller.onKeyPress((key) => {\r\n            if (this.hasActiveModal) { return }\r\n            if (key === Input.Keys.H) {\r\n                if (this.buildings && this.buildings[0]) {\r\n                    this.stopFollowing()\r\n                    this.camera.move(this.buildings[0].pos, 500)\r\n                    this.camera.zoom(0.5, 1000)\r\n                }\r\n            } else if (key === Input.Keys.Esc) {\r\n                this.planet.colony.currentlyConstructing = null\r\n                this.construction.placingFunction = null\r\n                this.stopFollowing(true)\r\n                this.hud.setStatus(this.defaultMessage)\r\n            }\r\n        })\r\n\r\n        this.controller.activate()\r\n    }\r\n\r\n\r\n\r\n    showTutorial: boolean = true\r\n    private infoMessage(message: string, onComplete: () => any = null) {\r\n        this.hasActiveModal = true\r\n        this.hud.systemMessage(message, \"\", {\r\n            continue: () => { this.closeSystemMessage(); if (onComplete) { onComplete() } },\r\n         })\r\n    }\r\n\r\n    private askYesNo(message: string, onYes: () => any, onNo: () => any) {\r\n        this.hasActiveModal = true\r\n        this.hud.systemMessage(message, \"\", {\r\n            yes: () => { this.closeSystemMessage(); if (onYes) { onYes() } },\r\n            no: () => { this.closeSystemMessage(); if (onNo) { onNo() } },\r\n         })\r\n    }\r\n\r\n    private tutorialMessage(message: string) {\r\n        if (this.showTutorial) {\r\n            this.hasActiveModal = true\r\n            this.hud.systemMessage(message, \"\", {\r\n                continue: () => { this.closeSystemMessage() },\r\n                'i got this': () => {\r\n                    this.closeSystemMessage()\r\n                    this.showTutorial = false\r\n                }\r\n            })\r\n        }\r\n    }\r\n\r\n    private rankUp(rank: TechnologyRank) {\r\n        if (this.lost) { return }\r\n\r\n        if (this.hasActiveModal) {\r\n            this.closeSystemMessage()\r\n        }\r\n\r\n        this.hasActiveModal = true\r\n        let rankUpMessage =\r\n            \"Your colony's mastery of a discipline has improved! \" +\r\n            \"The following new machines are now available for construction:\"\r\n\r\n        let okay = sample([ 'excellent!', 'great!', 'perfect', 'good work', 'cool', 'wonderful', 'brilliant', 'that is what i am talking about', 'keep up the good work', 'learning is fun!' ])\r\n\r\n        let modal = this.hud.systemMessage(\r\n            rankUpMessage,\r\n            \"rank up\",\r\n            { [okay]: () => { this.closeSystemMessage() }\r\n        })\r\n\r\n        modal.addHeading(rank.name, 28, Color.Orange)\r\n        modal.addHeading(rank.description, 12)\r\n\r\n        modal.addIconMatrix(\r\n            rank.unlocks.map(m => new m()).map(machine => { return {\r\n                image: machine.image,\r\n                label: machine.name\r\n            }})\r\n        )\r\n    }\r\n\r\n    private closeSystemMessage() {\r\n        this.hud.closeSystemMessage()\r\n        this.hasActiveModal = false\r\n    }\r\n\r\n\r\n    timeStepIntervalMillis: number = 50\r\n    private stepTime() { \r\n        this.time += this.timeStepIntervalMillis / Game.minuteTickMillis  /// this.timeStepIntervalMillis //  0.125 //.25\r\n        this.planet.setTime(this.time) \r\n    }\r\n\r\n  \r\n    get buildings() { return this.planet.colony.buildings }\r\n\r\n\r\n    private nextMissingStructureOrFunction(): Structure | RoomRecipe {\r\n        let reqs = Construct.requiredStructuresAndFunctions.map(req => new req())\r\n\r\n        let actualStructureNames = this.buildings.map(building => building.structure.name)\r\n        let actualFunctionNames = flatSingle(\r\n            this.buildings.map(building => building.spaceFunction && building.spaceFunction.name)\r\n        )\r\n        let actualNames = [...actualStructureNames, ...actualFunctionNames]\r\n        return reqs.find(req => !actualNames.includes(req.name))\r\n    }\r\n\r\n    protected prepareNextBuilding(pos: Vector = new Vector(0,0)) {\r\n        let structure = null;\r\n        let nextMissing = this.nextMissingStructureOrFunction()\r\n        if (nextMissing) { structure = nextMissing; }\r\n        if (structure) {\r\n            let congrats = sample([ 'Alright!', 'Perfect.', 'Great work!', 'Excellent!', 'Good.', 'That works.', 'Cool.', 'Fantastic!', 'Now we are cooking.', 'It looks good!' ])\r\n            let nextUp = sample([ \"Let's pick a location for a\", 'Next we will build a', 'Okay, time to make a', 'Get ready to place a'])\r\n            this.tutorialMessage(`${congrats} ${nextUp} ${structure.name}...`)\r\n            this.startConstructing(structure, pos)\r\n        } else {\r\n            this.hud.showPalettes()\r\n        }\r\n    }\r\n\r\n    toggleFollowing(citizen) {\r\n        if (this.followedCitizen === citizen) {\r\n            this.stopFollowing(true)\r\n        } else {\r\n            this.startFollowing(citizen)\r\n        }\r\n    }\r\n\r\n    cameraStrategy: LockCameraToActorStrategy\r\n    startFollowing(citizen) {\r\n        this.stopFollowing()\r\n        this.cameraStrategy = new LockCameraToActorStrategy(citizen)\r\n        this.camera.zoom(1.2, 1000)\r\n        this.camera.addStrategy(this.cameraStrategy)\r\n        this.followedCitizen = citizen\r\n\r\n    }\r\n\r\n    stopFollowing(resetZoom=false) {\r\n        if (this.cameraStrategy) {\r\n            this.camera.removeStrategy(this.cameraStrategy)\r\n            if (resetZoom) { \r\n                this.camera.zoom(0.5, 1000)\r\n            }\r\n            this.followedCitizen = null\r\n        }\r\n    }\r\n\r\n    startConstructing(structureOrMachine: Structure | Machine | RoomRecipe, pos: Vector = new Vector(0, 0)) {\r\n        this.hud.showCard(structureOrMachine)\r\n        \r\n        let theNextOne = null\r\n        if (structureOrMachine instanceof Structure) {\r\n            let structure = structureOrMachine\r\n            this.hud.setStatus(`Place ${structure.name} (${structure.description})`)\r\n            theNextOne = this.spawnBuilding(structure, pos)\r\n            if (this.construction.firstBuilding) {\r\n                this.camera.zoom(structure.zoom, 250)\r\n                this.camera.pos = theNextOne.pos\r\n                this.construction.firstBuilding = false\r\n            } \r\n        } else if (structureOrMachine instanceof Machine) {\r\n            let machine = structureOrMachine\r\n            this.hud.setStatus(`Install ${machine.name} (${machine.description})`)\r\n            theNextOne = this.spawnDevice(machine, pos)\r\n            // this.camera.zoom(1.5, 250)\r\n        } else if (structureOrMachine instanceof RoomRecipe) {\r\n            let fn: RoomRecipe = structureOrMachine\r\n            this.hud.setStatus(`Place ${fn.name} (${fn.description})`)\r\n            theNextOne = this.spawnFunction(fn, pos)\r\n            this.construction.placingFunction = fn\r\n\r\n        }\r\n\r\n        this.planet.colony.currentlyConstructing = null\r\n        if (theNextOne) {\r\n            this.planet.colony.currentlyConstructing = theNextOne\r\n            // this.camera.pos = theNextOne.pos\r\n        }\r\n    }\r\n\r\n    protected spawnDevice(machine: Machine, pos: Vector): Device {\r\n        let device = new Device(machine, pos)\r\n        if (device.snap(this.planet)) {\r\n            this.camera.pos = device.pos\r\n \r\n        }\r\n        return device\r\n    }\r\n\r\n    protected spawnBuilding(structure: Structure, pos: Vector): Building {\r\n        let anotherBuilding = this.assembleBuildingFromStructure(structure, pos)\r\n        anotherBuilding.reshape(anotherBuilding.constrainCursor(pos))\r\n        return anotherBuilding\r\n    }\r\n    \r\n    private assembleBuildingFromStructure(structure: Structure, pos: Vector): Building {\r\n        let View = structureViews[structure.view]\r\n        let building = new View(pos, structure, this.planet)\r\n        return building;\r\n    }\r\n\r\n    protected spawnFunction(fn: RoomRecipe, pos: Vector): Building {\r\n        let theStructure: Structure = (fn.structure && new fn.structure()) // || new SmallRoomThree()\r\n        if (!theStructure) {\r\n            theStructure = new SmallRoomThree()\r\n            let machines = fn.machines.map(m => new m())\r\n\r\n            if (machines.some(m => m.size === DeviceSize.Medium)) {\r\n                theStructure = new MediumRoomThree()\r\n            }\r\n\r\n            if (machines.some(m => m.size === DeviceSize.Large)) {\r\n                theStructure = new LargeRoom()\r\n            }\r\n\r\n            if (machines.some(m => m.size === DeviceSize.Huge)) {\r\n                theStructure = new HugeRoom()\r\n            }\r\n\r\n            if (machines.some(m => m.forDome)) {\r\n                theStructure = new SmallDome()\r\n            }\r\n        }\r\n\r\n        // console.log(\"SPAWN FUNCTION\", { fn, structure: theStructure })\r\n        let building = this.assembleBuildingFromStructure(theStructure, pos)\r\n        building.reshape(building.constrainCursor(building.pos))\r\n        return building\r\n    }\r\n} \r\n","module.exports = __webpack_public_path__ + \"37914c496c3c503f7a53d7c9a1457b53.mp3\";","module.exports = __webpack_public_path__ + \"1b8e735649248c4c552a84996e61f241.mp3\";","module.exports = __webpack_public_path__ + \"1a607294aebce07746d6f25ffa517d80.mp3\";","module.exports = __webpack_public_path__ + \"22bdefc1e8515661fdeb8e8076820641.mp3\";","module.exports = __webpack_public_path__ + \"cf150ab26eba01503f4f6dc3d9ab47f7.mp3\";","module.exports = __webpack_public_path__ + \"94754f62e0ae4d23d386e246f5e0cb6e.png\";","import { Game } from './Game';\r\nimport { World } from './models/World';\r\nimport { Construct } from './scenes/Construct';\r\nimport { Resources } from './Resources';\r\nimport { Sound } from 'excalibur';\r\nimport { Arena } from './scenes/Arena';\r\nimport { Menu } from './scenes/Menu';\r\n\r\nconst theWorld = new World();\r\nconst game = new Game(theWorld);\r\n\r\nconst construct = new Construct(game);\r\ngame.add('construct', construct);\r\n\r\nconst arena = new Arena(game)\r\ngame.add('arena', arena)\r\n\r\nconst menu = new Menu(game)\r\ngame.add('menu', menu)\r\n\r\n\r\ngame.start().then(() => {\r\n  game.goToScene('menu')\r\n});\r\n"],"sourceRoot":""}