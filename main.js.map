{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/Util.ts","webpack:///./src/values/DeviceSize.ts","webpack:///./src/actors/Building/index.ts","webpack:///./src/Game.ts","webpack:///./src/models/Economy.ts","webpack:///./src/models/Machine.ts","webpack:///./src/values/Orientation.ts","webpack:///./src/actors/Building/Building.ts","webpack:///./src/Painting.ts","webpack:///./src/actors/Device.ts","webpack:///./src/models/Structure.ts","webpack:///./src/values/Scale.ts","webpack:///./src/models/RoomRecipe.ts","webpack:///./src/strategies/Strategy.ts","webpack:///./src/actors/Building/BackgroundPatterns.ts","webpack:///./src/actors/Hud/Pane.ts","webpack:///./src/values/Graph.ts","webpack:///./src/models/World.ts","webpack:///./src/Resources.ts","webpack:///./src/models/TechnologyRank.ts","webpack:///./src/models/TechTree.ts","webpack:///./src/actors/player.ts","webpack:///./src/actors/Planet/PlanetBackground.ts","webpack:///./src/actors/Planet/SkyLayer.ts","webpack:///./src/actors/Planet/SkyLayers.ts","webpack:///./src/strategies/EatingStrategy.ts","webpack:///./src/strategies/WhenHungryEatingStrategy.ts","webpack:///./src/strategies/SleepingStrategy.ts","webpack:///./src/strategies/AnyBedSleepingStrategy.ts","webpack:///./src/strategies/ConstructionStrategy.ts","webpack:///./src/strategies/ProximityBasedConstruction.ts","webpack:///./src/values/InteractionRequest.ts","webpack:///./src/strategies/ProductionStrategy.ts","webpack:///./src/strategies/CapacityBasedProduction.ts","webpack:///./src/actors/Citizen.ts","webpack:///./src/actors/Planet/Population.ts","webpack:///./src/actors/Planet/NavigationTree.ts","webpack:///./src/actors/Planet/Colony.ts","webpack:///./src/actors/Planet/Planet.ts","webpack:///./src/actors/Hud/CitizenList.ts","webpack:///./src/actors/Hud/Modal.ts","webpack:///./src/actors/Hud/Palette.ts","webpack:///./src/actors/Hud/CardBody.ts","webpack:///./src/actors/Hud/CardTitle.ts","webpack:///./src/actors/Hud/Card.ts","webpack:///./src/actors/Hud/MusicPlayer.ts","webpack:///./src/actors/Hud/EconomicValue.ts","webpack:///./src/actors/Hud/EconomyView.ts","webpack:///./src/actors/Hud/ResourceListEntry.ts","webpack:///./src/actors/Hud/ResourcesList.ts","webpack:///./src/actors/Hud/StatusAnalysisView.ts","webpack:///./src/actors/Hud/Hud.ts","webpack:///./src/actors/Building/GroundVehiclePoolView.ts","webpack:///./src/actors/Building/MediumSurfaceRoomView.ts","webpack:///./src/actors/Building/MediumRoomThreeView.ts","webpack:///./src/actors/Building/HugeRoomView.ts","webpack:///./src/actors/Building/LargeRoomView.ts","webpack:///./src/actors/Building/MediumRoomView.ts","webpack:///./src/actors/Building/SmallRoomThreeView.ts","webpack:///./src/actors/Building/BigDomeView.ts","webpack:///./src/actors/Building/MidDomeView.ts","webpack:///./src/actors/Building/SmallDomeThreeView.ts","webpack:///./src/actors/Building/SurfaceRoadView.ts","webpack:///./src/actors/Building/LadderView.ts","webpack:///./src/actors/Building/ArcologyView.ts","webpack:///./src/actors/Building/TunnelView.ts","webpack:///./src/actors/Building/DomeView.ts","webpack:///./src/actors/Building/CommonAreaView.ts","webpack:///./src/actors/Building/CorridorView.ts","webpack:///./src/images/wood-panel-bg.png","webpack:///./src/images/ussf.png","webpack:///./src/images/window-bg.png","webpack:///./src/images/beige-bg.png","webpack:///./src/images/checker-bg.png","webpack:///./src/images/tech-bg.png","webpack:///./src/images/poster-wall-bg.png","webpack:///./src/images/books-bg.png","webpack:///./src/images/leafy-bg.png","webpack:///./src/images/raised-square-bg.png","webpack:///./src/images/mineral-processor-plain.svg","webpack:///./src/images/water-condenser-plain.svg","webpack:///./src/images/oxygen-extractor-plain.svg","webpack:///./src/images/greenhouse-plain.svg","webpack:///./src/images/books-plain.svg","webpack:///./src/images/telescope-plain.svg","webpack:///./src/images/orrery-plain.svg","webpack:///./src/images/lava-lamp-plain.svg","webpack:///./src/images/codex-plain.svg","webpack:///./src/images/statue-plain.svg","webpack:///./src/images/miner-plain.svg","webpack:///./src/images/solar-collector-plain.svg","webpack:///./src/images/couch-plain.svg","webpack:///./src/images/fabricator-plain.svg","webpack:///./src/images/mega-console-plain.svg","webpack:///./src/images/console-red-plain.svg","webpack:///./src/images/console-green-plain.svg","webpack:///./src/images/console-purple-plain.svg","webpack:///./src/images/console-plain.svg","webpack:///./src/images/workstation-plain.svg","webpack:///./src/images/houseplant-plain.svg","webpack:///./src/images/research-server-plain.svg","webpack:///./src/images/fridge-plain.svg","webpack:///./src/images/bed-plain.svg","webpack:///./src/images/cooking-fire-plain.svg","webpack:///./src/images/cabin-plain.svg","webpack:///./src/images/stove-plain.svg","webpack:///./src/images/bench-simple-plain.svg","webpack:///./src/images/vat-plain.svg","webpack:///./src/images/bookshelf-plain.svg","webpack:///./src/models/MechanicalOperation.ts","webpack:///./src/scenes/Construct.ts","webpack:///./src/sounds/future tense.mp3","webpack:///./src/sounds/understanding.mp3","webpack:///./src/sounds/indivision.mp3","webpack:///./src/sounds/assembler.mp3","webpack:///./src/sounds/crater-rock.mp3","webpack:///./src/images/sword.png","webpack:///./src/index.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","1","exports","module","l","m","c","d","name","getter","o","defineProperty","configurable","enumerable","get","r","value","n","__esModule","default","object","property","p","jsonpArray","window","webpackJsonp","oldJsonpFunction","bind","slice","excalibur_1","extremumBy","arr","pluck","extremum","reduce","best","next","pair","_ecRange","a","minBy","fn","Math","min","maxBy","max","sample","floor","random","range","Array","fill","map","_val","idx","closest","cursor","getVector","predicate","matching","filter","elem","distance","flatSingle","concat","deleteByValue","e","deleteByValueOnce","index","indexOf","eachCons","eachChunk","array","measureDistance","b","sleep","ms","Promise","resolve","setTimeout","shuffle","sort","zip","countOccurrences","counts","forEach","containsUniq","testElems","doesContain","arrCopy","missingItem_1","testElem","find","mixColors","factor","aFactor","bFactor","Color","g","onlyUnique","self","DeviceSize","Scale_1","major","Scale","minor","Tiny","Small","Medium","Large","Huge","getVisibleDeviceSize","size","sz","third","fourth","eighth","second","Building_1","Building","CorridorView_1","CorridorView","CommonAreaView_1","CommonAreaView","DomeView_1","DomeView","TunnelView_1","TunnelView","ArcologyView_1","ArcologyView","LadderView_1","LadderView","SurfaceRoadView_1","SurfaceRoadView","SmallDomeThreeView_1","SmallDomeThreeView","MidDomeView_1","MidDomeView","BigDomeView_1","BigDomeView","SmallRoomThreeView_1","SmallRoomThreeView","MediumRoomView_1","MediumRoomView","LargeRoomView_1","LargeRoomView","HugeRoomView_1","HugeRoomView","MediumRoomThreeView_1","MediumRoomThreeView","MediumSurfaceRoomView_1","MediumSurfaceRoomView","GroundVehiclePoolView_1","structureViews","GroundVehiclePoolView","Resources_1","Game","_super","world","_this","this","width","height","displayMode","DisplayMode","FullScreen","backgroundColor","Black","__extends","start","loader","Loader","key","Resources","addResource","logo","logoWidth","logoHeight","startButtonFactory","myButton","document","createElement","textContent","style","border","display","padding","fontFamily","font","color","fontSize","fontWeight","onmouseenter","Red","darken","toRGBA","onmouseleave","then","console","log","citizenSpeed","debugPath","startHour","minuteTickMillis","title","Engine","PureValue","availableCapacity","market","supply","demand","Power","Oxygen","Water","Shelter","Hope","Joy","Wisdom","Wealth","Beauty","Wonder","allValues","emptyMarket","sumMarkets","ea","eb","newMarket","_a","sa","da","_b","equilibrium","every","ResourceBlock","Biomass","Ore","Idea","Meal","Data","Mineral","Bioplasma","Alloy","Algorithm","Argent","Aurum","Omnium","blockColors","Green","Blue","lighten","Yellow","cStep","Viridian","DarkGray","Gray","Orange","White","blockColor","block","desaturate","t","setPrototypeOf","__proto__","constructor","create","__assign","assign","arguments","Economy_1","DeviceSize_1","MechanicalOperation_1","Util_1","images","bookshelf","vat","bench","stove","cabin","fire","bed","fridge","server","plant","workstation","consolePurple","consoleGreen","consoleRed","megaconsole","fabricator","couch","solar","miner","statue","codex","lavaLamp","orrery","telescope","books","greenhouse","o2","h20","minProcessor","Violet","store","mechanicalOperations","generate","recipe","spawn","accelerateTime","explore","Machine","description","LightGray","cost","operation","type","image","prereqs","economy","forDome","hide","isVehicle","tinySlots","isEatingSurface","concretize","onPlacement","device","CommandCenter","built","produceResource","building","populate","pos","add","MissionLog","LavaLamp","Table","Figurine","Orrery","Books","OxygenExtractor","WaterCondensingMachine","SolarCell","Bed","Telescope","Statue","StudyMachine","Workstation","Codex","Bookshelf","Couch","Fridge","Stove","Houseplant","Botany","PersonnelRegistry","CloningVat","OrientationConsole","productionTime","AlgaeVat","DissolutionVat","PlasmaBank","Fabricator","LifeSciencesConsole","Miner","MineralProcessor","MiningDrill","MetalStorage","ResearchServer","Greenhouse","Cabin","Orchard","Arbor","ThinkingFountain","Mainframe","Megafabricator","MolecularEngine","fromHex","SilverForest","TimeCrystal","HoloProjector","SacredGrove","AtomicCompiler","Preserve","LogicPool","Cathedral","Microcity","LogicCrystal","allMachines","Orientation","Left","Up","Right","Down","compass","flip","orientation","Error","Orientation_1","Game_1","Graph_1","RoomRecipe_1","Machine_1","BackgroundPatterns_1","Painting_1","DevicePlace","structure","planet","x","y","infra","Transparent","edgeWidth","placed","hover","showLabel","facing","hideBox","childrenBuildings","devices","active","step","anchor","Vector","setup","traits","trait","Traits","OffscreenCulling","on","some","currentlyViewing","toggleActive","collisionType","CollisionType","PreventCollision","nameLabel","Label","draw","ctx","delta","drawRect","aabb","processedColor","spaceFunction","slots","slot","rect","nodes","node","update","engine","tryProduce","tinyDevices","tinyDevice","poly","aabbPoly","getHeight","emptyUnlessActive","isActive","machineEconomies","buildingEconomy","inUse","wasEquil","_i","allValues_1","localCap","globalCap","agg","constrainCursor","clone","reshape","alignToSlot","afterConstruct","handleClick","_pos","getWidth","devicePlaces","deviceInteractionPlaces","place","position","visibleSize","graph","supergraph","Graph","rootNode","findOrCreate","child","parentSlot","edge","childNode","redeem","res","gather","debit","spend","elite","pathFromRect","angledRoofPoly","angleStartY","overlaps","other","rect1","rect2","overlapsAny","colony","buildings","bldg","edgeColor","mainColor","colorBase","clr","connections","findSlot","validConnections","slotList","dir","validStructures","flipped","closestBuildingByType","matchingSlot","compass_1","theSlot","offset","sub","addEqual","buildSlot","parent","addDevice","subEqual","updateFunction","machine","hasPlaceForDevice","nextDevicePlace","getDevices","allTheMachines","machines","allSpaceFunctions","spaceFn","sf","text","background","BackgroundPattern","Grid","Actor","drawPatternedPoly","path","pattern","gridPattern","getBackgroundPattern","save","translate","beginPath","moveTo","pt","lineTo","closePath","fillStyle","strokeStyle","stroke","restore","drawLine","lineWidth","drawPatternedRect","rectangle","filled","dashed","main","fillRect","setLineDash","strokeRect","drawPoly","drawStar","cx","cy","outerRadius","innerRadius","spikes","rot","PI","cos","sin","drawCircle","radius","hemi","theta","arc","drawEllipse","radiusX","radiusY","ellipse","Structure_1","Device","initialPos","product","imageLoaded","reserved","parentDevice","Image","onload","src","computeEconomy","globalAlpha","imageX","imageY","vel","scale","drawImage","iv","bx","by","yOff","produced","blockSize","assemble","citizen","isCarryingUnique","drop","progressBar","sent","label","interact","request","worked","op","recipe_1","carrying","it","consumes","includes","consumed","workTime","getEffectiveWorkTime","carry","produces","warn","requires","has","storeOrExplore","dispense","store_1","stores","getEffectiveOperationalCapacity","res_1","stored","origX","groundSpeed","driving","xOff","actions","asPromise","gathers","bonus","bonuses","capacity","workSpeed","round","resource","generationTime","generates","snap","snapTiny","allStructures","snapped","spot","getCenter","halfSize","abs","floorY","findAllDevices","hasTinyPlace","nextTinyPlace","tx0","ndx","addTinyDevice","smallMachines","mediumMachines","largeMachines","hugeMachines","smallDome","smallBelow","midDome","midBelow","largeDome","largeBelow","hugeDome","hugeBelow","medGroundVehicles","Structure","view","zoom","Corridor","Ladder","MainTunnel","fifth","MediumSurfaceRoom","SurfaceRoad","first","Dome","seventh","CommonArea","SmallRoomThree","sixth","SmallRoomTwo","SmallDome","MediumRoom","MediumRoomThree","LargeRoom","HugeRoom","SmallDomeThree","MidDome","LargeDome","Arcology","GroundVehiclePool","majorUnit","minorUnit","minorScale","RoomRecipe","Beige","MissionControl","Window","LivingQuarters","Barracks","Kitchen","Checker","LifeSupportPod","Retreat","CloneMatrix","CloneReception","ReadingRoom","Library","Study","Wood","ComputerLab","Archive","Arboretum","AlgaeFarm","SolarArray","Workshop","Nursery","Leafy","Farm","Factory","ComputerCore","Tech","LifeSciencesLab","Refinery","Mine","HoloMatrix","TimeChamber","LivingRoom","Statuary","InteractionRequest_1","Strategy","pawn","sleepInterval","currentPlanet","findPoweredDevices","recipes","operations","explores","attempt","pause","gatherBlock","gathered","generatesDesiredBlock","gen","closestDeviceByType","storesDesiredBlock","visitDevice","waitTimes","retrieveResource","visit","workExploration","exploring","knowsHow","vehicle","explored","drive","driven","workRecipe","debug","knowsRecipe","maker","made","gatherIngredients","performRecipeTask","blocks","blocks_1","ingredient","tries","timesToAttempt","raisedSquare","leafy","bookish","posters","tech","checker","beige","ussf","wood","loadBg","loading","Poster","USSF","backgroundPatterns","bg","matrix","DOMMatrix","createPattern","setTransform","Pane","dragging","dragStart","target","initialX","clientX","initialY","clientY","drag","preventDefault","currentX","currentY","dragEnd","makeRootElement","_element","parentElement","removeChild","flexWrap","body","appendChild","container","margin","addEventListener","left","canvas","offsetLeft","top_1","offsetTop","top","buttonFactory","fg","theButton","textTransform","onmouseover","saturate","empty","edges","edgesInverse","isEmpty","newNode","contains","testNode","measure","tolerance","dfs","dst","union","otherGraph","edgeList","theEdges","_c","otherIndex","otherNode","adjacent","adjacentIndices","testNodeIndex","es","esInv","root","visited","rIndex","dfsIndex","rootIndex","childIndex","bfs","cb","bfsIndex","halt","visited_1","visitedNode","adj_1","adjacentNode","shortestPath","maxStep","prevStep","dstIndex","prev","curr","steps","srcIndex","reverse","World","colors","skyColor","Cyan","nameCitizen","Azure","sword","craterRock","assembler","indivision","understanding","futureTense","Sword","Texture","CraterRock","Sound","Assembler","Indivision","Understanding","FutureTense","Discipline","Survival","Agriculture","LibraryScience","Cooking","MineralProduction","disciplineTree","level","unlocks","TechnologyRank_1","TechTree","currentLevels","findDisciplineToRankUp","keys","disciplineName","discipline","canRankUp","rankUp","currentRank","nextLevel","allUnlockedMachines","unlocked","unlockedMachinesFor","tree","ex","Player","setWidth","setHeight","PlanetBackground","MountainLayers","layers","layerHeight","layerCount","peakCount","onInitialize","layerIndex","unshift","baseY","deltas","genPeaks","wc","sc","ls_1","layer","drawLayer","ox","oy","peakWidth","dMax","last","times","pick","Mountains","peaks","peakDistance","drift","h","baseColor","brightColor","yBase","peak","y0","mtnWidth","PlanetBackground_1","SkyLayer","lo","hi","mid","backMountainLayers","mountains","mountainLayers","setLoHi","SkyLayer_1","SkyLayers","c0","c1","setHi","EatingStrategy","EatingStrategy_1","WhenHungryEatingStrategy","canApply","isHungry","storedResources","desk","eat","SleepingStrategy","SleepingStrategy_1","AnyBedSleepingStrategy","isTired","hour","takeRest","Strategy_1","ConstructionStrategy","unbuiltDevice","ProxmityBasedConstruction","constructDevice","resources","__awaiter","throw","done","__generator","trys","ops","return","Symbol","iterator","TypeError","pop","ProductionStrategy","storeBlock","tryStoreBlock","openStore","CapacityBasedProduction","findStore","findRecipe","explorer","findExplorer","storage_1","storage_2","explorers","CapacityBasedProduction_1","ProximityBasedConstruction_1","AnyBedSleepingStrategy_1","WhenHungryEatingStrategy_1","Citizen","home","isPlanning","workInProgress","sleeping","hunger","energy","currentBuilding","productionStrategy","constructionStrategy","sleepingStrategy","eatingStrategy","shirtColor","speedMultiplier","timeFactor","now","Date","getTime","progress","workStarted","workDuration","work","rotate","drawSelf","carried","pw","px","py","c_1","duration","reject","targetForDevice","pathBetweenPoints","followPath","glideTo","walkSpeed","all","choice","strategies","strat","thirtyMinuteTimer","Citizen_1","World_1","Population","citizens","increase","NavigationTree","seekPath","origin","dest","closestNode","NavigationTree_1","Colony","currentlyConstructing","debugTree","navTree","gradient","createLinearGradient","addColorStop","placeBuilding","buildNavTree","structureTypes","st","pathBetween","destination","srcNode","destNode","machineTypes","ctrl","activeBuildings","Colony_1","Population_1","Device_1","SkyLayers_1","Planet","hud","onBuildingHover","onDeviceHover","w","depth","sky","createLayer","skyLayers","population","currentHour","setTime","time","nextHour","inc","oldC","skyColorForHour","newC","mixC","assignColors","colorMap","night","dawn","morning","afternoon","evening","set","buildingOrDevice","theLayer","theEconomy","popularDemand","resourceGathered","resourceExpended","maxPop","theEconomyWithoutPeople","values","val","closestDevice","acc","hasMachineKind","kind","CitizenList","onCitizenSelect","updateRoster","makeRoster","btn","onclick","Modal","message","makeDialog","clientHeight","addButtons","buttonMap","buttons","entries","intent","_footer","teardown","textAlign","_header","_body","paddingBottom","addHeading","heading","headerMessage","addIconMatrix","iconSet","img","lbl","icon","flexDirection","modalButton","Palette","onButtonClick","onButtonEnter","comprehend","comprehended","makePalette","updateBuilt","nowComprehended","prereq","CardBody","entity","describeResources","freqs","join","notes","fontStyle","FontStyle","Italic","footer","show","describeEconomy","resourceDescription","domeStatus","bonusMessages","econ","toFixed","CardTitle","announce","CardTitle_1","CardBody_1","Card","x0","cardBody","ix","iy","present","MusicPlayer","playlist","paused","makePlayer","startMusic","_titleElem","currentTrack","play","advancePlaylist","_wrapper","maxHeight","overflow","inlineBlock","iconFactory","handleAction","action","song","stop","trackNames","append","iconContent","innerHTML","EconomicValue","valueLabel","setCount","count","EconomicValue_1","EconomyView","valueLabels","val1","val2","addValue","updateView","updatedEconomy","Tooltip","messageLabel","ResourceListEntry","resourceBlock","hovering","tooltip","visible","u","credit","amt","UIActor","ResourceListEntry_1","ResourcesList","res1","res2","rx","ry","addEntry","entry","increment","decrement","ResourcesList_1","EconomyView_1","MusicPlayer_1","StatusAnalysisView","brand","ty","version","clock","popLabel","musicPlayer","Crater Rock","Future Tense","incrementResource","decrementResource","setMessage","showEconomy","showPopCap","cap","setClock","days","toString","hh","hours","minutes","ampm","padStart","StatusAnalysisView_1","Card_1","Palette_1","Modal_1","CitizenList_1","Hud","game","onBuildingSelect","onMachineSelect","onFunctionSelect","canvasWidth","canvasHeight","hidePalettes","showCitizenList","modal","devicePixelRatio","status","displayInfo","showCard","machinePalette","structurePalette","structuresForPalette","functionPalette","functionsForPalette","citizenList","card","systemMessage","closeSystemMessage","showPalettes","setStatus","updateDetails","techTree","rebuildPalettes","updatePalettes","updateEconomy","updateMaxPop","updateBuildingPalette","updateMachinePalette","updateFunctionPalette","builtStructures","builtMachines","machinesForPalette","builtReifiedFunctions","builtFunctions","rf","_1","deviceSize","theSlots","slotY","buffer","devicePlaceSize","devicePlaceCount","floorHeight","sg","right","isGroundFloor","leftSlot","rightSlot","topSlot","getTop","backgroundPattern","floorColor","floorEdgeHeight","flagX","flagY","flagpoleHeight","originSlot","slotSize","pickingOrigin","drawShape","xoff","yoff","bezierCurveTo","halfWidth","slotHeights","heights","y1","btm","lst","slotCount","originX","newCursor","input","output","Hud_1","Planet_1","player_1","TechTree_1","Construct","defaultMessage","placingFunction","hasActiveModal","firstBuilding","showTutorial","timeStepIntervalMillis","rank","buildIt","startConstructing","startFollowing","player","prepareNextBuilding","camera","addTimer","Timer","stepTime","continue","tutorialMessage","i got this","okay","onActivate","pointers","primary","dragOrigin","currentlyBuilding","constrained","button","Input","PointerButton","buildingUnderConstruction_1","placementValid","deviceUnderConstruction","Middle","z","getZoom","deltaY","moveCam","direction","camMoveSpeed","dv","move","keyboard","Keys","H","Esc","stopFollowing","W","A","S","D","onDeactivate","off","nextMissingStructureOrFunction","reqs","requiredStructuresAndFunctions","req","actualStructureNames","actualFunctionNames","actualNames","nextMissing","congrats","nextUp","cameraStrategy","LockCameraToActorStrategy","addStrategy","removeStrategy","structureOrMachine","theNextOne","spawnBuilding","spawnDevice","spawnFunction","anotherBuilding","assembleBuildingFromStructure","theStructure","Scene","Construct_1","theWorld","construct","goToScene"],"mappings":"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J,EAAAwB,EAAuB,iDAAA4C,EAAAkM,EAAAnP,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAkM,EAAAnP,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAkM,EAAAnP,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAkM,EAAAnP,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAkM,EAAAnP,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAkM,EAAAnP,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAkM,EAAAnP,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAkM,EAAAnP,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAkM,EAAAnP,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAkM,EAAAnP,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAkM,EAAAnP,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAkM,EAAAnP,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAkM,EAAAnP,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAkM,EAAAnP,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAkM,EAAAnP,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAkM,EAAAnP,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAkM,EAAAnP,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAkM,EAAAnP,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAkM,EAAAnP,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAkM,EAAAnP,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAkM,EAAAnP,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAkM,EAAAnP,GCAxCd,E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","file":"main.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t1: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([118,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import { Vector, Color } from \"excalibur\";\r\nimport { Rectangle } from \"./values/Rectangle\";\r\nimport { getBackgroundPattern, BackgroundPattern } from \"./actors/Building/BackgroundPatterns\";\r\n\r\nconst extremumBy = (arr, pluck, extremum) => {\r\n  return arr.reduce(function(best, next) {\r\n    var pair = [ pluck(next), next ];\r\n    if (!best) {\r\n       return pair;\r\n    } else if (extremum.apply(null, [ best[0], pair[0] ]) == best[0]) {\r\n       return best;\r\n    } else {\r\n       return pair;\r\n    }\r\n  },null)[1];\r\n}\r\n\r\nexport const minBy = (arr, fn) => extremumBy(arr, fn, Math.min)\r\nexport const maxBy = (arr, fn) => extremumBy(arr, fn, Math.max)\r\n\r\n\r\nexport const sample = (arr) => arr[Math.floor(Math.random() * arr.length)]\r\n\r\nexport const range = (n) => Array(n).fill(0).map((_val,idx) => idx)\r\n\r\nexport function closest<T>(cursor: Vector, arr: Array<T>, getVector: (elem: T) => Vector, predicate?: (elem: T) => boolean) {\r\n   let matching: Array<T> = arr;\r\n   if (predicate) { arr = arr.filter(predicate) }\r\n   if (matching) {\r\n      let distanceToCursor = (elem: T) => cursor.distance(getVector(elem))\r\n      return minBy(matching, distanceToCursor)\r\n   }\r\n}\r\n\r\nexport const flatSingle = arr => [].concat(...arr);\r\n\r\nexport const deleteByValue = (arr, elem) => arr.filter(e => e !== elem)\r\n\r\nexport const deleteByValueOnce = (arr, elem) => {\r\n  let index = arr.indexOf(elem);\r\n  if (index !== -1) arr.splice(index, 1);\r\n}\r\n\r\nexport function eachCons(a, n) {\r\n  var r = []\r\n  for (var i = 0; i < a.length - n + 1; i++) {\r\n    r.push(_ecRange(a, i, n))\r\n  }\r\n  return r\r\n}\r\n\r\nfunction _ecRange (a, i, n) {\r\n  var r = []\r\n  for (var j = 0; j < n; j++) {\r\n    r.push(a[i + j])\r\n  }\r\n  return r\r\n}\r\n\r\nexport function eachChunk(a, n) {\r\n  return a.reduce(function (result, value, index, array) {\r\n    if (index % n === 0)\r\n      result.push(array.slice(index, index + n));\r\n    return result;\r\n  }, []);\r\n}\r\n\r\nexport const measureDistance = (a: Vector, b: Vector) => a.distance(b)\r\n\r\n\r\nexport function sleep(ms) {\r\n  return new Promise(resolve => setTimeout(resolve, ms));\r\n}\r\n\r\nexport function shuffle(arr) {\r\n  return arr.sort(() => Math.random() > 0.5 ? 1 : -1)\r\n}\r\n\r\nexport const zip = (a, b) => a.map((e, i) => [e, b[i]])\r\n\r\nexport const countOccurrences = (arr) => {\r\n  let counts = {}\r\n  arr.forEach((elem) => {\r\n    counts[elem] = counts[elem] || 0\r\n    counts[elem] += 1\r\n  })\r\n  return counts\r\n}\r\n\r\nexport function containsUniq<T>(arr: T[], testElems: T[]) {\r\n  let doesContain = false\r\n  let arrCopy = arr.slice()\r\n  if (arr.length > 0) {\r\n    let missingItem = false\r\n    testElems.forEach(testElem => {\r\n      if (arrCopy.find(e => e === testElem)) {\r\n        deleteByValueOnce(arrCopy, testElem)\r\n      } else {\r\n        missingItem = true\r\n      }\r\n    })\r\n    doesContain = !missingItem\r\n  }\r\n  return doesContain\r\n}\r\n\r\n\r\nexport function mixColors(a: Color, b: Color, factor: number = 0.5): Color {\r\n  let aFactor = factor, bFactor = (1-factor)\r\n  return new Color(\r\n    (a.r * aFactor) + (b.r * bFactor),\r\n    (a.g * aFactor) + (b.g * bFactor),\r\n    (a.b * aFactor) + (b.b * bFactor),\r\n    1\r\n  )\r\n}\r\n\r\nexport function onlyUnique(value, index, self) { \r\n    return self.indexOf(value) === index;\r\n}","import { Scale } from \"./Scale\";\r\nlet { major, minor } = Scale\r\n\r\nexport enum DeviceSize {\r\n    Tiny,\r\n    Small,\r\n    Medium,\r\n    Large,\r\n    Huge,\r\n}\r\n\r\n\r\nexport function getVisibleDeviceSize(size: DeviceSize): number {\r\n    let sz = 10;\r\n    switch (size) {\r\n        case DeviceSize.Tiny: sz = minor.third; break;\r\n        case DeviceSize.Small: sz = major.third; break;\r\n        case DeviceSize.Medium: sz = major.fourth; break;\r\n        case DeviceSize.Large: sz = major.eighth + major.second; break;\r\n        case DeviceSize.Huge: sz = 6 * major.eighth; break;\r\n    }\r\n    return sz;\r\n}","import { Building } from './Building';\r\n\r\nimport { CorridorView } from './CorridorView';\r\nimport { CommonAreaView } from './CommonAreaView';\r\nimport { DomeView } from './DomeView';\r\nimport { TunnelView } from './TunnelView';\r\nimport { ArcologyView } from './ArcologyView';\r\nimport { LadderView } from './LadderView';\r\nimport { SurfaceRoadView } from './SurfaceRoadView';\r\nimport { SmallDomeThreeView } from './SmallDomeThreeView';\r\nimport { MidDomeView } from './MidDomeView';\r\nimport { BigDomeView } from './BigDomeView';\r\nimport { SmallRoomThreeView } from './SmallRoomThreeView';\r\nimport { MediumRoomView } from './MediumRoomView';\r\nimport { LargeRoomView } from './LargeRoomView';\r\nimport { HugeRoomView } from './HugeRoomView';\r\nimport { MediumRoomThreeView } from './MediumRoomThreeView';\r\nimport { MediumSurfaceRoomView } from './MediumSurfaceRoomView';\r\nimport { GroundVehiclePoolView } from './GroundVehiclePoolView';\r\n\r\n\r\nconst structureViews: { [key: string]: typeof Building } = {\r\n    CorridorView,\r\n    LadderView,\r\n    TunnelView,\r\n    SurfaceRoadView,\r\n\r\n    DomeView, // small dome 2\r\n    SmallDomeThreeView,\r\n    MidDomeView,\r\n    BigDomeView,\r\n\r\n    SmallRoomThreeView,\r\n\r\n    CommonAreaView,\r\n    MediumRoomView,\r\n    MediumRoomThreeView,\r\n    LargeRoomView,\r\n    HugeRoomView,\r\n\r\n    ArcologyView,\r\n    MediumSurfaceRoomView,\r\n\r\n    GroundVehiclePoolView,\r\n}\r\n\r\nexport {\r\n    Building,\r\n\r\n    CorridorView,\r\n    LadderView,\r\n    TunnelView,\r\n    SurfaceRoadView,\r\n\r\n    DomeView, // small dome 2\r\n    SmallDomeThreeView,\r\n    MidDomeView,\r\n    BigDomeView,\r\n\r\n    SmallRoomThreeView,\r\n\r\n    CommonAreaView,\r\n    MediumRoomView,\r\n    MediumRoomThreeView,\r\n\r\n    LargeRoomView,\r\n    HugeRoomView,\r\n\r\n    ArcologyView,\r\n\r\n    MediumSurfaceRoomView,\r\n\r\n\r\n    structureViews\r\n\r\n}","import { Engine, DisplayMode, Loader, Timer, Color } from 'excalibur';\r\nimport { World } from './models/World';\r\nimport { Resources } from './Resources';\r\n\r\nexport class Game extends Engine {\r\n  // static showTutorial: boolean = true\r\n  static citizenSpeed: number = 130\r\n  static debugPath: boolean = false\r\n  static startHour: number = 9\r\n\r\n  // 10000 = 1 min / 10 sec\r\n  // 1000 = 1 min / second\r\n  // 100 = 10 min / second\r\n  static minuteTickMillis: number = 1e3\r\n\r\n  static font = 'Helvetica'\r\n  static title: string = 'ASTRA';\r\n\r\n  constructor(public world: World) {\r\n    super({\r\n      width: 800,\r\n      height: 600,\r\n      displayMode: DisplayMode.FullScreen,\r\n      backgroundColor: Color.Black //world.skyColor\r\n    });\r\n  }\r\n\r\n  public start() {\r\n    let loader = new Loader();\r\n    for (let key in Resources) {\r\n      loader.addResource(Resources[key]);\r\n    }\r\n    loader.backgroundColor = '#0a0e0c'\r\n    // loader.logo = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAABACAYAAAD1Xam+AAACwklEQVR4nO3dQXKbMBQAULvTbXYe1u30fln0IF3kfp1mzXjnA7grMoRxDBISSOi9VSYBPsrw/xdg8OkEAAAAAAAAAAAAAAAAAAAAABTjvPcOHEXfX+/P/t51l6z/61zx+/56n647Fys27qNYIeum2o+WfN97B2o2Puj+/Pq5eNlUB2PINlPHX7qNIW6OBNxz/EehAETq++t9LunHxsuu6XSx2xgvmyJ+aNzUMWsZf+kUgEBDJwlJ/qnX7hLdGVN01K67nHN25mcxUxS+YXtr92Xtdo5AAQgQ2vWfee0uH9sMmU6nOmBzdea5mGvP82sef4m+7b0DtUiZ/D9eXj5+Hs8G5uLnOFDH3bBkrY8/FwWATbWecKVRABZI2f0fmZsF5J6mlp6UrY8/JwVgRu7kH3xVBLY6Ry01CVoff24KADRMAYCGKQBP5Jr+v99uD38/PQ3Y+hbVFtPgvW57LtHiaYACAA1TAPgkZ8et4UM3pe9fagrAxr6a/h9dDcnfIh8F3lBM8u9xTpr6oZ0126x9/KVTADYSk/x7HIhLE27pcmsf2oldN1ZrFwEVgA0ccdq/5Pn7ljpprVwDyGxN8tfcjVLcUqt5/LVQAJ7ousv5999/Ueu+327Byf/WXz911q3vS5fWtVsf/xYUgAyOOOWP0eIHa2rjGkAikv6xVG8CIg8FYMZwAA9v8MllOv2fxt/ircIlJmnr48/NKcACXXc5v/XXbNv/KvnH8XNOpUt/3r728ZdMAWATrgeUSQFYKNcsYK77j+PnSKBaul/r48/FNYAA44Nw7TWBoZiEvts+1eus93gt9trz+drHXyIFIND4ddKxRWBp15+LX8LrtUOlKAKnU73jL40CEGk6JZ0rBuPTh1RfzdXyV2O1Pv5UFIAVpl83tXTZo8SPlerWXq3jBwAAAAAAAAAAAAAAAAAAAAB46D+AUA+q0Ax9RQAAAABJRU5ErkJggg=='\r\n    loader.logo = 'data:image/png;base64,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'\r\n    // loader.logo = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAwAAAADACAYAAACzgQSnAAAJdUlEQVR4nO3dsYocxxYG4LkXp84uzhauMbq5soF9A1+Q3sSBHsTBvokN0hsMTOZci5BhM6FMD2AHC015dnqmarqqu7rP90WD6Z2tqT0eKM6vU7sdAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALCAfy29AOC6L1++Xn3m6XgcXt/t93+1XM/T8Th8d9zt91ef/+GH/7RcTnM5+3+i6f7vCr+759z/k71K92FY89h6LvzsUq7uc4u9nbKHLah/2J5/L70AAABgPg4AAAAQyHdLLwA4L227f/zwfnj9v5//f7a9nkZxfv3px4Yr2+3effp8tcX/8cP7oU2ffpa1tOMvxB5y4g2t45VFa1jj/p9YKq46ts9b2tuz1D9smw4AAAAE4gAAAACBmAIECxtrtY9N9Wkd76nl3afPw+vHw2H4rnl1f3/2+aVa85kTTs5OYslR63NNnMQy2zSbRlOAZpt+U6sepqxzzn1Q/89Eg4hGBwAAAAJxAAAAgEBEgGABpRN+1hL7Sf357dvw+mGkff/H778N30Gv37wd/vuCMY+rU19SvcUGevhca48Ajcnc2yr72XofeqiTFrb6uaAFHQAAAAjEAQAAAAJxERjMJCf2s8aoT45fRlrqD1++Dp89jQO1uLhnSoQj1XM8IF3byecd+1xnP7uLk17K3Nubp+W0pv7PUv+EpQMAAACBOAAAAEAgIkCwgAixn/9+//3wOp0IlEqjQWkcaNc+PtH0IqceZE7aWUV8pTcXoiZndRgpUf/P1D9h6QAAAEAgDgAAABCICBA0lLabn47H4fXdfr/Eclbj8XAYXk+JT+TEM1Jrjz3k2EB8pWddRUrU/0vqH57pAAAAQCAOAAAAEIgIEFQW+cKvKcYmApVeEFbrwqOArsZXxCFeKo2UtKb+b6b+CUUHAAAAAnEAAACAQESAoCGxn9tUvCBs8xceTXEhvtLVNBtupv4vUP9EpgMAAACBOAAAAEAgIkBAOJFjD2N6m2ZDO+r/JfVPNDoAAAAQiAMAAAAEIgIElT0dj8Pru/1+wZVsz+PhMLzWpl+WS5Ge9VCHPawBWBcdAAAACMQBAAAAAhEBgsru9nuXf+12uz+/favyPjdcCubinrpcipSvh/3pYQ1bov7ZJB0AAAAIxAEAAAACEQECQog8qaaUS5EuK92THmqvhzWshfonAh0AAAAIxAEAAAACEQECIFfYyScXoiAmw8Th78tm6AAAAEAgDgAAABCICBBQTa3Lv1owzYMcmXVyNfbT29Qd9Q+kdAAAACAQBwAAAAhEBAiYpOfYz+6fUQ3qWmQiysxRlrH6WUXsZ6f+WzIRiFXTAQAAgEAcAAAAIBARIKBY57Efrfl2loqULPV7r9ZSh7Ef9d+OSBWboQMAAACBOAAAAEAgIkBAls5jP1d1GNVYhU4ukGoda1ndxV6l1r7+pXRS/1CdDgAAAATiAAAAAIGIAAGjVhr7ORvnSFv54hCX9Rx7qPW3O/mMaeznahyoc+p/op7rH2rRAQAAgEAcAAAAIBARIKjs6Xgc2u7vPn0e2vG//vTjMgvK0HPU5yFpxz8eDsPevrq/H/uRLcU5erDJPUxjMDmRjxVFaNR/XfaQTdIBAACAQBwAAAAgEBEgqOxuv196CVl6jv2MSWM/YzEMEzzm0XkMZoqrEZre4kClcSYAHQAAAAjEAQAAAAIRAYINWmO8Z069RTh6EDk6ciFCs8mJOur/pcj1T0w6AAAAEIgDAAAABCICBA19/PD+7KVgv2i7X5Re/vXH778Ne/j6zdvSt1rdRJc5XYg9bCbuUmpjF4Sp/wvUP5HpAAAAQCAOAAAAEIgIEFQ2FiF4PByGVvLDl6/iQCceRvYqjf3kRBSiTXSp6OqeRIuInFhFnEb930z9E4oOAAAABOIAAAAAgYgAQUOlE0V49ur+fng9pe2+sYkuVZTW4Vb3Icfa4zTq/yX1D890AAAAIBAHAAAACEQECBaQXm4VeSJQxQu/ShVNdEmtJRKQGXXoNr7Sm43FadT/M/VPWDoAAAAQiAMAAAAEIgIEMxmLEIzFgVJrjwY9jLTjx2I/LWIGN0x0OftMz9GOC7GHq58r1dvn6txWLwg7+0wPn2WM+od8OgAAABCIAwAAAATiX73Dwsba1o+Hw/D61f396iYFpbGfx8Nh+K5JL/lKLdV2bz0tpNbnuuEiuaI1N1rn2TWM/a4pP7uUzNhJ0frn3Af1/6y3uoLWdAAAACAQBwAAAAhEBAg6dTIpaHj9+s3bsYkWg9YxobGpPqk5J/y0cMNEkVTr79ab19B6/6NFgFI560/1vA/qH7ZNBwAAAAJxAAAAgEBcBAadyry4Z5BODRq7UKyWnKk+a4z9pEr3/0TT/c9cw2CN+78BVy8I65n6h23TAQAAgEAcAAAAIBARIFiBGy4PahozSGM/Edrrve1/qvP9n7IPq4jKpCbGZsYsvg/qH7ZHBwAAAAJxAAAAAAAAAAAAAAAAgHVYfLoARHEyJWPzLkxEWdzY5JAe1llr33re/x6YHgNE5h8BAwBAIA4AAAAQiAgQzOQkhvFXxo+k/3+WPj/2u3KeKX3PnOdrrWfsdxU9nxmPab0nOfuQ83yt95nzmVp7O/azRe8vDgREowMAAACBOAAAAEAg3y29ACArtlEa+ZgSF2nxfK315JgSbewtTpMTfan1PlP+RqX7lpqzHqasE2AzdAAAACAQBwAAAAhEBAgqy7x0qedYQosYTKnqU26mTHqZ4VKt0rhU6/cp1fr9U9Xr00VplDI5irXTAQAAgEAcAAAAIBARIKiv9JKj1nGg0khG66lBc65nkMY8Stv3M0dEWsSoSk2J8cwZNyp9fs5YFNvWQ1wTbqYDAAAAgTgAAABAICJAUF/pZJLWWkcdSmNLOeuZss7SCNbYMznvU/r8VbUmDk18n7VM9UlNiWSIcwCh6AAAAEAgDgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMv7G9i5acpcIMLyAAAAAElFTkSuQmCC'\r\n    // loader.logo = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAACACAYAAAB9V9ELAAAHOElEQVR4nO3dvYodRxoG4G+WTZ0tzgRrjDZXNjB34AXpThzoQhzMndgg3cHAZM4lhBaUCWW+AG3iZuYUp7v6p/qnup4nnBl1V59CwftWVZ8IAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIiIuNl7ALTl69dvV3/+5fExIiJe3N5+X3L9L4+PN39f5+rvf/zxX0suv1jf8z+z6Pkj83+61PM/e45uvDfXrn/l70q7+rxzn3Psc811lvnnHP6x9wAAgO39c+8B0IYu+Xx4/y4iIv7zy38vkk6X2H/7+adF93n76fPVBPXh/bub5+PYOgldSX59SW9pKzd43b2ePx1HQenzHuU5L5h/jkgDAAANsgeAVaSJJ13jX5r0p3r76XNERHx8eLiJiHh5d3fx+9KJaGCt92Jtuc/U8UxYWy6yZr5gD0CRNfWpn+/Y+5Ua79nnn3PQAABAgzQAFJVb6986+Xf+99dfERFxnySlP//4/SYi4tXrNxGxSjK9ukbdWTt5rTWevRuAgfFcvV8nd9+l421l/jkHDQAANMgpAIroS/57Jf4+vyYJ5/7rt+8RT03A3F3SYxNoZ6uk1d3n2fjS8VyMs9Zd4gPPOWrNfSnzT400AADQIA0ARR01+f/7hx8i4mkvQKdrBLomIMqdwz7U2urA2vymSXltVxLvhQ0SrvmnGhoAAGiQBoBFuiTx7Jz/nsNZ7OPDQ0SMT4q589d7J78+B0jKW1k14Zp/aqYBAIAGaQCYpZZd/2OlewFypwKm7vquwNWkXGsSzCXcpcw/Z6ABAIAGaQBYpPbkn5pxKuCQu77H2vv8/AmYf6qlAQCABmkAoKBakl9q7TXzVph/aqIBAIAGaQCY5Szn/nPS9wK0qrbd4Bvu/odqaQAAoEEaAGZ5cXtb1e7/9DsAckacBjj7Lumz7AZfa/y1fy45Z5l/BmgAAKBBGgAooJa18Zzad4Pv9W5+80+NNAAA0CANADCkirXfE76b/yh8fiemAQCABmkAOLWpu//nsma6rYHPe5d385t/aqQBAIAGaQA4pa2SfzwlzrMruhZcMDGnn//W38pn/qmWBgAAGqQB4FQ2TP6tJKLSCbf09a7OwwbJ3/xTPQ0AADRIA8ApbJj8rzrLm+A6K+5qX5qcd9nln7P3/UtzqqENGgAAaJAGgKrtmPwvkmiXmGpPglslv6mf07NxHeVb6sw/1dMAAECDNADM8uXx8SYi4u2nz98jIn77+adN7rtV4r//Owl9fHi4iYh4eXeX/slRkuhaDvVcuW+p2yGBm3+qpwEAgAZpAJjlxe3tpvfba62/S/5psmxtrfSAa9tXE/jaTUCuiYCaaAAAoEEaAA5l7/P8S9W6G7yWRHslgR9qLd78UxMNAAA0SAPAIh/ev7s4DfBrZckn1e3+//OP328iIl69fpP7J7usRZdyJfkdIknnHOhUgPmnWhoAAGiQBoBZ0gTWnZe///qtyiYgPfffJf++BHf0tegZDvmO/Qk2TeLmnzPQAABAgzQALHK2c9F95/77HGgtepLcfB1tvH32TuLmn5ppAACgQRoAiup2z9eyF2DGrv+cwbXoztYJayDx1bpmfeFASdz8Uw0NAAA0SANAEWkCS5uAzt6NwH2ShNLkPzeZjViLvvj5Vol04Jz3xXg6J1r7PdqpgIufm3+OQAMAAA2y7sMq0uTx8eEhIiJe3t3tsjcgPeff7fbvlE4+S9dcp45nxCmMwfsuuN/FdQe+NXHw70rLveGu7/6lxnv2+eccNAAA0CANAJt4tjcgIiJevX6TrkVGxPJmIF3j75Ra659rxFpsZ+n/yVHXXfr8R28AcvfvbDXes80/56ABAIAGOQXAJgZ2SUfE0x6B9NTAVH1r/Hsl/07u+Z9Z9PwD170YR4N2fVe/+eeINAAA0CANAJsasft6UTKb+i7/ra39/Ln7rGDseHfZbzQheadWGe8J55+KaQAAAAAAAOCUvAeAIka8iWxXuW+LK32fzlr3m/o8Wz3/WqxpQ3n2AABAgzQAFHHlDWqpvm9HS3+fXqfv57l/1/f7qddPrzP4+4GkvXTcufPr6e+n/n2pn099zvTvfFsdbEQDAAAN8h4A1tKXPHMJdWySnfv7qdfvM7Y9WzuJ594cN/bvx34uY9+kV+rz3eXNfdACDQAANEgDwCwDu8m3Sm5zk3XOrDX0sWvTBXbj55qMpX8/9f5zzZq/Wk8x1M7ei3PSAABAgzQAzJXb7b20CcglzKV7BEpdPyKekmkuKRVMsHObjZyxyb5UkzD2+qWaB+axB+OENAAA0CANAHOt9X3m6fXnXi/XPPRdf+z9xr5vIHe+fez5+Qsrvglw6zX+9L45kigUogEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAoBH/B3e/aYAJzy67AAAAAElFTkSuQmCC'\r\n    loader.logoWidth = 3 * 256\r\n    loader.logoHeight = 3 * 64\r\n\r\n    // loader.playButtonText = 'make planetfall'\r\n    loader.startButtonFactory = () => {\r\n      let myButton = document.createElement('button');\r\n      myButton.textContent = 'Make Planetfall';\r\n      myButton.style.border = 'none'\r\n      myButton.style.display = 'block'\r\n      myButton.style.padding = '24px'\r\n      myButton.style.fontFamily = Game.font //'Helvetica'\r\n      myButton.style.color = 'white'\r\n      myButton.style.fontSize = '20pt'\r\n      myButton.style.fontWeight = '300'\r\n\r\n      myButton.style.backgroundColor = '#9a5e5c'\r\n\r\n\r\n      myButton.onmouseenter = () => {\r\n        myButton.style.backgroundColor = Color.Red.darken(0.5).toRGBA()\r\n      }\r\n      myButton.onmouseleave = () => { myButton.style.backgroundColor = '#9a5e5c' }\r\n      return myButton;\r\n    };\r\n\r\n    return super.start(loader).then(() => {\r\n      console.log(\"Osiris running.\")\r\n    });\r\n  }\r\n}","import { Color } from \"excalibur\";\r\n\r\n// an abstract/intangible thing (or at least something we don't represent)\r\nexport enum PureValue {\r\n    Power = 'Power',\r\n    Oxygen = 'Oxygen',\r\n    Water = 'Water',\r\n    Shelter = 'Shelter',\r\n    Hope = 'Hope',\r\n    Joy = 'Joy',\r\n    Wisdom = 'Wisdom',\r\n    Wealth = 'Wealth',\r\n    Beauty = 'Beauty',\r\n    Wonder = 'Wonder'\r\n}\r\n\r\nexport const allValues: PureValue[] = [\r\n    PureValue.Power,\r\n    PureValue.Oxygen,\r\n    PureValue.Water,\r\n    PureValue.Shelter,\r\n    PureValue.Hope,\r\n    PureValue.Joy,\r\n    PureValue.Wisdom,\r\n    PureValue.Wealth,\r\n    PureValue.Beauty,\r\n    PureValue.Wonder\r\n]\r\n\r\nexport type Economy = { [key in PureValue]: {\r\n    supply: number,\r\n    demand: number\r\n} }\r\n\r\nexport function emptyMarket() : Economy {\r\n    return {\r\n        Power: { supply: 0, demand: 0 },\r\n        Oxygen: { supply: 0, demand: 0 },\r\n        Water: { supply: 0, demand: 0 },\r\n        Shelter: { supply: 0, demand: 0 },\r\n        Hope: { supply: 0, demand: 0 },\r\n        Joy: { supply: 0, demand: 0 },\r\n        Wealth: { supply: 0, demand: 0 },\r\n        Wisdom: { supply: 0, demand: 0 },\r\n        Beauty: { supply: 0, demand: 0 },\r\n        Wonder: { supply: 0, demand: 0 },\r\n    }\r\n}\r\n\r\nexport function availableCapacity(market: Economy, value: PureValue) {\r\n    return Math.floor(market[value].supply - market[value].demand)\r\n}\r\n\r\nexport const sumMarkets: (ea: Economy, eb: Economy) => Economy = (ea, eb) => {\r\n    let newMarket = emptyMarket();\r\n    for (let value in PureValue) {\r\n        let { supply: sa, demand: da } = ea[value]\r\n        let { supply: sb, demand: db } = eb[value]\r\n        let supply = sa + sb\r\n        let demand = da + db\r\n        newMarket[value] = {\r\n            supply,\r\n            demand,\r\n        }\r\n    }\r\n    return newMarket\r\n}\r\n\r\nexport const equilibrium: (e: Economy) => boolean = (e) => {\r\n    return allValues.every(value => availableCapacity(e, value) >= 0)\r\n}\r\n\r\nexport enum ResourceBlock {\r\n    // base\r\n    Biomass = 'Biomass',\r\n    Ore = 'Ore',\r\n    Idea = 'Idea',\r\n\r\n    // derived\r\n    Meal = 'Meal',\r\n    Data = 'Data',\r\n    Mineral = 'Mineral',\r\n    Bioplasma = 'Bioplasma',\r\n\r\n    // higher-order\r\n    Alloy = \"Alloy\",\r\n    Algorithm = \"Algorithm\",\r\n\r\n    // superb\r\n    Argent = \"Argent\",\r\n    Aurum = \"Aurum\",\r\n\r\n    // hyperbolic\r\n    Omnium = \"Omnium\",\r\n}\r\n\r\nlet cStep = 0.3\r\nconst blockColors: { [key in ResourceBlock]: Color } = {\r\n    Biomass: Color.Green,\r\n    Data: Color.Blue.lighten(cStep),\r\n    Mineral: Color.Red,\r\n\r\n    Meal: Color.Yellow.darken(cStep),\r\n    Idea: Color.Blue.lighten(cStep*2), //.desaturate(cStep),\r\n    Ore: Color.Red.darken(cStep),\r\n\r\n    Bioplasma: Color.Viridian,\r\n\r\n    Alloy: Color.DarkGray.darken(cStep), //(cStep),\r\n    Algorithm: Color.Blue.darken(cStep), //.desaturate(cStep),\r\n\r\n    Argent: Color.Gray.lighten(cStep),\r\n    Aurum: Color.Orange.lighten(cStep),\r\n\r\n    Omnium: Color.White,\r\n}\r\n\r\nexport function blockColor(block: ResourceBlock) {\r\n    let baseColor = blockColors[block]\r\n    return baseColor.desaturate(0.1) //.lighten(0.1) //.desaturate(0.25).lighten(0.125)\r\n}\r\n\r\n","import { ResourceBlock, Economy, emptyMarket } from \"./Economy\";\r\nimport { Color, FontStyle, Resource } from \"excalibur\";\r\nimport { DeviceSize } from \"../values/DeviceSize\";\r\nimport { MechanicalOperation, mechanicalOperations } from \"./MechanicalOperation\";\r\nimport { shuffle, range, sample } from \"../Util\";\r\nimport { Device } from \"../actors/Device\";\r\nimport { doesNotReject } from \"assert\";\r\n\r\nconst bookshelfSvg = require('../images/bookshelf-plain.svg');\r\nconst vatSvg = require('../images/vat-plain.svg');\r\nconst benchSimple = require('../images/bench-simple-plain.svg');\r\nconst stove = require('../images/stove-plain.svg');\r\nconst cabin = require('../images/cabin-plain.svg');\r\nconst fire = require('../images/cooking-fire-plain.svg')\r\nconst bed = require('../images/bed-plain.svg')\r\nconst fridge = require('../images/fridge-plain.svg')\r\nconst server = require('../images/research-server-plain.svg')\r\nconst plant = require('../images/houseplant-plain.svg')\r\nconst workstation = require('../images/workstation-plain.svg')\r\n\r\nconst console = require('../images/console-plain.svg')\r\nconst consolePurple = require('../images/console-purple-plain.svg')\r\nconst consoleGreen = require('../images/console-green-plain.svg')\r\nconst consoleRed = require('../images/console-red-plain.svg')\r\nconst megaconsole = require('../images/mega-console-plain.svg')\r\n\r\nconst fabricator = require('../images/fabricator-plain.svg')\r\n\r\nconst couch = require('../images/couch-plain.svg')\r\nconst solar = require('../images/solar-collector-plain.svg')\r\nconst miner = require('../images/miner-plain.svg')\r\n\r\nconst statue = require('../images/statue-plain.svg')\r\nconst codex = require('../images/codex-plain.svg')\r\n\r\nconst lavaLamp = require('../images/lava-lamp-plain.svg')\r\nconst orrery = require('../images/orrery-plain.svg')\r\nconst telescope = require('../images/telescope-plain.svg')\r\nconst books = require('../images/books-plain.svg')\r\n\r\nconst greenhouse = require('../images/greenhouse-plain.svg')\r\nconst o2 = require('../images/oxygen-extractor-plain.svg')\r\nconst h20 = require('../images/water-condenser-plain.svg')\r\n\r\nconst minProcessor = require('../images/mineral-processor-plain.svg')\r\n\r\nconst images = {\r\n    bookshelf: bookshelfSvg,\r\n    vat: vatSvg,\r\n    bench: benchSimple,\r\n    stove,\r\n    cabin,\r\n    fire,\r\n    bed,\r\n    fridge,\r\n    server,\r\n    plant,\r\n    workstation,\r\n\r\n    console,\r\n    consolePurple,\r\n    consoleGreen,\r\n    consoleRed,\r\n    megaconsole,\r\n\r\n    fabricator,\r\n\r\n    couch,\r\n    solar,\r\n    miner,\r\n    statue,\r\n\r\n    codex,\r\n    lavaLamp,\r\n    orrery,\r\n    telescope,\r\n    books,\r\n    greenhouse,\r\n\r\n    o2,\r\n    h20,\r\n\r\n    minProcessor,\r\n\r\n}\r\n\r\n\r\nconst { Red, Green, Blue, Orange, Violet, Yellow } = Color;\r\n\r\nlet { store, generate, recipe, spawn, accelerateTime, explore } = mechanicalOperations\r\n\r\nexport class Machine {\r\n    name: string = '(machine name)'\r\n    description: string = '(machine description)'\r\n    color: Color = Color.LightGray\r\n\r\n    cost: ResourceBlock[] = [ResourceBlock.Mineral]\r\n\r\n    size: DeviceSize = DeviceSize.Small\r\n    operation: MechanicalOperation = { type: 'noop' }\r\n    image = images.vat\r\n    prereqs: (typeof Machine)[] = []\r\n    economy: Economy = emptyMarket()\r\n    forDome: boolean = false\r\n    hide: boolean = false\r\n\r\n    capacity: boolean\r\n\r\n    isVehicle: boolean = false\r\n\r\n    tinySlots: boolean = false\r\n    isEatingSurface: boolean = false\r\n\r\n    concretize(): Machine { return this; } \r\n\r\n    onPlacement(device: Device) {\r\n        // ...whatever we need to script here?\r\n    }\r\n}\r\n\r\nexport class CommandCenter extends Machine {\r\n    name = 'Command Console'\r\n    description = 'commander, we need your help'\r\n    operation = store(\r\n        [ResourceBlock.Mineral, ResourceBlock.Ore], //,ResourceBlock.Biomass],\r\n        24\r\n    )\r\n    image = images.megaconsole\r\n    size = DeviceSize.Medium\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 1, demand: 0 },\r\n        Oxygen: { supply: 10, demand: 0 },\r\n        Water: { supply: 1, demand: 0 },\r\n        Hope: { supply: 1, demand: 0 },\r\n        Shelter: { supply: 1, demand: 0}\r\n    }\r\n\r\n    onPlacement(device: Device) {\r\n        device.built = true\r\n        for (let i in range(20)) {\r\n            device.produceResource(ResourceBlock.Mineral)\r\n        }\r\n        let { building } = device\r\n        building.populate(device.pos.add(building.pos), true)\r\n    }\r\n}\r\n\r\nexport class MissionLog extends Machine {\r\n    name = 'Mission Log'\r\n    description = 'gather data'\r\n    operation = store(\r\n        [ResourceBlock.Data],\r\n        8\r\n    )\r\n    image = images.consolePurple\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 0.1 },\r\n        Hope: { supply: 1, demand: 0 }\r\n    }\r\n}\r\n\r\n//export class Energon extends Machine {\r\n//    name = 'Energon'\r\n//    description = 'food paste'\r\n//}\r\n\r\n// tiny\r\nexport class LavaLamp extends Machine {\r\n    name = 'Lava Lamp'\r\n    description = 'mesmerizing'\r\n    size = DeviceSize.Tiny\r\n    prereqs = [ Table ]\r\n    image  = images.lavaLamp\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Joy: { supply: 1, demand: 0 },\r\n        Power: { supply: 0, demand: 0.1 },\r\n    }\r\n}\r\n\r\nexport class Figurine extends Machine {\r\n    name = 'Figurine'\r\n    description = 'not an action figure'\r\n    size = DeviceSize.Tiny\r\n    prereqs = [ Table ]\r\n    image = images.statue   \r\n    economy = {\r\n        ...emptyMarket(),\r\n        Beauty: { supply: 0.1, demand: 0 },\r\n    }\r\n}\r\n\r\nexport class Orrery extends Machine {\r\n    name = 'Orrery'\r\n    description = 'to the stars'\r\n    size = DeviceSize.Tiny\r\n    prereqs = [ Table ]\r\n    image = images.orrery\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Wonder: { supply: 0.1, demand: 0 },\r\n    }\r\n}\r\n\r\nexport class Books extends Machine {\r\n    name = 'Books'\r\n    description = 'all there in black and white'\r\n    operation = generate(ResourceBlock.Idea, 2)\r\n    size = DeviceSize.Tiny\r\n    prereqs = [ Table ]\r\n    image = images.books\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Wisdom: { supply: 0.1, demand: 0 },\r\n    }\r\n}\r\n\r\n// small\r\n/// small surface\r\n\r\nexport class OxygenExtractor extends Machine {\r\n    name = 'O2 Extractor'\r\n    description = 'breathe deep'\r\n    image = images.o2\r\n    prereqs = [ WaterCondensingMachine, SolarCell ]\r\n    forDome = true\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Oxygen: { supply: 6, demand: 0 },\r\n        Power: { supply: 0, demand: 1 },\r\n    }\r\n}\r\n\r\nexport class SolarCell extends Machine {\r\n    name = 'Solar Cell'\r\n    description = 'feel the warmth'\r\n    image = images.solar\r\n    prereqs = [ Bed ] \r\n\r\n    forDome = true\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 10, demand: 0 },\r\n    }\r\n}\r\n\r\n\r\nexport class WaterCondensingMachine extends Machine {\r\n    name = 'H2O Condenser'\r\n    description = 'have a drink'\r\n// setup a loop here so we have to get survival I?\r\n    prereqs = [ SolarCell, OxygenExtractor ]\r\n    image = images.h20\r\n\r\n    forDome = true\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Water: { supply: 5, demand: 0 },\r\n        Power: { supply: 0, demand: 1 },\r\n    }\r\n}\r\n\r\nexport class Telescope extends Machine {\r\n    name = 'Telescope'\r\n    description = 'look to the stars'\r\n    prereqs = [ Orrery ]\r\n    forDome = true\r\n    image = images.telescope\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Wisdom: { supply: 1, demand: 0 },\r\n    } \r\n}\r\n\r\n\r\n// /// small subsurface\r\n\r\nexport class Table extends Machine {\r\n    name = 'Table'\r\n    description = 'a simple table'\r\n    image = images.bench\r\n    isEatingSurface = true\r\n    // this device provides slots for tiny-sized deviecs\r\n    tinySlots = true\r\n}\r\n\r\nexport class Statue extends Machine {\r\n    name = 'Statue'\r\n    description = 'for honor'\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Hope: { supply: 0.1, demand: 0 },\r\n        Beauty: { supply: 1, demand: 0 },\r\n    }\r\n    image = images.statue\r\n    prereqs = [ Figurine ]\r\n}\r\n\r\nexport class StudyMachine extends Machine {\r\n    operation = recipe(\r\n        [ ResourceBlock.Idea, ResourceBlock.Idea, ResourceBlock.Idea ],\r\n        ResourceBlock.Data\r\n    )\r\n    color = Blue\r\n    concretize(): Machine { return new Workstation() } //(sample([Workstation, Desk]))() }\r\n}\r\n\r\n// export class Desk extends StudyMachine {\r\n//     name = 'Desk'\r\n//     description = 'get to work'\r\n//     image = images.bench\r\n//     prereqs = [ OxygenExtractor ]\r\n//     concretize() { return this }\r\n// }\r\n\r\nexport class Codex extends Machine {\r\n    name = 'Codex'\r\n    description = 'read it closely'\r\n    image = images.codex\r\n    prereqs = [ Bookshelf ]\r\n    operation = store([ResourceBlock.Data], 3)\r\n    color = Blue\r\n    // concretize() { return this }\r\n}\r\n\r\nexport class Workstation extends StudyMachine {\r\n    name = 'Workstation'\r\n    description = 'hackety hack'\r\n    prereqs = [ Bookshelf ]\r\n    image = images.workstation\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 1 },\r\n    }\r\n    concretize() { return this }\r\n}\r\n\r\nexport class Couch extends Machine {\r\n    name = 'Couch'\r\n    description = 'take it easy'\r\n    prereqs = []\r\n    image = images.couch\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Joy: { supply: 0.1, demand: 0 },\r\n    }\r\n}\r\n\r\n\r\n\r\nexport class Bookshelf extends Machine {\r\n    name = 'Shelf'\r\n    description = 'brainstorm'\r\n    operation = generate(ResourceBlock.Idea)\r\n    image = images.bookshelf\r\n    prereqs = [ Books, Codex ] // setup a loop...\r\n    color = Blue\r\n}\r\n\r\n\r\nexport class Fridge extends Machine {\r\n    name = 'Fridge'\r\n    description = 'store meals'\r\n    operation = store([ResourceBlock.Meal], 6)\r\n    image = images.fridge\r\n    prereqs = [Bookshelf]\r\n    color = Yellow\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 1 },\r\n    }\r\n}\r\n\r\nexport class Stove extends Machine {\r\n    name = 'Stove'\r\n    description = 'make a meal'\r\n    operation = recipe(\r\n        [ResourceBlock.Biomass, ResourceBlock.Biomass],\r\n        ResourceBlock.Meal\r\n    )\r\n    image = images.stove\r\n\r\n    prereqs = [Bookshelf, Fridge]\r\n    color = Yellow\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 1 },\r\n    }\r\n}\r\n\r\nexport class Bed extends Machine {\r\n    name = 'Bed'\r\n    description = 'sweet dreams'\r\n    image = images.bed\r\n    prereqs = [ OxygenExtractor ]\r\n    color = Orange\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Shelter: { supply: 1, demand: 0 },\r\n    }\r\n}\r\n\r\nexport class Houseplant extends Machine {\r\n    name = 'House Plant'\r\n    description = 'so nice'\r\n    prereqs = [ Botany, Bed ]\r\n    // produces = ResourceBlock.Food\r\n    cost = [ ResourceBlock.Biomass ]\r\n    operation = generate(ResourceBlock.Biomass, 1)\r\n    color = Green\r\n    image = images.plant\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Oxygen: { supply: 1, demand: 0 },\r\n        Water: { supply: 0, demand: 0.1 },\r\n    }\r\n}\r\n\r\nexport class PersonnelRegistry extends Machine {\r\n    name = 'Personnel Registry'\r\n    description = 'track everybody'\r\n    prereqs = [ CloningVat ]\r\n    operation = store([ResourceBlock.Data], 4)\r\n    color = Yellow\r\n    image = images.console\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 0.1 },\r\n        Wisdom: { supply: 1, demand: 0 },\r\n    }\r\n\r\n    // onPlacement(device: Device) {\r\n    //     device.building.planet\r\n    // }\r\n}\r\n\r\nexport class OrientationConsole extends Machine {\r\n    name = 'Orientation Console'\r\n    description = 'welcome to the colony'\r\n    prereqs = [CloningVat]\r\n    operation = generate(ResourceBlock.Data, 1)\r\n    image = images.consoleRed\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 0.1 },\r\n        Hope: { supply: 1, demand: 0 },\r\n    }\r\n}\r\n\r\nexport class CloningVat extends Machine {\r\n    name = 'Cloning Vat'\r\n    description = 'we all grow'\r\n    // behavior = MachineOperation.SpawnCitizen \r\n    operation = spawn()\r\n    productionTime = 1500\r\n    image = images.vat\r\n    prereqs = [AlgaeVat]\r\n    size = DeviceSize.Small\r\n    color = Violet\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 2 },\r\n    }\r\n}\r\n\r\nexport class DissolutionVat extends Machine {\r\n    name = 'Dissolution Vat'\r\n    description = 'back to basics'\r\n    // behavior = MachineOperation.SpawnCitizen \r\n    operation = recipe(\r\n        [ ResourceBlock.Biomass, ResourceBlock.Biomass ],\r\n        ResourceBlock.Bioplasma\r\n    )\r\n    productionTime = 1500\r\n    image = images.vat\r\n    prereqs = [PlasmaBank]\r\n    size = DeviceSize.Small\r\n    color = Violet\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 1 },\r\n    }\r\n}\r\n\r\nexport class PlasmaBank extends Machine {\r\n    name = 'Bioplasm Bank'\r\n    description = 'hold on'\r\n    operation = store([ ResourceBlock.Bioplasma ])\r\n    prereqs = [AlgaeVat]\r\n    color = Green\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 1 },\r\n    }\r\n}\r\n\r\n    \r\nexport class Fabricator extends Machine {\r\n    name = 'Fabricator'\r\n    description = 'you made that'\r\n    operation = recipe(\r\n        [ResourceBlock.Mineral, ResourceBlock.Mineral],\r\n         ResourceBlock.Alloy\r\n    )\r\n    size = DeviceSize.Small\r\n    color = Red\r\n    prereqs = [Workstation]\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 3 },\r\n    }\r\n    image = images.fabricator\r\n}\r\n\r\nexport class AlgaeVat extends Machine {\r\n    name = 'Algae Vat'\r\n    description = 'where there is a will'\r\n    operation = generate(ResourceBlock.Biomass)\r\n    prereqs = [ OxygenExtractor, Bookshelf, Fridge ]\r\n    size = DeviceSize.Small\r\n    color = Violet\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 2 },\r\n    }\r\n}\r\n\r\nexport class LifeSciencesConsole extends Machine {\r\n    name = 'Life Sciences Console'\r\n    description = 'mind and body together'\r\n    operation = store([ResourceBlock.Biomass, ResourceBlock.Data], 5)\r\n    prereqs = [Houseplant, Botany]\r\n    color = Green\r\n    image = images.consoleGreen\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 0.2 },\r\n    }\r\n}\r\n\r\n// medium\r\n\r\nexport class Miner extends Machine {\r\n    name = 'Miner (Rover)'\r\n    description = 'mobile drill unit'\r\n\r\n    // gather actually takes the machine/citizen around?\r\n    operation = explore(ResourceBlock.Ore, 2)\r\n\r\n    prereqs = [MineralProcessor, MiningDrill]\r\n    color = Red\r\n    size = DeviceSize.Medium\r\n    isVehicle = true\r\n    image = images.miner\r\n}\r\n\r\nexport class MetalStorage extends Machine {\r\n    name = 'Metal Storage'\r\n    description = 'contain minerals and alloys?'\r\n    operation = store([ResourceBlock.Mineral, ResourceBlock.Alloy], 8)\r\n    prereqs = [Bookshelf]\r\n    color = Red\r\n    size = DeviceSize.Medium\r\n}\r\n\r\nexport class ResearchServer extends Machine {\r\n    name = 'Research Server'\r\n    description = 'hold data'\r\n    operation = store([ResourceBlock.Data, ResourceBlock.Algorithm], 10)\r\n    image = images.server\r\n    prereqs = [Bookshelf, Workstation]\r\n    size = DeviceSize.Medium\r\n    color = Blue\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 4 },\r\n    }\r\n}\r\n\r\nexport class Greenhouse extends Machine {\r\n   name = 'Greenhouse'\r\n   description = 'grow some food'\r\n   operation = generate(ResourceBlock.Biomass)\r\n   size = DeviceSize.Medium\r\n   prereqs = [AlgaeVat]\r\n   color = Green\r\n    forDome = true\r\n    image = images.greenhouse\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 1 },\r\n        Water: { supply: 0, demand: 1 },\r\n        Oxygen: { supply: 4, demand: 0 },\r\n    }\r\n}\r\n\r\n\r\nexport class Cabin extends Machine {\r\n   name = 'Cabin'\r\n   description = 'home on the plains'\r\n   operation = recipe(\r\n       [ ResourceBlock.Biomass, ResourceBlock.Biomass ],\r\n       ResourceBlock.Meal\r\n   )\r\n   image = images.cabin\r\n   prereqs = [Orchard]\r\n   size = DeviceSize.Medium\r\n   color = Orange\r\n    forDome = true\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 1 },\r\n        Water: { supply: 0, demand: 1 },\r\n        Shelter: { supply: 4, demand: 0 },\r\n    }\r\n}\r\n\r\nexport class Arbor extends Machine {\r\n    name = 'Arbor'\r\n    description = 'arbor around the clock'\r\n    operation = generate(ResourceBlock.Biomass)\r\n    prereqs = [Orchard]\r\n    size = DeviceSize.Medium\r\n    color = Green\r\n    forDome = true\r\n}\r\n\r\n\r\nexport class Botany extends Machine {\r\n    name = 'Botany'\r\n    description = 'plant lab'\r\n    operation = generate(ResourceBlock.Biomass)\r\n    prereqs = [ OxygenExtractor, Bookshelf ]\r\n    size = DeviceSize.Medium\r\n    color = Green\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 1 },\r\n    }\r\n}\r\n\r\n\r\nexport class MineralProcessor extends Machine {\r\n    name = 'Mineral Processor'\r\n    description = 'wheat from the chaff'\r\n    operation = recipe(\r\n        [ResourceBlock.Ore, ResourceBlock.Ore, ResourceBlock.Ore],\r\n         ResourceBlock.Mineral\r\n    )\r\n    size = DeviceSize.Medium\r\n    color = Red\r\n    image = images.minProcessor\r\n    prereqs = [Workstation, Fabricator]\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 2 },\r\n    }\r\n}\r\n\r\nexport class ThinkingFountain extends Machine {\r\n    name = 'Thinking Fountain'\r\n    description = 'slowly growing'\r\n    size = DeviceSize.Medium\r\n    prereqs = [ Mainframe, Megafabricator, MolecularEngine ]\r\n    color = Color.fromHex('daa520')\r\n    operation = generate(ResourceBlock.Aurum, 8)\r\n    cost = [ResourceBlock.Aurum]\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Wisdom: { supply: 2, demand: 0 },\r\n        Wonder: { supply: 1, demand: 0 }\r\n    }\r\n}\r\n\r\nexport class SilverForest extends Machine {\r\n    name = 'Silver Forest'\r\n    description = 'immense serenity'\r\n    size = DeviceSize.Medium\r\n    prereqs = [ Megafabricator, Mainframe ]\r\n    color = Color.fromHex('c0c0c0')\r\n    operation = store([ResourceBlock.Argent], 12)\r\n    cost = [ResourceBlock.Alloy, ResourceBlock.Algorithm]\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Beauty: { supply: 2, demand: 0 },\r\n        Wonder: { supply: 1, demand: 0 }\r\n    }\r\n    forDome = true\r\n}\r\n\r\nexport class TimeCrystal extends Machine {\r\n    name = 'Time Crystal'\r\n    description = 'xlr8'\r\n    size = DeviceSize.Medium\r\n    color = Color.fromHex('e5e4e2')\r\n    operation = accelerateTime()\r\n    cost = [ResourceBlock.Omnium]\r\n    prereqs = [ Megafabricator, SilverForest ]\r\n}\r\n\r\nexport class HoloProjector extends Machine {\r\n    name = 'Holo Projector'\r\n    description = 'whatever your heart desires'\r\n    size = DeviceSize.Medium\r\n    color = Blue\r\n    operation = generate(ResourceBlock.Data, 3)\r\n    cost = [ResourceBlock.Algorithm, ResourceBlock.Mineral]\r\n    prereqs = [ Mainframe ]\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 2 },\r\n        Joy: { supply: 3, demand: 0 },\r\n    }\r\n}\r\n\r\nexport class SacredGrove extends Machine {\r\n    name = 'Sacred Grove'\r\n    description = 'where the furies play'\r\n    size = DeviceSize.Medium\r\n    forDome = true\r\n    cost = [ ResourceBlock.Omnium ]\r\n    prereqs = [ AtomicCompiler ]\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Oxygen: { supply: 4, demand: 0 },\r\n        Wonder: { supply: 1, demand: 0 },\r\n    }\r\n}\r\n\r\nexport class AtomicCompiler extends Machine {\r\n    name = 'Atomic Compiler'\r\n    description = 'super position'\r\n    operation = recipe(\r\n        [ ResourceBlock.Aurum, ResourceBlock.Argent ],\r\n        ResourceBlock.Omnium\r\n    )\r\n    cost = [ ResourceBlock.Argent, ResourceBlock.Algorithm ]\r\n    prereqs = [ ThinkingFountain, SilverForest ]\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 3 },\r\n    }\r\n}\r\n\r\n\r\n// large devices!\r\n\r\nexport class Orchard extends Machine {\r\n   name = 'Orchard'\r\n   description = 'grow some food'\r\n   operation = generate(ResourceBlock.Biomass, 10)\r\n   size = DeviceSize.Large\r\n   prereqs = [AlgaeVat]\r\n   color = Green\r\n    forDome = true\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 1 },\r\n        Water: { supply: 0, demand: 1 },\r\n        Oxygen: { supply: 2, demand: 0 },\r\n    }\r\n}\r\n\r\n\r\nexport class MiningDrill extends Machine {\r\n    name = 'Mining Drill'\r\n    description = 'ore away'\r\n    operation = generate(ResourceBlock.Ore)\r\n    size = DeviceSize.Large\r\n    prereqs = [ Fabricator ]\r\n    image = images.miner\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 5 },\r\n    }\r\n}    \r\n\r\nexport class Megafabricator extends Machine {\r\n    name = 'Mega-Fabricator'\r\n    size = DeviceSize.Large\r\n    prereqs = [ Fabricator ]\r\n    color = Red\r\n    operation = recipe(\r\n        [ResourceBlock.Alloy, ResourceBlock.Algorithm],\r\n        ResourceBlock.Argent\r\n    )\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 8 },\r\n    }\r\n}\r\n\r\nexport class MolecularEngine extends Machine {\r\n    name = 'Molecular Engine'\r\n    size = DeviceSize.Large\r\n    prereqs = [ Megafabricator ]\r\n    color = Violet\r\n    operation = recipe(\r\n        [ResourceBlock.Bioplasma, ResourceBlock.Algorithm],\r\n        ResourceBlock.Aurum\r\n    )\r\n    image = images.megaconsole\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 3 },\r\n        Water: { supply: 0, demand: 1 },\r\n    }\r\n}\r\n\r\nexport class Mainframe extends Machine {\r\n    name = 'Mainframe'\r\n    size = DeviceSize.Large\r\n    color = Blue\r\n    prereqs = [ResearchServer]\r\n    cost = [ ResourceBlock.Mineral, ResourceBlock.Mineral ]\r\n    operation = recipe(\r\n        [ ResourceBlock.Data, ResourceBlock.Data ],\r\n        ResourceBlock.Algorithm\r\n    )\r\n    image = images.server\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 6 },\r\n    }\r\n}\r\n\r\nexport class Preserve extends Machine {\r\n    name = 'Nature Preserve'\r\n    size = DeviceSize.Large\r\n    prereqs = [ Arbor ]\r\n    color = Green\r\n    forDome = true\r\n    operation = generate(ResourceBlock.Biomass, 12)\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Water: { supply: 0, demand: 4 },\r\n        Oxygen: { supply: 12, demand: 0 },\r\n    }\r\n}\r\n\r\nexport class LogicPool extends Machine {\r\n    name = 'Logic Pool'\r\n    size = DeviceSize.Large\r\n    prereqs = [ MolecularEngine ]\r\n    color = Color.fromHex('daa520')\r\n    operation = store([ResourceBlock.Aurum], 12)\r\n    cost = [ResourceBlock.Algorithm, ResourceBlock.Bioplasma]\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Wisdom: { supply: 2, demand: 0 },\r\n        Wonder: { supply: 1, demand: 0 }\r\n    }\r\n}\r\n\r\nexport class Cathedral extends Machine {\r\n    name = 'Cathedral'\r\n    description = 'first ultrahumanist'\r\n    size = DeviceSize.Large\r\n    prereqs = [ SacredGrove ]\r\n}\r\n\r\n\r\n/// huge devices\r\n\r\nexport class Microcity extends Machine {\r\n    name = 'Microcity'\r\n    size = DeviceSize.Huge\r\n    prereqs = [ Megafabricator ]\r\n    color = Orange\r\n    forDome = true\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Water: { supply: 0, demand: 2 },\r\n        Power: { supply: 0, demand: 2 },\r\n        Joy: { supply: 5, demand: 0 },\r\n        Hope: { supply: 5, demand: 0 },\r\n        Beauty: { supply: 1, demand: 0 },\r\n        Wonder: { supply: 1, demand: 0 },\r\n    }\r\n}\r\n\r\nexport class LogicCrystal extends Machine {\r\n    name = 'Logic Crystal'\r\n    size = DeviceSize.Huge\r\n    prereqs = [ Megafabricator ]\r\n    color = Blue\r\n}\r\n\r\n// export class MiniSun extends Machine {}\r\n\r\nexport const allMachines: (typeof Machine)[] = [\r\n    AlgaeVat,\r\n    Arbor,\r\n    Bed,\r\n    Bookshelf,\r\n    Cabin,\r\n    CloningVat,\r\n    // Desk,\r\n    Fabricator,\r\n    Fridge,\r\n    Houseplant,\r\n    Megafabricator,\r\n    MiningDrill,\r\n    Orchard,\r\n    OxygenExtractor,\r\n    Preserve,\r\n    ResearchServer,\r\n    SolarCell,\r\n    Stove,\r\n    WaterCondensingMachine,\r\n    Workstation,\r\n    Microcity,\r\n    LogicCrystal,\r\n    Botany,\r\n\r\n    MineralProcessor,\r\n    PlasmaBank,\r\n    DissolutionVat,\r\n    MetalStorage,\r\n    Mainframe,\r\n\r\n    PersonnelRegistry,\r\n    MolecularEngine,\r\n    ThinkingFountain,\r\n    SilverForest,\r\n\r\n    OrientationConsole,\r\n    LifeSciencesConsole,\r\n\r\n    TimeCrystal,\r\n    LogicPool,\r\n    HoloProjector,\r\n    Cathedral,\r\n    SacredGrove,\r\n    AtomicCompiler,\r\n\r\n    Couch,\r\n    Statue,\r\n    Codex,\r\n\r\n    Table,\r\n    LavaLamp,\r\n\r\n    Figurine,\r\n\r\n    Miner,\r\n    Orrery,\r\n    Telescope,\r\n    Books,\r\n]","\r\nexport enum Orientation { Left, Up, Right, Down } //, Angle }\r\n\r\nexport const compass = [\r\n    Orientation.Left,\r\n    Orientation.Right,\r\n    Orientation.Up,\r\n    Orientation.Down,\r\n]\r\n\r\n\r\nexport function flip(orientation: Orientation): Orientation {\r\n    switch (orientation) {\r\n        case Orientation.Left: return Orientation.Right\r\n        case Orientation.Right: return Orientation.Left\r\n        case Orientation.Up: return Orientation.Down\r\n        case Orientation.Down: return Orientation.Up\r\n    }\r\n    throw new Error(`Don't know orientation ${ orientation }`)\r\n}","import { Actor, Vector, CollisionType, Color, Label, Traits, FontStyle } from \"excalibur\";\r\nimport { Planet } from \"../Planet/Planet\";\r\nimport { Structure, } from \"../../models/Structure\";\r\nimport { Slot } from \"../../values/Slot\";\r\nimport { Orientation, flip, compass } from \"../../values/Orientation\";\r\nimport { Game } from \"../../Game\";\r\nimport { Rectangle } from \"../../values/Rectangle\";\r\nimport { closest, measureDistance, deleteByValue, containsUniq, flatSingle } from \"../../Util\";\r\nimport { Graph } from \"../../values/Graph\";\r\nimport { ResourceBlock, emptyMarket, Economy, sumMarkets, equilibrium, allValues, availableCapacity } from \"../../models/Economy\";\r\nimport { Device } from \"../Device\";\r\nimport { allSpaceFunctions, RoomRecipe } from \"../../models/RoomRecipe\";\r\nimport { DeviceSize, getVisibleDeviceSize } from \"../../values/DeviceSize\";\r\nimport { World } from \"../../models/World\";\r\nimport { Machine, allMachines, CommandCenter, MissionLog, StudyMachine } from \"../../models/Machine\";\r\nimport { BackgroundPattern } from \"./BackgroundPatterns\";\r\nimport { EconomicValue } from \"../Hud/EconomicValue\";\r\nimport { drawRect, pathFromRect } from \"../../Painting\";\r\n\r\nexport class DevicePlace {\r\n    constructor(private pos: Vector, private size: DeviceSize) {}\r\n    get position() { return this.pos }\r\n    get visibleSize() { return getVisibleDeviceSize(this.size) }\r\n\r\n}\r\n\r\nexport class Building extends Actor {\r\n    edgeWidth: number = 0\r\n\r\n    nameLabel: Label\r\n\r\n    placed: boolean = false\r\n    hover: boolean = false\r\n    showLabel: boolean = false\r\n    facing: Orientation = Orientation.Right\r\n    hideBox: boolean = false\r\n    parentSlot: Slot\r\n    childrenBuildings: Building[] = []\r\n\r\n    spaceFunction: RoomRecipe\r\n\r\n    private devices: Device[] = []\r\n    givenName: string\r\n\r\n\r\n    private active: boolean = true\r\n    // private built: boolean = false\r\n\r\n    constructor(pos: Vector, public structure: Structure, public planet: Planet) {\r\n        super(\r\n          pos.x,\r\n          pos.y,\r\n          structure.width,\r\n          structure.height,\r\n          structure.infra ? planet.color.darken(0.3) : Color.Transparent\r\n        )\r\n        this.anchor = new Vector(0,0)\r\n\r\n        this.setup();\r\n        this.traits = this.traits.filter(trait => !(trait instanceof Traits.OffscreenCulling))\r\n\r\n        this.on('pointerenter', () => {\r\n            this.hover = true\r\n            if (!this.devices.some(d => d.hover)) {\r\n                this.planet.currentlyViewing = this\r\n            }\r\n        })\r\n\r\n\r\n        this.on('pointerdown', () => {\r\n            // console.log(\"CLICKED BUILDING\", { building: this })\r\n            this.toggleActive();\r\n        })\r\n\r\n        this.on('pointerleave', () => {\r\n            this.hover = false\r\n        })\r\n\r\n        this.collisionType = CollisionType.PreventCollision\r\n\r\n        this.nameLabel = new Label(this.structure.name, 0, 0, Game.font) // 'Helvetica')\r\n        this.nameLabel.fontSize = 9\r\n        // this.nameLabel.fontStyle = FontStyle.Italic\r\n        this.nameLabel.color = Color.White\r\n\r\n        if (this.structure.infra) { this.active = true }\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        if (!this.hideBox) {\r\n            drawRect(ctx, this.aabb(), this.edgeWidth, this.processedColor())\r\n        }\r\n        // this.devices.forEach(device => device.draw(ctx, delta))\r\n        super.draw(ctx, delta)\r\n\r\n        if (this.showLabel && this.spaceFunction) {\r\n            this.nameLabel.pos = this.pos.add(new Vector(28, 24)) //get getCenter().\r\n            // this.nameLabel.color = Color.White\r\n            // this.nameLabel.pos.x = this.getCenter().x //ctx.measureText(this.structure.name).width / 2\r\n            // this.nameLabel.pos.x -= ctx.measureText(this.structure.name).width / 2\r\n            this.nameLabel.draw(ctx, delta)\r\n\r\n        }\r\n\r\n        // let debug = true;\r\n        if (Game.debugPath) {\r\n            if (this.slots().length > 0) {\r\n                // draw slots\r\n                this.slots().forEach((slot: Slot) => {\r\n                    let rect: Rectangle = { x: slot.pos.x, y: slot.pos.y, width: 3, height: 3 }\r\n                    drawRect(ctx, rect, 1, Color.Gray.lighten(0.5))\r\n                })\r\n            }\r\n         if (this.nodes().length > 0) {\r\n                // draw nodes\r\n                this.nodes().forEach((node: Vector) => {\r\n                    let rect: Rectangle = { x: node.x, y: node.y, width: 4, height: 4 }\r\n                    drawRect(ctx, rect, 1, Color.Yellow.lighten(0.5))\r\n                })\r\n            }\r\n\r\n        }\r\n\r\n        let showDevicePlaces = false\r\n        if (showDevicePlaces && this.devicePlaces().length > 0 && this.devices.length < this.devicePlaces().length) {\r\n            this.devicePlaces().forEach(p => {\r\n                let place = p.position\r\n                let sz = p.visibleSize\r\n                drawRect(ctx,\r\n                    { x: place.x - sz/2, y: place.y - sz/2, width: sz, height: sz },\r\n                    0.1,\r\n                    Color.White,\r\n                    false,\r\n                    true\r\n                )\r\n            })\r\n        }\r\n    }\r\n\r\n\r\n    step: number = 0\r\n    update(engine: Game, delta: number) {\r\n        super.update(engine, delta)\r\n\r\n        let tryProduce = this.placed;\r\n        if (tryProduce) {\r\n            this.devices.forEach(device => {\r\n                device.tryProduce(this.step)\r\n                if(device.tinyDevices.length > 0) {\r\n                    device.tinyDevices.forEach(tinyDevice => tinyDevice.tryProduce(this.step))\r\n                }\r\n            });\r\n\r\n        }\r\n\r\n        // this.devices.forEach(d => d.update(engine, delta))\r\n\r\n        this.step += 1\r\n    }\r\n\r\n\r\n    poly() { return this.aabbPoly() }\r\n\r\n\r\n    get name() {\r\n        if (this.spaceFunction) {\r\n            return this.spaceFunction.name\r\n        } else {\r\n            return this.structure.name\r\n        }\r\n    }\r\n\r\n    get description() {\r\n        if (this.spaceFunction) {\r\n            return this.spaceFunction.description\r\n        } else {\r\n            return this.structure.description\r\n        }\r\n    }\r\n\r\n    get floorY() {\r\n        return this.pos.y + this.getHeight() //().y\r\n    }\r\n\r\n    economy(emptyUnlessActive: boolean = true): Economy {\r\n        if (emptyUnlessActive && !this.isActive) {\r\n            return emptyMarket()\r\n        } else {\r\n            let machineEconomies = this.devices.map(d => d.economy)\r\n            //machine.economy)\r\n\r\n            let buildingEconomy = {\r\n                ...emptyMarket(),\r\n                Oxygen: { demand: 1, supply: 0 }, // structural demand\r\n                // Water: { demand: 0.1, supply: 0 },\r\n            }\r\n\r\n            let aggregate = [...machineEconomies, buildingEconomy]\r\n                .reduce(sumMarkets, emptyMarket())\r\n\r\n            return aggregate\r\n        }\r\n    }\r\n\r\n    private toggleActive() {\r\n        if (!this.structure.infra) {\r\n            if (this.active) {\r\n                if (this.devices.some(d => d.inUse)) { return }\r\n                let wasEquil = equilibrium(this.planet.economy)\r\n                this.active = false\r\n                if (wasEquil) {\r\n                    if (!equilibrium(this.planet.economy)) {\r\n                        this.active = true\r\n                        // return\r\n                    }\r\n                    // this.active = true\r\n                } else {\r\n                    // we weren't at equilibrium previously\r\n                    // permit it, if we don't have any supply that would go negative without us?\r\n                    // console.log(\"can we toggle?\")\r\n                    for (let value of allValues) {\r\n                        let localCap = availableCapacity(this.economy(false), value)\r\n                        let globalCap = availableCapacity(this.planet.economy, value)\r\n                        // console.log(\"value\", { value, localCap, globalCap})\r\n                        if (localCap > 0 && globalCap < 0) {\r\n                            // don't permit it to be turned off\r\n                            this.active = true\r\n                        }\r\n                    }\r\n                }\r\n            } else { // this.active is false now\r\n                let agg = [\r\n                    this.planet.economy,\r\n                    this.economy(false)\r\n                ].reduce(sumMarkets, emptyMarket())\r\n\r\n                if (equilibrium(agg)) {\r\n                    this.active = true\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    get isActive() { return !!this.active }\r\n\r\n\r\n    setup(): void { }\r\n\r\n    constrainCursor(cursor: Vector): Vector {\r\n        return cursor.clone();\r\n    }\r\n    reshape(cursor: Vector): void {\r\n        // this.pos = cursor.clone()\r\n        this.alignToSlot(cursor)\r\n    }\r\n\r\n    afterConstruct(): void {}\r\n\r\n    handleClick(_pos): boolean { return true; }\r\n\r\n    slots(): Slot[] {\r\n        return []\r\n    }\r\n\r\n    nodes(): Vector[] {\r\n        let x = this.pos.x + this.getWidth()/2;\r\n        let y = this.pos.y + this.getHeight()\r\n        return [\r\n            new Vector(Math.floor(x), Math.floor(y))\r\n        ];\r\n    }\r\n\r\n    devicePlaces(): DevicePlace[] {\r\n        return []; //this.nodes();\r\n    }\r\n\r\n    deviceInteractionPlaces(): Vector[] {\r\n        return this.devicePlaces().map(place => {\r\n            place.position.y += (place.visibleSize/2)\r\n            return place.position\r\n        })\r\n    }\r\n\r\n    graph(supergraph: Graph<Vector> = new Graph()): Graph<Vector> {\r\n        let g = supergraph\r\n        // assemble subgraph\r\n        let nodes = this.nodes()\r\n        let rootNode = g.findOrCreate(nodes[0], measureDistance)\r\n        for (let child of this.childrenBuildings) {\r\n            let slot = g.findOrCreate(child.parentSlot.pos, measureDistance)\r\n            g.edge(rootNode, slot)\r\n\r\n            let childNode = g.findOrCreate(child.nodes()[0], measureDistance)\r\n            g.edge(slot, childNode)\r\n\r\n            child.graph(g)\r\n        }\r\n        return g\r\n    }\r\n\r\n    // just a patch through to planet -- but could animate something here?\r\n    public redeem(res: ResourceBlock) {\r\n        this.planet.gather(res)\r\n    }\r\n\r\n    public debit(res: ResourceBlock) {\r\n        this.planet.spend(res)\r\n    }\r\n\r\n    public populate(pos: Vector, elite: boolean = false) {\r\n        this.planet.populate(pos, elite) //this.pos)\r\n    }\r\n\r\n    protected aabb(): Rectangle {\r\n        return {\r\n            x: this.pos.x,\r\n            y: this.pos.y,\r\n            width: this.getWidth(),\r\n            height: this.getHeight()\r\n        }\r\n    }\r\n\r\n    protected aabbPoly(): {x:number,y:number}[] {\r\n        return pathFromRect(this.aabb());\r\n\r\n    }\r\n\r\n    protected angledRoofPoly(): {x: number, y: number}[] {\r\n        let angleStartY = 1 * (this.getHeight() / 3) - 3\r\n        let angleStartX = 20 // 1 * (this.getWidth() / 10)\r\n        return [\r\n            // bottom-left\r\n            { x: this.pos.x, y: this.pos.y + this.getHeight() },\r\n\r\n            // upper-left\r\n            { x: this.pos.x, y: this.pos.y + angleStartY },\r\n            { x: this.pos.x + angleStartX, y: this.pos.y },\r\n\r\n            // upper-right\r\n            { x: this.pos.x + this.getWidth() - angleStartX, y: this.pos.y },\r\n            { x: this.pos.x + this.getWidth(), y: this.pos.y + angleStartY },\r\n\r\n            // bottom-right\r\n            { x: this.pos.x + this.getWidth(), y: this.pos.y + this.getHeight() },\r\n        ]\r\n            \r\n    }\r\n\r\n    protected overlaps(other: Building): boolean {\r\n        let rect1 = this.aabb(), rect2 = other.aabb();\r\n        let doesOverlap = (\r\n            rect1.x < rect2.x + rect2.width &&\r\n            rect1.x + rect1.width > rect2.x &&\r\n            rect1.y < rect2.y + rect2.height &&\r\n            rect1.y + rect1.height > rect2.y\r\n        )\r\n        return(!!doesOverlap);\r\n    }\r\n\r\n    public overlapsAny(): boolean {\r\n        return !!this.planet.colony.buildings.find(bldg => bldg !== this && this.overlaps(bldg))\r\n    }\r\n\r\n    protected edgeColor(): Color {\r\n        let edge = this.processedColor().lighten(0.85);\r\n        return edge;\r\n    }\r\n\r\n    protected mainColor(): Color {\r\n        let main = this.processedColor().darken(0.08);\r\n        return main;\r\n    }\r\n\r\n    protected colorBase(): Color {\r\n        return this.color;\r\n    }\r\n\r\n    protected processedColor(): Color {\r\n        let clr = this.colorBase().clone();\r\n        if (!this.placed)  { \r\n            if (this.overlapsAny()) { clr = Color.Red }\r\n            clr.a = 0.8\r\n        }\r\n        if (!this.active) {\r\n            clr = clr.darken(0.8)\r\n        }\r\n\r\n        if (this.hover) { clr.a = 0.5 }\r\n        return clr;\r\n    }\r\n\r\n    get connections() {\r\n        return this.structure.connections;\r\n    }\r\n\r\n\r\n    protected findSlot(\r\n        pos: Vector,\r\n        validConnections: { [key in Orientation]: (typeof Structure)[] } = this.connections\r\n    ): Slot {\r\n        let slotList = []\r\n            for (let dir of compass) {\r\n                const validStructures = validConnections[dir];\r\n                let flipped = flip(dir)\r\n                const buildings = validStructures.map(structure =>\r\n                    this.planet.closestBuildingByType(pos, [structure])\r\n                )\r\n                buildings.forEach(building => {\r\n                    if (building) {\r\n                        let neighborSlots = building.slots()\r\n                        neighborSlots.filter(slot => slot.facing === flipped)\r\n                        .forEach(matchingSlot => {\r\n                            slotList.push(matchingSlot)\r\n                        })\r\n                    }\r\n                })\r\n            }\r\n\r\n        if (slotList.length > 0) {\r\n            return closest(pos, slotList, (slot) => slot.pos)\r\n        } else {\r\n            // console.warn('no conecting structures found')\r\n        }\r\n    }\r\n\r\n    protected alignToSlot(\r\n        cursor: Vector,\r\n        validConnections: { [key in Orientation]: (typeof Structure)[] } = this.connections\r\n    ) {\r\n        let theSlot = this.findSlot(cursor, validConnections)\r\n        if (theSlot) {\r\n            let matchingSlot = this.slots()\r\n                .find(s => s.facing == flip(theSlot.facing))\r\n            if (matchingSlot) {\r\n                let offset = theSlot.pos.sub(matchingSlot.pos)\r\n                this.pos.addEqual(offset)\r\n\r\n                this.parentSlot = theSlot;\r\n                return theSlot;\r\n            }\r\n        }\r\n    }\r\n\r\n    protected buildSlot(x: number, y: number, facing: Orientation = Orientation.Right): Slot {\r\n        return {\r\n            pos: new Vector(x,y),\r\n            facing,\r\n            parent: this\r\n        }\r\n    }\r\n\r\n    public addDevice(device: Device) {\r\n        // device.finalize()\r\n        if (device.building !== this) {\r\n            device.building = this\r\n        }\r\n        this.devices.push(device)\r\n        device.pos.subEqual(this.pos) // = this.devicePlaces()[0].position\r\n        // console.log(\"DEVICE IS AT\", { pos: device.pos })\r\n        this.add(device)\r\n        this.updateFunction()\r\n        device.machine.onPlacement(device)\r\n        this.toggleActive()\r\n\r\n        device.placed = true\r\n    }\r\n\r\n    public hasPlaceForDevice() {\r\n        return this.devices.length < this.devicePlaces().length\r\n    }\r\n\r\n    public nextDevicePlace(): DevicePlace {\r\n        // could throw an err if we have no place\r\n        return this.devicePlaces()[\r\n            this.devices.length\r\n        ]\r\n    }\r\n\r\n    public getDevices() {\r\n        return [ ...this.devices, ...flatSingle(this.devices.map(d => d.tinyDevices)) ]\r\n    }\r\n\r\n    public updateFunction() {\r\n        let allTheMachines = [ StudyMachine, ...allMachines, CommandCenter, MissionLog ]\r\n        let machines = this.devices.map(\r\n            d => allTheMachines.find((m: typeof Machine) => d.machine instanceof m)\r\n        )\r\n        let fn = allSpaceFunctions.find(spaceFn => {\r\n            let sf = new spaceFn()\r\n\r\n            return containsUniq(\r\n              machines,\r\n              sf.machines\r\n            );\r\n        })\r\n        if (fn) {\r\n            // console.log(\"Determined building function\", { fn })\r\n            let sf = new fn()\r\n            this.spaceFunction = sf\r\n            this.nameLabel.text = sf.name\r\n        } else {\r\n            // console.warn(\"Could not identify function!\")\r\n        }\r\n    }\r\n\r\n    get backgroundPattern() {\r\n        if (this.spaceFunction) {\r\n            return this.spaceFunction.background\r\n        } else {\r\n            return BackgroundPattern.Grid\r\n        }\r\n    }\r\n}","import { Vector, Color } from \"excalibur\";\r\nimport { Rectangle } from \"./values/Rectangle\";\r\nimport { BackgroundPattern, getBackgroundPattern } from \"./actors/Building/BackgroundPatterns\";\r\n\r\ntype PaintingPath = { x: number, y: number }[]\r\n\r\nexport function pathFromRect(rect: Rectangle): PaintingPath {\r\n  let pos = { x: rect.x, y: rect.y }\r\n  let path = [\r\n            // bottom-left\r\n            { x: pos.x, y: pos.y + rect.height }, // this.getHeight() },\r\n\r\n            // upper-left\r\n            { x: pos.x, y: pos.y },\r\n\r\n            // upper-right\r\n            { x: pos.x + rect.width, y: pos.y },\r\n\r\n            // bottom-right\r\n            { x: pos.x + rect.width, y: pos.y + rect.height },\r\n        ];\r\n\r\n  return path\r\n}\r\n\r\n// tiny rendering lib\r\nexport function drawLine(ctx: CanvasRenderingContext2D, a: Vector, b: Vector, clr: Color = Color.White, lineWidth: number = 1) {\r\n  let c = clr.clone()\r\n  // c.a = 0.5\r\n  ctx.beginPath()\r\n  ctx.moveTo(a.x, a.y)\r\n  ctx.lineTo(b.x, b.y)\r\n  ctx.strokeStyle = c.toRGBA()\r\n  ctx.lineWidth = lineWidth\r\n  ctx.stroke()\r\n}\r\n\r\nexport function drawPatternedRect(\r\n  ctx: CanvasRenderingContext2D,\r\n  rect: Rectangle,\r\n  pattern: BackgroundPattern = BackgroundPattern.Grid\r\n) {\r\n  const gridPattern = getBackgroundPattern(ctx, pattern)\r\n  if (gridPattern) {\r\n    drawPatternedPoly(ctx, pathFromRect(rect), pattern)\r\n\r\n  }\r\n}\r\n\r\nexport function drawPatternedPoly(\r\n  ctx: CanvasRenderingContext2D,\r\n  path: {x:number, y:number}[],\r\n  // rect: Rectangle,\r\n  pattern: BackgroundPattern = BackgroundPattern.Grid,\r\n  edgeColor: Color = Color.Black\r\n) {\r\n  const gridPattern = getBackgroundPattern(ctx, pattern)\r\n  if (gridPattern) {\r\n    ctx.save()\r\n    ctx.translate(path[0].x, path[0].y)\r\n    // ctx.moveTo(0, 0)\r\n    ctx.beginPath()\r\n    ctx.moveTo(0,0) //path[0].x, path[0].y)\r\n    path.forEach(pt => ctx.lineTo(pt.x - path[0].x, pt.y-path[0].y))\r\n    ctx.lineTo(0,0) // path[0].x, path[0].y)\r\n    ctx.closePath()\r\n    // let { x, y, width, height } = rect;\r\n    ctx.fillStyle = gridPattern\r\n    ctx.fill()\r\n\r\n\r\n    ctx.strokeStyle = edgeColor.fillStyle()\r\n    ctx.stroke()\r\n    ctx.restore()\r\n    // ctx.fillRect(x,y,width,height)\r\n\r\n    // ctx.lineWidth = 2\r\n    // ctx.setLineDash([])\r\n    // ctx.strokeStyle = Color.White.toRGBA()\r\n    // ctx.strokeRect(x,y,width,height)\r\n  }\r\n}\r\n\r\nexport function drawRect(\r\n  ctx: CanvasRenderingContext2D,\r\n  rectangle: Rectangle,\r\n  edgeWidth: number = 0,\r\n  color: Color = Color.White,\r\n  filled: boolean = true,\r\n  dashed: boolean = false\r\n) {\r\n  let { x, y, width, height } = rectangle;\r\n\r\n  if (filled) {\r\n    let main = color.clone();\r\n    // main.a = 1\r\n    ctx.fillStyle = main.toRGBA();\r\n    ctx.fillRect(\r\n      x,\r\n      y,\r\n      width,\r\n      height\r\n    )\r\n  }\r\n\r\n  if (edgeWidth > 0) {\r\n    let edge = Color.White.clone();\r\n    ctx.strokeStyle = edge.toRGBA();\r\n    ctx.lineWidth=edgeWidth\r\n    if (dashed) { ctx.setLineDash([5, 10]) }\r\n    else { ctx.setLineDash([]) }\r\n    ctx.strokeRect(\r\n      x, y, width, height\r\n    )\r\n  }\r\n}\r\n\r\nexport function drawPoly(\r\n  ctx: CanvasRenderingContext2D,\r\n  path: {x:number, y:number}[],\r\n  color: Color\r\n  // rect: Rectangle,\r\n  // pattern: BackgroundPattern = BackgroundPattern.Grid\r\n) {\r\n  // const gridPattern = getBackgroundPattern(ctx, pattern)\r\n  // if (gridPattern) {\r\n    ctx.beginPath()\r\n    ctx.moveTo(path[0].x, path[0].y)\r\n    path.forEach(pt => ctx.lineTo(pt.x, pt.y))\r\n    ctx.lineTo(path[0].x, path[0].y)\r\n    ctx.closePath()\r\n    // let { x, y, width, height } = rect;\r\n    ctx.fillStyle = color.fillStyle()\r\n    ctx.fill()\r\n    // ctx.fillRect(x,y,width,height)\r\n\r\n    // ctx.lineWidth = 2\r\n    // ctx.setLineDash([])\r\n    // ctx.strokeStyle = Color.White.toRGBA()\r\n    // ctx.strokeRect(x,y,width,height)\r\n  // }\r\n}\r\n\r\nexport function drawStar(ctx, cx, cy, outerRadius=3.6, innerRadius=1.4, spikes=5, ) {\r\n    var rot = Math.PI / 2 * 3;\r\n    var x = cx;\r\n    var y = cy;\r\n    var step = Math.PI / spikes;\r\n\r\n    ctx.beginPath();\r\n    ctx.moveTo(cx, cy - outerRadius)\r\n    for (let i = 0; i < spikes; i++) {\r\n        x = cx + Math.cos(rot) * outerRadius;\r\n        y = cy + Math.sin(rot) * outerRadius;\r\n        ctx.lineTo(x, y)\r\n        rot += step\r\n\r\n        x = cx + Math.cos(rot) * innerRadius;\r\n        y = cy + Math.sin(rot) * innerRadius;\r\n        ctx.lineTo(x, y)\r\n        rot += step\r\n    }\r\n    ctx.lineTo(cx, cy - outerRadius);\r\n    ctx.closePath();\r\n    ctx.lineWidth = 1;\r\n    ctx.strokeStyle = 'yellow';\r\n    ctx.stroke();\r\n    ctx.fillStyle = 'yellow';\r\n    ctx.fill();\r\n}\r\n\r\nexport function drawCircle(ctx, cx, cy: number, radius: number, color: Color, hemi=false) {\r\n  let theta = hemi ? Math.PI : (2 * Math.PI)\r\n  ctx.beginPath()\r\n\r\n  ctx.arc(\r\n    cx,\r\n    cy, //this.getHeight(),\r\n    radius,\r\n    0,\r\n    theta,\r\n    true\r\n  )\r\n  ctx.closePath()\r\n\r\n  ctx.fillStyle = color.toRGBA()\r\n  ctx.fill()\r\n}\r\n\r\nexport function drawEllipse(ctx, cx, cy, radiusX: number, radiusY: number, color: Color, hemi=false) {\r\n  let theta = hemi ? Math.PI : (2 * Math.PI)\r\n  ctx.beginPath()\r\n\r\n  ctx.ellipse(\r\n    cx,\r\n    cy, //this.getHeight(),\r\n    radiusX,\r\n    radiusY,\r\n    0,\r\n    theta,\r\n    true\r\n  )\r\n  ctx.closePath()\r\n\r\n  ctx.fillStyle = color.toRGBA()\r\n  ctx.fill()\r\n}","import { Actor, Label, Color, Vector } from \"excalibur\";\r\nimport { Machine } from \"../models/Machine\";\r\nimport { Building } from \"./Building\";\r\nimport { ResourceBlock, blockColor, emptyMarket, sumMarkets } from \"../models/Economy\";\r\nimport { Citizen } from \"./Citizen\";\r\nimport { Planet } from \"./Planet/Planet\";\r\nimport { allStructures } from \"../models/Structure\";\r\nimport { getVisibleDeviceSize, DeviceSize } from \"../values/DeviceSize\";\r\nimport { Recipe, ResourceStorage, MechanicalOperation, ResourceGenerator, ExploreForResource } from \"../models/MechanicalOperation\";\r\nimport { range, deleteByValueOnce, closest } from \"../Util\";\r\nimport { drawRect } from \"../Painting\";\r\nimport { InteractionRequest, retrieveResource } from \"../values/InteractionRequest\";\r\nimport { Game } from \"../Game\";\r\nimport { Rectangle } from \"../values/Rectangle\";\r\n\r\nexport class Device extends Actor {\r\n    // constructionMaterials: ResourceBlock[] = []\r\n\r\n    // could also use for storage?\r\n    product: ResourceBlock[] = []\r\n    nameLabel: Label\r\n    image: HTMLImageElement\r\n    building: Building\r\n    inUse: boolean = false\r\n    hover: boolean = false\r\n\r\n    imageLoaded: boolean = false\r\n\r\n    built: boolean = false\r\n    reserved: boolean = false\r\n\r\n    constructor(\r\n        public machine: Machine,\r\n        initialPos: Vector\r\n    ) {\r\n        super(\r\n            initialPos.x,\r\n            initialPos.y,\r\n            getVisibleDeviceSize(machine.size),\r\n            getVisibleDeviceSize(machine.size),\r\n            Color.Transparent\r\n            // machine.color\r\n        )\r\n\r\n        this.nameLabel = new Label(this.machine.name, 0, 0, Game.font) // 'Helvetica')\r\n        this.nameLabel.fontSize = this.machine.size === DeviceSize.Tiny ? 2 : 6\r\n        this.nameLabel.color = Color.White\r\n\r\n        this.image = new Image();\r\n        this.image.onload = () => { this.imageLoaded = true }\r\n        this.image.src = machine.image\r\n\r\n        this.on('pointerenter', () => {\r\n            // console.log(\"HOVER OVER\", { machine: this.machine })\r\n            this.hover = true\r\n            let tinyDevices = this.tinyDevices.length > 0 &&\r\n              this.tinyDevices.some(d => d.hover)\r\n            if (this.building && !tinyDevices) {\r\n                this.building.planet.currentlyViewing = this\r\n            }\r\n        })\r\n\r\n        this.on('pointerleave', () => {\r\n            this.hover = false\r\n            if (this.building && this.building.planet.currentlyViewing === this) {\r\n                this.building.planet.currentlyViewing = null\r\n            }\r\n        })\r\n    }\r\n\r\n    get imageX() { return this.pos.x - this.getWidth() / 2 }\r\n    get imageY() { return this.pos.y - this.getHeight() / 2 } //- 10 }\r\n\r\n    get economy() { return this.built ? this.computeEconomy() : emptyMarket() }\r\n\r\n    private computeEconomy() {\r\n        let econs = [ this.machine.economy, ...this.tinyDevices.map(d => d.economy) ]\r\n        return econs.reduce(sumMarkets, emptyMarket())\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        if (this.imageLoaded) {\r\n            ctx.save()\r\n            if (!this.built) { ctx.globalAlpha = 0.5 }\r\n            ctx.translate(this.imageX, this.imageY)\r\n            if (this.vel.x > 0) {\r\n                // flip? (assume we're drawn facing left)\r\n                ctx.translate(this.getWidth(), 0)\r\n                ctx.scale(-1,1)\r\n            }\r\n            ctx.drawImage(\r\n                this.image,\r\n                0,\r\n                0, //this.imageY,\r\n\r\n                this.getWidth(),\r\n                this.getHeight()\r\n            )\r\n            // if (!this.built) { ctx.globalAlpha = 1.0 }\r\n\r\n            let c = Color.Transparent.clone()\r\n            if (this.hover) {\r\n                c = Color.White.clone()\r\n                c.a = 0.5\r\n            }\r\n            if (!(this.size === DeviceSize.Tiny || this.placed) && this.overlapsAny()) {\r\n                c = Color.Red.clone()\r\n                c.a = 0.3\r\n            }\r\n\r\n            // if (this.hover || this.overlapsAny()) {\r\n                // let c = Color.White.clone()\r\n                // c.a = 0.6\r\n                drawRect(\r\n                    ctx,\r\n                    { x: 0, y: 0, width: this.getWidth(), height: this.getHeight() },\r\n                    0,\r\n                    c\r\n                )\r\n            // }\r\n            ctx.restore()\r\n        }\r\n\r\n        let iv = new Vector(this.imageX, this.imageY + this.getHeight() / 8)\r\n\r\n        let showLabel = true\r\n        if (showLabel) {\r\n            this.nameLabel.pos = iv\r\n            this.nameLabel.draw(ctx, delta)\r\n        }\r\n\r\n        let { x: bx, y: by } = iv\r\n        let blockSize = 5\r\n        let yOff = this.nameLabel.fontSize\r\n        this.product.forEach((produced, index) => {\r\n            ctx.fillStyle = blockColor(produced).toRGBA()\r\n            ctx.fillRect(bx + blockSize * index, by - blockSize + yOff, blockSize-1, blockSize-1)\r\n        })\r\n\r\n        super.draw(ctx ,delta)\r\n        // this.tinyDevices.forEach(d => d.draw(ctx, delta))\r\n    }\r\n\r\n    get name() { return this.machine.name }\r\n    get description() { return this.machine.description }\r\n    get size() { return this.machine.size }\r\n    get operation() { return this.machine.operation }\r\n\r\n    async assemble(citizen: Citizen) {\r\n        if (citizen.isCarryingUnique(this.machine.cost)) {\r\n            for (let res of this.machine.cost) {\r\n                citizen.drop(res)\r\n                await citizen.progressBar(3000)\r\n            }\r\n            this.built = true\r\n        }\r\n    }\r\n\r\n    async interact(citizen: Citizen, request: InteractionRequest): Promise<boolean> {\r\n        if (this.inUse || !this.built) {\r\n            return false\r\n        }\r\n\r\n        let worked = false\r\n        let op = this.operation\r\n        if (op.type === 'recipe' && request.type === 'work') {\r\n            let recipe: Recipe = op\r\n            // do we have all the things?\r\n            if (citizen.carrying.some(it => recipe.consumes.includes(it))) {\r\n                this.inUse = true\r\n                if (citizen.isCarryingUnique(recipe.consumes)) {\r\n                    recipe.consumes.forEach(consumed => citizen.drop(consumed))\r\n                    let workTime = this.getEffectiveWorkTime(recipe)\r\n                    await citizen.progressBar(workTime) // recipe.workTime)\r\n                    citizen.carry(recipe.produces)\r\n\r\n                    worked = true\r\n                } else {\r\n                    console.warn(\"not carrying all requirements?\", { requires: recipe.consumes, has: citizen.carrying })\r\n                }\r\n                this.inUse = false\r\n            }\r\n        } else if ((op.type === 'store' || op.type === 'explore') && (request.type === 'retrieve' || request.type === 'store')) {\r\n            // accept it! (whatever you have that matches...?)\r\n            let storeOrExplore: ResourceStorage | ExploreForResource = op\r\n            if (request && request.type === 'retrieve') { // assume dispense request for now?\r\n                this.inUse = true\r\n                await citizen.progressBar(1000)\r\n                worked = this.dispense(citizen, request)\r\n                //if (worked) {\r\n                //    await citizen.progressBar(500)\r\n                //}\r\n                this.inUse = false\r\n            } else {\r\n                if (storeOrExplore.type === 'store') {\r\n                    let store: ResourceStorage = storeOrExplore\r\n                    if (request.type === 'store' &&\r\n                        citizen.carrying.some(it => store.stores.includes(it))) { // maybe trying to store?\r\n                        if (this.product.length < this.getEffectiveOperationalCapacity(store)) { // store.capacity) {\r\n                            let res = null\r\n                            if (store.stores.some(stored => { res = citizen.drop(stored); return res })) {\r\n                                if (res) {\r\n                                    this.produceResource(res)\r\n                                    // this.product.push(res)\r\n                                    // this.building.redeem(res)\r\n                                    worked = true\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                } else {\r\n                    console.warn(\"no capacity in this store!!\")\r\n                    worked = false\r\n                }\r\n            }\r\n        } else if (op.type === 'generator') {\r\n            this.inUse = true\r\n            worked = this.dispense(citizen, request)\r\n            if (worked) {\r\n                await citizen.progressBar(500)\r\n            }\r\n            this.inUse = false\r\n        } else if (op.type === 'explore') {\r\n            this.inUse = true\r\n            // this.add(citizen)\r\n            // if (this.product.length < this.getEffectiveOperationalCapacity(op)) {\r\n            let origX = this.pos.x\r\n            let groundSpeed = Game.citizenSpeed * 3\r\n            citizen.driving = this\r\n            // let oldAnchor = citizen.anchor\r\n            // citizen.anchor = this.anchor\r\n            let xOff = 5000 * (Math.random() > 0.5 ? -1 : 1)\r\n            await this.actions.moveTo(this.pos.x + xOff, this.pos.y, groundSpeed).asPromise()\r\n            // for (let times in range(op.capacity)) {\r\n            this.produceResource(op.gathers)\r\n            // }\r\n            await this.actions.moveTo(origX, this.pos.y, groundSpeed).asPromise()\r\n            worked = true\r\n            citizen.driving = null\r\n            // citizen.anchor = oldAnchor\r\n\r\n            this.inUse = false\r\n\r\n            //await this.interact(citizen, retrieveResource(op.gathers))\r\n            // }\r\n            // this.remove(citizen)\r\n        }\r\n\r\n        return worked\r\n    }\r\n\r\n\r\n\r\n    getEffectiveOperationalCapacity(op: ResourceGenerator | ResourceStorage | ExploreForResource) {\r\n        let bonus = this.building.spaceFunction\r\n            ? this.building.spaceFunction.bonuses.capacity \r\n        : 0\r\n        return op.capacity + bonus\r\n    }\r\n\r\n    getEffectiveWorkTime(op: Recipe) {\r\n        let bonus = this.building.spaceFunction \r\n         ? this.building.spaceFunction.bonuses.workSpeed\r\n         : 1\r\n\r\n        return Math.round(op.workTime * (1/bonus))\r\n    } \r\n\r\n\r\n    private dispense(citizen: Citizen, request: InteractionRequest) {\r\n        if (request && request.type === 'retrieve') {\r\n            let canFulfill = this.product.find(p => p === request.resource)\r\n            if (canFulfill) {\r\n                deleteByValueOnce(this.product, request.resource)\r\n                citizen.carry(request.resource)\r\n                this.building.debit(request.resource)\r\n                return true\r\n            }\r\n        }\r\n        return false\r\n    }\r\n\r\n    public tryProduce(step: number) {\r\n        if (this.building.isActive && this.built) {\r\n            if (this.machine.operation.type === 'generator') {\r\n                if (step % this.machine.operation.generationTime === 0) {\r\n                    if (this.product.length < this.machine.operation.capacity) {\r\n                        this.produceResource(this.machine.operation.generates)\r\n                    }\r\n                }\r\n\r\n            } else if (this.machine.operation.type === 'spawn') {\r\n                if (step % 1000 == 0) {\r\n                    // console.log(\"WOULD SPAWN\")\r\n                    setTimeout(() => this.building.populate(this.pos.add(this.building.pos)), 100)\r\n                }\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    public produceResource(res: ResourceBlock) {\r\n        this.product.push(res)\r\n        this.building.redeem(res)\r\n    }\r\n\r\n    snap(planet: Planet, pos: Vector = this.pos) {\r\n        if (this.size === DeviceSize.Tiny) { // or large...\r\n            return this.snapTiny(planet, pos)\r\n        } else {\r\n            console.log(\"attempt to snap device...\")\r\n            let bldg = planet.colony.closestBuildingByType(pos,\r\n                allStructures,\r\n                (bldg: Building) => {\r\n                    // let hasSpace = bldg.hasPlaceForDevice()\r\n                    let compatible = bldg.structure.machines.some(Machine => this.machine instanceof Machine)\r\n                    return compatible\r\n\r\n                }\r\n            )\r\n\r\n            let snapped = false\r\n            if (bldg) {\r\n                // console.log(\"we have a building!\", { bldg })\r\n                let spot = bldg.getCenter()\r\n                let halfSize = getVisibleDeviceSize(this.size)/2\r\n                let d = spot.distance(pos)\r\n                snapped = d < (bldg.getWidth()/2 - halfSize) && (Math.abs(spot.y - pos.y) < 80)\r\n            } else {\r\n                // console.log(\"no bldg found\")\r\n            }\r\n\r\n            if (snapped) {\r\n                this.building = bldg;\r\n                this.pos = pos //.x //this.building.nextDevicePlace().position\r\n                let gridGrain = 20\r\n                this.pos.x += bldg.x\r\n                this.pos.x = Math.floor(this.pos.x / gridGrain) * gridGrain\r\n                this.pos.x -= bldg.x\r\n                this.pos.y = bldg.floorY - getVisibleDeviceSize(this.size)/2 //getCenter().y + (bldg.getHeight()/8)\r\n            } else {\r\n                this.pos = pos\r\n            }\r\n\r\n            // let overlapping = !this.overlapsAny()\r\n\r\n            return snapped // && !overlapping\r\n        }\r\n    }\r\n\r\n    public overlapsAny(): boolean {\r\n        if (this.building) {\r\n            return !!this.building.planet.colony.findAllDevices().find(device => device !== this && this.overlaps(device))\r\n        } else {\r\n            return true\r\n        }\r\n    }\r\n\r\n    private overlaps(other: Device): boolean {\r\n        let rect1 = this.aabb(), rect2 = other.aabb();\r\n        let doesOverlap = (\r\n            rect1.x < rect2.x + rect2.width &&\r\n            rect1.x + rect1.width > rect2.x &&\r\n            rect1.y < rect2.y + rect2.height &&\r\n            rect1.y + rect1.height > rect2.y\r\n        )\r\n        return(!!doesOverlap);\r\n    }\r\n\r\n    placed: boolean = false\r\n    private aabb(): Rectangle {\r\n        let pos = this.pos.clone()\r\n        if (this.placed) {\r\n            pos.addEqual(this.building.pos)\r\n        }\r\n        return {\r\n            x: pos.x,\r\n            y: pos.y,\r\n            width: this.getWidth(),\r\n            height: this.getHeight()\r\n        }\r\n    }\r\n    // private overlapsAny()\r\n\r\n    private snapTiny(planet: Planet, pos: Vector) {\r\n        // okay, we need the closest building with any built machine that HAS a tiny slot\r\n        let bldg = planet.colony.closestBuildingByType(pos,\r\n            allStructures,\r\n            (bldg: Building) => bldg.getDevices().some(\r\n                (device: Device) => device.built && device.hasTinyPlace()\r\n            )\r\n        )\r\n\r\n        // todo look at all devices? (closest bldg may not house closest device!!)\r\n        let device: Device = closest(\r\n            pos,\r\n            bldg.getDevices().filter((d: Device) => d.built && d.hasTinyPlace()),\r\n            (d: Device) => d.pos,\r\n        )\r\n\r\n        this.pos = pos\r\n        let snapped = false\r\n        if (device) {\r\n            let spot = device.nextTinyPlace().add(device.pos).add(device.building.pos)\r\n            let d = spot.distance(pos)\r\n            snapped = d < 50\r\n\r\n            if (snapped) {\r\n                this.building = device.building\r\n                this.parentDevice = device\r\n                this.pos = spot\r\n            }\r\n        }\r\n\r\n        return snapped\r\n    }\r\n\r\n    public parentDevice: Device = null\r\n    tinyDevices: Device[] = []\r\n    private hasTinyPlace() {\r\n        if (!this.machine.tinySlots) {\r\n            return false\r\n        } else {\r\n            return this.tinyDevices.length < 3\r\n        }\r\n    }\r\n\r\n    private nextTinyPlace() {\r\n        let tx0 = -this.getWidth()/3, ty0 = -3\r\n        let ndx = this.tinyDevices.length\r\n        return new Vector(tx0 + (ndx * 14), ty0)\r\n    }\r\n\r\n    public addTinyDevice(device: Device) {\r\n        // console.log(\"ADD TINY DEVICE\", { device: device.machine })\r\n        device.pos = this.nextTinyPlace() //.add(this.pos)\r\n        // device.pos.addEqual(this.pos.add(this.nextTinyPlace()))\r\n        this.tinyDevices.push(device)\r\n        this.add(device)\r\n    }\r\n}","import { Color } from 'excalibur';\r\nimport { Scale } from '../values/Scale';\r\nimport { Orientation } from '../values/Orientation';\r\nimport { Machine, OxygenExtractor, WaterCondensingMachine, SolarCell, allMachines } from './Machine';\r\nimport { DeviceSize } from '../values/DeviceSize';\r\n\r\nconst { major, minor } = Scale\r\n\r\nconst smallMachines = allMachines.filter(machine => (new machine()).size === DeviceSize.Small)\r\nconst mediumMachines = allMachines.filter(machine => (new machine()).size === DeviceSize.Medium)\r\nconst largeMachines = allMachines.filter(machine => (new machine()).size === DeviceSize.Large)\r\nconst hugeMachines = allMachines.filter(machine => (new machine()).size === DeviceSize.Huge)\r\n\r\nconst smallDome = smallMachines.filter(machine => (new machine()).forDome)\r\nconst smallBelow = smallMachines.filter(machine => !(new machine()).forDome)\r\n\r\nconst midDome = mediumMachines.filter(machine => (new machine()).forDome)\r\nconst midBelow = mediumMachines.filter(machine => !(new machine()).forDome && !(new machine()).isVehicle)\r\n\r\nconst largeDome = largeMachines.filter(machine => (new machine()).forDome)\r\nconst largeBelow = largeMachines.filter(machine => !(new machine()).forDome)\r\n\r\nconst hugeDome = hugeMachines.filter(machine => (new machine()).forDome)\r\nconst hugeBelow = hugeMachines.filter(machine => !(new machine()).forDome)\r\n\r\nconst medGroundVehicles = mediumMachines.filter(machine => (new machine()).isVehicle)\r\n\r\nexport class Structure {\r\n    name: string = '(structure name)';\r\n    description: string = '(structure description)';\r\n    view: string = '<structure (room) view>';\r\n    width: number = 10\r\n    height: number = 10\r\n    zoom: number = 1\r\n    color: Color = Color.Gray\r\n    infra: boolean = false\r\n\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Left]: [ Corridor ],\r\n        [Orientation.Right]: [ Corridor ],\r\n        [Orientation.Up]: [ Ladder ],\r\n        [Orientation.Down]: [ Ladder ],\r\n    }\r\n\r\n    machines: (typeof Machine)[] = []\r\n    prereqs: (typeof Structure)[] = []\r\n\r\n\r\n    hide: boolean = false\r\n}\r\n\r\n\r\nexport class MainTunnel extends Structure {\r\n    name: string = 'Main Tunnel';\r\n    description: string = 'Elevating';\r\n    view: string = 'TunnelView';\r\n    width: number = major.fifth\r\n    height: number = major.eighth\r\n    zoom = 0.25\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Left]: [ Corridor ],\r\n        [Orientation.Right]: [ Corridor ],\r\n        [Orientation.Up]: [ MediumSurfaceRoom ],\r\n        [Orientation.Down]: [ ],\r\n    }\r\n    infra = true\r\n}\r\n\r\n\r\nexport class SurfaceRoad extends Structure {\r\n    name: string = 'Road'\r\n    description: string = 'go for a walk'\r\n    view: string = 'SurfaceRoadView'\r\n    width: number = minor.fifth\r\n    height: number = minor.first\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Left]: [ Dome, MediumSurfaceRoom ],\r\n        [Orientation.Right]: [  Dome, MediumSurfaceRoom ],\r\n        [Orientation.Up]: [ ],\r\n        [Orientation.Down]: [ ],\r\n    }\r\n    infra = true\r\n}\r\n\r\nexport class Corridor extends Structure {\r\n    name: string = 'Corridor'\r\n    description: string = 'in the hallway'\r\n    view: string = 'CorridorView'\r\n    width: number = minor.fifth\r\n    height: number = minor.seventh\r\n    zoom = 0.5\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Left]: [\r\n            MainTunnel,\r\n            CommonArea,\r\n            Ladder,\r\n        ],\r\n        [Orientation.Right]: [\r\n            MainTunnel,\r\n            CommonArea,\r\n            Ladder,\r\n        ],\r\n        [Orientation.Up]: [ ],\r\n        [Orientation.Down]: [ ],\r\n    }\r\n    prereqs = [SurfaceRoad] //MainTunnel]\r\n    infra = true\r\n}\r\n\r\nexport class Ladder extends Structure {\r\n    name = 'Ladder'\r\n    description = 'connect vertically'\r\n    view = 'LadderView'\r\n    width = major.second\r\n    height = major.third\r\n    zoom = 0.5\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Up]: [ CommonArea ],\r\n        [Orientation.Down]: [ CommonArea ],\r\n        [Orientation.Left]: [ ],\r\n        [Orientation.Right]: [ ],\r\n    }\r\n    prereqs = [Corridor, SmallRoomThree]\r\n    infra = true\r\n}\r\n\r\n// 'abstract' structure...\r\n\r\nclass Dome extends Structure {\r\n    description: string = 'Biome sweet biome';\r\n\r\n    view: string = 'DomeView';\r\n    width: number  = 2 * major.sixth\r\n    height: number = major.fifth\r\n    zoom = 0.2\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Left]: [ SurfaceRoad ],\r\n        [Orientation.Right]: [ SurfaceRoad ],\r\n        [Orientation.Up]: [ ],\r\n        [Orientation.Down]: [ ],\r\n    }\r\n\r\n    machines = [\r\n        SolarCell,\r\n        OxygenExtractor, WaterCondensingMachine,\r\n    ]\r\n}\r\n\r\n// common subsurface room...\r\nclass CommonArea extends Structure {\r\n    name: string = 'Commons'\r\n    description: string = 'hallway cap'\r\n    view: string = 'CommonAreaView'\r\n    width: number = major.eighth\r\n    height: number = major.fifth\r\n\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Left]: [\r\n            Corridor, CommonArea\r\n            ],\r\n        [Orientation.Right]: [\r\n            Corridor,\r\n            CommonArea,\r\n        ],\r\n        [Orientation.Up]: [ Ladder ],\r\n        [Orientation.Down]: [ Ladder ],\r\n    }\r\n\r\n    machines = []\r\n\r\n    prereqs = [\r\n    ]\r\n}\r\n\r\nexport class SmallRoomTwo extends CommonArea {\r\n    name = 'Sm. Room (2)'\r\n    width = major.eighth\r\n    height = major.fifth\r\n    prereqs = [ SmallDome ]\r\n    machines = smallBelow\r\n}\r\n\r\nexport class SmallRoomThree extends CommonArea {\r\n    name = 'Sm. Room (3)'\r\n    prereqs = [SmallRoomTwo]\r\n    view = 'SmallRoomThreeView'\r\n    width = 2 * major.eighth\r\n    height = major.eighth\r\n    machines = smallBelow\r\n}\r\n\r\nexport class MediumRoom extends CommonArea {\r\n    name = 'Mid Room'\r\n    prereqs = [ SmallRoomThree ]\r\n    view = 'MediumRoomView'\r\n    width = 2 * major.eighth\r\n    machines = [ ...midBelow, ...smallBelow ]\r\n}\r\n\r\nexport class MediumRoomThree extends CommonArea {\r\n    name = 'Mid Room (3)'\r\n    prereqs = [ MediumRoom ]\r\n    view = 'MediumRoomThreeView'\r\n    width = 3 * major.eighth\r\n    height = major.eighth\r\n\r\n    machines = [ ...midBelow, ...smallBelow ]\r\n}\r\n\r\nexport class LargeRoom extends CommonArea {\r\n    name = 'Lg. Room'\r\n    view = 'LargeRoomView'\r\n    prereqs = [ MediumRoom ]\r\n    width = 4 * major.eighth\r\n    height = 2*major.eighth\r\n    machines = [ ...largeBelow, ...midBelow, ...smallBelow ]\r\n}\r\n\r\nexport class HugeRoom extends CommonArea {\r\n    name = 'Huge Room'\r\n    view = 'HugeRoomView'\r\n    width = 10 * major.eighth\r\n    height = 8 * major.eighth\r\n\r\n    prereqs = [LargeRoom]\r\n    machines = hugeBelow\r\n}\r\n\r\n// export class Octagon extends CommonArea {\r\n//     // ...\r\n//     name = 'Octagon'\r\n//     view = 'OctagonView'\r\n// }\r\n\r\n/// surface bldgs\r\n\r\nexport class MediumSurfaceRoom extends Dome {\r\n    name = 'Mid Surf Bldg'\r\n    description = 'home away from home';\r\n\r\n    view: string = 'MediumSurfaceRoomView';\r\n\r\n    width: number = 4 * major.eighth\r\n    height: number = major.seventh\r\n\r\n    zoom = 0.1\r\n\r\n    prereqs = [ SmallDome ]\r\n\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Left]: [ SurfaceRoad ],\r\n        [Orientation.Right]: [ SurfaceRoad ],\r\n        [Orientation.Up]: [ MainTunnel, MediumSurfaceRoom ],\r\n        [Orientation.Down]: [ MainTunnel, MediumSurfaceRoom ],\r\n    }\r\n\r\n    machines = [ ...midBelow, ...smallBelow ]\r\n\r\n    // hide = false // need another one which cares about connecting to roads...\r\n}\r\n\r\nexport class SmallDome extends Dome {\r\n    name = 'Sm. Dome'\r\n    width = 2 * major.fifth\r\n    // height = major.seventh\r\n    machines = smallDome\r\n}\r\n\r\nexport class SmallDomeThree extends Dome {\r\n    name = 'Sm. Dome (3)'\r\n    view = 'SmallDomeThreeView'\r\n    width = 3 * major.fifth\r\n    // height = 2*major.fifth\r\n    machines = smallDome\r\n}\r\n\r\nexport class MidDome extends Dome {\r\n    name = 'Mid Dome'\r\n    view = 'MidDomeView'\r\n    width = 3 * major.seventh\r\n    // height = 2 * major.seventh\r\n    prereqs = [ SmallDome, MediumRoom ]\r\n    machines = [ ...midDome, ...smallDome ]\r\n}\r\n\r\nexport class LargeDome extends Dome {\r\n    name = 'Lg. Dome'\r\n    view = 'BigDomeView'\r\n    width = 4 * major.eighth\r\n    // height = 3 * major.eighth\r\n    prereqs = [MidDome, LargeRoom]\r\n    machines = [ ...largeDome, ...midDome, ...smallDome ]\r\n}\r\n\r\nexport class Arcology extends Dome {\r\n    name = 'Arcology'\r\n    view = 'ArcologyView'\r\n    width = 12 * major.eighth\r\n    height = 36 * major.eighth\r\n    prereqs = [LargeDome, HugeRoom]\r\n    machines = hugeDome\r\n\r\n}\r\n\r\n/// vehicles...!\r\n\r\nexport class GroundVehiclePool extends Dome {\r\n    name = 'Veh. Pool'\r\n    description = 'ground transit hub'\r\n    view = 'GroundVehiclePoolView'\r\n    width = 2 * major.eighth\r\n    height = minor.second\r\n    machines = medGroundVehicles\r\n}\r\n\r\n\r\nexport const allStructures =\r\n    [\r\n        SmallDome,\r\n        SmallDomeThree,\r\n        MidDome,\r\n        LargeDome,\r\n        Arcology,\r\n        MediumSurfaceRoom,\r\n\r\n        SmallRoomTwo,\r\n        SmallRoomThree,\r\n        MediumRoom,\r\n        MediumRoomThree,\r\n        LargeRoom,\r\n        HugeRoom,\r\n\r\n        GroundVehiclePool,\r\n    ]\r\n\r\n\r\n","const majorUnit = 16\r\nconst minorUnit = 4\r\n\r\nconst majorScale = {\r\n    first: majorUnit,\r\n    second: majorUnit * 2,\r\n    third: majorUnit * 3,\r\n    fourth: majorUnit * 4,\r\n    fifth: majorUnit * 5,\r\n    sixth: majorUnit * 6,\r\n    seventh: majorUnit * 7,\r\n    eighth: majorUnit * 8,\r\n}\r\n\r\nconst minorScale = {\r\n    first:   minorUnit,\r\n    second:  minorUnit * 2,\r\n    third:   minorUnit * 3,\r\n    fourth:  minorUnit * 4,\r\n    fifth:   minorUnit * 5,\r\n    sixth:   minorUnit * 6,\r\n    seventh: minorUnit * 7,\r\n    eighth:  minorUnit * 8,\r\n}\r\n\r\nexport const Scale = {\r\n    major: majorScale,\r\n    minor: minorScale\r\n}","import { Machine, OxygenExtractor, WaterCondensingMachine, CloningVat, Bookshelf, Bed, Stove, AlgaeVat, ResearchServer, Fridge, SolarCell, Arbor, Cabin, Workstation, Fabricator, Houseplant, Orchard, Megafabricator, StudyMachine, Mainframe, CommandCenter, MissionLog, Botany, OrientationConsole, PersonnelRegistry, MineralProcessor, MiningDrill, HoloProjector, TimeCrystal, Couch, Statue } from './Machine';\r\nimport { Color } from 'excalibur';\r\nimport { Structure, MediumSurfaceRoom } from './Structure';\r\nimport { BackgroundPattern } from '../actors/Building/BackgroundPatterns';\r\n\r\nexport class RoomRecipe {\r\n     name: string = '(generic)'\r\n     description: string = '(generic description)'\r\n     machines: (typeof Machine)[] = []\r\n     color: Color = Color.Gray\r\n\r\n     prereqs: (typeof RoomRecipe)[] =  [] \r\n\r\n     structure: typeof Structure = null\r\n     hide: boolean = false\r\n     background: BackgroundPattern = BackgroundPattern.Beige\r\n\r\n     bonuses: {\r\n          capacity: number, // every store/generator gets this??\r\n          workSpeed: number, // 2 should double work speed (dur *= 1/multiplier)\r\n     } = {\r\n          capacity: 0, // boost cap by one\r\n          workSpeed: 1.00 // 20% bonus to work speed\r\n     }\r\n}\r\n\r\nexport class MissionControl extends RoomRecipe {\r\n     hide = true\r\n     name = 'Mission Control'\r\n     description = 'keeping everything on track'\r\n     structure = MediumSurfaceRoom\r\n     prereqs = [] //ComputerCore, Factory, Farm ]\r\n     machines = [ CommandCenter, MissionLog ]\r\n     background = BackgroundPattern.Window\r\n}\r\n\r\nexport class LivingQuarters extends RoomRecipe {\r\n     name = 'Living Quarters'\r\n     description = 'good night'\r\n     machines = [ Bed ]\r\n}\r\n\r\nclass Barracks extends RoomRecipe {\r\n     name = 'Barracks'\r\n     description = 'sleep tight'\r\n     machines = [ Bed, Bed, Bed ]\r\n}\r\n\r\nexport class Kitchen extends RoomRecipe {\r\n     name = 'Kitchen'\r\n     description = 'stay together'\r\n     machines = [ Stove, Fridge ]\r\n     bonuses = {\r\n          capacity: 2,\r\n          workSpeed: 1.1\r\n     }\r\n     background = BackgroundPattern.Checker\r\n}\r\n\r\nexport class LifeSupportPod extends RoomRecipe {\r\n     name = 'Life Support'\r\n     description = 'keep it going'\r\n     machines = [ OxygenExtractor, WaterCondensingMachine ]\r\n}\r\n\r\nclass Retreat extends RoomRecipe {\r\n     name = 'Retreat'\r\n     description = 'take it easy'\r\n     machines = [ Cabin, Cabin ]\r\n}\r\n\r\nexport class CloneMatrix extends RoomRecipe {\r\n     name = 'Clone Matrix'\r\n     description = 'clone home'\r\n     machines = [ CloningVat, CloningVat ]\r\n}\r\n\r\nexport class CloneReception extends RoomRecipe {\r\n     name = 'Clone Reception'\r\n     description = 'welcome clone'\r\n     machines = [ CloningVat, OrientationConsole, PersonnelRegistry ]\r\n}\r\n\r\nclass ReadingRoom extends RoomRecipe {\r\n     name = 'Reading Room'\r\n     description = 'butterflies in the sky'\r\n     machines = [ Bookshelf, Bookshelf ]\r\n}\r\n\r\nexport class Library extends RoomRecipe {\r\n     name = 'Library'\r\n     description = 'take a look'\r\n     machines = [ Bookshelf, Bookshelf, Bookshelf ]\r\n     background = BackgroundPattern.Books\r\n}\r\n\r\nexport class Study extends RoomRecipe {\r\n     name = 'Study'\r\n     description = 'plan it out'\r\n     machines = [ StudyMachine, Bookshelf ]\r\n     background = BackgroundPattern.Wood\r\n}\r\n\r\nclass ComputerLab extends RoomRecipe {\r\n     name = 'Computer Lab'\r\n     description = 'make it happen'\r\n     machines = [ Workstation, Workstation, Workstation ]\r\n}\r\n\r\nexport class Archive extends RoomRecipe {\r\n     name = 'Archive'\r\n     description = 'write it down'\r\n     machines = [ ResearchServer, ResearchServer ]\r\n}\r\n\r\nclass Arboretum extends RoomRecipe {\r\n     name = 'Arboretum'\r\n     description = 'walk it out'\r\n     machines = [ Arbor, Arbor ]\r\n}\r\n\r\nclass AlgaeFarm extends RoomRecipe {\r\n     name = 'Algae Farm'\r\n     description = 'make do'\r\n     machines = [ AlgaeVat, AlgaeVat ]\r\n}\r\n\r\nexport class SolarArray extends RoomRecipe {\r\n     name = 'Solar Array'\r\n     description = 'warm up'\r\n     machines = [ SolarCell, SolarCell ]\r\n}\r\n\r\nexport class Workshop extends RoomRecipe {\r\n     name = 'Workshop'\r\n     description = 'take form'\r\n     machines = [ Fabricator, Fabricator ]\r\n}\r\n\r\nclass Nursery extends RoomRecipe {\r\n     name = 'Nursery'\r\n     description = 'quiet please'\r\n     machines = [ Houseplant, Houseplant, Houseplant ]\r\n     background = BackgroundPattern.Leafy\r\n}\r\n\r\nclass Farm extends RoomRecipe {\r\n     name = 'Farm'\r\n     description = 'food for the masses'\r\n     machines = [ Orchard, Orchard ]\r\n}\r\n\r\nclass Factory extends RoomRecipe {\r\n     name = 'Factory'\r\n     description = 'production lines'\r\n     machines = [ Megafabricator, Megafabricator ]\r\n}\r\n\r\n\r\nexport class ComputerCore extends RoomRecipe {\r\n     name = 'Computer Core'\r\n     description = 'let us calculate'\r\n     machines = [ Mainframe, Mainframe ]\r\n     background = BackgroundPattern.Tech\r\n}\r\n\r\nexport class LifeSciencesLab extends RoomRecipe {\r\n     name = 'Life Sciences Lab'\r\n     description = 'where do i come from'\r\n     machines = [ Botany, Botany ]\r\n}\r\n\r\nexport class Refinery extends RoomRecipe {\r\n     name = 'Refinery'\r\n     description = 'separation'\r\n     machines = [ MineralProcessor ]\r\n}\r\n\r\nexport class Mine extends RoomRecipe {\r\n     name = 'Mine'\r\n     description = 'ore from the stone'\r\n     machines = [ MiningDrill ]\r\n}\r\n\r\nexport class HoloMatrix extends RoomRecipe {\r\n     name = 'Hologram Matrix'\r\n     description = 'dream it'\r\n     machines = [ HoloProjector, HoloProjector ]\r\n}\r\n\r\nexport class TimeChamber extends RoomRecipe {\r\n     name = 'Time Chamber'\r\n     description = 'believe it'\r\n     machines = [ TimeCrystal, TimeCrystal ]\r\n}\r\n\r\n// export class DreamMatrix extends \r\n\r\nexport class LivingRoom extends RoomRecipe {\r\n     name = 'Living Room'\r\n     description = 'just relax'\r\n     machines = [ Couch, Couch ]\r\n}\r\n\r\nexport class Statuary extends RoomRecipe {\r\n     name = 'Statuary'\r\n     description = 'to remember'\r\n     machines = [ Statue, Statue, Statue ]\r\n}\r\n\r\nexport const allSpaceFunctions = [\r\n    MissionControl,\r\n\r\n    Library,\r\n    Barracks,\r\n    LifeSupportPod,\r\n    CloneMatrix,\r\n    LivingQuarters,\r\n    Kitchen,\r\n    AlgaeFarm,\r\n    Archive,\r\n    Arboretum,\r\n    SolarArray,\r\n    Retreat,\r\n    Study,\r\n    Workshop,\r\n    ReadingRoom,\r\n    Nursery,\r\n    Farm,\r\n    Factory,\r\n    ComputerLab,\r\n\r\n    ComputerCore,\r\n\r\n    LifeSciencesLab,\r\n\r\n    CloneReception,\r\n    \r\n    Refinery,\r\n    Mine,\r\n    HoloMatrix,\r\n    TimeChamber,\r\n\r\n    LivingRoom,\r\n    Statuary,\r\n]","import { Citizen } from \"../actors/Citizen\";\r\nimport { Planet } from \"../actors/Planet/Planet\";\r\nimport { Device } from \"../actors/Device\";\r\nimport { sleep } from \"../Util\";\r\nimport { ResourceBlock } from \"../models/Economy\";\r\nimport { retrieveResource, drive } from \"../values/InteractionRequest\";\r\nimport { Recipe, MechanicalOperation, ExploreForResource } from \"../models/MechanicalOperation\";\r\n\r\nexport abstract class Strategy {\r\n    private sleepInterval: number = 150\r\n    protected isActive: boolean = false;\r\n    constructor(protected pawn: Citizen) { }\r\n\r\n    protected abstract async apply();\r\n    abstract canApply(): boolean;\r\n\r\n    protected get planet(): Planet { return this.pawn.currentPlanet; }\r\n    protected get devices(): Device[] { return this.planet.colony.findPoweredDevices(); }\r\n    protected get operations(): MechanicalOperation[] { return this.devices.map(d => d.operation); }\r\n    protected get recipes(): Recipe[] {\r\n        let recipes: Recipe[] = [];\r\n        this.operations.forEach(op => {\r\n            if (op.type === 'recipe') {\r\n                recipes.push(op);\r\n            }\r\n        });\r\n        return recipes;\r\n    }\r\n\r\n    protected get explorers(): ExploreForResource[] {\r\n        let explores: ExploreForResource[] = []\r\n        this.operations.forEach(op => {\r\n            if (op.type === 'explore') {\r\n                explores.push(op)\r\n            }\r\n        })\r\n        return explores;\r\n    }\r\n\r\n\r\n    async attempt(): Promise<void> {\r\n        if (this.isActive) {\r\n            return;\r\n        }\r\n        if (!this.isActive) {\r\n            this.isActive = true\r\n            // note apply will need to set this.isActive around its critical section\r\n            await this.apply();\r\n            this.isActive = false\r\n        }\r\n\r\n        // await this.pause()\r\n        // setInterval(() => { this.attempt() }, this.sleepInterval)\r\n    }\r\n\r\n    protected async pause() {\r\n        await sleep(this.sleepInterval)\r\n    }\r\n\r\n    protected async gatherBlock(res: ResourceBlock): Promise<boolean> {\r\n        let gathered = false\r\n        let generatesDesiredBlock = (d: Device) => (d.operation.type === 'generator') &&\r\n            d.product.some(stored => res === stored) //&& !d.inUse\r\n        let gen: Device = this.planet.colony.closestDeviceByType(this.pawn.pos, [], generatesDesiredBlock)\r\n\r\n        let storesDesiredBlock = (d: Device) => (d.operation.type === 'store') &&\r\n              d.product.some(stored => res === stored) //&& !d.inUse\r\n        let store: Device = this.planet.colony.closestDeviceByType(this.pawn.pos, [], storesDesiredBlock)\r\n\r\n        let device: Device = gen || store\r\n\r\n        if (device) {\r\n            // device.inUse = true\r\n            await this.visitDevice(device)\r\n\r\n            if (device.inUse) {\r\n                // at least wait a bit and try again?\r\n                let waitTimes = 0\r\n                while (device.inUse) {\r\n                    await this.pause() //sleep(5000) //this.pause()\r\n                    if (waitTimes++ > 10) {\r\n                        return false \r\n                    }\r\n                }\r\n            }\r\n\r\n            if (await device.interact(this.pawn, retrieveResource(res))) {\r\n                gathered = true\r\n            }\r\n        } else {\r\n            console.warn(\"Didn't gather...\")\r\n            // don't work sub-recipes??\r\n            // let recipe = this.recipes.find(recipe => recipe.produces === res);\r\n            // if (recipe) {\r\n                // gathered = await this.workRecipe(recipe);\r\n                // gathered = true\r\n            // }\r\n        }\r\n\r\n        return gathered\r\n    }\r\n\r\n    protected async visitDevice(device: Device) {\r\n        await this.pawn.visit(device)\r\n    }\r\n\r\n    protected async workExploration(exploring: ExploreForResource): Promise<boolean> {\r\n        let knowsHow = (d: Device) => d.operation === exploring && !d.reserved\r\n        let vehicle = this.planet.colony.closestDeviceByType(this.pawn.pos, [], knowsHow)\r\n        let explored = false\r\n        if (vehicle) {\r\n            vehicle.reserved = true\r\n            if (await this.drive(vehicle, exploring)) {\r\n                explored = true\r\n            }\r\n\r\n            vehicle.reserved = false\r\n        }\r\n        return explored\r\n    }\r\n\r\n    private async drive(vehicle: Device, exploring: ExploreForResource) {\r\n        let driven = false\r\n        if (!vehicle.machine.isVehicle) {\r\n            throw new Error(\"Tried to drive a device that wasn't a vehicle!\")\r\n        } else {\r\n            await this.visitDevice(vehicle)\r\n            if (await vehicle.interact(this.pawn, drive())) {\r\n                if (await vehicle.interact(this.pawn, retrieveResource(exploring.gathers))) {\r\n                    driven = true\r\n                }\r\n            }\r\n        }\r\n        return driven\r\n    }\r\n\r\n    protected async workRecipe(recipe: Recipe): Promise<boolean> {\r\n        console.debug(\"Working recipe\", { product: recipe.produces })\r\n        let knowsRecipe = (d: Device) => d.operation === recipe && !d.reserved\r\n        let maker = this.planet.colony.closestDeviceByType(this.pawn.pos, [], knowsRecipe)\r\n        let made = false\r\n        if (maker) {\r\n            maker.reserved = true\r\n            // maker.inUse = true\r\n            if (await this.gatherIngredients(recipe.consumes)) {\r\n                await this.visitDevice(maker)\r\n                if (await this.performRecipeTask(maker, recipe)) {\r\n                    made = true\r\n                }\r\n            }\r\n            maker.reserved = false\r\n            // maker.inUse = false\r\n        }\r\n        // await this.pause()\r\n        // await this.workRecipe(recipe);\r\n        return made\r\n    }\r\n\r\n    protected async gatherIngredients(blocks: ResourceBlock[]): Promise<boolean> {\r\n        if (!this.pawn.isCarryingUnique(blocks)) {\r\n            console.debug(\"Gathering blocks...\")\r\n            for (let ingredient of blocks) {\r\n                let tries = 0\r\n                let gathered = false\r\n                while (!gathered && tries < 20) {\r\n                    tries += 1\r\n                    if (await this.gatherBlock(ingredient)) {\r\n                        gathered = true\r\n                    } else {\r\n                        await this.pause()\r\n                    }\r\n                }\r\n\r\n                if (!gathered) {\r\n                    console.warn(\"couldn't gather one of the ingredients!!\")\r\n                    return false\r\n                }\r\n                //else {\r\n                //    console.warn(\"didn't gather it!\")\r\n                //    return false\r\n                //}\r\n            }\r\n        }\r\n        return true\r\n    }\r\n\r\n    protected async performRecipeTask(maker: Device, recipe: Recipe, timesToAttempt: number = 5) {\r\n        console.debug(\"Try to perform recipe task...\", { produces: recipe.produces })\r\n        let worked = await maker.interact(this.pawn, { type: 'work', recipe })\r\n        if (!worked) {\r\n            // await this.pause()\r\n            console.warn(\"waiting for machine to become available...\")\r\n            for (let i = 0; i < timesToAttempt; i ++) {\r\n                await this.pause()\r\n                if (await this.performRecipeTask(maker, recipe)) {\r\n                    worked = true\r\n                    break\r\n                }\r\n            }\r\n        }\r\n        return worked\r\n    }\r\n}","const raisedSquare = require('../../images/raised-square-bg.png')\r\nconst leafy = require('../../images/leafy-bg.png')\r\nconst bookish = require('../../images/books-bg.png')\r\nconst posters = require('../../images/poster-wall-bg.png')\r\nconst tech = require('../../images/tech-bg.png')\r\nconst checker = require('../../images/checker-bg.png')\r\nconst beige = require('../../images/beige-bg.png')\r\nconst window = require('../../images/window-bg.png')\r\nconst ussf = require('../../images/ussf.png')\r\nconst wood = require('../../images/wood-panel-bg.png')\r\n\r\ninterface Background {\r\n    image: HTMLImageElement\r\n    pattern: CanvasPattern\r\n    loading: boolean\r\n}\r\n\r\nconst loadBg = (path, scale = 1) => {\r\n    let background: Background = { image: null, pattern: null, loading: true }\r\n    background.image = new Image();\r\n    background.image.src = path\r\n    background.image.onload = function () {\r\n      background.loading = false\r\n    }\r\n    return { background, scale }\r\n}\r\n\r\nexport enum BackgroundPattern {\r\n    Leafy = 'Leafy',\r\n    Grid = 'Grid',\r\n    Books = 'Books',\r\n    Poster = 'Poster',\r\n    Tech = 'Tech',\r\n    Checker = 'Checker',\r\n    Beige = 'Beige',\r\n    Window = 'Window',\r\n    USSF = 'USSF',\r\n    Wood = 'Wood',\r\n}\r\n\r\nconst backgroundPatterns: { [ key in BackgroundPattern ]: { background: Background, scale: number } } = {\r\n    Leafy: loadBg(leafy),\r\n    Grid: loadBg(raisedSquare),\r\n    Books: loadBg(bookish),\r\n    Poster: loadBg(posters),\r\n    Tech: loadBg(tech),\r\n    Checker: loadBg(checker),\r\n    Beige: loadBg(beige),\r\n    Window: loadBg(window),\r\n    USSF: loadBg(ussf, 0.5),\r\n    Wood: loadBg(wood),\r\n}\r\n\r\nexport const getBackgroundPattern = (ctx: CanvasRenderingContext2D, p: BackgroundPattern) => {\r\n    let pattern = backgroundPatterns[p]\r\n    let bg = pattern.background\r\n    if (!bg.loading) {\r\n        if (!bg.pattern) {\r\n            let matrix = new DOMMatrix() //bg.pattern.cre //ctx. // new SVGMatrix()\r\n\r\n            // bg.image.scal\r\n            // bg.image.scale\r\n            bg.pattern = ctx.createPattern(bg.image, 'repeat');\r\n            bg.pattern.setTransform(matrix.scale(pattern.scale)) //0.5))\r\n\r\n        }\r\n        return bg.pattern\r\n    }\r\n}","import { Color } from \"excalibur\";\r\nimport { Game } from \"../../Game\";\r\n\r\nexport class Pane {\r\n    protected _element: HTMLDivElement;\r\n    title: HTMLDivElement\r\n    dragging: boolean = false\r\n    xOff: number = 0\r\n    yOff: number = 0\r\n    initialX: number\r\n    initialY: number\r\n\r\n\r\n    constructor(protected name: string, private x: number, private y: number) {\r\n        this.makeRootElement()\r\n\r\n    }\r\n\r\n    protected makeRootElement() {\r\n        if (this._element) {\r\n            this._element.parentElement.removeChild(this._element);\r\n        }\r\n        // if (!(this.comprehended.length > 0)) { return }\r\n\r\n        this._element = document.createElement('div');\r\n        this._element.style.position = 'absolute';\r\n        this._element.style.display = 'flex';\r\n        this._element.style.flexWrap = 'wrap';\r\n        this._element.style.width = '200px';\r\n        this._element.style.border = 'none'; //1px solid black'; //0.5px solid white';\r\n        // this._element.style.zIndex = '1'; //1px solid black'; //0.5px solid white';\r\n\r\n\r\n        document.body.appendChild(this._element);\r\n\r\n        // make title...\r\n        if (this.name) {\r\n            let container = document.createElement('div')\r\n            container.style.width = '200px'\r\n            // container.draggable = true\r\n            // container.position = 'absolute'\r\n            container.style.backgroundColor = Color.Violet.darken(0.92).toRGBA()\r\n\r\n            this.title = document.createElement('div')\r\n            this.title.textContent = this.name\r\n            this.title.style.fontFamily = Game.font //'Verdana'\r\n            this.title.style.border = 'none'\r\n            this.title.style.fontSize = '7pt'\r\n            this.title.style.fontWeight = '400'\r\n            this.title.style.color = Color.White.toRGBA()\r\n            this.title.style.padding = '4px'\r\n            this.title.style.margin = '0px'\r\n\r\n            container.appendChild(this.title)\r\n            this._element.appendChild(\r\n                container\r\n            )\r\n\r\n            /// hmmmm\r\n            document.addEventListener(\"pointerdown\", (e) => { this.dragStart(e) }, false);\r\n            document.addEventListener(\"pointerup\", (e) => { this.dragEnd(e) }, false);\r\n            document.addEventListener(\"pointermove\", (e) => { this.drag(e) }, false);\r\n\r\n        }\r\n\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D): any {\r\n        if (this._element) {\r\n            let left = ctx.canvas.offsetLeft;\r\n            let top = ctx.canvas.offsetTop;\r\n            this._element.style.left = `${left + this.x + this.xOff}px`;\r\n            this._element.style.top = `${top + this.y + this.yOff}px`;\r\n        }\r\n    }\r\n    private dragStart = (e) => {\r\n        if (e.target === this.title) {\r\n            // console.log(\"drag start\")\r\n            this.initialX = e.clientX - this.xOff;\r\n            this.initialY = e.clientY - this.yOff;\r\n            this.dragging = true\r\n        }\r\n    }\r\n\r\n    private drag = (e) => {\r\n        if (this.dragging) {\r\n            e.preventDefault()\r\n            // console.log(\"drag\")\r\n            let currentX = e.clientX - this.initialX;\r\n            let currentY = e.clientY - this.initialY;\r\n            this.xOff = currentX\r\n            this.yOff = currentY\r\n        }\r\n\r\n    }\r\n\r\n    private dragEnd = (e) => {\r\n        if (this.dragging) {\r\n            // console.log(\"drag end\")\r\n            this.dragging = false\r\n        }\r\n\r\n    }\r\n\r\n    protected buttonFactory(label: string, color: Color = Color.LightGray) {\r\n        let c = color.clone()\r\n        let bg = c.darken(0.5).desaturate(0.5).clone();\r\n        bg.a = 0.8;\r\n        let fg = c.lighten(0.8).desaturate(0.4).clone();\r\n        let theButton = document.createElement('button');\r\n        theButton.textContent = label;\r\n\r\n        theButton.style.display = 'block';\r\n        theButton.style.fontSize = '6pt';\r\n        theButton.style.fontFamily = Game.font // 'Verdana';\r\n        theButton.style.fontWeight = '500';\r\n        theButton.style.padding = '2px';\r\n        theButton.style.width = '100px';\r\n        theButton.style.textTransform = 'uppercase';\r\n        theButton.style.border = 'none' //1px solid rgba(255,255,255,0.08)';\r\n        theButton.style.background = bg.toRGBA();\r\n        theButton.style.color = fg.toRGBA();\r\n        theButton.onmouseover = () => {\r\n            theButton.style.background = bg.saturate(0.5).lighten(0.95).toRGBA();\r\n            theButton.style.color = fg.lighten(0.9).toRGBA();\r\n        };\r\n        theButton.onmouseleave = () => {\r\n            theButton.style.background = bg.toRGBA();\r\n            theButton.style.color = fg.toRGBA();\r\n        };\r\n        return theButton;\r\n    }\r\n}","import { minBy } from \"../Util\";\r\n\r\nexport class Graph<T> {\r\n    private empty: boolean = true\r\n    public nodes: T[] = []\r\n    private edges: { [key: number]: number[] } = {}\r\n    private edgesInverse: { [key: number]: number[] } = {}\r\n\r\n    public isEmpty(): boolean {\r\n        return this.empty;\r\n    }\r\n\r\n    public get size() { return this.nodes.length }\r\n\r\n    public node(newNode: T) {\r\n        this.empty = false;\r\n        if (!this.contains(newNode)) {\r\n            this.nodes.push(newNode)\r\n        }\r\n    }\r\n\r\n    public contains(testNode: T) {\r\n        return this.nodes.includes(testNode)\r\n    }\r\n\r\n    public findOrCreate(testNode: T, measure: (a: T, b: T) => number, tolerance: number = 5): T {\r\n        let nodes = this.dfs();\r\n        let closest = minBy(nodes, (node: T) => measure(testNode, node))\r\n        if (closest && measure(closest, testNode) < tolerance) {\r\n            return closest;\r\n        }\r\n        return testNode;\r\n    }\r\n\r\n    public edge(src: T, dst: T) {\r\n        this.node(src)\r\n        this.node(dst)\r\n\r\n        let s = this.indexOf(src), d = this.indexOf(dst)\r\n        this.edges[s] = this.edges[s] || []\r\n        this.edges[s].push(d)\r\n\r\n        this.edgesInverse[d] = this.edgesInverse[d] || []\r\n        this.edgesInverse[d].push(s)\r\n    }\r\n\r\n    public union(otherGraph: Graph<T>) {\r\n       otherGraph.edgeList().forEach(([a,b]) => this.edge(a,b))\r\n    }\r\n\r\n    public edgeList(): [T,T][] {\r\n        let theEdges = []\r\n        for (let node of this.nodes) {\r\n            let index = this.indexOf(node)\r\n            if (this.edges[index]) {\r\n                for (let otherIndex of this.edges[index]) {\r\n                    let otherNode = this.nodes[otherIndex]\r\n                    if (!theEdges.includes([otherNode, node])) {\r\n                        theEdges.push([node, otherNode])\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return theEdges\r\n    }\r\n\r\n    public adjacent(testNode: T): T[] {\r\n        let index = this.indexOf(testNode)\r\n        let vertex = this.adjacentIndices(index)\r\n        return vertex.map((n) => this.nodes[n])\r\n    }\r\n\r\n    private adjacentIndices(testNodeIndex: number): number[] {\r\n        let es = this.edges[testNodeIndex] || []\r\n        let esInv = this.edgesInverse[testNodeIndex] || []\r\n        let vertex = [...es, ...esInv ]\r\n        return vertex\r\n    }\r\n\r\n    public dfs(root:T=null, visited=[]): T[] {\r\n        let rIndex = root ? this.indexOf(root) : 0\r\n        return this.dfsIndex(rIndex).map(n => this.nodes[n])\r\n    }\r\n\r\n    private dfsIndex(rootIndex:number=0, visited:number[]=[]) {\r\n        visited.push(rootIndex)\r\n        let children = this.adjacentIndices(rootIndex)\r\n        children.forEach((childIndex: number) => {\r\n            if (!visited.includes(childIndex)) {\r\n                this.dfsIndex(childIndex, visited)\r\n            }\r\n        })\r\n\r\n        return visited\r\n    }\r\n\r\n    public bfs(root:T=null, cb: (x: number,y: number)=>boolean = ()=>true): T[] {\r\n        let rIndex = root ? this.indexOf(root) : 0\r\n        return this.bfsIndex(rIndex, cb).map(n => this.nodes[n])\r\n    }\r\n\r\n    private bfsIndex(rootIndex:number=null, cb: (x: number, y: number) => boolean = () => true): number[] {\r\n        let halt = false;\r\n        let visited: number[] = []\r\n        visited.push(rootIndex)\r\n        let tries = 0\r\n        while (visited.length < this.nodes.length && tries++ < this.nodes.length * 20) {\r\n            for (let visitedNode of visited) {\r\n                let adj: number[] = this.adjacentIndices(visitedNode)\r\n                for (let adjacentNode of adj) {\r\n                    if (!visited.includes(adjacentNode)) {\r\n                        if (!cb(visitedNode, adjacentNode)) {\r\n                            halt = true;\r\n                            break;\r\n                        }\r\n                        visited.push(adjacentNode)\r\n                    }\r\n                }\r\n                if (halt) break;\r\n            }\r\n            if (halt) break;\r\n        }\r\n        return visited\r\n    }\r\n\r\n    public shortestPath(src: T, dst: T, maxStep: number = 256): T[] {\r\n        let prevStep = {}\r\n        let dstIndex = this.indexOf(dst)\r\n        this.bfs(src, (prev, curr) => {\r\n            prevStep[curr] = prev;\r\n            return curr !== dstIndex\r\n        })\r\n        let path = []\r\n        let curr = dstIndex\r\n        let steps = 0\r\n        let srcIndex = this.indexOf(src)\r\n        while (!path.includes(srcIndex) && steps < maxStep) {\r\n            path.push(curr)\r\n            curr = prevStep[curr]\r\n            steps += 1\r\n        }\r\n        let pathNodes = path.map(n => this.nodes[n])\r\n        return pathNodes.reverse()\r\n    }\r\n\r\n    private indexOf(node: T) {\r\n        return this.nodes.indexOf(node)\r\n    }\r\n\r\n}","import { Color } from 'excalibur';\r\nimport { Structure } from './Structure';\r\nimport { sample } from '../Util';\r\nimport { Planet } from '../actors/Planet/Planet';\r\n\r\n\r\nexport class World {\r\n    static nameCitizen(): string {\r\n      return sample([\r\n        'Parthas',\r\n        'Athos',\r\n        'Karzak',\r\n        'Echo',\r\n        'Jaen',\r\n        'Xavier',\r\n        'Mante',\r\n        'Ern',\r\n        'Leor',\r\n        'Exiel',\r\n        'Tomlien',\r\n        'Amriel',\r\n        'Sariel',\r\n        'Arthax',\r\n        'Avalon',\r\n        'Kor',\r\n        'Exelon',\r\n        'Dominel',\r\n        'Prinz',\r\n        'Etsa',\r\n        'Corinth',\r\n        'Coade',\r\n        'Exter',\r\n        'Domnek',\r\n        'Tahm',\r\n        'Esk',\r\n        'Ith',\r\n        'Torl',\r\n        'Klapaucius',\r\n        'Antonidus',\r\n        'Exeleron',\r\n        'Moab',\r\n        'Thim',\r\n        'Pol',\r\n        'Maigel',\r\n      ])\r\n    }\r\n  static colors = [Color.Orange, Color.Azure] //, Color.Red, Color.Blue, Color.Green] //, Color.Violet] //, Color.White]\r\n\r\n  color: Color = sample(World.colors).\r\n      clone().\r\n      darken(0.1).\r\n      desaturate(0.8);\r\n  skyColor: Color = sample(\r\n    //   [ Color.Blue ]\r\n      [Color.Cyan] //, Color.Vermillion, Color.Violet, Color.Chartreuse, Color.Orange, Color.Rose]\r\n  ).\r\n        clone().\r\n        lighten(0.15).\r\n        desaturate(0.8) //65)\r\n\r\n}","import { Texture, Sound } from 'excalibur';\r\nconst sword = require('./images/sword.png');\r\nconst craterRock = require('./sounds/crater-rock.mp3')\r\nconst assembler = require('./sounds/assembler.mp3')\r\nconst indivision = require('./sounds/indivision.mp3')\r\nconst understanding = require('./sounds/understanding.mp3')\r\nconst futureTense = require('./sounds/future tense.mp3')\r\n// const isomer = require('./sounds/isomer.mp3')\r\n// const outbound = require('./sounds/outbound.mp3')\r\n\r\nlet Resources = {\r\n    Sword: new Texture(sword),\r\n\r\n    CraterRock: new Sound(craterRock),\r\n    Assembler: new Sound(assembler),\r\n    Indivision: new Sound(indivision),\r\n    Understanding: new Sound(understanding),\r\n    FutureTense: new Sound(futureTense),\r\n    // Isomer: new Sound(isomer),\r\n    // Outbound: new Sound(outbound),\r\n\r\n\r\n}\r\n\r\nexport { Resources }\r\n","import { Machine, Houseplant, Orchard, Bed, OxygenExtractor, WaterCondensingMachine, Codex, Bookshelf, SolarCell, Fridge, Stove, Books, Workstation, Greenhouse, Botany, MineralProcessor, Miner, Table } from \"./Machine\";\r\n\r\nexport enum Discipline {\r\n    Survival = 'Environmental Control',\r\n    Agriculture = 'Food Production',\r\n    LibraryScience = 'Library Science',\r\n    Cooking = 'Food Preparation',\r\n    // PowerGeneration = 'Power Generation',\r\n    // LifeScience = 'Life Sciences',\r\n    // PlasticArts = 'Plastic Arts',\r\n    MineralProduction = 'Mineral Production',\r\n}\r\n\r\nexport interface TechnologyRank {\r\n    name: string\r\n    level: number\r\n    description: string\r\n    prereqs: (typeof Machine)[]\r\n    unlocks: (typeof Machine)[]\r\n}\r\n\r\nexport const disciplineTree: { [key in Discipline]: TechnologyRank[] } = {\r\n    [Discipline.Survival]: [\r\n        { \r\n            name: \"Survival I\",\r\n            level: 1,\r\n            description: \"staying alive\",\r\n            prereqs: [ Bed, SolarCell ],\r\n            unlocks: [ OxygenExtractor, WaterCondensingMachine ]\r\n        },\r\n    ],\r\n\r\n    [Discipline.Agriculture]: [\r\n        // small planter?\r\n        {\r\n            name: 'Food Prod. I',\r\n            level: 1,\r\n            description: \"watch the calories\",\r\n            prereqs: [Botany],\r\n            unlocks: [Houseplant, Greenhouse, Orchard],\r\n        } // Greenhouse...? ] }\r\n    ],\r\n\r\n    [Discipline.Cooking]: [\r\n        {\r\n            name: 'Food Prep. I',\r\n            level: 1,\r\n            description: \"bam\",\r\n            prereqs: [Fridge],\r\n            unlocks: [Stove],\r\n        }\r\n    ],\r\n\r\n    [Discipline.LibraryScience]: [\r\n        {\r\n            name: \"Library Science I\",\r\n            level: 1,\r\n            description: \"try to understand\",\r\n            prereqs: [ Books ],\r\n            unlocks: [ Bookshelf, Workstation, Codex ],\r\n        }\r\n    ],\r\n\r\n    [Discipline.MineralProduction]: [\r\n        {\r\n            name: 'Mineral Production I',\r\n            level: 1,\r\n            description: 'make it work',\r\n            prereqs: [ Table ],\r\n            unlocks: [ Miner, MineralProcessor ],\r\n        }\r\n    ]\r\n\r\n    // [Discipline.LifeScience]: [ \r\n    //     { prereqs: [], unlocks: [ Botany, AlgaeVat ]}\r\n    // ],\r\n\r\n    // [Discipline.PlasticArts]: [\r\n    //     { prereqs: [ Figurine ], unlocks: [ Statue ] }\r\n\r\n    // ],\r\n}\r\n\r\n","import { Machine } from \"./Machine\";\r\nimport { range } from \"../Util\";\r\nimport { Discipline, TechnologyRank, disciplineTree } from \"./TechnologyRank\";\r\n\r\nexport class TechTree {\r\n    currentLevels: {\r\n        [key in Discipline]: number;\r\n    } = {\r\n            [Discipline.Survival]: -1,\r\n            [Discipline.LibraryScience]: -1,\r\n            [Discipline.Agriculture]: -1,\r\n            [Discipline.Cooking]: -1,\r\n            [Discipline.MineralProduction]: -1,\r\n        };\r\n\r\n    findDisciplineToRankUp(machines: (typeof Machine)[]): Discipline {\r\n        for (let disciplineName of Object.keys(Discipline)) {\r\n            let discipline: Discipline = Discipline[disciplineName];\r\n            if (this.canRankUp(discipline, machines)) {\r\n                return discipline;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    rankUp(discipline: Discipline): TechnologyRank {\r\n        this.currentLevels[discipline] += 1;\r\n        return this.currentRank(discipline);\r\n    }\r\n\r\n    private currentRank(discipline: Discipline): TechnologyRank {\r\n        return disciplineTree[discipline][this.currentLevels[discipline]];\r\n    }\r\n\r\n    private canRankUp(discipline: Discipline, machines: (typeof Machine)[]): boolean {\r\n        let level = this.currentLevels[discipline];\r\n        let nextLevel: TechnologyRank = disciplineTree[discipline][level + 1];\r\n        if (nextLevel) {\r\n            if (nextLevel.prereqs.every(machine => machines.includes(machine))) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    allUnlockedMachines(): (typeof Machine)[] {\r\n        let unlocked = [];\r\n        for (let disciplineName of Object.keys(Discipline)) {\r\n            unlocked.push(...this.unlockedMachinesFor(Discipline[disciplineName]));\r\n        }\r\n        return unlocked;\r\n    }\r\n\r\n    private unlockedMachinesFor(discipline: Discipline) {\r\n        let tree = disciplineTree[discipline];\r\n        let unlocked = [];\r\n        let level = this.currentLevels[discipline] + 1;\r\n        for (let i in range(level)) {\r\n            unlocked.push(...tree[i].unlocks);\r\n        }\r\n        return unlocked;\r\n    }\r\n}\r\n","import * as ex from 'excalibur';\r\n\r\nexport class Player extends ex.Actor {\r\n  constructor() {\r\n    super();\r\n    this.setWidth(5);\r\n    this.setHeight(5);\r\n    this.x = 5;\r\n    this.y = 5;\r\n    this.color = new ex.Color(255, 255, 255);\r\n  }\r\n}\r\n","import { Actor, Color } from 'excalibur';\r\nimport { range, mixColors } from '../../Util';\r\nimport { drawRect } from '../../Painting';\r\n\r\nclass PlanetBackground extends Actor {\r\n    constructor(y: number, width: number, color: Color) {\r\n        super(0, y, width, 1500, color)\r\n    }\r\n}\r\n\r\nexport class MountainLayers extends PlanetBackground {\r\n    layers: {\r\n        baseY: number,\r\n        // color: Color,\r\n        deltas: number[]\r\n    }[] = []\r\n\r\n    skyColor: Color = Color.Blue.clone()\r\n    layerHeight: number = 100\r\n    layerCount = 1\r\n    peakCount = 100\r\n\r\n    get peakWidth() {\r\n        return Math.floor(this.getWidth() / this.peakCount)\r\n    }\r\n\r\n    onInitialize() {\r\n        // let min = -this.layerHeight\r\n        for (let layerIndex of range(this.layerCount)) {\r\n            this.layers.unshift({\r\n                baseY: (layerIndex+1) * -this.layerHeight, // - (20 * layerIndex),\r\n                deltas: this.genPeaks(layerIndex)\r\n            })\r\n        }\r\n    }\r\n\r\n    draw(ctx, delta) {\r\n        let wc = this.color.clone() //.lighten(0.1)\r\n        let sc = this.skyColor.clone() //.lighten(0.1)\r\n\r\n        let ndx = 1\r\n        let ls = this.layers.slice()\r\n        for (let layer of ls) {\r\n            let c = mixColors(wc, sc, (ndx / (this.layers.length)))\r\n            this.drawLayer(ctx, layer, c) //.lighten(0.1))\r\n            ndx += 1\r\n        }\r\n    }\r\n\r\n    private drawLayer(ctx, layer, color) {\r\n        let ox = -this.getWidth()/2, oy = this.pos.y + layer.baseY \r\n        let c = color.clone()\r\n\r\n        ctx.beginPath()\r\n        ctx.moveTo(ox, oy)\r\n        let ndx = 0\r\n        for (let delta of layer.deltas) {\r\n            ctx.lineTo(ox + (ndx * this.peakWidth), oy + delta)\r\n            ndx += 1\r\n        }\r\n        ctx.lineTo(ox + (this.peakCount * this.peakWidth), oy)\r\n        ctx.lineTo(ox + (this.peakCount * this.peakWidth), oy + this.layerHeight)\r\n        ctx.lineTo(ox, oy+this.layerHeight)\r\n        ctx.closePath()\r\n        c.a = 1\r\n        ctx.fillStyle = c.toRGBA()\r\n        ctx.fill()\r\n    }\r\n\r\n    private genPeaks(n) {\r\n        let dMax = 2*(this.layerHeight/3)\r\n        let deltas = []\r\n        let randomDelta = () => (Math.random() * (dMax)) - (dMax/2)\r\n        let last = 0\r\n        let maxDiff = 15 // + (n*2)\r\n        for (let times in range(this.peakCount)) {\r\n            let curr = randomDelta()\r\n            let pick = Math.max(\r\n                   last - maxDiff,\r\n                   Math.min(curr, last + maxDiff),\r\n               )\r\n            deltas.push(\r\n               pick\r\n            )\r\n            last = pick\r\n        }\r\n        return deltas\r\n    }\r\n}\r\n\r\nexport class Mountains extends PlanetBackground {\r\n    peaks: {\r\n        x: number;\r\n        height: number;\r\n    }[] = [];\r\n    onInitialize() {\r\n        let peakCount = 3\r\n        let peakHeight = 800\r\n        let xOff = this.getWidth() / 2\r\n        let peakDistance = this.getWidth() / peakCount\r\n        // for (let times of range(2)) {\r\n        let heightRange = 100\r\n        let drift = 3 * (peakDistance / 2)\r\n        for (let i of range(peakCount)) {\r\n            let h = Math.max(400, 200 + (Math.random() * peakHeight) + ((Math.random() * heightRange) - (heightRange / 2))) //(Util.randomIntInRange(-160,160))\r\n            this.peaks.push({\r\n                x: Math.min(this.getWidth() / 2 - h / 2, -xOff + i * peakDistance + ((Math.random() * drift))), // - (drift / 2)),\r\n                height: h\r\n            })\r\n        }\r\n        // }\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        let baseColor = this.color.desaturate(0.35)\r\n        let brightColor = baseColor.lighten(0.1)\r\n        ctx.fillStyle = baseColor.toRGBA()\r\n        let yBase = this.pos.y-3\r\n        this.peaks.forEach(peak => {\r\n            let y0 = yBase - peak.height;\r\n            let mtnWidth = peak.height * 3.4;\r\n            ctx.beginPath();\r\n            ctx.moveTo(peak.x, y0);\r\n            ctx.lineTo(peak.x - mtnWidth, yBase);\r\n            ctx.lineTo(peak.x + mtnWidth, yBase);\r\n\r\n            ctx.fillStyle = baseColor.toRGBA()\r\n            ctx.fill();\r\n\r\n            ctx.beginPath();\r\n            ctx.moveTo(peak.x, y0);\r\n            ctx.lineTo(peak.x + 3*(mtnWidth/4), yBase);\r\n            ctx.lineTo(peak.x + mtnWidth, yBase);\r\n            ctx.fillStyle = brightColor.toRGBA()\r\n            ctx.fill();\r\n\r\n        });\r\n    }\r\n}","import { Actor, Color } from 'excalibur';\r\nimport { mixColors } from '../../Util';\r\nimport { Mountains, MountainLayers } from './PlanetBackground';\r\nexport class SkyLayer extends Actor {\r\n    mountains: Mountains;\r\n    mountainLayers: MountainLayers;\r\n    backMountainLayers: MountainLayers;\r\n    constructor(y: number, width: number, lo: Color, hi: Color) {\r\n        super(0, y, width, 1500); //width,1500) //height)\r\n        let mid = mixColors(lo, hi);\r\n        this.backMountainLayers = new MountainLayers(-80, width, mid);\r\n        this.backMountainLayers.skyColor = hi;\r\n        this.add(this.backMountainLayers);\r\n        this.mountains = new Mountains(0, width, mid);\r\n        this.add(this.mountains);\r\n        this.mountainLayers = new MountainLayers(0, this.getWidth(), lo);\r\n        this.mountainLayers.skyColor = mid;\r\n        this.add(this.mountainLayers);\r\n    }\r\n    setLoHi(lo: Color, hi: Color) {\r\n        let mid = mixColors(lo, hi);\r\n        this.backMountainLayers.color = mid;\r\n        this.backMountainLayers.skyColor = hi;\r\n        this.mountains.color = mid;\r\n        this.mountainLayers.color = lo;\r\n        this.mountainLayers.skyColor = mid;\r\n    }\r\n}\r\n","import { Actor, Color } from 'excalibur';\r\nimport { range, mixColors } from '../../Util';\r\nimport { SkyLayer } from \"./SkyLayer\";\r\nexport class SkyLayers extends Actor {\r\n    layers: SkyLayer[] = [];\r\n    constructor(y: number, width: number, private lo: Color, hi: Color, private layerCount: number = 5) {\r\n        super(0, y, width, 1500);\r\n        for (let i of range(layerCount)) {\r\n            let c0 = mixColors(lo, hi, (i / (layerCount + 1)));\r\n            let c1 = mixColors(lo, hi, ((i + 1) / (layerCount + 1)));\r\n            let layer = new SkyLayer(-20 - (50 * (layerCount - i - 1)), this.getWidth(), c1, c0);\r\n            this.layers.push(layer);\r\n            this.add(layer);\r\n        }\r\n    }\r\n    setHi(hi: Color) {\r\n        let lo = this.lo;\r\n        for (let i of range(this.layerCount)) {\r\n            let c0 = mixColors(lo, hi, (i / (this.layerCount + 1)));\r\n            let c1 = mixColors(lo, hi, ((i + 1) / (this.layerCount + 1)));\r\n            this.layers[i].setLoHi(c1, c0);\r\n            // let layer = new SkyLayer(-100 * (layerCount-i-1), this.getWidth(), c1, c0)\r\n        }\r\n    }\r\n}\r\n","import { Strategy } from \"./Strategy\";\r\n\r\nexport abstract class EatingStrategy extends Strategy {}","import { EatingStrategy } from \"./EatingStrategy\";\r\nimport { ResourceBlock } from \"../models/Economy\";\r\n\r\nexport class WhenHungryEatingStrategy extends EatingStrategy {\r\n    canApply(): boolean {\r\n        return this.pawn.isHungry &&\r\n            this.planet.storedResources.includes(ResourceBlock.Meal)\r\n        // hunger > 0.6\r\n        // throw new Error(\"Method not implemented.\");\r\n    }\r\n\r\n    protected async apply() {\r\n        // find the store with the food! reserve it maybe?\r\n        let fridge = this.devices.find(d => d.machine.operation.type === 'store' &&\r\n          d.machine.operation.stores.includes(ResourceBlock.Meal) &&\r\n          d.product.includes(ResourceBlock.Meal) &&\r\n          !d.reserved\r\n        )\r\n\r\n        if (fridge) {\r\n            fridge.reserved = true\r\n            // take the meal to a desk? (maybe need table here... or eatingSurface aspect?)\r\n            await this.visitDevice(fridge)\r\n            await fridge.interact(this.pawn, { type: 'retrieve', resource: ResourceBlock.Meal })\r\n            fridge.reserved = false\r\n\r\n            let desk = this.devices.find(d => d.machine.isEatingSurface) // instanceof Desk)\r\n            if (desk) {\r\n                await this.visitDevice(desk)\r\n            }\r\n            await this.pawn.eat()\r\n            // fridge.interac\r\n            // this.pawn.interact()\r\n        }\r\n    }\r\n    \r\n    \r\n}","import { Strategy } from \"./Strategy\";\r\n\r\nexport abstract class SleepingStrategy extends Strategy {\r\n\r\n}","import { SleepingStrategy } from \"./SleepingStrategy\";\r\nimport { Bed } from \"../models/Machine\";\r\nimport { shuffle } from \"../Util\";\r\n\r\nexport class AnyBedSleepingStrategy extends SleepingStrategy {\r\n    canApply(): boolean {\r\n        if (!this.pawn.isTired) {\r\n            return false\r\n        }\r\n\r\n        let bedtime = this.planet.hour > 21 || this.planet.hour < 4\r\n        return bedtime\r\n    }\r\n\r\n    protected async apply() {\r\n        // find a bed\r\n        let bed = shuffle(this.devices).find(d => d.machine instanceof Bed && !d.inUse)\r\n        if (bed) {\r\n            bed.inUse = true\r\n            await this.visitDevice(bed)\r\n        }\r\n        await this.pawn.takeRest() //1000 * 24)\r\n        if (bed) { \r\n            bed.inUse = false\r\n        }\r\n        return true\r\n    }\r\n\r\n}","import { Strategy } from \"./Strategy\";\r\nimport { Device } from \"../actors/Device\";\r\nimport { containsUniq } from \"../Util\";\r\n\r\nexport abstract class ConstructionStrategy extends Strategy {\r\n    canApply(): boolean {\r\n        return !!this.unbuiltDevice\r\n    }\r\n\r\n    get unbuiltDevice() {\r\n        const isUnbuilt = (d: Device) => !d.built && !d.inUse && d.building.isActive &&\r\n          // the player can TRY to build it, we don't have to hang forever on it though\r\n          containsUniq(this.planet.storedResources, d.machine.cost)\r\n        return this.planet.colony.findAllDevices().find(isUnbuilt)\r\n    }\r\n}","import { ConstructionStrategy } from \"./ConstructionStrategy\";\r\nimport { Device } from \"../actors/Device\";\r\n\r\nexport class ProxmityBasedConstruction extends ConstructionStrategy {\r\n    async apply() {\r\n        if (this.unbuiltDevice && this.unbuiltDevice.building) {\r\n            await this.constructDevice(this.unbuiltDevice)\r\n        }\r\n        await this.pause()\r\n    }\r\n\r\n    private async constructDevice(device: Device) {\r\n        device.inUse = true\r\n        let resources = device.machine.cost\r\n        if (await this.gatherIngredients(resources)) {\r\n            await this.visitDevice(device)\r\n            await device.assemble(this.pawn)\r\n        } \r\n\r\n        device.inUse = false\r\n    }\r\n}","import { ResourceBlock } from \"../models/Economy\";\r\n\r\nimport { Recipe } from \"../models/MechanicalOperation\";\r\n\r\nexport interface RetrieveResource {\r\n    type: 'retrieve'\r\n    resource: ResourceBlock\r\n    // count: number\r\n}\r\n\r\nexport interface WorkRecipe {\r\n    type: 'work'\r\n    recipe: Recipe\r\n}\r\n\r\nexport interface StoreResource {\r\n    type: 'store'\r\n    resource: ResourceBlock\r\n}\r\n\r\nexport interface DriveAround {\r\n    type: 'drive'\r\n}\r\n\r\nexport function retrieveResource(res: ResourceBlock): RetrieveResource {\r\n    return {\r\n        type: 'retrieve',\r\n        resource: res,\r\n        // count: 1\r\n    }\r\n}\r\n\r\nexport function drive(): DriveAround {\r\n    return { type: 'drive' }\r\n}\r\n\r\nexport type InteractionRequest = StoreResource | RetrieveResource | WorkRecipe | DriveAround\r\n\r\n","import { Device } from \"../actors/Device\";\r\nimport { MechanicalOperation, Recipe } from \"../models/MechanicalOperation\";\r\nimport { ResourceBlock } from \"../models/Economy\";\r\nimport { retrieveResource } from \"../values/InteractionRequest\";\r\nimport { Strategy } from \"./Strategy\";\r\n\r\nexport abstract class ProductionStrategy extends Strategy {\r\n\r\n    protected async storeBlock(res: ResourceBlock) {\r\n        let stored = false\r\n        let tries = 0\r\n        while (!stored && tries < 30) {\r\n            tries++\r\n            if (await this.tryStoreBlock(res)) {\r\n                stored = true\r\n            } else {\r\n                await this.pause()\r\n            }\r\n        }\r\n    }\r\n\r\n    private async tryStoreBlock(res: ResourceBlock): Promise<boolean> {\r\n        let storesDesiredBlock = (d: Device) => d.operation.type === 'store' &&\r\n            d.product.length < d.getEffectiveOperationalCapacity(d.operation) && //operation.capacity &&\r\n            d.operation.stores.includes(res)\r\n        let openStore = this.planet.colony.closestDeviceByType(this.pawn.pos, [], storesDesiredBlock)\r\n        let stored = false\r\n        if (openStore) {\r\n            await this.visitDevice(openStore)\r\n            if (await openStore.interact(this.pawn, { type: 'store', resource: res })) {\r\n                stored = true\r\n            }\r\n        }\r\n\r\n        //if (!stored) {\r\n        //    await this.pause()\r\n        //    // should try agi\r\n        //    // await this.storeBlock(res)\r\n        //}\r\n\r\n        return stored\r\n    }\r\n\r\n}\r\n","import { shuffle, containsUniq } from \"../Util\";\r\nimport { Device } from \"../actors/Device\";\r\nimport { Recipe, ResourceStorage, ExploreForResource } from \"../models/MechanicalOperation\";\r\nimport { ProductionStrategy } from \"./ProductionStrategy\";\r\nimport { Resource } from \"excalibur\";\r\n\r\nexport class CapacityBasedProduction extends ProductionStrategy {\r\n    canApply(): boolean {\r\n        let hasOpenStore = !!(this.findStore())\r\n        return hasOpenStore\r\n    }\r\n\r\n    async apply() {\r\n        let store = this.findStore()\r\n        let recipe = this.findRecipe(store)\r\n        let explorer = this.findExplorer(store)\r\n\r\n\r\n        if (recipe && containsUniq(this.planet.storedResources, recipe.consumes)) {\r\n            if (await this.workRecipe(recipe)) {\r\n                await this.storeBlock(recipe.produces)\r\n            }\r\n        } else if (explorer) {\r\n            if (await this.workExploration(explorer)) {\r\n                await this.storeBlock(explorer.gathers)\r\n            }\r\n        } else {\r\n            // console.warn(\"No recipe or explorer!\")\r\n        }\r\n    }\r\n\r\n    private findStore() {\r\n        const storeWithCapacity = (d: Device) => d.operation.type === 'store' &&\r\n            d.product.length < d.getEffectiveOperationalCapacity(d.operation) //&&\r\n        let store: Device = shuffle(this.devices).find(storeWithCapacity)\r\n        return store\r\n    }\r\n\r\n\r\n    private findRecipe(store: Device): Recipe {\r\n        if (store && store.operation.type === 'store') {\r\n            const storage: ResourceStorage = store.operation\r\n            const recipeForStoredResource = (r: Recipe) => storage.stores.some(stored => r.produces === stored)\r\n            let recipe: Recipe = shuffle(this.recipes).find(recipeForStoredResource)\r\n            return recipe\r\n        }\r\n    }\r\n\r\n    private findExplorer(store: Device): ExploreForResource {\r\n        if (store && store.operation.type === 'store') {\r\n            const storage: ResourceStorage = store.operation\r\n            // console.log(\"Looking for explorer for\", { stored: storage.stores })\r\n            const explorerForStored = (e: ExploreForResource) => storage.stores.some(stored => e.gathers === stored)\r\n            let explorer: ExploreForResource = shuffle(this.explorers).find(explorerForStored)\r\n            // console.log(\"Looked for explorer, found: \", { explorer })\r\n            return explorer\r\n        }\r\n    }\r\n}\r\n","import { Actor, Color, Traits, Vector, VisibleEvent } from \"excalibur\";\r\nimport { Building } from \"./Building\";\r\nimport { Planet } from \"./Planet/Planet\";\r\nimport { ResourceBlock, blockColor } from \"../models/Economy\";\r\nimport { Game } from \"../Game\";\r\nimport { eachCons, deleteByValueOnce, sleep, containsUniq, deleteByValue, sample } from \"../Util\";\r\nimport { Device } from \"./Device\";\r\nimport { Scale } from \"../values/Scale\";\r\nimport { ProductionStrategy } from \"../strategies/ProductionStrategy\";\r\nimport { CapacityBasedProduction } from \"../strategies/CapacityBasedProduction\";\r\nimport { drawStar, drawRect, drawCircle, drawEllipse } from \"../Painting\";\r\nimport { ConstructionStrategy } from \"../strategies/ConstructionStrategy\";\r\nimport { ProxmityBasedConstruction } from \"../strategies/ProximityBasedConstruction\";\r\nimport { SleepingStrategy } from \"../strategies/SleepingStrategy\";\r\nimport { AnyBedSleepingStrategy } from \"../strategies/AnyBedSleepingStrategy\";\r\nimport { EatingStrategy } from \"../strategies/EatingStrategy\";\r\nimport { WhenHungryEatingStrategy } from \"../strategies/WhenHungryEatingStrategy\";\r\nimport { DeviceSize, getVisibleDeviceSize } from \"../values/DeviceSize\";\r\n\r\nexport class Citizen extends Actor {\r\n    isPlanning: boolean = false // \r\n\r\n    // walkSpeed: number = Game.citizenSpeed\r\n    carrying: ResourceBlock[] = [] // null\r\n    path: Vector[] = []\r\n\r\n    private workInProgress: boolean = false\r\n    private workStarted: number\r\n    private workDuration: number\r\n    private progress: number\r\n\r\n    private sleeping: boolean = false\r\n\r\n\r\n    private productionStrategy: ProductionStrategy\r\n    private constructionStrategy: ConstructionStrategy\r\n    private sleepingStrategy: SleepingStrategy\r\n    private eatingStrategy: EatingStrategy\r\n\r\n    private hunger: number = 0.0;\r\n    private energy: number = 100\r\n\r\n    driving: Device = null\r\n\r\n    private shirtColor: Color\r\n\r\n    constructor(public name: string, private home: Vector, protected planet: Planet, private elite: boolean = false) {\r\n        super(home.x, home.y, Scale.minor.first, Scale.minor.fourth, Color.White.clone())\r\n        this.traits = this.traits.filter(trait => !(trait instanceof Traits.OffscreenCulling))\r\n\r\n        this.productionStrategy = new CapacityBasedProduction(this)\r\n        this.constructionStrategy = new ProxmityBasedConstruction(this)\r\n        this.sleepingStrategy = new AnyBedSleepingStrategy(this)\r\n        this.eatingStrategy = new WhenHungryEatingStrategy(this)\r\n\r\n\r\n        this.shirtColor = sample([\r\n            Color.Green,\r\n            Color.Blue,\r\n            Color.Red\r\n        ]).clone()\r\n    }\r\n\r\n    get isHungry() { return this.hunger > 0.6 }\r\n    get isTired()  { return this.energy < 90 }\r\n\r\n    // get isWorking() { return this.isWorking }\r\n    get currentPlanet() { return this.planet }\r\n\r\n    get walkSpeed() {\r\n        let speedMultiplier = this.planet.timeFactor * (this.elite ? 1.6 : 1)\r\n        return Game.citizenSpeed * speedMultiplier\r\n    }\r\n\r\n    update(engine, delta) {\r\n        super.update(engine, delta)\r\n\r\n\r\n        // check wip\r\n        if (this.workInProgress) {\r\n            let now = (new Date()).getTime()\r\n            this.progress = \r\n              Math.min(\r\n                  (now - this.workStarted) / this.workDuration,\r\n                  1\r\n              )\r\n\r\n            this.energy -= 0.1\r\n            this.hunger += 0.001\r\n        } else if (this.path.length > 0) {\r\n            // we have a non-empty path\r\n        } else {\r\n\r\n            // we aren't working or walking -- make sure we are busy!\r\n            this.work()\r\n        }\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        let { x, y } = this\r\n        if (this.driving) {\r\n\r\n            x = this.driving.pos.add(this.driving.building.pos).x //- getVisibleDeviceSize(this.driving.size)/2\r\n            y = this.driving.pos.add(this.driving.building.pos).y // - 14\r\n        } \r\n\r\n        ctx.save()\r\n        // ctx.globalAlpha = 1.0\r\n        ctx.translate(x, y - this.getHeight()/2 - 5)\r\n        if (this.sleeping) {\r\n            ctx.rotate(-Math.PI / 2);\r\n            ctx.translate(5, -10)\r\n        }\r\n        // ctx.globalAlpha = 1.0 //?\r\n\r\n        this.drawSelf(ctx)\r\n        \r\n\r\n        if (this.elite) {\r\n            // draw a little star?\r\n            drawStar(ctx, 12, -8)\r\n        }\r\n\r\n        // super.draw(ctx, delta)\r\n        if (this.carrying) {\r\n            let dx = 5\r\n            // if (this.vel.x < 0) { dx = -5 }\r\n            this.carrying.forEach((carried, idx) => {\r\n                ctx.fillStyle = blockColor(carried).clone().saturate(0.2).toRGBA()\r\n                ctx.fillRect(dx, 2 - 4 * idx, 5, 5)\r\n            })\r\n        }\r\n        ctx.restore()\r\n\r\n        if (this.workInProgress) {\r\n            ctx.lineWidth = 1\r\n            let pw = 10 + Math.floor(this.workDuration / 10000), ph = 3\r\n            let px = this.x - pw/2, py = this.y - 10;\r\n            ctx.strokeStyle = Color.White.toRGBA()\r\n            ctx.strokeRect(px, py, pw, ph)\r\n            ctx.fillStyle = Color.Violet.darken(0.9).toRGBA()\r\n            ctx.fillRect(px, py, pw, ph)\r\n            ctx.fillStyle = Color.Violet.toRGBA()\r\n            ctx.fillRect(px, py, this.progress * pw, ph)\r\n        }\r\n\r\n        // let debugPath = true\r\n        if (this.path && Game.debugPath) {\r\n            let c = Color.White.clone().lighten(0.5)\r\n            c.a = 0.5\r\n            eachCons(this.path, 2).forEach(([a,b]) => {\r\n                ctx.beginPath()\r\n                ctx.moveTo(a.x,a.y)\r\n                ctx.lineTo(b.x,b.y)\r\n                ctx.strokeStyle = c.toRGBA()\r\n                ctx.lineWidth = 4\r\n                ctx.stroke()\r\n            })\r\n        }\r\n    }\r\n\r\n    private drawSelf(ctx: CanvasRenderingContext2D) {\r\n        // assume we are at 0,0 and draw ourselves\r\n        drawRect(\r\n            ctx,\r\n            { x: 0, y: 0, width: this.getWidth(), height: this.getHeight() },\r\n            0,\r\n            Color.White\r\n        )\r\n\r\n        drawCircle(ctx, 2, 8,\r\n            9, // 5,\r\n            this.shirtColor.desaturate(0.5).lighten(0.4))\r\n\r\n        drawCircle(ctx, 2, -4,\r\n             4.5, Color.Orange.lighten(0.8))\r\n\r\n    }\r\n\r\n    async progressBar(duration: number) {\r\n        this.workInProgress = true\r\n        this.workStarted = (new Date()).getTime()\r\n        this.workDuration = duration\r\n        await new Promise((resolve, reject) => setTimeout(resolve, duration));\r\n        this.workInProgress = false\r\n    }\r\n\r\n\r\n    carry(c: ResourceBlock) {\r\n        this.carrying.push(c);\r\n    }\r\n\r\n    isCarryingUnique(resources: ResourceBlock[]): boolean {\r\n        let isCarrying = containsUniq(this.carrying, resources)\r\n        return isCarrying\r\n    }\r\n\r\n    drop(res: ResourceBlock): ResourceBlock {\r\n        if (this.carrying.length > 0) {\r\n            if (this.carrying.find(r => r === res)) {\r\n                deleteByValueOnce(this.carrying, res)\r\n                return res\r\n            }\r\n        }\r\n        return null\r\n    }\r\n\r\n    currentBuilding: Building = null\r\n    async visit(device: Device) {\r\n        let target = this.targetForDevice(device)\r\n        if (this.currentBuilding != device.building) {\r\n            const path = this.planet.pathBetweenPoints(this.pos.clone(), target)\r\n            path.pop()\r\n\r\n            await this.followPath(path)\r\n        }\r\n        await this.glideTo(target)\r\n        this.currentBuilding = device.building\r\n    }\r\n\r\n    private targetForDevice(device: Device) {\r\n        let target = device.pos.add(device.building.pos)\r\n        if (device.parentDevice) {\r\n            target = (device.parentDevice.pos).add(device.building.pos)\r\n            target.x += device.pos.x\r\n            target.y += getVisibleDeviceSize(device.parentDevice.size) / 2\r\n        } else {\r\n            target.y += getVisibleDeviceSize(device.size) / 2\r\n        }\r\n        return target\r\n    }\r\n\r\n    glideTo(pos: Vector) {\r\n        if (pos) {\r\n            return this.actions.moveTo(pos.x, pos.y, this.walkSpeed).asPromise()\r\n        }\r\n    }\r\n\r\n    async followPath(path: Vector[]) {\r\n        if (path.length > 0) {\r\n            this.path = path\r\n            await Promise.all(\r\n                path.map(step => this.glideTo(step))\r\n            )\r\n            this.path = []\r\n        }\r\n    }\r\n    \r\n    protected get strategies() {\r\n        return [\r\n            this.sleepingStrategy,\r\n            this.eatingStrategy,\r\n            this.constructionStrategy,\r\n            this.productionStrategy\r\n        ]\r\n    }\r\n\r\n    async work() {\r\n        if (this.isPlanning || this.sleeping) { return }\r\n\r\n        this.isPlanning = true\r\n        // just get rid of it??\r\n        if (this.carrying.length > 0) { this.carrying = [] }\r\n        let choice = this.strategies.find(strat => strat.canApply())\r\n        if (choice) {\r\n            await choice.attempt()\r\n            this.energy -= 1\r\n            this.hunger += 0.01\r\n        }\r\n        this.isPlanning = false\r\n    }\r\n\r\n    async takeRest(duration: number = 8 * 60 * Game.minuteTickMillis) {\r\n        console.log(\"Citizen taking a well-deserved rest!!\")\r\n        this.sleeping = true\r\n        await this.progressBar(duration)\r\n        this.energy = 100\r\n        this.sleeping = false\r\n    }\r\n\r\n    async eat() {\r\n        console.log(\"Citizen eating a meal!\")\r\n        // this.eating = true\r\n        let thirtyMinuteTimer = 30 * Game.minuteTickMillis\r\n        await this.progressBar(thirtyMinuteTimer)\r\n        deleteByValueOnce(this.carrying, ResourceBlock.Meal)\r\n        this.hunger = 0\r\n    }\r\n}","import { Actor, Traits } from 'excalibur';\r\nimport { Citizen } from '../Citizen';\r\nimport { Planet } from './Planet';\r\nimport { Device } from '../Device';\r\nimport { World } from '../../models/World';\r\n\r\nexport class Population extends Actor {\r\n    citizens: Citizen[] = [];\r\n    constructor(private planet: Planet) {\r\n        super(0, -planet.getHeight() / 2, 0, 0);\r\n        this.traits = this.traits.filter(trait => !(trait instanceof Traits.OffscreenCulling));\r\n    }\r\n\r\n    increase(pos, elite: boolean = false) {\r\n        let citizen = new Citizen(World.nameCitizen(), pos, this.planet, elite);\r\n        citizen.work();\r\n        this.citizens.push(citizen);\r\n        this.add(citizen);\r\n    }\r\n}\r\n","import { Graph } from \"../../values/Graph\";\r\nimport { Vector } from \"excalibur\";\r\nimport { Building } from \"../Building\";\r\nimport { minBy } from \"../../Util\";\r\n\r\nexport class NavigationTree {\r\n   graph: Graph<Vector>\r\n\r\n   constructor(root: Building) {\r\n       this.graph = root.graph()\r\n   }\r\n\r\n   seekPath(origin: Vector, dest: Vector): Vector[] {\r\n      return this.graph.shortestPath(origin, dest)\r\n   }\r\n\r\n   closestNode(testNode: Vector) {\r\n       let nodes = this.graph.dfs()\r\n       let closest = minBy(nodes,\r\n           (node: Vector) => Math.abs(testNode.distance(node))\r\n       )\r\n       if (closest) {\r\n           return closest\r\n       }\r\n       return false\r\n   }\r\n}","import { Actor, Vector, Traits, Color } from 'excalibur';\r\nimport { Building } from '../Building';\r\nimport { minBy, flatSingle } from '../../Util';\r\nimport { Structure } from '../../models/Structure';\r\nimport { NavigationTree } from './NavigationTree';\r\nimport { Machine } from '../../models/Machine';\r\nimport { Device } from '../Device';\r\nimport { Game } from '../../Game';\r\n\r\nexport class Colony extends Actor {\r\n    navTree: NavigationTree;\r\n    buildings: Building[] = [];\r\n    currentlyConstructing: Building | Device = null;\r\n\r\n    constructor(x: number, y: number) {\r\n        super(x, y, 0, 0); // 1000, 1000);\r\n        this.traits = this.traits.filter(trait => !(trait instanceof Traits.OffscreenCulling));\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        super.draw(ctx, delta);\r\n\r\n        let debugTree = Game.debugPath\r\n        if (this.navTree && debugTree) {\r\n            let edges = this.navTree.graph.edgeList();\r\n            edges.forEach((edge) => {\r\n                let [a,b] = edge;\r\n                var gradient = ctx.createLinearGradient(a.x,a.y+this.pos.y,b.x,b.y+this.pos.y);\r\n\r\n                gradient.addColorStop(0, 'green');\r\n                gradient.addColorStop(1, 'blue');\r\n\r\n                ctx.beginPath()\r\n                ctx.moveTo(a.x, a.y + this.pos.y)\r\n                ctx.lineTo(b.x, b.y + this.pos.y)\r\n                ctx.closePath()\r\n                ctx.strokeStyle = gradient\r\n                ctx.lineWidth = 0.5\r\n                ctx.stroke()\r\n            })\r\n        }\r\n\r\n    }\r\n\r\n\r\n    placeBuilding(building: Building) {\r\n        building.placed = true;\r\n        if (building.parentSlot) {\r\n            building.parentSlot.parent.childrenBuildings.push(building);\r\n            this.buildNavTree();\r\n        }\r\n        this.buildings.push(building);\r\n        building.afterConstruct();\r\n        this.add(building);\r\n    }\r\n\r\n    closestBuildingByType(cursor: Vector, structureTypes: (typeof Structure)[] = [], predicate: (Building) => boolean = () => true): Building {\r\n        let matching = this.buildings\r\n        .filter(building => //predicate(building) &&\r\n            (structureTypes.length > 0\r\n            ? structureTypes.some(st => building.structure instanceof st)\r\n            : true)\r\n             && predicate(building)\r\n        )\r\n\r\n        if (matching && matching.length > 0) {\r\n            let distanceToCursor = (building) => cursor.distance(building.nodes()[0]);\r\n            return minBy(matching, distanceToCursor);\r\n        }\r\n    }\r\n\r\n    pathBetween(origin: Vector, destination: Building): Vector[] {\r\n        if (!this.navTree) {\r\n            this.buildNavTree();\r\n        }\r\n        let srcNode = this.navTree.closestNode(origin);\r\n        let dest = destination.nodes()[0] //.length > 1 ? destination.nodes()[1] : destination.nodes()[0];\r\n        let destNode = this.navTree.closestNode(dest);\r\n        let path = this.navTree.seekPath(srcNode, destNode);\r\n        return path;\r\n    }\r\n\r\n    pathBetweenPoints(origin: Vector, destination: Vector): Vector[] {\r\n        if (!this.navTree) {\r\n            this.buildNavTree();\r\n        }\r\n        let srcNode = this.navTree.closestNode(origin);\r\n        let dest = destination; //.nodes()[0];\r\n        let destNode = this.navTree.closestNode(dest);\r\n        let path = this.navTree.seekPath(srcNode, destNode);\r\n        // console.log(\"PATH FOUND BTWN POINTS\", { srcNode, destNode, path })\r\n        return path;\r\n    }\r\n\r\n\r\n\r\n    closestDeviceByType(cursor: Vector, machineTypes: (typeof Machine)[] = [], predicate: (Device) => boolean = () => true) {\r\n        let devices = this.findPoweredDevices()\r\n        devices = devices.filter(d => \r\n            (machineTypes.length > 0 ? machineTypes.some(machine => d.machine instanceof machine) : true)\r\n             && predicate(d)\r\n        )\r\n\r\n        if (devices && devices.length > 0) {\r\n            let proximity = (d) => cursor.distance(d.pos.add(d.building.pos))\r\n            return minBy(devices, proximity)\r\n        }\r\n    }\r\n\r\n    private buildNavTree() {\r\n        let ctrl = this.buildings[0] //.find(building => building.structure instanceof MissionControl);\r\n        if (ctrl) {\r\n            this.navTree = new NavigationTree(ctrl);\r\n        }\r\n    }\r\n\r\n    findAllDevices(): Device[] {\r\n        return flatSingle(this.buildings.map(b => b.getDevices()))\r\n    }\r\n\r\n    findPoweredDevices(): Device[] {\r\n        return flatSingle(this.activeBuildings.map(b => b.getDevices()))\r\n            .filter(d => d.built) /// ....\r\n    }\r\n\r\n    protected get activeBuildings() {\r\n        return this.buildings.filter(b => b.isActive)\r\n    }\r\n}\r\n","import * as ex from 'excalibur';\r\nimport { Actor, Color, Vector } from 'excalibur';\r\nimport { Building } from '../Building';\r\nimport { range, flatSingle, mixColors } from '../../Util';\r\nimport { Structure } from '../../models/Structure';\r\nimport { Hud } from '../Hud/Hud';\r\nimport { ResourceBlock, Economy, sumMarkets, emptyMarket, availableCapacity, PureValue } from '../../models/Economy';\r\nimport { Colony } from './Colony';\r\nimport { Population } from './Population';\r\nimport { Machine } from '../../models/Machine';\r\nimport { Device } from '../Device';\r\nimport { MechanicalOperation } from '../../models/MechanicalOperation';\r\nimport { World } from '../../models/World';\r\nimport { Colorize } from 'excalibur/dist/Drawing/SpriteEffects';\r\nimport { SkyLayers } from './SkyLayers';\r\n\r\nexport class Planet extends Actor {\r\n    colony: Colony\r\n    population: Population\r\n    // baseColor: Color\r\n    sky: Actor\r\n    skyLayers: SkyLayers\r\n\r\n    constructor(\r\n        public world: World,\r\n        public hud: Hud,\r\n        // public color: Color,\r\n        private onBuildingHover: (b: Building) => any,\r\n        private onDeviceHover: (d: Device) => any,\r\n        private w: number = 200000,\r\n        private depth: number = 40000,\r\n    ) {\r\n        super(0, depth / 2, w, depth, world.color)\r\n        this.traits = this.traits.filter(trait => !(trait instanceof ex.Traits.OffscreenCulling))\r\n\r\n        this.sky = new Actor(0, -depth, w, depth, world.skyColor)\r\n        this.add(this.sky)\r\n\r\n        let yBase = -depth / 2\r\n        let crustHeight = 40\r\n        this.createLayer(yBase, crustHeight, this.color.lighten(0.45))\r\n\r\n\r\n        let layerCount = 10\r\n        let layerHeight = depth / layerCount\r\n        for (let i of range(layerCount)) {\r\n            this.createLayer(\r\n                yBase + crustHeight + (layerHeight / 2) + (layerHeight * (i + 1)),\r\n                layerHeight,\r\n                this.color.darken(0.05 + 0.01 * i)\r\n            )\r\n        }\r\n        let c = this.color.clone()\r\n\r\n        this.skyLayers =new SkyLayers(\r\n           -depth/2, // - 20,\r\n           this.getWidth(),\r\n           this.color.lighten(0.04),\r\n           world.skyColor,\r\n           20\r\n        )\r\n        this.add(this.skyLayers)\r\n\r\n        this.colony = new Colony(0, -depth / 2)\r\n        this.add(this.colony)\r\n\r\n        this.population = new Population(this)\r\n        this.add(this.population)\r\n\r\n    }\r\n\r\n\r\n    private currentHour: number\r\n    get hour() { return this.currentHour }\r\n\r\n    setTime(time: number) {\r\n        this.hour = (Math.floor(time / 60)) % 24\r\n\r\n        let nextHour = this.hour + 1\r\n\r\n        let minute = Math.floor(time % 60)\r\n        let inc = (minute / 60)\r\n        // console.log({ hour: this.hour, nextHour: nextHour, minute, inc })\r\n\r\n        let oldC = this.skyColorForHour(this.hour),\r\n            newC = this.skyColorForHour(nextHour)\r\n\r\n        let mixC = mixColors(newC, oldC, inc)\r\n\r\n        // this.sky.color = mixC // skyColor\r\n        this.assignColors(mixC)\r\n    }\r\n\r\n    private assignColors(skyColor: Color) {\r\n        this.sky.color = skyColor\r\n\r\n        let inc = 0.04\r\n\r\n        let c = mixColors(\r\n            this.sky.color.lighten(5 * inc), //.lighten(3*inc).saturate(5*inc),\r\n            this.color.darken(5 * inc), //.lighten(2*inc)\r\n            0.7\r\n        )\r\n\r\n        this.skyLayers.setHi(c)\r\n\r\n        // this.skyLayer.mountainLayers.color = this.color.lighten(inc) //0.1)\r\n        // this.skyLayer.mountainLayers.skyColor = c.lighten(inc)\r\n        // this.skyLayer.mountains.color = c.lighten(inc)\r\n        // this.skyLayer.backMountainLayers.color = c.lighten(inc)\r\n        // this.skyLayer.backMountainLayers.skyColor = c.lighten(inc * 3).desaturate(inc)\r\n    }\r\n\r\n    skyColorForHour(hour: number) {\r\n        let c = this.world.skyColor.clone().darken(0.2).desaturate(0.1)\r\n\r\n        let colorMap = {\r\n            night: c.darken(0.7),\r\n            dawn: c.darken(0.2),\r\n            morning: c.lighten(0.1),\r\n            afternoon: c.lighten(0.2).desaturate(0.1),\r\n            evening: c,\r\n        }\r\n\r\n        let result: Color = null\r\n        if (hour >= 5 && hour < 8) { // dawn\r\n            let inc = (hour - 6) / 5\r\n            result = colorMap.dawn.lighten(inc)\r\n        } else if (hour >= 8 && hour < 12) { // morning\r\n            let inc = (hour - 8) / 24\r\n            result = colorMap.morning.lighten(inc)\r\n        } else if (hour >= 12 && hour < 14) { // early afternoon\r\n            result = colorMap.afternoon //.darken(inc)\r\n        } else if (hour >= 14 && hour < 18) {  // late afternoon\r\n            let inc = (hour - 14) / 16\r\n            result = colorMap.afternoon.darken(inc)\r\n        } else if (hour >= 18 && hour < 23) { // evening\r\n            let inc = (hour - 18) / 10\r\n            result = colorMap.evening.darken(inc)\r\n        } else if (hour >= 23) { // late night\r\n            result = colorMap.night\r\n        } else if (hour < 5) { // early morning\r\n            result = colorMap.night\r\n        }\r\n        return result\r\n    }\r\n\r\n    set hour(hour: number) {\r\n        this.currentHour = hour\r\n    }\r\n\r\n    set currentlyViewing(buildingOrDevice: Building | Device) {\r\n        if (buildingOrDevice instanceof Building) {\r\n            let b: Building = buildingOrDevice\r\n            this.onBuildingHover(b)\r\n        } else if (buildingOrDevice instanceof Device) {\r\n            let d: Device = buildingOrDevice\r\n            this.onDeviceHover(d)\r\n        }\r\n    }\r\n\r\n    private createLayer(y: number, size: number, color: Color) {\r\n        let theLayer = new Actor(0, y, this.getWidth(), size, color);\r\n        this.add(theLayer);\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta) {\r\n        super.draw(ctx, delta)\r\n\r\n        if (this.currentlyConstructing) {\r\n            this.currentlyConstructing.draw(ctx, delta)\r\n        }\r\n    }\r\n\r\n    get economy(): Economy {\r\n        // let devices = this.colony.findPoweredDevices()\r\n        // let economies = devices.map((d: Device) => d.machine.economy)\r\n\r\n        let buildings = this.colony.buildings\r\n        let economies = buildings.map(b => b.economy())\r\n        let theEconomy = economies.reduce(sumMarkets, emptyMarket())\r\n\r\n        let popularDemand = this.population.citizens.length\r\n        theEconomy['Shelter'].demand = popularDemand\r\n        theEconomy['Oxygen'].demand += popularDemand\r\n        theEconomy['Water'].demand += popularDemand\r\n        return theEconomy\r\n    }\r\n\r\n    update(engine, delta) {\r\n        super.update(engine, delta)\r\n\r\n        this.colony.buildings.forEach(building => building.update(engine, delta))\r\n        this.population.citizens.forEach(citizen => citizen.update(engine, delta))\r\n    }\r\n\r\n    get currentlyConstructing() {\r\n        return this.colony.currentlyConstructing\r\n    }\r\n\r\n    gather(resource: ResourceBlock): any {\r\n        this.hud.resourceGathered(resource)\r\n    }\r\n\r\n    spend(resource: ResourceBlock): any {\r\n        this.hud.resourceExpended(resource)\r\n    }\r\n\r\n    placeBuilding(building: Building) {\r\n        this.colony.placeBuilding(building)\r\n    }\r\n\r\n    populate(pos: Vector, elite: boolean = false) {\r\n        if (this.population.citizens.length < this.maxPop) {\r\n            // console.log(\"POPULATIN'!\")\r\n            // let home = this.closestDevice(pos, [CloningVat])\r\n            this.population.increase(pos, elite) //home)\r\n        } else {\r\n            console.warn(\"too many citizens already to populate more!\")\r\n        }\r\n    }\r\n\r\n    get maxPop() {\r\n        let devices = this.colony.findPoweredDevices()\r\n        let economies = devices.map((d: Device) => d.machine.economy)\r\n        let theEconomyWithoutPeople = economies.reduce(sumMarkets, emptyMarket())\r\n\r\n        let values = [PureValue.Shelter, PureValue.Water, PureValue.Oxygen]\r\n        return Math.max(0, Math.min(\r\n            ...values.map(val => availableCapacity(theEconomyWithoutPeople, val))\r\n        ))\r\n    }\r\n\r\n    closestBuildingByType(cursor: Vector, structureTypes: (typeof Structure)[], predicate: (Building) => boolean = () => true): Building {\r\n        return this.colony.closestBuildingByType(cursor, structureTypes, predicate)\r\n    }\r\n\r\n    closestDevice(cursor: Vector, machineTypes: (typeof Machine)[] = [], predicate: (Device) => boolean = () => true) {\r\n        return this.colony.closestDeviceByType(cursor, machineTypes, predicate);\r\n    }\r\n\r\n    pathBetween(origin: Vector, destination: Building): Vector[] {\r\n        return this.colony.pathBetween(origin, destination)\r\n    }\r\n\r\n    pathBetweenPoints(origin: Vector, destination: Vector): Vector[] {\r\n        return this.colony.pathBetweenPoints(origin, destination)\r\n    }\r\n\r\n    get timeFactor() {\r\n        let devices = this.colony.findPoweredDevices()\r\n        let ops: MechanicalOperation[] = devices.map(d => d.operation) //.filter(op => op.type === 'accelerate')\r\n        return ops\r\n            .map(op => op.type === 'accelerate' ? op.factor : 1)\r\n            .reduce((acc, val) => val * acc, 1.0)\r\n    }\r\n\r\n    get storedResources(): ResourceBlock[] {\r\n        let devices = this.colony.findAllDevices()\r\n        return flatSingle(devices.map(d => d.product))\r\n    }\r\n\r\n    hasMachineKind(kind: typeof Machine) {\r\n        return this.colony.findPoweredDevices().find(d => d.machine instanceof kind);\r\n    }\r\n}","import { Color } from \"excalibur\";\r\nimport { Pane } from \"./Pane\";\r\nimport { Citizen } from \"../Citizen\";\r\nexport class CitizenList extends Pane {\r\n    citizens: Citizen[] = [];\r\n    constructor(x: number, y: number, private onCitizenSelect: (Citizen) => any = null) {\r\n        super(\"Citizens\", x, y);\r\n    }\r\n    updateRoster(citizens: Citizen[]): any {\r\n        this.citizens = citizens;\r\n        this.makeRoster();\r\n    }\r\n    private makeRoster() {\r\n        this.makeRootElement();\r\n        this.citizens.forEach(citizen => {\r\n            let btn = this.buttonFactory(citizen.name, Color.DarkGray);\r\n            this._element.appendChild(btn);\r\n            if (this.onCitizenSelect) {\r\n                btn.onclick = () => { this.onCitizenSelect(citizen); };\r\n            }\r\n        });\r\n    }\r\n}\r\n","import { Color } from \"excalibur\";\r\nimport { Game } from \"../../Game\";\r\nexport class Modal {\r\n    private _element: HTMLDivElement\r\n\r\n    private _header: HTMLDivElement\r\n    private _body: HTMLDivElement\r\n    private _footer: HTMLDivElement\r\n    // private titleLabel: Label\r\n    // private messageLabel: Label\r\n    constructor(private title: string, private message: string, private x: number, private y: number, private width: number = 500) {\r\n        this.makeDialog();\r\n        // super(x,y,200,200, Color.DarkGray)\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D): any {\r\n        // console.log(\"DRAW MODAL\")\r\n        if (this._element) {\r\n            let left = ctx.canvas.offsetLeft - this.width/2;\r\n            let top = ctx.canvas.offsetTop - this._element.clientHeight/2;\r\n            this._element.style.left = `${left + this.x}px`;\r\n            this._element.style.top = `${top + this.y}px`;\r\n        }\r\n    }\r\n\r\n    addButtons(buttonMap: {\r\n        [intent: string]: () => any;\r\n    }) {\r\n        // throw new Error(\"Method not implemented.\");\r\n        let buttons = Object.entries(buttonMap)\r\n        buttons.forEach(([intent, cb]) => {\r\n            let btn = this.buttonFactory(intent, Color.Gray, this.width/(buttons.length))\r\n            btn.onclick = cb\r\n            this._footer.appendChild(btn)\r\n        })\r\n    }\r\n\r\n    teardown() {\r\n        document.body.removeChild(this._element)\r\n        // throw new Error(\"Method not implemented.\");\r\n    }\r\n\r\n    private makeDialog() {\r\n        this._element = document.createElement('div');\r\n        this._element.style.position = 'absolute';\r\n        this._element.style.display = 'flex';\r\n        this._element.style.flexWrap = 'wrap';\r\n        this._element.style.width = `${this.width}px`;\r\n        this._element.style.border = 'none'; //1px solid black'; //0.5px solid white';\r\n        document.body.appendChild(this._element);\r\n\r\n        let bg = Color.Violet.clone().darken(0.92).toRGBA()\r\n\r\n        let title = document.createElement('div');\r\n        title.textContent = this.title;\r\n        title.style.fontFamily = Game.font //'Verdana';\r\n        title.style.fontSize = '14pt';\r\n        title.style.fontWeight = '700';\r\n        title.style.textTransform = 'uppercase';\r\n        title.style.textAlign = 'center'\r\n        title.style.width = `${this.width}px`;\r\n        title.style.color = Color.White.toRGBA();\r\n        title.style.backgroundColor = bg //Color.Violet.darken(0.92).toRGBA();\r\n        title.style.padding = '12px';\r\n        title.style.margin = '0px';\r\n        this._element.appendChild(title);\r\n\r\n        this._header = document.createElement('div')\r\n        this._header.style.width = `${this.width}px`;\r\n        this._header.style.backgroundColor = bg // Color.Violet.darken(0.92).toRGBA();\r\n        this._element.appendChild(this._header)\r\n\r\n        this._body = document.createElement('div');\r\n        this._body.textContent = this.message;\r\n        this._body.style.fontFamily = Game.font //'Verdana';\r\n        this._body.style.fontSize = '9pt';\r\n        this._body.style.fontWeight = '400';\r\n        this._body.style.width = `${this.width}px`;\r\n        this._body.style.color = Color.White.toRGBA();\r\n        this._body.style.backgroundColor = bg //Color.Violet.darken(0.92).toRGBA();\r\n        this._body.style.padding = '24px';\r\n        this._body.style.paddingBottom = '48px';\r\n        this._body.style.margin = '0px';\r\n        this._element.appendChild(this._body);\r\n\r\n        this._footer = document.createElement('div')\r\n        this._footer.style.width = `${this.width}px`\r\n        this._footer.style.display = 'flex';\r\n        this._footer.style.flexWrap = 'wrap';\r\n        this._element.appendChild(this._footer)\r\n    }\r\n\r\n    addHeading(heading: string, size: number = 24, color: Color = Color.White) {\r\n        let headerMessage = document.createElement('div');\r\n        headerMessage.textContent = heading;\r\n        headerMessage.style.fontFamily = Game.font // 'Helvetica';\r\n        headerMessage.style.fontSize = `${size}pt`;\r\n        headerMessage.style.fontWeight = '600';\r\n        headerMessage.style.textAlign = 'center';\r\n        headerMessage.style.width = `${this.width}px`;\r\n        headerMessage.style.color = color.clone().toRGBA();\r\n        // headerMessage.style.backgroundColor = Color.Violet.darken(0.8).toRGBA();\r\n        headerMessage.style.padding = '0px';\r\n        headerMessage.style.margin = '0px';\r\n        this._header.appendChild(headerMessage)\r\n    }\r\n\r\n    addIconMatrix(iconSet: { image: string, label: string }[] = []) {\r\n        // build a icon matrix\r\n        let matrix = document.createElement('div')\r\n        matrix.style.display = 'flex'\r\n        matrix.style.flexWrap = 'wrap'\r\n        matrix.style.padding = '15px'\r\n        matrix.style.width = `100%` //${this.width}px`\r\n\r\n        iconSet.forEach(({ label, image }) => {\r\n            let img = new Image()\r\n            img.width = 64\r\n            img.height = 64\r\n            img.src = image\r\n            img.style.padding = '8px'\r\n\r\n            let lbl = document.createElement('span')\r\n            lbl.textContent = label\r\n            lbl.style.textAlign = 'center'\r\n            lbl.style.padding = '8px'\r\n            lbl.style.fontSize = '6pt'\r\n            lbl.style.fontFamily = Game.font\r\n\r\n            let icon = document.createElement('div')\r\n            icon.style.display = 'flex'\r\n            icon.style.flexDirection = 'column'\r\n            icon.style.padding = '4px'\r\n            icon.appendChild(img)\r\n            icon.appendChild(lbl)\r\n            \r\n            matrix.appendChild(icon)\r\n\r\n        })\r\n\r\n        this._body.appendChild(matrix)\r\n    }\r\n\r\n    private buttonFactory(label: string, color: Color = Color.DarkGray, width: number = this.width/2) {\r\n        let bg = color.darken(0.5).desaturate(0.5).clone();\r\n        bg.a = 0.8;\r\n        let fg = color.lighten(0.8).desaturate(0.4).clone();\r\n        let modalButton = document.createElement('button');\r\n        modalButton.textContent = label;\r\n        modalButton.style.display = 'block';\r\n        modalButton.style.fontSize = '7pt';\r\n        modalButton.style.fontFamily = Game.font //'Verdana';\r\n        modalButton.style.fontWeight = '500';\r\n        modalButton.style.padding = '20px';\r\n        modalButton.style.width = `${width}px`;\r\n        modalButton.style.textTransform = 'uppercase';\r\n        modalButton.style.border = 'none'; //1px solid rgba(255,255,255,0.08)';\r\n        modalButton.style.background = bg.toRGBA();\r\n        modalButton.style.color = fg.toRGBA();\r\n        modalButton.onmouseover = () => {\r\n            modalButton.style.background = bg.saturate(0.5).lighten(0.95).toRGBA();\r\n            modalButton.style.color = fg.lighten(0.9).toRGBA();\r\n        };\r\n        modalButton.onmouseleave = () => {\r\n            modalButton.style.background = bg.toRGBA();\r\n            modalButton.style.color = fg.toRGBA();\r\n        };\r\n        return modalButton;\r\n    }\r\n}\r\n","import { Color } from \"excalibur\";\r\nimport { EntityKind } from \"../../values/Entity\";\r\nimport { onlyUnique } from \"../../Util\";\r\nimport { Pane } from \"./Pane\";\r\n\r\nexport class Palette extends Pane {\r\n    built: EntityKind[] = [];\r\n    comprehended: EntityKind[] = [];\r\n\r\n    constructor(\r\n        name: string,\r\n        x: number,\r\n        y: number,\r\n        private all: EntityKind[],\r\n        private onButtonClick: (EntityKind) => any = null,\r\n        private onButtonEnter: (EntityKind) => any = null,\r\n        private comprehend = true \r\n    ) {\r\n        super(name, x, y)\r\n        this.makePalette();\r\n    }\r\n\r\n\r\n    updateBuilt(built: (EntityKind)[], unlocked: (EntityKind)[] = []) {\r\n        this.built = built;\r\n        if (this.comprehend) {\r\n            let nowComprehended = this.all.filter((e: EntityKind) => {\r\n                let s = new e();\r\n                let prereqs: (EntityKind)[] = s.prereqs;\r\n                return prereqs.every((prereq: EntityKind) => {\r\n                    let built = this.built.some((s: EntityKind) => s === prereq);\r\n                    return built;\r\n                });\r\n            });\r\n            this.comprehended = [\r\n                ...nowComprehended,\r\n                ...unlocked\r\n            ].filter(onlyUnique)\r\n        } else {\r\n            this.comprehended = [ ...this.built, ...unlocked ].filter(onlyUnique)\r\n        }\r\n        this.makePalette();\r\n    }\r\n\r\n    private makePalette() {\r\n\r\n        this.makeRootElement()\r\n\r\n\r\n        this.comprehended\r\n            .map((elem: EntityKind) => new elem())\r\n            .sort((a, b) => a.color > b.color ? -1 : 1)\r\n            .forEach(elem => {\r\n                if (elem.hide) { return }\r\n                let label = elem.name;\r\n                if (!this.built.map(m => new m().name).includes(elem.name)) {\r\n                    label += ' *';\r\n                }\r\n                let clr = elem.color;\r\n                let btn = this.buttonFactory(label, clr);\r\n                this._element.appendChild(btn);\r\n                if (this.onButtonEnter) {\r\n                    btn.onmouseenter = () => { this.onButtonEnter(elem); };\r\n                }\r\n                if (this.onButtonClick) {\r\n                    btn.onclick = () => { this.onButtonClick(elem); };\r\n                }\r\n            });\r\n    }\r\n\r\n}\r\n","import { Label, Actor, FontStyle, Color } from \"excalibur\";\r\nimport { Structure } from \"../../models/Structure\";\r\nimport { Machine } from \"../../models/Machine\";\r\nimport { PureValue, Economy, ResourceBlock } from \"../../models/Economy\";\r\nimport { RoomRecipe } from \"../../models/RoomRecipe\";\r\nimport { Building } from \"../Building\";\r\nimport { Device } from \"../Device\";\r\nimport { countOccurrences, flatSingle } from \"../../Util\";\r\nimport { Game } from \"../../Game\";\r\n\r\nexport class CardBody extends Actor {\r\n    description: Label\r\n    values: Label\r\n    notes: Label\r\n    footer: Label\r\n\r\n    constructor(private entity: Machine | Structure | RoomRecipe | Building | Device, x: number, y: number) {\r\n        super(x, y, 0, 0)\r\n        // resources / recipes\r\n\r\n        this.values = new Label('', 0, 0, Game.font)\r\n        this.values.fontSize = 10\r\n        this.add(this.values)\r\n\r\n        this.notes = new Label('behavioral notes', 0, 30, Game.font)\r\n        this.notes.fontSize = 11\r\n        this.add(this.notes)\r\n\r\n        this.description = new Label('description', 0, 60, Game.font)\r\n        this.description.fontSize = 12\r\n        this.description.fontStyle = FontStyle.Italic\r\n        this.description.color = Color.DarkGray\r\n        this.add(this.description)\r\n\r\n        this.footer = new Label('footer', 20, 80, Game.font)\r\n        this.footer.fontSize = 10\r\n        this.footer.fontStyle = FontStyle.Italic\r\n        this.add(this.footer)\r\n\r\n        this.show(entity)\r\n    }\r\n\r\n    describeResources = (arr: ResourceBlock[]) => {\r\n        let freqs = countOccurrences(arr)\r\n        return Object.keys(freqs)\r\n            .map(elem => `${elem} x${freqs[elem]}`)\r\n            .join(' + ')\r\n    }\r\n\r\n    show(entity: Machine | Structure | RoomRecipe | Building | Device) {\r\n        if (entity) {\r\n            this.description.text = entity.description;\r\n\r\n            if (entity instanceof Machine || entity instanceof Device) {\r\n                this.values.text =  this.describeEconomy(entity.economy)\r\n                // let footerNotes = []\r\n                let resourceDescription = entity instanceof Machine\r\n                    ? `Cost: ${this.describeResources(entity.cost)}`\r\n                    : (entity.built ? this.describeResources(entity.product) : 'under construction')\r\n                let forDome = entity instanceof Machine ? entity.forDome : entity.machine.forDome\r\n                let domeStatus = `For Dome: ${forDome ? 'Yes' : 'No'}`\r\n                this.footer.text = resourceDescription === ''\r\n                    ? domeStatus\r\n                    : [resourceDescription, domeStatus].join(' | ') \r\n                this.notes.text = '' //\r\n                let op = entity.operation\r\n                if (op) {\r\n                    if (op.type === 'recipe') {\r\n                        this.notes.text = `Turns ${op.consumes.join(' + ')} -> ${op.produces}.`\r\n                    } else if (op.type === 'generator') {\r\n                        this.notes.text = `Generates ${op.generates}.`\r\n                    } else if (op.type === 'store') {\r\n                        this.notes.text = `Stores ${op.stores.join(' + ')}`\r\n                    } else if (op.type === 'spawn') {\r\n                        this.notes.text = 'Decants clones.'\r\n                    }\r\n                }\r\n            } else if (entity instanceof RoomRecipe) {\r\n                let { capacity, workSpeed } = entity.bonuses\r\n                let bonusMessages = [];\r\n                if (capacity > 0) {\r\n                    bonusMessages.push(`+${capacity} cap`)\r\n                }\r\n                if (workSpeed > 1.0) {\r\n                    bonusMessages.push(`+${Math.floor((workSpeed*100)-100)}% efficiency` )\r\n                }\r\n                this.values.text = bonusMessages.join('; ') \r\n                this.notes.text = entity.machines.map(m => (new m()).name).join(' + ')\r\n                this.footer.text = ''\r\n            } else if (entity instanceof Building) {\r\n                this.values.text =  this.describeEconomy(entity.economy(false))\r\n                this.notes.text = entity.getDevices().map(d => d.machine.name).join(' + ')\r\n\r\n                let product = entity.getDevices()\r\n                    .map(d => d.product)\r\n                    .reduce((a, b) => a.concat(b), [])\r\n                this.footer.text = product.length > 0\r\n                    ? \"Currently contains: \" + this.describeResources(product)\r\n                    : ''\r\n            } else {\r\n                this.values.text = ''\r\n                this.notes.text = ''\r\n                this.footer.text = ''\r\n            }\r\n\r\n        }\r\n        // other bonuses? behaviors?\r\n    }\r\n\r\n    private describeEconomy(e: Economy): string {\r\n        let values = []\r\n        let econ = e // entity.economy\r\n        for (let value in PureValue) {\r\n            let { supply, demand } = econ[value]\r\n            let delta = supply - demand\r\n            if (delta > 0) {\r\n                values.push(`+${delta.toFixed()} ${value}`)\r\n            } else if (delta < 0) {\r\n                values.push(`${delta.toFixed()} ${value}`)\r\n            }\r\n        }\r\n        return values.join(' | ')\r\n    }\r\n}\r\n","import { Label, Color, Actor, FontStyle } from \"excalibur\";\r\nimport { Structure } from \"../../models/Structure\";\r\nimport { Machine } from \"../../models/Machine\";\r\nimport { DeviceSize } from \"../../values/DeviceSize\";\r\nimport { RoomRecipe } from \"../../models/RoomRecipe\";\r\nimport { Building } from \"../Building\";\r\nimport { Device } from \"../Device\";\r\nimport { Game } from \"../../Game\";\r\nexport class CardTitle extends Actor {\r\n    \r\n    name: Label;\r\n    type: Label;\r\n    constructor(private entity: Machine | Structure | RoomRecipe | Building | Device, x: number, y: number) {\r\n        super(x, y, 14, 32, entity && entity.color || Color.Gray);\r\n        this.name = new Label(entity && entity.name || '..', 20, 16, Game.font)\r\n        this.name.fontSize = 28\r\n        this.name.color = Color.Black\r\n        this.add(this.name)\r\n\r\n        this.type = new Label('..', 220, 18, Game.font)\r\n        this.type.fontSize = 10\r\n        this.type.color = Color.Gray\r\n        this.type.fontStyle = FontStyle.Italic\r\n        this.add(this.type)\r\n\r\n        if (entity) {\r\n            this.announce(entity)\r\n        }\r\n    }\r\n\r\n    announce(entity: Machine | Structure | RoomRecipe | Building | Device): any {\r\n        this.name.text = entity.name\r\n        this.color = entity.color.desaturate(0.5).darken(0.2)\r\n        if (entity instanceof Machine) { this.type.text = `${DeviceSize[entity.size]} Machine Type` }\r\n        if (entity instanceof Structure) { this.type.text = 'Structure' }\r\n        if (entity instanceof RoomRecipe) { this.type.text = 'Function' }\r\n        if (entity instanceof Building) { this.type.text = 'Building' }\r\n        if (entity instanceof Device) { this.type.text = `${DeviceSize[entity.size]} Machine` }\r\n    }\r\n}\r\n","import { Color, Actor } from \"excalibur\";\r\nimport { Structure } from \"../../models/Structure\";\r\nimport { Machine } from \"../../models/Machine\";\r\nimport { CardTitle } from \"./CardTitle\";\r\nimport { CardBody } from \"./CardBody\";\r\nimport { RoomRecipe } from \"../../models/RoomRecipe\";\r\nimport { Building } from \"../Building\";\r\nimport { Device } from \"../Device\";\r\n\r\nexport class Card extends Actor {\r\n    title: CardTitle\r\n    cardBody: CardBody\r\n    image: HTMLImageElement\r\n\r\n    constructor(private entity: Machine | Structure | RoomRecipe | Building | Device, x: number, y: number) {\r\n        super(x + 160, y + 90, 320, 180, Color.White);\r\n        let x0 = -150, y0 = -50;\r\n        this.title = new CardTitle(entity, x0 - 3, y0); //x, y)\r\n        this.add(this.title);\r\n        this.cardBody = new CardBody(entity, x0 + 14, y0 + 40)\r\n        this.add(this.cardBody)\r\n\r\n        this.image = new Image();\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta) {\r\n        super.draw(ctx, delta)\r\n        if (this.entity) {\r\n            if (this.entity instanceof Machine || this.entity instanceof Device) {\r\n                // if (this.image.src !== null) {\r\n                    let ix = this.pos.x + 48, iy = this.pos.y - 16\r\n                    let isz = 92\r\n\r\n                    // maybe try-fail around this? something for painting?\r\n                    ctx.drawImage(this.image, ix, iy, isz, isz)\r\n                // }\r\n            }\r\n        }\r\n    }\r\n\r\n    present(entity: Machine | Structure | RoomRecipe | Building | Device): any {\r\n        this.title.announce(entity)\r\n        this.cardBody.show(entity)\r\n\r\n        this.entity = entity\r\n        let src = null\r\n        if (this.entity instanceof Machine) { //} || this.entity instanceof Device) {\r\n            src = this.entity.image\r\n        } else if (this.entity instanceof Device) {\r\n            src = this.entity.machine.image\r\n        }\r\n        // console.log(\"img src\", { src })\r\n        if (src) {\r\n            this.image.src = src\r\n        }\r\n    }\r\n\r\n}\r\n","import { Sound, Color } from \"excalibur\";\r\nimport { sample } from \"../../Util\";\r\nimport { Game } from \"../../Game\";\r\n\r\ninterface MusicPlayerPlay { type: 'play'}\r\ninterface MusicPlayerPause { type: 'pause'}\r\ninterface MusicPlayerStop { type: 'stop'}\r\ninterface MusicPlayerNext { type: 'next'}\r\ntype MusicPlayerAction = MusicPlayerPlay | MusicPlayerPause | MusicPlayerStop | MusicPlayerNext\r\n\r\nexport class MusicPlayer {\r\n    private _wrapper: HTMLDivElement;\r\n    private _element: HTMLDivElement;\r\n    private _titleElem: HTMLSpanElement;\r\n\r\n    currentTrack: string\r\n    paused: boolean = false\r\n\r\n    constructor(private x: number, private y: number, private playlist: {\r\n        [track: string]: Sound;\r\n    }) {\r\n        this.makePlayer();\r\n        setTimeout(() => { this.startMusic() }, 3000)\r\n        this._titleElem.textContent = `Getting ready...`;\r\n        this.currentTrack = sample(Object.keys(this.playlist)); //[0];\r\n    }\r\n\r\n    startMusic() {\r\n        this._titleElem.textContent = `Playing: ${this.currentTrack}`;\r\n        this.playlist[this.currentTrack].play()\r\n        .then(() => {\r\n                this.advancePlaylist()\r\n        })\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D) {\r\n        if (this._element) {\r\n            let left = ctx.canvas.offsetLeft;\r\n            let top = ctx.canvas.offsetTop;\r\n            this._wrapper.style.left = `${left + this.x}px`;\r\n            this._wrapper.style.top = `${top + this.y}px`;\r\n        }\r\n    }\r\n\r\n    private makePlayer() {\r\n        this._wrapper = document.createElement('div')\r\n        this._wrapper.style.position = 'absolute'\r\n        this._wrapper.style.width = '20%'\r\n        this._wrapper.style.maxHeight = '20px'\r\n        this._wrapper.style.textAlign = 'left'\r\n        this._wrapper.style.border = 'none';\r\n        this._wrapper.style.overflow = 'hidden';\r\n        document.body.appendChild(this._wrapper);\r\n\r\n        this._element = document.createElement('div');\r\n        this._element.style.display = 'inline-block';\r\n        this._element.style.border = 'none';\r\n        this._wrapper.appendChild(this._element)\r\n\r\n        this._titleElem = document.createElement('span');\r\n        this._titleElem.style.fontFamily = Game.font //'Verdana';\r\n        this._titleElem.style.fontSize = '7pt';\r\n        this._titleElem.style.padding = '24px'\r\n        this._titleElem.style.color = 'white';\r\n        this._wrapper.appendChild(this.inlineBlock(this._titleElem));\r\n\r\n        let play = this.iconFactory({ type: 'play' }, '&#9655;')\r\n        this._wrapper.appendChild(this.inlineBlock(play));\r\n\r\n        let pause = this.iconFactory({ type: 'pause' }, '&#10072; &#10072;')\r\n        this._wrapper.appendChild(this.inlineBlock(pause))\r\n\r\n        let next = this.iconFactory({ type: 'next' }, '&rarr;')\r\n        this._wrapper.appendChild(this.inlineBlock(next))\r\n\r\n    }\r\n\r\n    handleAction(action: MusicPlayerAction) {\r\n        if (action.type === 'pause') {\r\n            this.song.pause()\r\n            this.paused = true\r\n            this._titleElem.textContent = `Paused: ${this.currentTrack}`;\r\n        } else if (action.type === 'play') {\r\n            this.song.play()\r\n            this.paused = false\r\n            this._titleElem.textContent = `Playing: ${this.currentTrack}`;\r\n        } else if (action.type === 'next') {\r\n            if (this.paused) {\r\n                this.song.play()\r\n                this.paused = false\r\n            }\r\n            this.song.stop()\r\n        }\r\n    }\r\n\r\n    advancePlaylist() {\r\n        let ndx = this.trackNames.indexOf(this.currentTrack)\r\n        ndx = (ndx + 1) % this.trackNames.length\r\n        this.currentTrack = this.trackNames[ndx]\r\n        this.startMusic()\r\n    }\r\n\r\n    get trackNames() { return Object.keys(this.playlist) }\r\n    get song() { return this.playlist[this.currentTrack] }\r\n\r\n    private inlineBlock(elem) {\r\n        let block = document.createElement('div');\r\n        block.style.display = 'inline-block';\r\n        block.style.border = 'none';\r\n        block.append(elem)\r\n        return block\r\n    }\r\n\r\n    private iconFactory(\r\n        action: MusicPlayerAction,\r\n        iconContent: string,\r\n    ) {\r\n        let bg = Color.Transparent\r\n        let fg = Color.White\r\n        let icon = document.createElement('button')\r\n        icon.innerHTML = iconContent\r\n        icon.style.display = 'block';\r\n        icon.style.fontSize = '7pt';\r\n        icon.style.fontFamily = Game.font //'Verdana';\r\n        icon.style.border = 'none'\r\n        icon.style.padding = '4px'\r\n        icon.style.background = bg.toRGBA();\r\n        icon.style.color = fg.toRGBA();\r\n        icon.onclick = () => { this.handleAction(action) }\r\n        return icon\r\n    }\r\n\r\n}\r\n","import { Label, Color, Actor } from \"excalibur\";\r\nimport { Game } from \"../../Game\";\r\nexport class EconomicValue extends Actor {\r\n    private nameLabel: Label;\r\n    private valueLabel: Label;\r\n    constructor(name: string, x: number, y: number) {\r\n        super(x, y, 0, 0);\r\n        this.nameLabel = new Label(name, x, y, Game.font);\r\n        this.nameLabel.fontSize = 10;\r\n        this.nameLabel.color = Color.White.darken(0.2);\r\n        this.add(this.nameLabel);\r\n        this.valueLabel = new Label('0', x + 40, y, Game.font);\r\n        this.valueLabel.fontSize = 10;\r\n        this.valueLabel.color = Color.White.darken(0.2);\r\n        this.add(this.valueLabel);\r\n    }\r\n    setCount(count: number) {\r\n        this.valueLabel.text = `${count}`;\r\n        let c = Color.Gray;\r\n        if (count > 0) {\r\n            c = Color.Green;\r\n        }\r\n        else if (count < 0) {\r\n            c = Color.Red;\r\n        }\r\n        this.valueLabel.color = c;\r\n    }\r\n}\r\n","import { Actor, Color } from \"excalibur\";\r\nimport { Economy, PureValue, availableCapacity, allValues } from \"../../models/Economy\";\r\nimport { EconomicValue } from \"./EconomicValue\";\r\nimport { eachChunk } from \"../../Util\";\r\n\r\nexport class EconomyView extends Actor {\r\n    private valueLabels: { [key in PureValue]: EconomicValue } = {\r\n        Power: null,\r\n        Oxygen: null,\r\n        Water: null,\r\n        Shelter: null,\r\n        Hope: null,\r\n        Joy: null,\r\n        Wisdom: null,\r\n        Wealth: null,\r\n        Beauty: null,\r\n        Wonder: null\r\n    }\r\n\r\n    constructor(market: Economy, x: number, y: number) {\r\n        super(x, y, 0, 0) //Color.DarkGray.clone().darken(0.5));\r\n\r\n        let index = 0\r\n        for (let [val1, val2] of eachChunk(allValues, 2)) {\r\n            this.addValue(index * 32, 0, val1)\r\n            this.addValue(index * 32, 7, val2)\r\n            index += 1\r\n        }\r\n\r\n        this.updateView(market);\r\n    }\r\n\r\n    private addValue(x: number, y: number, value: PureValue) {\r\n        let valueLabel: EconomicValue = new EconomicValue(value, x, y)\r\n        this.valueLabels[value] = valueLabel\r\n        this.add(valueLabel)\r\n    }\r\n\r\n    updateView(updatedEconomy: Economy): void {\r\n        let market = updatedEconomy;\r\n\r\n        for (let value of allValues) {\r\n            this.valueLabels[value].setCount(\r\n                availableCapacity(market, value)\r\n            )\r\n        }\r\n\r\n    }\r\n}\r\n","import { Label, Color, Actor, UIActor } from \"excalibur\";\r\nimport { ResourceBlock, blockColor } from \"../../models/Economy\";\r\nimport { Game } from \"../../Game\";\r\nclass Tooltip extends Actor {\r\n    messageLabel: Label\r\n    constructor(x: number, y: number, message: string) {\r\n        super(x, y, 60, 16, Color.Black)\r\n        this.messageLabel = new Label(message, -16, 6, Game.font) //'Verdana')\r\n        this.messageLabel.color = Color.White\r\n        this.add(this.messageLabel)\r\n    }\r\n}\r\n\r\nexport class ResourceListEntry extends UIActor {\r\n    icon: Actor;\r\n    count: Label;\r\n    hovering: boolean = false\r\n    tooltip: Tooltip\r\n\r\n    constructor(x: number, y: number, resourceBlock: ResourceBlock, protected value: number) {\r\n        super(x-5, y-5, 20, 10)\r\n        let icon = new Actor(5, 5, 10, 10, blockColor(resourceBlock));\r\n        this.add(icon);\r\n        this.count = new Label(`x${value}`, 15, 10, Game.font) //'Helvetica');\r\n        this.count.fontSize = 10;\r\n        this.count.color = Color.White;\r\n        this.add(this.count);\r\n\r\n        this.tooltip = new Tooltip(0, 5, ResourceBlock[resourceBlock])\r\n        this.tooltip.visible = false\r\n        this.add(this.tooltip)\r\n\r\n\r\n        this.on('pointerenter', () => {\r\n            this.tooltip.visible = true\r\n        })\r\n\r\n        this.on('pointerleave', () => {\r\n            this.tooltip.visible = false\r\n        })\r\n    }\r\n\r\n\r\n    credit(amt: number) {\r\n        this.value += amt;\r\n        this.count.text = `x${this.value}`;\r\n    }\r\n\r\n    debit(amt: number) {\r\n        this.value -= amt\r\n        this.count.text = `x${this.value}`\r\n    }\r\n}\r\n","import { Color, Actor } from \"excalibur\";\r\nimport { ResourceBlock } from \"../../models/Economy\";\r\nimport { ResourceListEntry } from \"./ResourceListEntry\";\r\nimport { eachCons, eachChunk } from \"../../Util\";\r\nexport class ResourcesList extends Actor {\r\n    entries: {\r\n        [block in ResourceBlock]: ResourceListEntry;\r\n    } = {\r\n            [ResourceBlock.Biomass]: null,\r\n            [ResourceBlock.Idea]: null,\r\n            [ResourceBlock.Ore]: null,\r\n            [ResourceBlock.Meal]: null,\r\n            [ResourceBlock.Mineral]: null,\r\n            [ResourceBlock.Data]: null,\r\n            [ResourceBlock.Alloy]: null,\r\n            [ResourceBlock.Bioplasma]: null,\r\n            [ResourceBlock.Algorithm]: null,\r\n            [ResourceBlock.Argent]: null,\r\n            [ResourceBlock.Aurum]: null,\r\n            [ResourceBlock.Omnium]: null,\r\n        };\r\n\r\n    constructor(x: number, y: number) {\r\n        super(x,y,0,0); // 200, 60, Color.Green.clone().darken(0.8));\r\n        let rx0 = 0, ry0 = -5;\r\n        let resources = [\r\n            ResourceBlock.Meal,\r\n            ResourceBlock.Bioplasma,\r\n\r\n            ResourceBlock.Data,\r\n            ResourceBlock.Algorithm,\r\n\r\n            ResourceBlock.Mineral,\r\n            ResourceBlock.Alloy,\r\n\r\n            ResourceBlock.Argent,\r\n            ResourceBlock.Aurum,\r\n        ];\r\n\r\n        eachChunk(resources, 2).forEach(([res1, res2], index) => {\r\n            let rx = rx0 + index * 36, ry = ry0 + index * 0;\r\n            this.addEntry(rx, ry, res1)\r\n            this.addEntry(rx, ry + 14, res2)\r\n        });\r\n    }\r\n\r\n    private addEntry(x: number, y: number, res: ResourceBlock) {\r\n        let entry = new ResourceListEntry(x, y, res, 0);\r\n        this.add(entry);\r\n        this.entries[res] = entry;\r\n    }\r\n\r\n    increment(resource: ResourceBlock) {\r\n        let res = this.entries[resource]\r\n        if (res) {\r\n            res.credit(1);\r\n        }\r\n    }\r\n\r\n    decrement(resource: ResourceBlock) {\r\n        let res = this.entries[resource]\r\n        if (res) {\r\n            res.debit(1)\r\n        }\r\n    }\r\n}\r\n","import { Label, Color, Actor, FontStyle, FontUnit } from \"excalibur\";\r\nimport { Economy, ResourceBlock, PureValue } from \"../../models/Economy\";\r\nimport { ResourcesList } from \"./ResourcesList\";\r\nimport { EconomyView } from \"./EconomyView\";\r\nimport { MusicPlayer } from \"./MusicPlayer\";\r\nimport { Resources } from \"../../Resources\";\r\nimport { drawRect } from \"../../Painting\";\r\nimport { Game } from \"../../Game\";\r\n\r\nexport class StatusAnalysisView extends Actor {\r\n    private messageLabel: Label\r\n    private popLabel: Label\r\n\r\n    private resources: ResourcesList\r\n    private economy: EconomyView\r\n\r\n    private musicPlayer: MusicPlayer\r\n    private clock: Label\r\n\r\n    constructor(market: Economy, w: number, h: number) {\r\n        super(0,0, w*2,h, Color.DarkGray.clone().darken(0.92));\r\n\r\n        let ty = 14\r\n\r\n        let brand = new Label(Game.title, 5, ty+18, Game.font)\r\n        brand.fontSize = 28\r\n        brand.color = Color.Gray\r\n        brand.fontStyle = FontStyle.Italic\r\n        this.add(brand)\r\n\r\n        let version = new Label(\"v0.1\", 100, ty + 14, Game.font)\r\n        version.fontSize = 7\r\n        version.color = Color.Gray.darken(0.4)\r\n        this.add(version)\r\n\r\n\r\n        this.resources = new ResourcesList(130, ty)\r\n        this.add(this.resources)\r\n\r\n        this.economy = new EconomyView(market, 280, ty)\r\n        this.add(this.economy)\r\n\r\n        this.clock = new Label('current time', 600, ty, Game.font) // 'Verdana')\r\n        this.clock.color = Color.White // 'white'\r\n        this.add(this.clock)\r\n\r\n        this.popLabel = new Label(\"\", 600, ty + 14, Game.font) // 'Verdana')\r\n        this.popLabel.fontSize = 10\r\n        this.popLabel.color = Color.White\r\n        this.add(this.popLabel)\r\n\r\n        this.messageLabel = new Label('hi', 750, ty, Game.font) // 'Verdana')\r\n        this.messageLabel.fontSize = 10\r\n        this.messageLabel.color = Color.White\r\n        this.messageLabel.fontStyle = FontStyle.Italic\r\n        this.add(this.messageLabel)\r\n\r\n        this.musicPlayer = new MusicPlayer(726, 12, {\r\n            'Crater Rock': Resources.CraterRock,\r\n            'Indivision': Resources.Indivision,\r\n            'Future Tense': Resources.FutureTense,\r\n            // 'Isomer': Resources.Isomer,\r\n            'Understanding': Resources.Understanding,\r\n            // 'Outbound': Resources.Outbound,\r\n            'Assembler': Resources.Assembler,\r\n        })\r\n// // enable propagating pointer events\r\n// this.enableCapturePointer = true;\r\n// // // enable move events, warning: performance intensive!\r\n// this.capturePointer.captureMoveEvents = true;\r\n//         this.on('pointerenter', () => { alert('hover!')})\r\n    }\r\n\r\n    draw(ctx, delta) {\r\n        super.draw(ctx, delta)\r\n        this.musicPlayer.draw(ctx)\r\n        // drawRect(\r\n        //     ctx,\r\n        //     {x: this.x, y: this.y, width: this.getWidth(), height: this.getHeight() },\r\n        //     0,\r\n        //     Color.Magenta\r\n        // )\r\n    }\r\n\r\n    incrementResource(res: ResourceBlock) {\r\n        this.resources.increment(res)\r\n    }\r\n\r\n    decrementResource(res: ResourceBlock) {\r\n        this.resources.decrement(res)\r\n    }\r\n\r\n    setMessage(text: string) { this.messageLabel.text = text }\r\n\r\n    showEconomy(updatedEconomy: Economy): any {\r\n        this.economy.updateView(updatedEconomy)\r\n    }\r\n\r\n    showPopCap(curr: any, cap: any): any {\r\n        this.popLabel.text = `Pop: ${curr}/${cap}`\r\n    }\r\n\r\n    setClock(time: number = 0) {\r\n        let days = (Math.floor(time / (60 * 24))+1).toString()\r\n        let hh = Math.floor(time / 60) % 24\r\n        let hours = Math.floor((hh + 11) % 12 + 1).toString()\r\n        let minutes = Math.floor(time % 60).toString()\r\n        let ampm = hh < 12 ? 'AM' : 'PM'\r\n        this.clock.text = `Day ${days}. ${hours}:${minutes.padStart(2, '0')} ${ampm}`\r\n    }\r\n    \r\n}\r\n","import { UIActor, Label } from \"excalibur\";\r\nimport { Structure, Corridor, SurfaceRoad, Ladder, allStructures } from \"../../models/Structure\";\r\nimport { Game } from \"../../Game\";\r\nimport { ResourceBlock, emptyMarket, PureValue } from \"../../models/Economy\";\r\nimport { Machine, allMachines, PersonnelRegistry } from \"../../models/Machine\";\r\nimport { flatSingle } from \"../../Util\";\r\nimport { Colony } from \"../Planet/Colony\";\r\nimport { StatusAnalysisView } from \"./StatusAnalysisView\";\r\nimport { Device } from \"../Device\";\r\nimport { Planet } from \"../Planet/Planet\";\r\nimport { Card } from \"./Card\";\r\nimport { allSpaceFunctions, RoomRecipe } from \"../../models/RoomRecipe\";\r\nimport { Palette } from \"./Palette\";\r\nimport { Building } from \"../Building\";\r\nimport { Modal } from \"./Modal\";\r\nimport { TechTree } from \"../../models/TechTree\";\r\nimport { CitizenList } from \"./CitizenList\";\r\n\r\nexport class Hud extends UIActor {\r\n    private hidePalettes: boolean = true\r\n    private structurePalette: Palette\r\n    private machinePalette: Palette\r\n    private functionPalette: Palette\r\n\r\n    private showCitizenList: boolean = false\r\n    private citizenList: CitizenList\r\n\r\n\r\n    private card: Card\r\n    private status: StatusAnalysisView\r\n\r\n    private modal: Modal = null\r\n\r\n    static structuresForPalette = [\r\n        SurfaceRoad,\r\n        Corridor,\r\n        Ladder,\r\n        ...allStructures\r\n    ];\r\n    static machinesForPalette = allMachines\r\n    static functionsForPalette = allSpaceFunctions\r\n\r\n\r\n    constructor(\r\n        private game: Game,\r\n        private onBuildingSelect = null,\r\n        private onMachineSelect = null,\r\n        private onFunctionSelect = null,\r\n        private onCitizenSelect = null,\r\n    ) {\r\n        super(0, 0, game.canvasWidth, game.canvasHeight);\r\n        let canvasHeight = game.canvasHeight / window.devicePixelRatio;\r\n        let canvasWidth = game.canvasWidth / window.devicePixelRatio;\r\n\r\n        this.status = new StatusAnalysisView(emptyMarket(), game.canvasWidth, 64);\r\n        this.add(this.status)\r\n\r\n        let displayInfo = (e) => this.showCard(e)\r\n        this.machinePalette = new Palette('Machine', 20, 55, allMachines, onMachineSelect, displayInfo) // (e) => this.showCard(e))\r\n        this.structurePalette = new Palette('Structure', 20, 300, Hud.structuresForPalette, onBuildingSelect, displayInfo)\r\n        this.functionPalette = new Palette('Room Recipe', 20, 435, Hud.functionsForPalette, onFunctionSelect, displayInfo, false)\r\n\r\n        this.citizenList = new CitizenList(canvasWidth - 220, 55, onCitizenSelect) //, (citizen) => {})\r\n\r\n\r\n        this.card = new Card(null, 20, canvasHeight - 200)\r\n        this.add(this.card)\r\n\r\n\r\n    }\r\n\r\n    systemMessage(\r\n        message: string,\r\n        title: string = 'Commander...',\r\n        // subtitle: string = ''\r\n        buttons: { [intent: string]: () => any },\r\n    ): Modal {\r\n\r\n        let canvasHeight = this.game.canvasHeight / window.devicePixelRatio;\r\n        let canvasWidth = this.game.canvasWidth / window.devicePixelRatio;\r\n        this.modal = new Modal(\r\n            title,\r\n            message,\r\n            canvasWidth/2, // - 100,\r\n            canvasHeight/2, // - 100\r\n        ) \r\n        this.modal.addButtons(buttons)\r\n        return this.modal\r\n\r\n        // this.showModal = true\r\n        // this.modal = {\r\n            // message, title\r\n        // }\r\n    }\r\n\r\n    closeSystemMessage() {\r\n        console.log(\"hide system message\")\r\n        this.modal.teardown()\r\n        this.modal = null\r\n    }\r\n\r\n\r\n    showPalettes() {\r\n        this.hidePalettes = false\r\n    }\r\n\r\n    setStatus(text: string) { this.status.setMessage(text) }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        super.draw(ctx, delta)\r\n        if (!this.hidePalettes) {\r\n            this.structurePalette.draw(ctx)\r\n            this.functionPalette.draw(ctx)\r\n\r\n            if (this.machinePalette.comprehended.length > 0) {\r\n                this.machinePalette.draw(ctx)\r\n            }\r\n        }\r\n\r\n        if (this.modal) {\r\n            // console.log(\"okay, we have modal!!\")\r\n            this.modal.draw(ctx)\r\n        } else {\r\n            // console.log(\"no modal\")\r\n        }\r\n        // if (this.showModal)\r\n\r\n        if (this.showCitizenList) {\r\n            this.citizenList.draw(ctx)\r\n        }\r\n    }\r\n\r\n    update(game: Game, delta: number) {\r\n        super.update(game, delta)\r\n    }\r\n\r\n    resourceGathered(resource: ResourceBlock) {\r\n        this.status.incrementResource(resource)\r\n    }\r\n\r\n    resourceExpended(resource: ResourceBlock) {\r\n        this.status.decrementResource(resource)\r\n    }\r\n\r\n    updateDetails(planet: Planet, techTree: TechTree, rebuildPalettes: boolean = true, time: number = 0) {\r\n        if (!planet) { return }\r\n        if (rebuildPalettes) {\r\n            this.updatePalettes(planet.colony, techTree)\r\n        }\r\n        this.updateEconomy(planet)\r\n        this.updateMaxPop(planet.economy[PureValue.Shelter].demand, planet.maxPop)\r\n\r\n        this.status.setClock(time)\r\n\r\n        if (planet.population.citizens.some(c => !this.citizenList.citizens.includes(c))) { \r\n            this.citizenList.updateRoster(planet.population.citizens)\r\n        }\r\n\r\n        // custom unlocks?\r\n        if (!this.showCitizenList && planet.hasMachineKind(PersonnelRegistry)) {\r\n            this.showCitizenList = true\r\n        }\r\n    }\r\n\r\n    showCard(entity: Machine | Structure | RoomRecipe | Building | Device) {\r\n        this.card.present(entity)\r\n    }\r\n\r\n    private updateMaxPop(curr, cap) {\r\n        this.status.showPopCap(curr, cap)\r\n    }\r\n\r\n    private updateEconomy(planet: Planet) {\r\n        this.status.showEconomy(planet.economy)\r\n    }\r\n\r\n    private updatePalettes(colony: Colony, techTree: TechTree) {\r\n        this.updateBuildingPalette(colony)\r\n        this.updateMachinePalette(colony, techTree)\r\n        this.updateFunctionPalette(colony)\r\n    }\r\n\r\n    private updateBuildingPalette(colony: Colony) {\r\n        let builtStructures =\r\n            Hud.structuresForPalette.filter((structure) => colony.buildings.some(b => b.structure instanceof structure))\r\n        if (!builtStructures.every(s => this.structurePalette.built.includes(s))) {\r\n            this.structurePalette.updateBuilt(builtStructures)\r\n        }\r\n    }\r\n\r\n    private updateMachinePalette(colony: Colony, techTree: TechTree) {\r\n        let devices = colony.findAllDevices()\r\n        let builtMachines = [\r\n            ...Hud.machinesForPalette.filter((machine) => devices.some(d => d.machine instanceof machine && d.built)),\r\n            // ...techTree.allUnlockedMachines()\r\n        ]\r\n        if (!builtMachines.every(machine => this.machinePalette.built.includes(machine))) {\r\n            this.machinePalette.updateBuilt(builtMachines, techTree.allUnlockedMachines())\r\n        }\r\n    }\r\n\r\n    private updateFunctionPalette(colony: Colony) {\r\n        let builtReifiedFunctions = flatSingle(colony.buildings.map(b => b.spaceFunction))\r\n        let builtFunctions = Hud.functionsForPalette.filter((fn) => builtReifiedFunctions.some(rf => rf instanceof fn))\r\n        if (!builtFunctions.every(fn => this.functionPalette.built.includes(fn))) {\r\n            this.functionPalette.updateBuilt(builtFunctions)\r\n        }\r\n    }\r\n\r\n}","import { drawRect } from \"../../Painting\";\r\nimport { DomeView, Building } from \".\";\r\nimport { Orientation } from \"../../values/Orientation\";\r\nimport { Color } from \"excalibur\";\r\nimport { DeviceSize } from \"../../values/DeviceSize\";\r\n\r\nexport class GroundVehiclePoolView extends Building {\r\n\r\n    deviceSize = DeviceSize.Small\r\n    colorBase() { return Color.Orange.clone().darken(0.05); } \r\n    draw(ctx, delta) {\r\n        // drawRect(ctx, this.aabb())\r\n       super.draw(ctx, delta)\r\n    }\r\n\r\n    slots() {\r\n        let theSlots = [];\r\n        let slotY = this.getHeight();\r\n\r\n        let buffer = this.getWidth() / 4\r\n\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x - buffer, this.pos.y + slotY,\r\n                Orientation.Left\r\n            )\r\n        )\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth() + buffer,\r\n                this.pos.y + slotY,\r\n                Orientation.Right\r\n            )\r\n        )\r\n\r\n        return theSlots;\r\n    } \r\n}","import { Color, Vector } from \"excalibur\";\r\nimport { Building, DevicePlace } from \"./Building\";\r\nimport { Orientation } from \"../../values/Orientation\";\r\nimport { Slot } from \"../../values/Slot\";\r\nimport { Device } from \"../Device\";\r\nimport { DeviceSize, getVisibleDeviceSize } from \"../../values/DeviceSize\";\r\nimport { drawPatternedRect, drawRect, drawPatternedPoly, drawPoly } from \"../../Painting\";\r\nimport { measureDistance, eachCons } from \"../../Util\";\r\nimport { BackgroundPattern } from \"./BackgroundPatterns\";\r\n// import { drawPatternedRect, drawRect } from \"../../Util\";\r\n\r\nexport class MediumSurfaceRoomView extends Building {\r\n    hideBox = true\r\n    showLabel = true\r\n    // hideLabe\r\n\r\n    devicePlaceSize = DeviceSize.Medium\r\n    devicePlaceCount = 3\r\n    get floorHeight() { return this.getHeight() / 6 }\r\n\r\n    get floorY() {\r\n        return this.pos.y + this.getHeight() - this.floorHeight\r\n    }\r\n\r\n   nodes(): Vector[] {\r\n        let x = this.pos.x + this.getWidth()/2;\r\n        let y = this.pos.y + this.getHeight() - 16\r\n        return [\r\n            new Vector(Math.floor(x), Math.floor(y))\r\n        ];\r\n    }\r\n    devicePlaces() {\r\n        let w = this.getWidth()/2\r\n        let x = this.pos.x + w;\r\n        let y = this.pos.y + this.getHeight() - this.floorHeight - 12 \r\n        y -= getVisibleDeviceSize(this.devicePlaceSize) / 3.5\r\n\r\n        let ds = [\r\n            new Vector(x - w/2, y),\r\n            ...(this.devicePlaceCount > 2 ? [new Vector(x,y)] : []),\r\n            new Vector(x + w/2, y),\r\n        ]\r\n\r\n        return ds.map(d => new DevicePlace(d, this.devicePlaceSize)) \r\n    }\r\n\r\n    //deviceInteractionPlaces() {\r\n\r\n    //}\r\n\r\n    graph(sg) {\r\n        let g = super.graph(sg)\r\n        let find = (s: Vector) => g.findOrCreate(s, measureDistance)\r\n        let slots: Vector[] = this.slots().map(s => s.pos)\r\n        // draw from left slot to each device place to right slot?\r\n        let devices = this.deviceInteractionPlaces().map(p => find(p)) //d.position))\r\n        eachCons(devices, 2).forEach(([left, right]) => g.edge(left, right))\r\n\r\n        if (this.isGroundFloor) {\r\n            let leftSlot = find(slots[0]), rightSlot = find(slots[slots.length - 1])\r\n            g.edge(leftSlot, devices[0])\r\n            g.edge(devices[devices.length - 1], rightSlot)\r\n        } else {\r\n            let topSlot = find(slots[1])\r\n            g.edge(devices[1], topSlot)\r\n        }\r\n\r\n        let node = this.nodes()[0]\r\n        devices.forEach(device => g.edge(device, find(node)))\r\n        // g.edge(devices[1], find(slots[1]))\r\n\r\n        return g\r\n    }\r\n\r\n\r\n    slots() {\r\n        let theSlots: Slot[] = []\r\n        let slotY = this.getHeight() - this.floorHeight;\r\n\r\n        if (this.isGroundFloor) {\r\n            theSlots.push(\r\n                this.buildSlot(\r\n                    this.pos.x, this.pos.y + slotY,\r\n                    Orientation.Left\r\n                )\r\n            )\r\n        }\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth() / 2,\r\n                this.pos.y + this.getHeight(), // + (2*this.floorHeight),\r\n                Orientation.Down\r\n            )\r\n        )\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth() / 2,\r\n                this.pos.y - 1, // + this.getHeight(),\r\n                Orientation.Up\r\n            )\r\n        )\r\n\r\n\r\n        if (this.isGroundFloor) {\r\n            theSlots.push(\r\n                this.buildSlot(\r\n                    this.pos.x + this.getWidth(),\r\n                    this.pos.y + slotY,\r\n                    Orientation.Right\r\n                )\r\n            )\r\n        }\r\n\r\n\r\n        return theSlots;\r\n    }\r\n\r\n    get isGroundFloor() {\r\n        return !this.parentSlot || !(this.parentSlot.parent instanceof MediumSurfaceRoomView)\r\n    }\r\n\r\n    constrainCursor(cursor: Vector): Vector {\r\n        if (this.planet.colony.buildings.length === 0) {\r\n            cursor.y = this.planet.getTop();\r\n        } // else {\r\n            // this.alignToSlot(cursor)\r\n        // }\r\n        return cursor;\r\n    }\r\n\r\n    reshape(cursor: Vector) {\r\n        if (this.planet.colony.buildings.length === 0) {\r\n            this.pos = cursor\r\n            this.pos.y -= this.getHeight() - 2 - this.floorHeight // hm\r\n        } else {\r\n            this.alignToSlot(cursor)\r\n\r\n        }\r\n    }\r\n\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        let color = this.mainColor()\r\n\r\n        ctx.fillStyle = color.toRGBA()\r\n\r\n        // ctx.fillRect(this.pos.x, this.pos.y, this.getWidth(), this.getHeight())\r\n        // let rect = \r\n            // { x: this.pos.x, y: this.pos.y, width: this.getWidth(), height: this.getHeight() };\r\n        drawPatternedPoly(\r\n            ctx,\r\n            this.angledRoofPoly(),\r\n            this.backgroundPattern,\r\n            this.mainColor()\r\n        )\r\n\r\n\r\n        if (!this.isActive) {\r\n            // draw overlay rect that darkens\r\n            let c = Color.Black.clone()\r\n            c.a = 0.6\r\n            drawPoly(ctx, this.angledRoofPoly(), c)\r\n        }\r\n\r\n        // floor\r\n        let floorColor = this.planet.color.darken(0.6)\r\n        let floorEdgeHeight = 12 // 6\r\n        let floorOff = -5\r\n        drawRect(\r\n            ctx,\r\n            { x: this.x, y: this.y + this.getHeight() - this.floorHeight - floorEdgeHeight,\r\n              width: this.getWidth(), height: floorEdgeHeight - floorOff },\r\n              0,\r\n              floorColor.lighten(0.4)\r\n        )\r\n\r\n        drawRect(\r\n            ctx,\r\n            { x: this.x, y: this.y + this.getHeight() - this.floorHeight - floorOff,\r\n              width: this.getWidth(), height: this.floorHeight + floorOff },\r\n              0,\r\n              floorColor\r\n        )\r\n\r\n        // a little flag :)\r\n        let flagpoleHeight = 18\r\n        let flagX = this.pos.x + 3 * (this.getWidth() / 4)\r\n        let flagY = this.pos.y - flagpoleHeight\r\n\r\n        ctx.fillStyle = Color.Black.fillStyle()\r\n        ctx.fillRect(flagX, flagY-1, 1, flagpoleHeight+1)\r\n        drawPatternedRect(\r\n            ctx,\r\n            { x: flagX, y: flagY, width: 10, height: 6 },\r\n            BackgroundPattern.USSF\r\n        )\r\n        // ctx.fillRect(flagX, flagY, 10, 5)\r\n\r\n        super.draw(ctx, delta)\r\n    }\r\n\r\n    colorBase() { return Color.White.clone(); }\r\n}","import { CommonAreaView } from \".\";\r\nimport { DeviceSize } from \"../../values/DeviceSize\";\r\n\r\nexport class MediumRoomThreeView extends CommonAreaView {\r\n    devicePlaceSize = DeviceSize.Medium\r\n    devicePlaceCount = 3\r\n\r\n    poly() { return this.angledRoofPoly() }\r\n\r\n    // devicePlaces() {\r\n    //     let w = this.getWidth()/2\r\n    //     let x = this.pos.x + w;\r\n    //     let y = this.pos.y + this.getHeight() - getVisibleDeviceSize(DeviceSize.Medium)/3\r\n    //     let ds = [\r\n    //         new Vector(x - w/3, y),\r\n    //         new Vector(x, y),\r\n    //         new Vector(x + w/3, y),\r\n    //     ]\r\n\r\n    //     return ds.map(d => new DevicePlace(d, DeviceSize.Medium))\r\n    // }\r\n}","import { CommonAreaView } from \".\";\r\nimport { Vector } from \"excalibur\";\r\nimport { DevicePlace } from \"./Building\";\r\nimport { DeviceSize, getVisibleDeviceSize } from \"../../values/DeviceSize\";\r\n\r\nexport class HugeRoomView extends CommonAreaView {\r\n    devicePlaceSize = DeviceSize.Huge\r\n    devicePlaces() {\r\n        let w = this.getWidth()/2\r\n        let x = this.pos.x + w;\r\n        let y = this.pos.y + this.getHeight() - this.floorHeight - getVisibleDeviceSize(DeviceSize.Huge)/2 \r\n        let ds = [\r\n            new Vector(x - w/3, y),\r\n            new Vector(x + w/3, y),\r\n        ]\r\n        return ds.map(d => new DevicePlace(d, DeviceSize.Huge))\r\n    }\r\n}","import { CommonAreaView } from \".\";\r\nimport { Vector } from \"excalibur\";\r\nimport { DevicePlace } from \"./Building\";\r\nimport { DeviceSize, getVisibleDeviceSize } from \"../../values/DeviceSize\";\r\n\r\nexport class LargeRoomView extends CommonAreaView {\r\n    devicePlaceSize = DeviceSize.Large\r\n    devicePlaces() {\r\n        let w = this.getWidth()/2\r\n        let x = this.pos.x + w;\r\n        let y = this.pos.y + this.getHeight() - getVisibleDeviceSize(DeviceSize.Large)/2 \r\n        let ds = [\r\n            new Vector(x - w/3, y),\r\n            new Vector(x + w/3, y),\r\n        ]\r\n\r\n        return ds.map(d => new DevicePlace(d, DeviceSize.Large))\r\n    }\r\n}","import { CommonAreaView } from \".\";\r\nimport { DeviceSize, getVisibleDeviceSize } from \"../../values/DeviceSize\";\r\nimport { DevicePlace } from \"./Building\";\r\nimport { Vector } from \"excalibur\";\r\n\r\nexport class MediumRoomView extends CommonAreaView {\r\n    devicePlaceSize = DeviceSize.Medium\r\n    devicePlaceCount = 2\r\n    // devicePlaces() {\r\n    //     let w = this.getWidth()/2\r\n    //     let x = this.pos.x + w;\r\n    //     let y = this.pos.y + this.getHeight() - this.floorHeight - getVisibleDeviceSize(DeviceSize.Medium)/3\r\n    //     let ds = [\r\n    //         new Vector(x - w/3, y),\r\n    //         new Vector(x + w/3, y),\r\n    //     ]\r\n\r\n    //     return ds.map(d => new DevicePlace(d, DeviceSize.Medium))\r\n    // }\r\n}","import { CommonAreaView } from \".\";\r\nimport { Vector } from \"excalibur\";\r\nimport { DevicePlace } from \"./Building\";\r\nimport { DeviceSize } from \"../../values/DeviceSize\";\r\n\r\nexport class SmallRoomThreeView extends CommonAreaView {\r\n    devicePlaceCount = 3\r\n    poly() { return this.angledRoofPoly() }\r\n    //devicePlaces() {\r\n    //    let w = this.getWidth()/2\r\n    //    let x = this.pos.x + w;\r\n    //    let y = this.pos.y + this.getHeight() - this.floorHeight - 10\r\n    //    let ds = [\r\n    //        new Vector(x - w / 2, y),\r\n    //        new Vector(x, y),\r\n    //        new Vector(x + w / 2, y),\r\n    //    ]\r\n\r\n    //    return ds.map(d => new DevicePlace(d, DeviceSize.Small))\r\n    //}\r\n}","import { DeviceSize } from \"../../values/DeviceSize\";\r\nimport { DevicePlace } from \"./Building\";\r\nimport { Vector } from \"excalibur\";\r\nimport { DomeView } from \".\";\r\n\r\nexport class BigDomeView extends DomeView {\r\n\r\n    devicePlaceCount = 3\r\n    // devicePlaces() {\r\n    //     let w = this.getWidth()/2\r\n    //     let x = this.pos.x + w;\r\n    //     let y = this.pos.y + this.getHeight() - 20\r\n    //     let ds = [\r\n    //         new Vector(x - w/3, y),\r\n    //         new Vector(x + w/3, y),\r\n    //     ]\r\n\r\n    //     return ds.map(d => new DevicePlace(d, DeviceSize.Large))\r\n    // }\r\n}","import { DomeView } from \".\";\r\nimport { Vector } from \"excalibur\";\r\nimport { DevicePlace } from \"./Building\";\r\nimport { DeviceSize } from \"../../values/DeviceSize\";\r\n\r\nexport class MidDomeView extends DomeView {\r\n\r\n    devicePlaceCount = 3\r\n    // devicePlaces() {\r\n    //     let w = this.getWidth()/2\r\n    //     let x = this.pos.x + w;\r\n    //     let y = this.pos.y + this.getHeight() - 20\r\n    //     let ds = [\r\n    //         new Vector(x - w/3, y),\r\n    //         new Vector(x + w/3, y),\r\n    //     ]\r\n\r\n    //     return ds.map(d => new DevicePlace(d, DeviceSize.Medium))\r\n    // }\r\n}","import { DomeView } from \".\";\r\nimport { Vector } from \"excalibur\";\r\nimport { DevicePlace } from \"./Building\";\r\nimport { DeviceSize } from \"../../values/DeviceSize\";\r\n\r\nexport class SmallDomeThreeView extends DomeView {\r\n\r\n    devicePlaceCount = 3\r\n    // devicePlaces() {\r\n    //     let w = this.getWidth()/2\r\n    //     let x = this.pos.x + w;\r\n    //     let y = this.pos.y + this.getHeight() - 6\r\n    //     let ds = [\r\n    //         new Vector(x - w/3, y),\r\n    //         new Vector(x, y),\r\n    //         new Vector(x + w/3, y),\r\n    //     ]\r\n\r\n    //     return ds.map(d => new DevicePlace(d, DeviceSize.Small))\r\n    // }\r\n}","import { CorridorView } from \".\";\r\n\r\nexport class SurfaceRoadView extends CorridorView {\r\n    edgeWidth: 0\r\n    colorBase() { return this.color.lighten(0.1); }\r\n\r\n}","import { TunnelView } from \".\";\r\nimport { Orientation } from \"../../values/Orientation\";\r\nimport { Slot } from \"../../values/Slot\";\r\nimport { Vector } from \"excalibur\";\r\nimport { Scale } from \"../../values/Scale\";\r\n\r\nexport class LadderView extends TunnelView {\r\n    originSlot: Slot = null\r\n    slotSize: number = Scale.major.third\r\n    constrainCursor(cursor: Vector): Vector {\r\n       if (this.pickingOrigin) {\r\n\r\n       } else {\r\n           cursor.x = this.pos.x\r\n       }\r\n       return cursor;\r\n    }\r\n\r\n    // minHeight: number = slt\r\n    reshape(cursor: Vector) {\r\n        if (this.pickingOrigin) { \r\n            let theSlot = this.alignToSlot(cursor)\r\n            if (theSlot) {\r\n                this.facing = theSlot.facing\r\n\r\n                if (theSlot) {\r\n                    this.originSlot = theSlot\r\n                }\r\n            }\r\n        } else {\r\n            if (this.facing === Orientation.Up) {\r\n                let maxHeight = this.originSlot.pos.y - this.planet.getTop() - 25\r\n\r\n                let h = Math.min(maxHeight, Math.max(this.slotSize, this.originSlot.pos.y - cursor.y))\r\n                this.setHeight((h/this.slotSize)*this.slotSize + 15)\r\n                this.pos.y = this.originSlot.pos.y - this.getHeight()\r\n            } else {\r\n                let h = Math.max(this.slotSize, cursor.y - this.originSlot.pos.y)\r\n                this.setHeight((h/this.slotSize)*this.slotSize + 15) // - cursor.y))\r\n            }\r\n        }\r\n    }\r\n}","import { DomeView } from \".\";\r\nimport { Color, Vector } from \"excalibur\";\r\nimport { DevicePlace } from \"./Building\";\r\nimport { DeviceSize } from \"../../values/DeviceSize\";\r\n\r\nexport class ArcologyView extends DomeView {\r\n\r\n    devicePlaces() {\r\n        let w = 3*this.getWidth()/5\r\n        let x = this.pos.x + w;\r\n        let y = this.pos.y + this.getHeight()/2\r\n        let ds = [\r\n            new Vector(x, y-800),\r\n            new Vector(x, y),\r\n            new Vector(x, y+800),\r\n        ]\r\n\r\n        return ds.map(d => new DevicePlace(d, DeviceSize.Huge))\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        this.drawShape(ctx, this.pos.x, this.pos.y)\r\n        this.getDevices().forEach(device => device.draw(ctx, delta))\r\n\r\n    }\r\n\r\n    private drawShape(ctx, xoff, yoff) {\r\n        let h = this.getHeight()\r\n        let w = this.getWidth()\r\n        ctx.beginPath();\r\n        ctx.moveTo(0 + xoff, h + yoff);\r\n        ctx.bezierCurveTo(1 + xoff, h - 150 + yoff, 121 + xoff, 70 + yoff, w - 80 + xoff, 8 + yoff);\r\n        ctx.bezierCurveTo(w - 40 + xoff, 2 + yoff, w - 5 + xoff, 11 + yoff, w - 10 + xoff, 25 + yoff);\r\n        ctx.bezierCurveTo(w - 5 + xoff, 10 + yoff, w + xoff, (h-10) + yoff, w + xoff, h + yoff);\r\n        ctx.lineTo(0 + xoff, h + yoff);\r\n        ctx.fillStyle = this.mainColor().toRGBA()\r\n        ctx.fill();\r\n    }\r\n}","import { Vector } from \"excalibur\";\r\nimport { Building } from \"./Building\";\r\nimport { range, eachCons, measureDistance } from \"../../Util\";\r\nimport { Slot } from \"../../values/Slot\";\r\nimport { Orientation, flip } from \"../../values/Orientation\";\r\nimport { Graph } from \"../../values/Graph\";\r\nimport { drawRect } from \"../../Painting\";\r\nimport { Scale } from \"../../values/Scale\";\r\n\r\nexport class TunnelView extends Building {\r\n    slotSize: number = Scale.major.eighth + 10\r\n    pickingOrigin: boolean = true\r\n    hideBox = true\r\n\r\n    colorBase() { return this.planet.color.darken(0.2); }\r\n\r\n    draw(ctx, delta) {\r\n        let rect = this.aabb()\r\n        drawRect(ctx, rect, 0, this.color.darken(0.1)) \r\n\r\n        let n = 5\r\n        rect.x = rect.x + this.getWidth() / n\r\n        rect.width -= (2) * (this.getWidth() / n)\r\n        drawRect(ctx, rect, 0, this.color.darken(0.2)) \r\n        // super.draw(ctx, delta)\r\n    }\r\n\r\n    nodes(): Vector[] {\r\n        let x = this.pos.x + this.getWidth()/2;\r\n        let y = this.pos.y\r\n        return [\r\n            new Vector(Math.floor(x), y)\r\n        ];\r\n    }\r\n\r\n    graph(supergraph: Graph<Vector> = new Graph()): Graph<Vector> {\r\n        let g = supergraph;\r\n\r\n        let halfWidth = this.getWidth()/2\r\n        let x = this.pos.x + halfWidth\r\n\r\n        let root = g.findOrCreate(this.nodes()[0], measureDistance)\r\n        let first = g.findOrCreate(new Vector(x,this.slotHeights()[0]), measureDistance)\r\n        g.edge(root,first)\r\n\r\n        let heights = this.slotHeights()\r\n\r\n        eachCons(heights, 2).forEach(([y0,y1]: [number,number]) => {\r\n            let top = g.findOrCreate(new Vector(x,y0), measureDistance)\r\n            let btm = g.findOrCreate(new Vector(x,y1), measureDistance)\r\n            g.edge(top, btm)\r\n        })\r\n\r\n        let btm = g.findOrCreate(new Vector(x, this.pos.y + this.getHeight()), measureDistance)\r\n        let lst = g.findOrCreate(new Vector(x, heights[heights.length-1]), measureDistance)\r\n        g.edge(btm,lst)\r\n\r\n        heights.forEach(y1 => {\r\n            let btm = g.findOrCreate(new Vector(x,y1), measureDistance)\r\n\r\n            let left = g.findOrCreate(new Vector(x-halfWidth,y1), measureDistance)\r\n            g.edge(left,btm)\r\n\r\n            let right = g.findOrCreate(new Vector(x+halfWidth,y1), measureDistance)\r\n            g.edge(btm,right)\r\n        });\r\n\r\n        for (let child of this.childrenBuildings) {\r\n            let slot = g.findOrCreate(child.parentSlot.pos, measureDistance)\r\n            let childNode = g.findOrCreate(child.nodes()[0], measureDistance)\r\n            g.edge(childNode, slot)\r\n            g.edge(slot, childNode)\r\n\r\n            child.graph(g)\r\n        }\r\n\r\n        return g;\r\n    }\r\n\r\n    private slotHeights() {\r\n            // let minDepth = Scale.major.eighth + 50\r\n            // let buffer = 20\r\n\r\n        // let slotSize = Scale.major.eighth + 5 //minDepth + buffer\r\n        let slotCount = Math.floor((this.getHeight()) / this.slotSize)\r\n        let heights = []\r\n\r\n        let y = this.pos.y // + minDepth + buffer\r\n\r\n        if (slotCount > 0) {\r\n            for (let i of range(slotCount)) {\r\n                heights.push(\r\n                    y + ((i+1) * this.slotSize),\r\n                )\r\n            }\r\n        } else {\r\n            heights.push(this.slotSize)\r\n        }\r\n        return heights\r\n    }\r\n\r\n    slots() {\r\n        let theSlots: Slot[] = []\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth()/2,\r\n                this.pos.y,\r\n                Orientation.Up\r\n            )\r\n        )\r\n\r\n        for (let y of this.slotHeights()) {\r\n            theSlots.push(\r\n                this.buildSlot(\r\n                    this.pos.x, y,\r\n                    Orientation.Left\r\n                )\r\n            )\r\n\r\n            theSlots.push(\r\n                this.buildSlot(\r\n                    this.pos.x + this.getWidth(),\r\n                    y,\r\n                    Orientation.Right,\r\n                )\r\n            )\r\n        }\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth()/2,\r\n                this.pos.y + this.getHeight(),\r\n                Orientation.Down\r\n            )\r\n        )\r\n        return theSlots;\r\n    } \r\n\r\n    handleClick(cursor: Vector) {\r\n        if (this.pickingOrigin) {\r\n            this.pickingOrigin = false;\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    constrainCursor(cursor: Vector): Vector {\r\n        if (this.pickingOrigin) {\r\n            // this.alignToSlot(cursor)\r\n        } else {\r\n            // cursor.y = Math.max(this.planet.getTop() + 100, cursor.y)\r\n        }\r\n        return cursor;\r\n    }\r\n\r\n    reshape(cursor: Vector) {\r\n        // this.pos.y = this.planet.getTop() + 2\r\n        if (this.pickingOrigin) {\r\n            this.alignToSlot(cursor)\r\n        } // else {\r\n            // min depth/height has to be at least \r\n            // let minDepth = Scale.major.eighth\r\n            // let buffer = 100\r\n\r\n            let depth = \r\n                (this.slotSize * Math.floor(Math.abs(cursor.y - this.planet.getTop()) / this.slotSize)) + 15\r\n\r\n          this.setHeight(\r\n              Math.max(depth, this.slotSize + 15)\r\n          )\r\n        // }\r\n    }\r\n\r\n}","import { Color, Vector } from \"excalibur\";\r\nimport { Building, DevicePlace } from \"./Building\";\r\nimport { Orientation } from \"../../values/Orientation\";\r\nimport { DeviceSize, getVisibleDeviceSize } from \"../../values/DeviceSize\";\r\nimport { Graph } from \"../../values/Graph\";\r\nimport { measureDistance, eachCons } from \"../../Util\";\r\n\r\nexport class DomeView extends Building {\r\n    hideBox = true\r\n    showLabel = true\r\n\r\n    graph(sg) {\r\n        let g = super.graph(sg)\r\n        let find = (s: Vector) => g.findOrCreate(s, measureDistance)\r\n\r\n        let slots: Vector[] = this.slots().map(s => s.pos)\r\n        let leftSlot = find(slots[0]), rightSlot = find(slots[slots.length-1])\r\n        let devices = this.deviceInteractionPlaces().map(position => find(position))\r\n        g.edge(leftSlot, devices[0])\r\n        eachCons(devices, 2).forEach(([left, right]) => g.edge(left, right))\r\n        g.edge(devices[devices.length-1], rightSlot)\r\n\r\n        let node = this.nodes()[0]\r\n        devices.forEach(device => g.edge(device, find(node)))\r\n\r\n        return g\r\n\r\n    }\r\n\r\n    slots() {\r\n        let theSlots = [];\r\n        let slotY = this.getHeight();\r\n\r\n        let buffer = this.getWidth() / 4\r\n\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x - buffer, this.pos.y + slotY,\r\n                Orientation.Left\r\n            )\r\n        )\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth() + buffer,\r\n                this.pos.y + slotY,\r\n                Orientation.Right\r\n            )\r\n        )\r\n\r\n        return theSlots;\r\n    } \r\n\r\n    //reshape(cursor: Vector) {\r\n    //    this.alignToSlot(cursor)\r\n    //}\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        let color: Color = this.mainColor()\r\n\r\n        let h = this.getHeight() //getWidth()/2\r\n\r\n        ctx.beginPath()\r\n        ctx.arc(\r\n            this.pos.x + this.getWidth()/2,\r\n            this.pos.y + h, //this.getHeight(),\r\n            this.getWidth()/1.5,\r\n            0,\r\n            Math.PI,\r\n            true\r\n        )\r\n        ctx.closePath()\r\n        ctx.fillStyle = color.toRGBA()\r\n        ctx.fill()\r\n\r\n        super.draw(ctx, delta)\r\n    }\r\n\r\n    colorBase() { return Color.White.clone().darken(0.05); } \r\n\r\n    deviceSize = DeviceSize.Small\r\n    devicePlaceCount = 2\r\n    devicePlaces() {\r\n        let w = this.getWidth()/2\r\n        let x = this.pos.x + w;\r\n        let y = this.pos.y + this.getHeight() - getVisibleDeviceSize(this.deviceSize)/3 // - 16\r\n        let ds = [\r\n            new Vector(x - w/3, y),\r\n            ...(this.devicePlaceCount === 3 ? [new Vector(x,y)] : []),\r\n            new Vector(x + w/3, y),\r\n        ]\r\n\r\n        return ds.map(d => new DevicePlace(d, this.deviceSize)) // DeviceSize.Small))\r\n    }\r\n}","import { Building, DevicePlace } from \"./Building\";\r\nimport { Orientation } from \"../../values/Orientation\";\r\nimport { Slot } from \"../../values/Slot\";\r\nimport { Vector, Color } from \"excalibur\";\r\nimport { DeviceSize, getVisibleDeviceSize } from \"../../values/DeviceSize\";\r\nimport { drawRect, drawPatternedPoly, drawPoly } from \"../../Painting\";\r\nimport { measureDistance, eachCons } from \"../../Util\";\r\n\r\nexport class CommonAreaView extends Building {\r\n    get floorHeight() { return this.getHeight() / 6 }\r\n    edgeWidth: number = 0\r\n    showLabel = true\r\n    hideBox = true\r\n\r\n    colorBase() { return this.color.darken(0.3); }\r\n\r\n    poly() { return this.aabbPoly() }\r\n\r\n    get floorY() {\r\n        return this.pos.y + this.getHeight() - this.floorHeight\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n\r\n\r\n        drawPatternedPoly(\r\n            ctx,\r\n            this.poly(),\r\n            this.backgroundPattern,\r\n            this.mainColor()\r\n        )\r\n\r\n        if (!this.isActive) {\r\n            let c = Color.Black.clone()\r\n            c.a = 0.6\r\n            drawPoly(ctx, this.poly(), c)\r\n        }\r\n\r\n        let floorEdgeHeight = 12 // 6\r\n        let floorColor = this.planet.color.darken(0.6)\r\n        let floorOff = -5\r\n        drawRect(\r\n            ctx,\r\n            { x: this.x, y: this.y + this.getHeight() - this.floorHeight - floorEdgeHeight,\r\n              width: this.getWidth(), height: floorEdgeHeight - floorOff },\r\n              0,\r\n              floorColor.lighten(0.4)\r\n        )\r\n\r\n        drawRect(\r\n            ctx,\r\n            { x: this.x, y: this.y + this.getHeight() - this.floorHeight - floorOff,\r\n              width: this.getWidth(), height: this.floorHeight + floorOff },\r\n              0,\r\n              floorColor\r\n        )\r\n\r\n        super.draw(ctx, delta)\r\n    }\r\n\r\n\r\n    slots() {\r\n        let theSlots = []\r\n        let slotY = this.getHeight() - this.floorHeight\r\n        let leftSlot: Slot = this.buildSlot(\r\n            this.pos.x,\r\n            this.pos.y + slotY,\r\n            Orientation.Left,\r\n        )\r\n        theSlots.push(leftSlot)\r\n\r\n        let rightSlot: Slot = this.buildSlot(\r\n            this.pos.x + this.getWidth(),\r\n            this.pos.y + slotY,\r\n            Orientation.Right,\r\n        )\r\n        theSlots.push(rightSlot)\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth()/2,\r\n                this.pos.y,\r\n                Orientation.Up\r\n            )\r\n        )\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth()/2,\r\n                this.pos.y + this.getHeight(),\r\n                Orientation.Down\r\n            )\r\n        )\r\n        return theSlots;\r\n    }\r\n\r\n    nodes(): Vector[] {\r\n        let x = this.pos.x + this.getWidth()/2;\r\n        let y = this.pos.y + this.getHeight()-this.floorHeight\r\n        return [\r\n            new Vector(Math.floor(x), Math.floor(y))\r\n        ];\r\n    }\r\n\r\n    graph(sg) {\r\n        let g = super.graph(sg)\r\n        let slots: Slot[] = this.slots()\r\n        let find = (s: Vector) => g.findOrCreate(s, measureDistance)\r\n        let leftSlot = find(slots[0].pos), rightSlot = find(slots[1].pos)\r\n        let devices = this.deviceInteractionPlaces().map(p => find(p))\r\n        g.edge(leftSlot, devices[0])\r\n        eachCons(devices, 2).forEach(([left, right]) => g.edge(left, right))\r\n        g.edge(devices[devices.length-1], rightSlot)\r\n\r\n        let node = this.nodes()[0]\r\n        devices.forEach(device => g.edge(device, find(node)))\r\n        return g\r\n    }\r\n  \r\n    reshape(cursor) {\r\n        this.alignToSlot(cursor);\r\n    }\r\n\r\n    devicePlaces() {\r\n        let w = this.getWidth()/2\r\n        let x = this.pos.x + w;\r\n        let y = this.pos.y + this.getHeight() - this.floorHeight - 10 \r\n        y -= getVisibleDeviceSize(this.devicePlaceSize) / 3.5 ///2\r\n\r\n        let ds = [\r\n            new Vector(x - w/2, y),\r\n            ...(this.devicePlaceCount > 2 ? [new Vector(x,y)] : []),\r\n            new Vector(x + w/2, y),\r\n        ]\r\n\r\n        return ds.map(d => new DevicePlace(d, this.devicePlaceSize)) \r\n        //DeviceSize.Small))\r\n    }\r\n\r\n    devicePlaceSize: DeviceSize = DeviceSize.Small\r\n    devicePlaceCount: number = 2\r\n}","import { Building } from \"./Building\";\r\nimport { Vector } from \"excalibur\";\r\nimport { Orientation } from \"../../values/Orientation\";\r\nimport { Slot } from \"../../values/Slot\";\r\n\r\nexport class CorridorView extends Building {\r\n    edgeWidth: number = 0\r\n\r\n    pickingOrigin: boolean = true\r\n    facing: Orientation = Orientation.Left\r\n\r\n   nodes(): Vector[] {\r\n        let x = this.pos.x + this.getWidth()/2;\r\n        let y = this.pos.y + this.getHeight()/2\r\n        return [\r\n            new Vector(Math.floor(x), Math.floor(y))\r\n        ];\r\n    }\r\n    colorBase() { return this.color.darken(0.2); }\r\n\r\n    slots() {\r\n        let theSlots: Slot[] = [];\r\n        let slotY = this.getHeight() / 2;\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x, this.pos.y + slotY,\r\n                Orientation.Left\r\n            )\r\n        )\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth(),\r\n                this.pos.y + slotY,\r\n                Orientation.Right\r\n            )\r\n        )\r\n\r\n        return theSlots;\r\n    } \r\n\r\n    \r\n    handleClick(cursor: Vector) {\r\n        if (this.pickingOrigin) {\r\n            this.pickingOrigin = false;\r\n            this.reshape(this.constrainCursor(cursor))\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    constrainCursor(cursor: Vector): Vector {\r\n        let newCursor = cursor.clone();\r\n        if (this.pickingOrigin) {\r\n        } else {\r\n            newCursor.y = this.pos.y\r\n        }\r\n\r\n        return newCursor;\r\n    }\r\n\r\n    originX: number = 0\r\n    reshape(cursor: Vector) {\r\n\r\n        if (this.pickingOrigin) {\r\n            let theSlot = this.alignToSlot(cursor)\r\n            if (theSlot) {\r\n                this.facing = theSlot.facing\r\n\r\n                if (theSlot && this.facing === Orientation.Left) {\r\n                    this.originX = theSlot.pos.x\r\n                }\r\n            }\r\n\r\n        } else {\r\n            if (this.facing === Orientation.Left) {\r\n                this.setWidth(Math.abs(this.originX - cursor.x))\r\n                this.pos.x = this.originX - this.getWidth()\r\n            } else {\r\n                this.setWidth(Math.abs(this.pos.x - cursor.x))\r\n            }\r\n        }\r\n    }\r\n}","module.exports = __webpack_public_path__ + \"0a266eded2bf27831b18735ffc081448.png\";","module.exports = __webpack_public_path__ + \"2475589a97ba4901bfa7ab53b5487778.png\";","module.exports = __webpack_public_path__ + \"98240dde9344ac8d071d076ac951e15d.png\";","module.exports = __webpack_public_path__ + \"da31cf43235263c1c3e0ad45a46360a1.png\";","module.exports = __webpack_public_path__ + \"a6a38278ac501400c6199e0df9e1bf84.png\";","module.exports = __webpack_public_path__ + \"ece1d5d5858bc048d2d949ecc3f5e9bc.png\";","module.exports = __webpack_public_path__ + \"3654f0489813e0668743efde017c9653.png\";","module.exports = __webpack_public_path__ + \"3abbdabf07943966f102ac7345a59986.png\";","module.exports = __webpack_public_path__ + \"d1b4690b9f5fa4957f98602afc8cfdb6.png\";","module.exports = __webpack_public_path__ + \"0eb7a15ea04678b14a2b88b5965aabeb.png\";","module.exports = __webpack_public_path__ + \"490d8337dc1436fdb073e0ce7c1aa4e2.svg\";","module.exports = __webpack_public_path__ + \"9a1897cb324167653e7d23e377df09f7.svg\";","module.exports = __webpack_public_path__ + \"f74ccf77b74f12d78334366e7365d1ee.svg\";","module.exports = __webpack_public_path__ + \"d754bb375d83b60c875254997ad378af.svg\";","module.exports = __webpack_public_path__ + \"48be2487ecb6d75a112437662b61e05d.svg\";","module.exports = __webpack_public_path__ + \"c39dae9d5741e8fcd6c6a812b599a99c.svg\";","module.exports = __webpack_public_path__ + \"f91c0d7d285b0686ece2084cc3640bce.svg\";","module.exports = __webpack_public_path__ + \"824e22e59890ae78258b54985e42ca6d.svg\";","module.exports = __webpack_public_path__ + \"dfe6e4db2f0c22d18befa85c1e163369.svg\";","module.exports = __webpack_public_path__ + \"9a947d50110c1d1db07c76a4bba2e653.svg\";","module.exports = __webpack_public_path__ + \"4976b6042ef557ca6085c8d0168251f4.svg\";","module.exports = __webpack_public_path__ + \"46418cf15643d9b1b171c1b64160a5af.svg\";","module.exports = __webpack_public_path__ + \"36a02c2483b688be86ce07bea4bd7295.svg\";","module.exports = __webpack_public_path__ + \"29c5f1be64c99bbc14d5063eea2f0953.svg\";","module.exports = __webpack_public_path__ + \"502f86b65239e20806bbae8bc77a6116.svg\";","module.exports = __webpack_public_path__ + \"5289b20985e3c3a98081267a2da1772e.svg\";","module.exports = __webpack_public_path__ + \"1d893905e4eea3bbc48b0e129e318ea6.svg\";","module.exports = __webpack_public_path__ + \"bd556d00e484db4e52d198d0bf39d0f2.svg\";","module.exports = __webpack_public_path__ + \"650cd431226df0755357c71d61bef1f2.svg\";","module.exports = __webpack_public_path__ + \"f12c591f538ab3026bf13e93f3fa9485.svg\";","module.exports = __webpack_public_path__ + \"3aeb9dd24809ba3fbd4eeb31a28c3b19.svg\";","module.exports = __webpack_public_path__ + \"6cc6f6773bb6eb26fcef87b9629f7b87.svg\";","module.exports = __webpack_public_path__ + \"43062e54318df93f49e2be9a4281eb4a.svg\";","module.exports = __webpack_public_path__ + \"24611230ec712ba7ee38b99561aedd87.svg\";","module.exports = __webpack_public_path__ + \"c4ab2ceb2f61e18493fc776770c65654.svg\";","module.exports = __webpack_public_path__ + \"bbd50a175546bd70d21c5eadbc30d479.svg\";","module.exports = __webpack_public_path__ + \"7441c2ab240d0f733451d75204ac0792.svg\";","module.exports = __webpack_public_path__ + \"91a8cce06c3c05ce6e4b176afafd7b0a.svg\";","module.exports = __webpack_public_path__ + \"0ce4f9c3384680565b6bb16495b64233.svg\";","module.exports = __webpack_public_path__ + \"1db542acabeb82ec8da785e77afd4dca.svg\";","import { ResourceBlock } from \"./Economy\";\r\n\r\nexport type MechanicalOperation =\r\n    Recipe |\r\n    ResourceGenerator |\r\n    ResourceStorage |\r\n    SpawnClone |\r\n    AccelerateTime |\r\n    ExploreForResource |\r\n    Noop\r\n\r\nexport interface Noop {\r\n    type: 'noop'\r\n}\r\n\r\nexport interface Recipe {\r\n    type: 'recipe'\r\n    consumes: ResourceBlock[]\r\n    produces: ResourceBlock\r\n    workTime: number\r\n}\r\n\r\nexport interface ResourceGenerator {\r\n    type: 'generator'\r\n    generates: ResourceBlock\r\n    generationTime: number\r\n    capacity: number\r\n}\r\n\r\nexport interface ResourceStorage {\r\n    type: 'store'\r\n    stores: ResourceBlock[]\r\n    capacity: number\r\n}\r\n\r\nexport interface SpawnClone {\r\n    type: 'spawn'\r\n}\r\n\r\nexport interface AccelerateTime {\r\n    type: 'accelerate'\r\n    factor: number\r\n}\r\n\r\nexport interface ExploreForResource {\r\n    type: 'explore'\r\n    gathers: ResourceBlock\r\n    capacity: number\r\n}\r\n\r\nfunction store(res: ResourceBlock[], capacity: number = 10): ResourceStorage {\r\n    return {\r\n        type: 'store',\r\n        stores: res,\r\n        capacity\r\n    }\r\n}\r\n\r\nfunction generate(res: ResourceBlock, cap: number = 4): ResourceGenerator {\r\n    return {\r\n        type: 'generator',\r\n        generates: res,\r\n        generationTime: 1000,\r\n        capacity: cap\r\n    }\r\n}\r\n\r\nfunction recipe(input: ResourceBlock[], output: ResourceBlock): Recipe {\r\n    return {\r\n        type: 'recipe',\r\n        consumes: input,\r\n        produces: output,\r\n        workTime: 1000,\r\n    }\r\n}\r\n\r\nfunction spawn(): SpawnClone {\r\n    return {\r\n        type: 'spawn',\r\n    }\r\n}\r\n\r\nfunction accelerateTime(): AccelerateTime {\r\n    return {\r\n        type: 'accelerate',\r\n        factor: 2\r\n    }\r\n}\r\n\r\nfunction explore(block: ResourceBlock, cap: number = 4): ExploreForResource {\r\n    return {\r\n        type: 'explore',\r\n        gathers: block,\r\n        capacity: cap\r\n    }\r\n}\r\n\r\nexport const mechanicalOperations = {\r\n    store,\r\n    generate,\r\n    recipe,\r\n    spawn,\r\n    accelerateTime,\r\n    explore,\r\n}","import { Input, Scene, Timer, Vector, LockCameraToActorStrategy, Color } from \"excalibur\";\r\nimport { Building, structureViews } from \"../actors/Building\";\r\nimport { DevicePlace } from \"../actors/Building/Building\";\r\nimport { Device } from \"../actors/Device\";\r\nimport { Hud } from \"../actors/Hud/Hud\";\r\nimport { Planet } from \"../actors/Planet/Planet\";\r\nimport { Player } from \"../actors/player\";\r\nimport { Game } from \"../Game\";\r\nimport { Machine, allMachines } from \"../models/Machine\";\r\nimport { LivingQuarters, MissionControl, SolarArray, RoomRecipe, CloneReception, Kitchen, Workshop, Archive, Refinery, Mine } from \"../models/RoomRecipe\";\r\nimport { Corridor, HugeRoom, LargeRoom, MainTunnel, MediumRoomThree, SmallDome, SmallRoomThree, Structure, SurfaceRoad } from \"../models/Structure\";\r\nimport { flatSingle, zip, sample } from \"../Util\";\r\nimport { DeviceSize } from \"../values/DeviceSize\";\r\nimport { Orientation } from \"../values/Orientation\";\r\nimport { TechnologyRank } from \"../models/TechnologyRank\";\r\nimport { TechTree } from \"../models/TechTree\";\r\n\r\n\r\nexport class Construct extends Scene {\r\n    game: Game\r\n    planet: Planet\r\n    hud: Hud\r\n    player: Player\r\n\r\n    dragging: boolean = false\r\n    dragOrigin: Vector\r\n\r\n    defaultMessage: string = 'Welcome to the Colony, Commander.'\r\n\r\n    placingFunction: RoomRecipe = null\r\n\r\n    time: number = Game.startHour*60\r\n\r\n    hasActiveModal: boolean = false\r\n\r\n    techTree: TechTree = new TechTree()\r\n\r\n    firstBuilding: boolean = true\r\n\r\n\r\n    static requiredStructuresAndFunctions: (typeof RoomRecipe | typeof Structure)[] = [\r\n        MissionControl,\r\n        SurfaceRoad,\r\n        SolarArray,\r\n        MainTunnel,\r\n        Corridor,\r\n        LivingQuarters,\r\n    ]\r\n\r\n    update(engine, delta) {\r\n        super.update(engine, delta)\r\n\r\n\r\n        let devices = this.planet.colony.findPoweredDevices()\r\n        let machines = allMachines.filter(machine => devices.some(device => device.machine instanceof machine))\r\n\r\n        let discipline = this.techTree.findDisciplineToRankUp(machines)\r\n        if (discipline) {\r\n            let rank = this.techTree.rankUp(discipline)\r\n            this.rankUp(rank)\r\n        }\r\n\r\n        // hmm!\r\n        this.hud.updateDetails(this.planet, this.techTree, true, this.time)\r\n\r\n    }\r\n\r\n    public onInitialize(game: Game) {\r\n        this.game = game\r\n\r\n        let buildIt = (e) => this.startConstructing(e)\r\n        let followIt = (c) => this.startFollowing(c)\r\n\r\n        this.hud = new Hud(game, buildIt, buildIt, buildIt, followIt)\r\n        this.add(this.hud)\r\n\r\n        this.planet = new Planet(\r\n            game.world,\r\n            this.hud,\r\n            (b) => this.hud.showCard(b),\r\n            (d) => this.hud.showCard(d)\r\n        )\r\n\r\n        this.add(this.planet)\r\n  \r\n        this.player = new Player()\r\n        this.add(this.player)\r\n\r\n        this.prepareNextBuilding()\r\n        this.camera.pos.y = this.planet.getTop() - 1000\r\n        this.camera.zoom(0.05)\r\n        this.camera.zoom(0.5, 10000)\r\n\r\n        this.addTimer(\r\n            new Timer(() => { this.stepTime() }, this.timeStepIntervalMillis, true)\r\n        )\r\n\r\n        this.systemMessage(\r\n            \"Welcome to the Colony, sir... \"\r\n            + \"We are what is left of the crew of the Osiris. \"\r\n            + \"Can you help us build a functioning society? \"\r\n            + \"First, choose a location for the Command post. \"\r\n            + \"Then we'll lay out some infrastructure.\"\r\n        )\r\n    }\r\n\r\n    showTutorial: boolean = true\r\n    private systemMessage(message: string) {\r\n        this.hasActiveModal = true\r\n        this.hud.systemMessage(message, \"\", {\r\n            continue: () => { this.closeSystemMessage() },\r\n            //stopTutorial: () => {\r\n            //    this.closeSystemMessage()\r\n            //    this.tuto\r\n            //}\r\n\r\n        })\r\n    }\r\n\r\n    private tutorialMessage(message: string) {\r\n        if (this.showTutorial) {\r\n        this.hasActiveModal = true\r\n            this.hud.systemMessage(message, \"\", {\r\n                continue: () => { this.closeSystemMessage() },\r\n                'i got this': () => {\r\n                    this.closeSystemMessage()\r\n                    this.showTutorial = false\r\n                }\r\n            })\r\n        }\r\n    }\r\n\r\n    private rankUp(rank: TechnologyRank) {\r\n        if (this.hasActiveModal) {\r\n            this.closeSystemMessage()\r\n        }\r\n\r\n        this.hasActiveModal = true\r\n        let rankUpMessage =\r\n            \"Your colony's mastery of a discipline has improved! \" +\r\n            \"The following new machines are now available for construction:\"\r\n\r\n        let okay = sample([ 'excellent!', 'great!', 'perfect', 'good work', 'cool', 'wonderful', 'brilliant', 'that is what i am talking about', 'keep up the good work', 'learning is fun!' ])\r\n\r\n        let modal = this.hud.systemMessage(\r\n            rankUpMessage,\r\n            \"rank up\",\r\n            { [okay]: () => { this.closeSystemMessage() }\r\n        })\r\n\r\n        modal.addHeading(rank.name, 28, Color.Orange)\r\n        modal.addHeading(rank.description, 12)\r\n\r\n        modal.addIconMatrix(\r\n            rank.unlocks.map(m => new m()).map(machine => { return {\r\n                image: machine.image,\r\n                label: machine.name\r\n            }})\r\n        )\r\n    }\r\n\r\n    private closeSystemMessage() {\r\n        this.hud.closeSystemMessage()\r\n        this.hasActiveModal = false\r\n    }\r\n\r\n\r\n    timeStepIntervalMillis: number = 50\r\n    private stepTime() { \r\n        this.time += this.timeStepIntervalMillis / Game.minuteTickMillis  /// this.timeStepIntervalMillis //  0.125 //.25\r\n        this.planet.setTime(this.time) \r\n    }\r\n\r\n    public onActivate() {\r\n        this.game.input.pointers.primary.on('move', (e: Input.PointerMoveEvent) => {\r\n            if (this.hasActiveModal) { return }\r\n\r\n            if (this.dragging) {\r\n                this.camera.pos = this.camera.pos.add(\r\n                    this.dragOrigin.sub(e.pos)\r\n                )\r\n\r\n            } else {\r\n                this.player.pos = e.pos\r\n\r\n                let currentlyBuilding = this.planet.currentlyConstructing\r\n                if (currentlyBuilding instanceof Building) {\r\n\r\n                    let constrained = currentlyBuilding.constrainCursor(this.player.pos)\r\n                    this.player.pos = constrained\r\n\r\n                    currentlyBuilding.reshape(this.player.pos)\r\n                } else if (currentlyBuilding instanceof Device) {\r\n                    currentlyBuilding.snap(this.planet, this.player.pos)\r\n                }\r\n            }\r\n        })\r\n\r\n        this.game.input.pointers.primary.on('up', () => {\r\n            if (this.dragging) { this.dragging = false; }\r\n        })\r\n\r\n        this.game.input.pointers.primary.on('down', (e: Input.PointerDownEvent) => {\r\n            if (this.hasActiveModal) { return }\r\n\r\n            if (e.button == Input.PointerButton.Left) {\r\n                const currentlyBuilding = this.planet.currentlyConstructing\r\n                if (currentlyBuilding) {\r\n                    if (currentlyBuilding instanceof Building) {\r\n                        let buildingUnderConstruction = currentlyBuilding\r\n                        let placementValid = !buildingUnderConstruction.overlapsAny()\r\n                        if (buildingUnderConstruction && placementValid && buildingUnderConstruction.handleClick(e.pos)) {\r\n                            this.planet.placeBuilding(buildingUnderConstruction)\r\n\r\n                            if (this.placingFunction) {\r\n                                let fn = this.placingFunction\r\n                                // console.log({ fn, bldg: buildingUnderConstruction })\r\n                                zip(fn.machines, buildingUnderConstruction.devicePlaces()).forEach(([machine, place]: [typeof Machine, DevicePlace]) => {\r\n                                    console.log(\"would add machine\", { machine, place })\r\n                                    let m = (new machine()).concretize()\r\n                                    let device = new Device(m, place.position)\r\n                                    buildingUnderConstruction.addDevice(device)\r\n                                })\r\n                                this.placingFunction = null\r\n                            }\r\n\r\n                            this.hud.setStatus(this.defaultMessage)\r\n                            this.planet.colony.currentlyConstructing = null\r\n                            this.prepareNextBuilding(e.pos)\r\n                            // this.hud.updateDetails(this.planet)\r\n                        }\r\n                    } else {\r\n                        let deviceUnderConstruction = currentlyBuilding\r\n                        let placementValid = (deviceUnderConstruction.size === DeviceSize.Tiny) ||\r\n                            !deviceUnderConstruction.overlapsAny()\r\n                        let snapped = deviceUnderConstruction.snap(this.planet)\r\n                        if (snapped && placementValid) {\r\n                            if (deviceUnderConstruction.size === DeviceSize.Tiny) {\r\n                                let parent = deviceUnderConstruction.parentDevice\r\n                                parent.addTinyDevice(deviceUnderConstruction)\r\n                            } else {\r\n                                let bldg = deviceUnderConstruction.building\r\n                                bldg.addDevice(deviceUnderConstruction)\r\n                            }\r\n                            this.planet.colony.currentlyConstructing = null\r\n                            this.hud.setStatus(this.defaultMessage)\r\n                        }\r\n                    }\r\n                }\r\n            } else if (e.button === Input.PointerButton.Middle) {\r\n                this.dragging = true;\r\n                this.dragOrigin = e.pos\r\n            }\r\n        })\r\n\r\n        this.game.input.pointers.primary.on('wheel', (e: Input.WheelEvent) => {\r\n            if (this.hasActiveModal) { return }\r\n\r\n            let z = this.camera.getZoom()\r\n            let step = 0.05\r\n            let min = 0.05, max = 8\r\n            if (e.deltaY < 0) {\r\n                this.camera.zoom(Math.min(z + step, max))\r\n            } else if (e.deltaY > 0) {\r\n                this.camera.zoom(Math.max(z - step, min))\r\n            }\r\n        })\r\n\r\n        let { Up, Down, Left, Right } = Orientation;\r\n        let moveCam = (direction: Orientation) => {\r\n            let camMoveSpeed = 10 * (1/this.camera.getZoom())\r\n            let dv = new Vector(0,0)\r\n            switch(direction) {\r\n            case Left: dv.x = -camMoveSpeed; break\r\n            case Right: dv.x = camMoveSpeed; break\r\n            case Up: dv.y = -camMoveSpeed; break\r\n            case Down: dv.y = camMoveSpeed; break\r\n            }\r\n            this.camera.move(this.camera.pos.add(dv), 0)\r\n        }\r\n\r\n\r\n        this.game.input.keyboard.on('press', (e: Input.KeyEvent) => {\r\n            if (e.key === Input.Keys.H) {\r\n                if (this.buildings && this.buildings[0]) {\r\n                    this.camera.move(this.buildings[0].pos, 500)\r\n                    this.camera.zoom(0.5, 1000)\r\n                }\r\n            } else if (e.key === Input.Keys.Esc) {\r\n                this.planet.colony.currentlyConstructing = null\r\n                this.placingFunction = null\r\n                this.stopFollowing()\r\n                this.hud.setStatus(this.defaultMessage)\r\n            } else if (e.key === Input.Keys.Up || e.key === Input.Keys.W) {\r\n                moveCam(Up)\r\n            } else if (e.key === Input.Keys.Left || e.key === Input.Keys.A) {\r\n                moveCam(Left)\r\n            } else if (e.key === Input.Keys.Down || e.key === Input.Keys.S) {\r\n                moveCam(Down)\r\n            } else if (e.key === Input.Keys.Right || e.key === Input.Keys.D) {\r\n                moveCam(Right)\r\n            }\r\n        })\r\n        this.game.input.keyboard.on('hold', (e: Input.KeyEvent) => {\r\n            if (e.key === Input.Keys.Up || e.key === Input.Keys.W) {\r\n                moveCam(Up)\r\n            } else if (e.key === Input.Keys.Left || e.key === Input.Keys.A) {\r\n                moveCam(Left)\r\n            } else if (e.key === Input.Keys.Down || e.key === Input.Keys.S) {\r\n                moveCam(Down)\r\n            } else if (e.key === Input.Keys.Right || e.key === Input.Keys.D) {\r\n                moveCam(Right)\r\n            }\r\n        })\r\n    }\r\n\r\n    public onDeactivate() {\r\n        this.game.input.pointers.primary.off('move')\r\n        this.game.input.pointers.primary.off('down')\r\n        this.game.input.pointers.primary.off('up')\r\n        this.game.input.pointers.primary.off('wheel')\r\n    }\r\n\r\n    get buildings() { return this.planet.colony.buildings }\r\n\r\n\r\n    private nextMissingStructureOrFunction(): Structure | RoomRecipe {\r\n        let reqs = Construct.requiredStructuresAndFunctions.map(req => new req())\r\n\r\n        let actualStructureNames = this.buildings.map(building => building.structure.name)\r\n        let actualFunctionNames = flatSingle(\r\n            this.buildings.map(building => building.spaceFunction && building.spaceFunction.name)\r\n        )\r\n        let actualNames = [...actualStructureNames, ...actualFunctionNames]\r\n        return reqs.find(req => !actualNames.includes(req.name))\r\n    }\r\n\r\n    protected prepareNextBuilding(pos: Vector = new Vector(0,0)) {\r\n        let structure = null;\r\n        let nextMissing = this.nextMissingStructureOrFunction() //this.nextMissingRequiredStructure();\r\n        if (nextMissing) { structure = nextMissing; }\r\n        if (structure) {\r\n            let congrats = sample([ 'Nice!', 'Perfect.', 'Great work!', 'Excellent!', 'Good.', 'That works.' ])\r\n            let nextUp = sample([ 'Now we need to', 'Next we will', 'Okay, time to'])\r\n            this.tutorialMessage(`${congrats} ${nextUp} build a ${structure.name}...`)\r\n            this.startConstructing(structure, pos)\r\n        } else {\r\n            // this.systemMessage(`Now we need to build a ${structure.name}...`)\r\n            this.hud.showPalettes()\r\n        }\r\n    }\r\n\r\n    cameraStrategy: LockCameraToActorStrategy\r\n    startFollowing(citizen) {\r\n        this.stopFollowing()\r\n        this.cameraStrategy = new LockCameraToActorStrategy(citizen)\r\n        this.camera.zoom(2, 1000)\r\n        this.camera.addStrategy(this.cameraStrategy)\r\n    }\r\n\r\n    stopFollowing() {\r\n        if (this.cameraStrategy) {\r\n            this.camera.removeStrategy(this.cameraStrategy)\r\n            this.camera.zoom(1, 1000)\r\n        }\r\n    }\r\n\r\n    startConstructing(structureOrMachine: Structure | Machine | RoomRecipe, pos: Vector = new Vector(0, 0)) {\r\n        this.hud.showCard(structureOrMachine)\r\n        \r\n        let theNextOne = null\r\n        if (structureOrMachine instanceof Structure) {\r\n            let structure = structureOrMachine\r\n            this.hud.setStatus(`Place ${structure.name} (${structure.description})`)\r\n            theNextOne = this.spawnBuilding(structure, pos)\r\n            if (this.firstBuilding) {\r\n                this.camera.zoom(structure.zoom, 250)\r\n                this.camera.pos = theNextOne.pos\r\n                this.firstBuilding = false\r\n            } \r\n        } else if (structureOrMachine instanceof Machine) {\r\n            let machine = structureOrMachine\r\n            this.hud.setStatus(`Install ${machine.name} (${machine.description})`)\r\n            theNextOne = this.spawnDevice(machine, pos)\r\n            // this.camera.zoom(1.5, 250)\r\n        } else if (structureOrMachine instanceof RoomRecipe) {\r\n            let fn: RoomRecipe = structureOrMachine\r\n            this.hud.setStatus(`Place ${fn.name} (${fn.description})`)\r\n            theNextOne = this.spawnFunction(fn, pos)\r\n            this.placingFunction = fn\r\n\r\n        }\r\n\r\n        this.planet.colony.currentlyConstructing = null\r\n        if (theNextOne) {\r\n            this.planet.colony.currentlyConstructing = theNextOne\r\n            // this.camera.pos = theNextOne.pos\r\n        }\r\n    }\r\n\r\n    protected spawnDevice(machine: Machine, pos: Vector): Device {\r\n        let device = new Device(machine, pos)\r\n        if (device.snap(this.planet)) {\r\n            this.camera.pos = device.pos\r\n \r\n        }\r\n        return device\r\n    }\r\n\r\n    protected spawnBuilding(structure: Structure, pos: Vector): Building {\r\n        let anotherBuilding = this.assembleBuildingFromStructure(structure, pos)\r\n        anotherBuilding.reshape(anotherBuilding.constrainCursor(pos))\r\n        return anotherBuilding\r\n    }\r\n    \r\n    private assembleBuildingFromStructure(structure: Structure, pos: Vector): Building {\r\n        let View = structureViews[structure.view]\r\n        let building = new View(pos, structure, this.planet)\r\n        return building;\r\n    }\r\n\r\n    protected spawnFunction(fn: RoomRecipe, pos: Vector): Building {\r\n        let theStructure: Structure = (fn.structure && new fn.structure()) // || new SmallRoomThree()\r\n        if (!theStructure) {\r\n            theStructure = new SmallRoomThree()\r\n            let machines = fn.machines.map(m => new m())\r\n\r\n            if (machines.some(m => m.size === DeviceSize.Medium)) {\r\n                theStructure = new MediumRoomThree()\r\n            }\r\n\r\n            if (machines.some(m => m.size === DeviceSize.Large)) {\r\n                theStructure = new LargeRoom()\r\n            }\r\n\r\n            if (machines.some(m => m.size === DeviceSize.Huge)) {\r\n                theStructure = new HugeRoom()\r\n            }\r\n\r\n            if (machines.some(m => m.forDome)) {\r\n                theStructure = new SmallDome()\r\n            }\r\n        }\r\n\r\n        // console.log(\"SPAWN FUNCTION\", { fn, structure: theStructure })\r\n        let building = this.assembleBuildingFromStructure(theStructure, pos)\r\n        building.reshape(building.constrainCursor(building.pos))\r\n        return building\r\n    }\r\n} \r\n","module.exports = __webpack_public_path__ + \"37914c496c3c503f7a53d7c9a1457b53.mp3\";","module.exports = __webpack_public_path__ + \"1b8e735649248c4c552a84996e61f241.mp3\";","module.exports = __webpack_public_path__ + \"1a607294aebce07746d6f25ffa517d80.mp3\";","module.exports = __webpack_public_path__ + \"22bdefc1e8515661fdeb8e8076820641.mp3\";","module.exports = __webpack_public_path__ + \"cf150ab26eba01503f4f6dc3d9ab47f7.mp3\";","module.exports = __webpack_public_path__ + \"94754f62e0ae4d23d386e246f5e0cb6e.png\";","import { Game } from './Game';\r\nimport { World } from './models/World';\r\nimport { Construct } from './scenes/Construct';\r\nimport { Resources } from './Resources';\r\nimport { Sound } from 'excalibur';\r\n\r\nconst theWorld = new World();\r\nconst game = new Game(theWorld);\r\n\r\nconst construct = new Construct(game);\r\ngame.add('construct', construct);\r\n\r\ngame.start().then(() => {\r\n  game.goToScene('construct');\r\n  // setTimeout(() => {\r\n  //   console.log(\"let's jam!\");\r\n  //   let jam: Sound = Resources.CraterRock //play();\r\n  //   jam.play()\r\n  // }, 1500)\r\n  // jam.oncomplete = () => jam.play()\r\n});\r\n"],"sourceRoot":""}