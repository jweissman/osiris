{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/Util.ts","webpack:///./src/Game.ts","webpack:///./src/values/DeviceSize.ts","webpack:///./src/actors/Building/index.ts","webpack:///./src/values/Scale.ts","webpack:///./src/models/Machine.ts","webpack:///./src/values/Orientation.ts","webpack:///./src/models/Economy.ts","webpack:///./src/actors/Building/Building.ts","webpack:///./src/Painting.ts","webpack:///./src/actors/Device.ts","webpack:///./src/Elemental.ts","webpack:///./src/actors/Hud/Pane.ts","webpack:///./src/strategies/Strategy.ts","webpack:///./src/actors/Citizen.ts","webpack:///./src/models/Structure.ts","webpack:///./src/models/RoomRecipe.ts","webpack:///./src/GameController.ts","webpack:///./src/actors/Building/BackgroundPatterns.ts","webpack:///./src/models/World.ts","webpack:///./src/actors/Planet/Planet.ts","webpack:///./src/Construction.ts","webpack:///./src/actors/Planet/MountainLayers.ts","webpack:///./src/actors/Planet/PlanetBackground.ts","webpack:///./src/actors/EmitterFactory.ts","webpack:///./src/actors/LaserBeam.ts","webpack:///./src/strategies/CombatStrategy.ts","webpack:///./src/values/Graph.ts","webpack:///./src/Resources.ts","webpack:///./src/scenes/Sandbox.ts","webpack:///./src/scenes/Menu.ts","webpack:///./src/scenes/Arena.ts","webpack:///./src/models/TechnologyRank.ts","webpack:///./src/models/TechTree.ts","webpack:///./src/actors/Hud/CitizenList.ts","webpack:///./src/actors/Hud/Modal.ts","webpack:///./src/actors/Hud/Palette.ts","webpack:///./src/actors/Hud/CardBody.ts","webpack:///./src/actors/Hud/CardTitle.ts","webpack:///./src/actors/Hud/Card.ts","webpack:///./src/actors/Hud/MusicPlayer.ts","webpack:///./src/actors/Hud/EconomicValue.ts","webpack:///./src/actors/Hud/EconomyView.ts","webpack:///./src/actors/Hud/ResourceListEntry.ts","webpack:///./src/actors/Hud/ResourcesList.ts","webpack:///./src/actors/Hud/StatusAnalysisView.ts","webpack:///./src/actors/Hud/Hud.ts","webpack:///./src/actors/Planet/Mountains.ts","webpack:///./src/actors/Planet/SkyLayer.ts","webpack:///./src/actors/Planet/SkyLayers.ts","webpack:///./src/strategies/AttackNearestHostileStrategy.ts","webpack:///./src/strategies/EatingStrategy.ts","webpack:///./src/strategies/WhenHungryEatingStrategy.ts","webpack:///./src/strategies/SleepingStrategy.ts","webpack:///./src/strategies/AnyBedSleepingStrategy.ts","webpack:///./src/strategies/ConstructionStrategy.ts","webpack:///./src/strategies/ProximityBasedConstruction.ts","webpack:///./src/values/InteractionRequest.ts","webpack:///./src/strategies/ProductionStrategy.ts","webpack:///./src/strategies/CapacityBasedProduction.ts","webpack:///./src/actors/Planet/Population.ts","webpack:///./src/actors/Planet/NavigationTree.ts","webpack:///./src/actors/Planet/Colony.ts","webpack:///./src/actors/Building/GroundVehiclePoolView.ts","webpack:///./src/actors/Building/MediumSurfaceRoomView.ts","webpack:///./src/actors/Building/MediumRoomThreeView.ts","webpack:///./src/actors/Building/HugeRoomView.ts","webpack:///./src/actors/Building/LargeRoomView.ts","webpack:///./src/actors/Building/MediumRoomView.ts","webpack:///./src/actors/Building/SmallRoomThreeView.ts","webpack:///./src/actors/Building/BigDomeView.ts","webpack:///./src/actors/Building/MidDomeView.ts","webpack:///./src/actors/Building/SmallDomeThreeView.ts","webpack:///./src/actors/Building/SurfaceRoadView.ts","webpack:///./src/actors/Building/LadderView.ts","webpack:///./src/actors/Building/ArcologyView.ts","webpack:///./src/actors/Building/TunnelView.ts","webpack:///./src/actors/Building/DomeView.ts","webpack:///./src/actors/Building/CommonAreaView.ts","webpack:///./src/actors/Building/CorridorView.ts","webpack:///./src/images/wood-panel-bg.png","webpack:///./src/images/ussf.png","webpack:///./src/images/window-bg.png","webpack:///./src/images/beige-bg.png","webpack:///./src/images/checker-bg.png","webpack:///./src/images/tech-bg.png","webpack:///./src/images/poster-wall-bg.png","webpack:///./src/images/books-bg.png","webpack:///./src/images/leafy-bg.png","webpack:///./src/images/raised-square-bg.png","webpack:///./src/images/laser-turret-plain.svg","webpack:///./src/images/mineral-processor-plain.svg","webpack:///./src/images/water-condenser-plain.svg","webpack:///./src/images/oxygen-extractor-plain.svg","webpack:///./src/images/greenhouse-plain.svg","webpack:///./src/images/books-plain.svg","webpack:///./src/images/telescope-plain.svg","webpack:///./src/images/orrery-plain.svg","webpack:///./src/images/lava-lamp-plain.svg","webpack:///./src/images/codex-plain.svg","webpack:///./src/images/statue-plain.svg","webpack:///./src/images/miner-plain.svg","webpack:///./src/images/solar-collector-plain.svg","webpack:///./src/images/couch-plain.svg","webpack:///./src/images/fabricator-plain.svg","webpack:///./src/images/mega-console-plain.svg","webpack:///./src/images/console-red-plain.svg","webpack:///./src/images/console-green-plain.svg","webpack:///./src/images/console-purple-plain.svg","webpack:///./src/images/console-plain.svg","webpack:///./src/images/workstation-plain.svg","webpack:///./src/images/houseplant-plain.svg","webpack:///./src/images/research-server-plain.svg","webpack:///./src/images/fridge-plain.svg","webpack:///./src/images/bed-plain.svg","webpack:///./src/images/cooking-fire-plain.svg","webpack:///./src/images/cabin-plain.svg","webpack:///./src/images/stove-plain.svg","webpack:///./src/images/bench-simple-plain.svg","webpack:///./src/images/vat-plain.svg","webpack:///./src/images/bookshelf-plain.svg","webpack:///./src/models/MechanicalOperation.ts","webpack:///./src/scenes/Play.ts","webpack:///./src/sounds/future tense.mp3","webpack:///./src/sounds/understanding.mp3","webpack:///./src/sounds/indivision.mp3","webpack:///./src/sounds/assembler.mp3","webpack:///./src/sounds/crater-rock.mp3","webpack:///./src/images/sword.png","webpack:///./src/index.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","1","exports","module","l","m","c","d","name","getter","o","defineProperty","configurable","enumerable","get","r","value","n","__esModule","default","object","property","p","jsonpArray","window","webpackJsonp","oldJsonpFunction","bind","slice","excalibur_1","extremumBy","arr","pluck","extremum","reduce","best","next","pair","_ecRange","a","minBy","fn","Math","min","maxBy","max","sample","floor","random","range","Array","fill","map","_val","idx","closest","cursor","getVector","predicate","matching","filter","elem","distance","flatSingle","concat","deleteByValue","e","deleteByValueOnce","index","indexOf","eachCons","eachChunk","array","measureDistance","b","sleep","ms","Promise","resolve","setTimeout","shuffle","sort","zip","countOccurrences","counts","forEach","containsUniq","testElems","doesContain","arrCopy","missingItem_1","testElem","find","mixColors","factor","aFactor","bFactor","Color","g","onlyUnique","self","Resources_1","Game","_super","world","_this","this","displayMode","DisplayMode","FullScreen","backgroundColor","Black","debugMode","__extends","start","loader","Loader","key","Resources","addResource","logo","logoWidth","logoHeight","startButtonFactory","myButton","document","createElement","textContent","style","border","display","padding","fontFamily","font","color","fontSize","fontWeight","onmouseenter","Red","darken","toRGBA","onmouseleave","then","console","log","toggleDebugMode","title","startHour","mansheight","citizenSpeed","bulletSpeed","raidingPartyFrequency","minuteTickMillis","Engine","DeviceSize","Scale_1","Game_1","major","Scale","minor","Tiny","Small","Medium","Large","Huge","getVisibleDeviceSize","size","sz","second","sixth","first","eighth","Building_1","Building","CorridorView_1","CorridorView","CommonAreaView_1","CommonAreaView","DomeView_1","DomeView","TunnelView_1","TunnelView","ArcologyView_1","ArcologyView","LadderView_1","LadderView","SurfaceRoadView_1","SurfaceRoadView","SmallDomeThreeView_1","SmallDomeThreeView","MidDomeView_1","MidDomeView","BigDomeView_1","BigDomeView","SmallRoomThreeView_1","SmallRoomThreeView","MediumRoomView_1","MediumRoomView","LargeRoomView_1","LargeRoomView","HugeRoomView_1","HugeRoomView","MediumRoomThreeView_1","MediumRoomThreeView","MediumSurfaceRoomView_1","MediumSurfaceRoomView","GroundVehiclePoolView_1","structureViews","GroundVehiclePoolView","majorUnit","minorUnit","octave","unit","third","fourth","fifth","seventh","majorScale","minorScale","Economy_1","DeviceSize_1","MechanicalOperation_1","Util_1","images","bookshelf","vat","bench","stove","cabin","fire","bed","fridge","server","plant","workstation","consolePurple","consoleGreen","consoleRed","megaconsole","fabricator","couch","solar","miner","statue","codex","lavaLamp","orrery","telescope","books","greenhouse","o2","h20","minProcessor","laser","Green","Blue","Orange","Violet","Yellow","store","mechanicalOperations","generate","recipe","spawn","accelerateTime","explore","Machine","description","LightGray","cost","ResourceBlock","Mineral","operation","type","image","prereqs","economy","emptyMarket","forDome","hide","isVehicle","tinySlots","isEatingSurface","powerEffect","defender","concretize","onPlacement","device","CommandCenter","arguments","Ore","__assign","Power","supply","demand","Oxygen","Water","Hope","Shelter","t","built","produceResource","building","times","populate","pos","add","MissionLog","Data","LavaLamp","Table","Joy","Figurine","Beauty","Orrery","Wonder","Books","Idea","Wisdom","OxygenExtractor","WaterCondensingMachine","SolarCell","Bed","Telescope","Statue","StudyMachine","Workstation","Codex","Bookshelf","Couch","Fridge","Meal","Stove","Biomass","Houseplant","Botany","PersonnelRegistry","CloningVat","OrientationConsole","productionTime","AlgaeVat","DissolutionVat","Bioplasma","PlasmaBank","Fabricator","Alloy","LifeSciencesConsole","Laser","Miner","MineralProcessor","MiningDrill","MetalStorage","ResearchServer","Algorithm","Greenhouse","Cabin","Orchard","Arbor","ThinkingFountain","Mainframe","Megafabricator","MolecularEngine","fromHex","Aurum","SilverForest","Argent","TimeCrystal","Omnium","HoloProjector","SacredGrove","AtomicCompiler","ExtropyFountain","Infinity","Preserve","LogicPool","Cathedral","Microcity","LogicCrystal","allMachines","Orientation","Left","Up","Right","Down","compass","flip","orientation","Error","PureValue","availableCapacity","market","Wealth","allValues","sumMarkets","ea","eb","newMarket","_a","sa","da","_b","equilibrium","every","blockColors","lighten","cStep","Viridian","DarkGray","Gray","White","blockColor","block","desaturate","setPrototypeOf","__proto__","constructor","create","assign","Orientation_1","Graph_1","RoomRecipe_1","Machine_1","BackgroundPatterns_1","Painting_1","DevicePlace","structure","planet","x","y","width","height","infra","Transparent","edgeWidth","placed","hover","showLabel","facing","hideBox","childrenBuildings","devices","active","debugGraph","step","anchor","Vector","setup","traits","trait","Traits","OffscreenCulling","collisionType","CollisionType","Passive","nameLabel","Label","draw","ctx","delta","drawRect","aabb","processedColor","spaceFunction","getWidth","getTextWidth","slots","slot","rect","nodes","node","devicePlaces","place","position","visibleSize","update","engine","tryProduce","tinyDevices","tinyDevice","poly","aabbPoly","getHeight","emptyUnlessActive","isActive","machineEconomies","buildingEconomy","constrainCursor","clone","reshape","alignToSlot","afterConstruct","handleClick","_pos","deviceInteractionPlaces","graph","supergraph","Graph","rootNode","findOrCreate","_i","child","parentSlot","edge","childNode","redeem","res","gather","debit","spend","elite","pathFromRect","angledRoofPoly","angleStartY","angleStartX","overlaps","other","rect1","rect2","overlapsAny","colony","buildings","bldg","edgeColor","mainColor","colorBase","clr","connections","findSlot","validConnections","slotList","dir","validStructures","flipped","closestBuildingByType","matchingSlot","compass_1","theSlot","offset","sub","addEqual","buildSlot","parent","addDevice","subEqual","updateFunction","machine","hasPlaceForDevice","nextDevicePlace","getDevices","allTheMachines","machines","allSpaceFunctions","spaceFn","sf","text","background","BackgroundPattern","Grid","Actor","drawPatternedPoly","path","pattern","gridPattern","getBackgroundPattern","save","translate","beginPath","moveTo","pt","lineTo","closePath","fillStyle","strokeStyle","stroke","restore","drawLine","lineWidth","drawPatternedRect","rectangle","filled","dashed","main","fillRect","drawPoly","drawStar","cx","cy","outerRadius","innerRadius","spikes","rot","PI","cos","sin","drawCircle","radius","hemi","theta","arc","drawEllipse","radiusX","radiusY","ellipse","drawText","msg","tx","ty","fillText","Structure_1","EmitterFactory_1","LaserBeam_1","Device","initialPos","product","inUse","imageLoaded","reserved","emitter","parentDevice","firing","Image","onload","src","makeEmitter","isEmitting","computeEconomy","population","raiders","some","hostile","abs","globalAlpha","imageX","imageY","vel","scale","ix","drawImage","iv","bx","by","yOff","produced","blockSize","assemble","citizen","isCarryingUnique","drop","progressBar","sent","label","interact","request","worked","op","recipe_1","carrying","it","consumes","includes","consumed","workTime","getEffectiveWorkTime","carry","produces","warn","requires","has","storeOrExplore","dispense","store_1","stores","getEffectiveOperationalCapacity","res_1","stored","origX","groundSpeed","drive","xOff","actions","asPromise","gathers","stopDriving","bonus","bonuses","capacity","workSpeed","round","resource","generationTime","generates","snap","snapTiny","allStructures","snapped","halfSize","spot","getCenter","gridGrain","floorY","findAllDevices","hasTinyPlace","nextTinyPlace","tx0","ndx","addTinyDevice","u","numTimes","bullet","LaserBeam","this_1","setHeight","setWidth","scene","z","addTimer","Timer","kill","_c","assembleButton","theButton","textTransform","bg","fg","onmouseover","saturate","assembleToggle","colorize","Pane","dragging","dragStart","target","initialX","clientX","initialY","clientY","drag","preventDefault","currentX","currentY","dragEnd","makeRootElement","_element","show","parentElement","removeChild","flexWrap","body","appendChild","container","margin","addEventListener","left","canvas","offsetLeft","top_1","offsetTop","top","InteractionRequest_1","Strategy","pawn","sleepInterval","currentPlanet","findPoweredDevices","recipes","operations","explores","attempt","pause","gatherBlock","gathered","generatesDesiredBlock","gen","closestDeviceByType","storesDesiredBlock","visitDevice","waitTimes","retrieveResource","visit","workExploration","exploring","knowsHow","vehicle","explored","driven","workRecipe","debug","knowsRecipe","maker","made","gatherIngredients","performRecipeTask","blocks","blocks_1","ingredient","tries","timesToAttempt","CapacityBasedProduction_1","ProximityBasedConstruction_1","AnyBedSleepingStrategy_1","WhenHungryEatingStrategy_1","AttackNearestHostileStrategy_1","World_1","Citizen","home","aspects","large","alive","isPlanning","shouldAwaken","workInProgress","sleeping","hunger","energy","health","maxHealth","driving","debugPath","currentBuilding","lastChoice","combatting","paceUnit","combatMovementUnit","firingRangeBuffer","guarding","productionStrategy","CapacityBasedProduction","constructionStrategy","ProxmityBasedConstruction","sleepingStrategy","AnyBedSleepingStrategy","eatingStrategy","WhenHungryEatingStrategy","fightingStrategy","AttackNearestHostileStrategy","shirtColors","Colors","primary","secondary","isEvil","tertiary","shirtColor","alien","skinColors","skinColor","weight","bloodColor","bloodEmitter","speedMultiplier","timeFactor","evil","now","Date","getTime","progress","workStarted","workDuration","fatigue","work","iy","ratio","healthColor","drawBar","Cyan","rotate","drawSelf","carried","pw","px","py","c_1","ph","strokeRect","halfWidth","halfHeight","shirt","head","headRadius","duration","reject","resources","targetForDevice","pathTo","glideTo","pathBetweenPoints","followPath","walkSpeed","v","__awaiter","__generator","choice","strategies","strat","canApply","takeRest","eat","thirtyMinuteTimer","engageHostile","distanceToHostile","getWorldPos","enemy","self_1","tooCloseToEnemyLine","enemyPosition","idealCombatRange","tooFarFromEnemyLine","withinFiringRange","advanceTowardsEnemy","nextGoal","hostileDirectionSign","advanceTowards","goal","bullet_1","assembleBullet","guard","length_1","hostileDir","injure","amt","attacker","die","bleed","actionQueue","clearActions","smallMachines","mediumMachines","largeMachines","hugeMachines","smallDome","smallBelow","midDome","midBelow","largeDome","largeBelow","hugeDome","hugeBelow","medGroundVehicles","Structure","view","zoom","Corridor","Ladder","MainTunnel","MediumSurfaceRoom","SurfaceRoad","Dome","CommonArea","SmallRoomThree","SmallRoomTwo","SmallDome","MediumRoom","MediumRoomThree","LargeRoom","HugeRoom","SmallDomeThree","MidDome","LargeDome","Arcology","GroundVehiclePool","RoomRecipe","Beige","MissionControl","Window","LivingQuarters","Barracks","Kitchen","Checker","LifeSupportPod","Retreat","CloneMatrix","CloneReception","ReadingRoom","Library","Study","Wood","ComputerLab","Archive","Arboretum","AlgaeFarm","SolarArray","Workshop","Nursery","Leafy","Farm","Factory","ComputerCore","Tech","LifeSciencesLab","Refinery","Mine","HoloMatrix","TimeChamber","LivingRoom","Statuary","GameController","game","camera","pointerMoveCallback","leftClickCallback","cameraPanCallback","keyPressCallback","onMove","cb","onLeftClick","onCameraPan","onKeyPress","activate","input","pointers","on","dragOrigin","button","Input","PointerButton","keyboard","isHeld","Keys","Shift","Middle","getZoom","deltaY","moveCam","direction","camMoveSpeed","dv","move","W","A","S","D","deactivate","off","raisedSquare","leafy","bookish","posters","tech","checker","beige","ussf","wood","loadBg","loading","Poster","USSF","backgroundPatterns","matrix","DOMMatrix","createPattern","setTransform","process","Vermillion","Chartreuse","Magenta","Azure","World","nameCitizen","pickColor","colors","pickSkyColor","skyColors","ex","Colony_1","Population_1","Device_1","SkyLayers_1","Citizen_1","Planet","w","depth","hostiles","threatLevel","baseSkyColor","sky","yBase","crustHeight","createLayer","layerHeight","skyLayers","SkyLayers","buildColonyAndPopulation","wireHud","hud","teardown","tearDown","remove","Colony","Population","currentHour","currentTime","setTime","time","nextHour","hour","inc","oldC","skyColorForHour","newC","mixC","assignColors","skyColor","setHi","colorMap","night","dawn","morning","afternoon","evening","set","buildingOrDevice","showCard","theLayer","currentlyConstructing","theEconomy","popularDemand","citizens","resourceGathered","resourceExpended","placeBuilding","maxPop","increase","theEconomyWithoutPeople","values","val","structureTypes","closestDevice","machineTypes","pathBetween","origin","destination","acc","hasMachineKind","kind","sendRaidingParty","maxPartySize","partySize","sendRaider","options","getTop","raider","Hud_1","TechTree_1","Construction","introMessage","restricted","lost","techTree","TechTree","followedCitizen","hasActiveModal","defaultMessage","firstBuilding","placingFunction","showTutorial","buildIt","startConstructing","Hud","toggleFollowing","standup","ctrl","welcome","controlWith","closeSystemMessage","stopFollowing","discipline","findDisciplineToRankUp","rank","rankUp","updateDetails","askYesNo","goToScene","lastWorldPos","hoverables","h","center","hoverable","currentScene","controller","currentlyBuilding","constrained","buildingUnderConstruction_1","placementValid","setStatus","prepareNextBuilding","deviceUnderConstruction","H","Esc","restrictionsOff","infoMessage","startFollowing","cameraStrategy","LockCameraToActorStrategy","addStrategy","resetZoom","removeStrategy","structureOrMachine","theNextOne","spawnBuilding","spawnDevice","spawnFunction","anotherBuilding","assembleBuildingFromStructure","theStructure","nextMissingStructureOrFunction","reqs","requiredStructuresAndFunctions","req","actualStructureNames","actualFunctionNames","actualNames","nextMissing","congrats","nextUp","tutorialMessage","showPalettes","message","onComplete","systemMessage","continue","onYes","onNo","yes","no","i got this","okay","modal","addHeading","addIconMatrix","unlocks","UIActor","PlanetBackground_1","MountainLayers","layers","peakCount","onInitialize","layerCount","layerIndex","unshift","baseY","deltas","genPeaks","wc","sc","ls_1","layer","drawLayer","ox","oy","peakWidth","dMax","last","maxDiff","curr","pick","PlanetBackground","beginC","endC","ParticleEmitter","emitterType","EmitterType","Circle","minVel","maxVel","minAngle","maxAngle","emitRate","opacity","fadeFlag","particleLife","maxSize","minSize","beginColor","endColor","source","targetDirectionSign","handleCollision","collision","hitPerson","damage","CombatStrategy","describe","empty","edges","edgesInverse","isEmpty","newNode","contains","testNode","measure","tolerance","dfs","dst","union","otherGraph","edgeList","theEdges","otherIndex","otherNode","adjacent","adjacentIndices","testNodeIndex","es","esInv","root","visited","rIndex","dfsIndex","rootIndex","childIndex","bfs","bfsIndex","halt","visited_1","visitedNode","adj_1","adjacentNode","shortestPath","maxStep","prevStep","dstIndex","prev","steps","srcIndex","reverse","sword","assembler","futureTense","Sword","Texture","Assembler","Sound","FutureTense","Planet_1","GameController_1","Construction_1","Sandbox","construction","onActivate","onDeactivate","Scene","Pane_1","Elemental_1","SceneList","travelling","btns","btn","onclick","Menu","canvasHeight","devicePixelRatio","canvasWidth","sceneList","blueEmitter","makeBigBangEmitter","redEmitter","SpawnPalette","buttons","Arena","friendlySpawnX","hostileSpawnY","spawnDrift","spawnFriendlyCommander","cmdrName","friendly","spawnFriendly","pawnName","spawnPoint","spawnHostile","spawnBigHostile","spawnHostileCommander","spawnPalette","spawnLaser","regenerate","spawnInitialPair","Discipline","Survival","Agriculture","LibraryScience","Cooking","MineralProduction","disciplineTree","level","TechnologyRank_1","currentLevels","keys","disciplineName","canRankUp","currentRank","nextLevel","allUnlockedMachines","unlocked","unlockedMachinesFor","tree","CombatStrategy_1","CitizenLine","onSelect","followed","buildLine","_line","isFollowed","hungry","tired","makeButton","sleepy","sleepingInBed","task","justifyContent","paddingLeft","join","alignSelf","busyRow","flexDirection","CitizenList","onCitizenSelect","following","citizenLines","Map","updateRoster","missingCitizens","doesRosterInclude","lostCitizens","makeRoster","updateRosterDetails","isHungry","isTired","_wrapper","overflow","makeCitizenLine","line","Modal","makeDialog","clientHeight","addButtons","buttonMap","entries","intent","buttonFactory","_footer","textAlign","_header","_body","paddingBottom","heading","headerMessage","iconSet","img","lbl","icon","modalButton","Palette","all","onButtonClick","onButtonEnter","comprehend","comprehended","omniscient","makePalette","updateBuilt","nowComprehended","prereq","CardBody","entity","describeResources","freqs","notes","fontStyle","FontStyle","Italic","footer","describeEconomy","resourceDescription","domeStatus","bonusMessages","econ","toFixed","CardTitle","announce","CardTitle_1","CardBody_1","Card","x0","cardBody","y0","present","MusicPlayer","playlist","paused","makePlayer","startMusic","_titleElem","currentTrack","play","advancePlaylist","stop","handleAction","maxHeight","inlineBlock","iconFactory","action","song","trackNames","append","iconContent","innerHTML","EconomicValue","valueLabel","setCount","count","Number","POSITIVE_INFINITY","EconomicValue_1","EconomyView","valueLabels","val1","val2","addValue","updateView","updatedEconomy","allValues_1","Tooltip","messageLabel","ResourceListEntry","resourceBlock","hovering","tooltip","visible","credit","ResourceListEntry_1","ResourcesList","res1","res2","rx","ry","addEntry","entry","increment","decrement","ResourcesList_1","EconomyView_1","MusicPlayer_1","StatusAnalysisView","brand","version","clock","popLabel","musicPlayer","Future Tense","incrementResource","decrementResource","setMessage","showEconomy","showPopCap","cap","setClock","days","toString","hh","hours","minutes","ampm","padStart","StatusAnalysisView_1","Card_1","Palette_1","Modal_1","CitizenList_1","ActionList","onBuildingSelect","onMachineSelect","onFunctionSelect","hidePalettes","showCitizenList","status","displayInfo","machinePalette","structurePalette","structuresForPalette","functionPalette","functionsForPalette","citizenList","card","actionList","rebuildPalettes","updatePalettes","updateEconomy","updateMaxPop","updateBuildingPalette","updateMachinePalette","updateFunctionPalette","builtStructures","builtMachines","machinesForPalette","builtReifiedFunctions","builtFunctions","rf","Mountains","peaks","peakHeight","peakDistance","heightRange","drift","baseColor","brightColor","peak","mtnWidth","Mountains_1","MountainLayers_1","SkyLayer","lo","hi","mid","buffer","ht","backMountainLayers","mountains","mountainLayers","setLoHi","SkyLayer_1","c0","c1","vigilanceRange","isDriving","enemyCombatant","cmdCenter","attack","defensePoint","EatingStrategy","EatingStrategy_1","storedResources","desk","SleepingStrategy","SleepingStrategy_1","Strategy_1","ConstructionStrategy","unbuiltDevice","constructDevice","throw","done","trys","ops","return","Symbol","iterator","TypeError","pop","ProductionStrategy","storeBlock","tryStoreBlock","openStore","findRecipe","explorer","findExplorer","findStore","storage_1","storage_2","explorers","notKilled","NavigationTree","seekPath","dest","closestNode","closestNodeAtSameYCoordinate","tol","NavigationTree_1","debugMap","debugTree","navTree","gradient","createLinearGradient","addColorStop","buildNavTree","st","srcNode","destNode","constrainSourceY","activeBuildings","_1","deviceSize","theSlots","slotY","devicePlaceSize","devicePlaceCount","floorHeight","sg","right","isGroundFloor","leftSlot","rightSlot","topSlot","backgroundPattern","floorColor","floorEdgeHeight","flagX","flagY","flagpoleHeight","originSlot","slotSize","pickingOrigin","drawShape","xoff","yoff","bezierCurveTo","slotHeights","heights","y1","btm","lst","slotCount","originX","newCursor","output","Play","timeStepIntervalMillis","stepTime","Play_1","Arena_1","Menu_1","Sandbox_1","theWorld","menu","arena","sandbox"],"mappings":"aACA,SAAAA,EAAAC,GAOA,IANA,IAKAC,EAAAC,EALAC,EAAAH,EAAA,GACAI,EAAAJ,EAAA,GACAK,EAAAL,EAAA,GAGAM,EAAA,EAAAC,KACQD,EAAAH,EAAAK,OAAoBF,IAC5BJ,EAAAC,EAAAG,GACAG,EAAAP,IACAK,EAAAG,KAAAD,EAAAP,GAAA,IAEAO,EAAAP,GAAA,EAEA,IAAAD,KAAAG,EACAO,OAAAC,UAAAC,eAAAC,KAAAV,EAAAH,KACAc,EAAAd,GAAAG,EAAAH,IAIA,IADAe,KAAAhB,GACAO,EAAAC,QACAD,EAAAU,OAAAV,GAOA,OAHAW,EAAAR,KAAAS,MAAAD,EAAAb,OAGAe,IAEA,SAAAA,IAEA,IADA,IAAAC,EACAf,EAAA,EAAiBA,EAAAY,EAAAV,OAA4BF,IAAA,CAG7C,IAFA,IAAAgB,EAAAJ,EAAAZ,GACAiB,KACAC,EAAA,EAAkBA,EAAAF,EAAAd,OAA2BgB,IAAA,CAC7C,IAAAC,EAAAH,EAAAE,GACA,IAAAf,EAAAgB,KAAAF,MAEAA,IACAL,EAAAQ,OAAApB,IAAA,GACAe,EAAAM,IAAAC,EAAAN,EAAA,KAGA,OAAAD,EAIA,IAAAQ,KAKApB,GACAqB,EAAA,GAGAZ,KAGA,SAAAS,EAAA1B,GAGA,GAAA4B,EAAA5B,GACA,OAAA4B,EAAA5B,GAAA8B,QAGA,IAAAC,EAAAH,EAAA5B,IACAK,EAAAL,EACAgC,KACAF,YAUA,OANAhB,EAAAd,GAAAa,KAAAkB,EAAAD,QAAAC,IAAAD,QAAAJ,GAGAK,EAAAC,KAGAD,EAAAD,QAKAJ,EAAAO,EAAAnB,EAGAY,EAAAQ,EAAAN,EAGAF,EAAAS,EAAA,SAAAL,EAAAM,EAAAC,GACAX,EAAAY,EAAAR,EAAAM,IACA1B,OAAA6B,eAAAT,EAAAM,GACAI,gBACAC,cACAC,IAAAL,KAMAX,EAAAiB,EAAA,SAAAb,GACApB,OAAA6B,eAAAT,EAAA,cAAiDc,YAIjDlB,EAAAmB,EAAA,SAAAd,GACA,IAAAM,EAAAN,KAAAe,WACA,WAA2B,OAAAf,EAAAgB,SAC3B,WAAiC,OAAAhB,GAEjC,OADAL,EAAAS,EAAAE,EAAA,IAAAA,GACAA,GAIAX,EAAAY,EAAA,SAAAU,EAAAC,GAAsD,OAAAvC,OAAAC,UAAAC,eAAAC,KAAAmC,EAAAC,IAGtDvB,EAAAwB,EAAA,GAEA,IAAAC,EAAAC,OAAAC,aAAAD,OAAAC,iBACAC,EAAAH,EAAA1C,KAAA8C,KAAAJ,GACAA,EAAA1C,KAAAX,EACAqD,IAAAK,QACA,QAAAnD,EAAA,EAAgBA,EAAA8C,EAAA5C,OAAuBF,IAAAP,EAAAqD,EAAA9C,IACvC,IAAAU,EAAAuC,EAIArC,EAAAR,MAAA,QAEAU,qFCrIA,IAAAsC,EAAA/B,EAAA,GAIMgC,EAAa,SAACC,EAAKC,EAAOC,GAC9B,OAAOF,EAAIG,OAAO,SAASC,EAAMC,GAC/B,IAAIC,GAASL,EAAMI,GAAOA,GAC1B,OAAKD,GAEMF,EAAS3C,MAAM,MAAQ6C,EAAK,GAAIE,EAAK,MAASF,EAAK,GACpDA,EAFAE,GAMV,MAAM,IAsCV,SAASC,EAAUC,EAAG9D,EAAGwC,GAEvB,IADA,IAAIF,KACKpB,EAAI,EAAGA,EAAIsB,EAAGtB,IACrBoB,EAAElC,KAAK0D,EAAE9D,EAAIkB,IAEf,OAAOoB,EAxCIb,EAAAsC,MAAQ,SAACT,EAAKU,GAAO,OAAAX,EAAWC,EAAKU,EAAIC,KAAKC,MAC9CzC,EAAA0C,MAAQ,SAACb,EAAKU,GAAO,OAAAX,EAAWC,EAAKU,EAAIC,KAAKG,MAG9C3C,EAAA4C,OAAS,SAACf,GAAQ,OAAAA,EAAIW,KAAKK,MAAML,KAAKM,SAAWjB,EAAIpD,UAErDuB,EAAA+C,MAAQ,SAAChC,GAAM,OAAAiC,MAAMjC,GAAGkC,KAAK,GAAGC,IAAI,SAACC,EAAKC,GAAQ,OAAAA,KAE/DpD,EAAAqD,QAAA,SAA2BC,EAAgBzB,EAAe0B,EAAgCC,GACvF,GAAmB,IAAf3B,EAAIpD,OAAgB,OAAO,KAC/B,IAAIgF,EAAqB5B,EAEzB,OADI2B,IAAa3B,EAAMA,EAAI6B,OAAOF,IAC9BC,EAEMzD,EAAAsC,MAAMmB,EADU,SAACE,GAAY,OAAAL,EAAOM,SAASL,EAAUI,WADjE,GAMU3D,EAAA6D,WAAa,SAAAhC,GAAO,SAAGiC,OAAM1E,SAAIyC,IAEjC7B,EAAA+D,cAAgB,SAAClC,EAAK8B,GAAS,OAAA9B,EAAI6B,OAAO,SAAAM,GAAK,OAAAA,IAAML,KAErD3D,EAAAiE,kBAAoB,SAACpC,EAAK8B,GACrC,IAAIO,EAAQrC,EAAIsC,QAAQR,IACT,IAAXO,GAAcrC,EAAIlC,OAAOuE,EAAO,IAGtClE,EAAAoE,SAAA,SAAyB/B,EAAGtB,GAE1B,IADA,IAAIF,KACKtC,EAAI,EAAGA,EAAI8D,EAAE5D,OAASsC,EAAI,EAAGxC,IACpCsC,EAAElC,KAAKyD,EAASC,EAAG9D,EAAGwC,IAExB,OAAOF,GAWTb,EAAAqE,UAAA,SAA0BhC,EAAGtB,GAC3B,OAAOsB,EAAEL,OAAO,SAAU1C,EAAQwB,EAAOoD,EAAOI,GAG9C,OAFIJ,EAAQnD,GAAM,GAChBzB,EAAOX,KAAK2F,EAAM5C,MAAMwC,EAAOA,EAAQnD,IAClCzB,QAIEU,EAAAuE,gBAAkB,SAAClC,EAAWmC,GAAc,OAAAnC,EAAEuB,SAASY,IAGpExE,EAAAyE,MAAA,SAAsBC,GACpB,OAAO,IAAIC,QAAQ,SAAAC,GAAW,OAAAC,WAAWD,EAASF,MAGpD1E,EAAA8E,QAAA,SAAwBjD,GACtB,OAAOA,EAAIkD,KAAK,WAAM,OAAAvC,KAAKM,SAAW,GAAM,GAAK,KAGtC9C,EAAAgF,IAAM,SAAC3C,EAAGmC,GAAM,OAAAnC,EAAEa,IAAI,SAACc,EAAGzF,GAAM,OAACyF,EAAGQ,EAAEjG,OAEtCyB,EAAAiF,iBAAmB,SAACpD,GAC/B,IAAIqD,KAKJ,OAJArD,EAAIsD,QAAQ,SAACxB,GACXuB,EAAOvB,GAAQuB,EAAOvB,IAAS,EAC/BuB,EAAOvB,IAAS,IAEXuB,GAGTlF,EAAAoF,aAAA,SAAgCvD,EAAUwD,GACxC,IAAIC,KACAC,EAAU1D,EAAIH,QAClB,GAAIG,EAAIpD,OAAS,EAAG,CAClB,IAAI+G,KACJH,EAAUF,QAAQ,SAAAM,GACZF,EAAQG,KAAK,SAAA1B,GAAK,OAAAA,IAAMyB,IAC1BzF,EAAAiE,kBAAkBsB,EAASE,GAE3BD,OAGJF,GAAeE,EAEjB,OAAOF,GAITtF,EAAA2F,UAAA,SAA0BtD,EAAUmC,EAAUoB,kBAAA,IAC5C,IAAIC,EAAUD,EAAQE,EAAW,EAAEF,EACnC,OAAO,IAAIjE,EAAAoE,MACR1D,EAAExB,EAAIgF,EAAYrB,EAAE3D,EAAIiF,EACxBzD,EAAE2D,EAAIH,EAAYrB,EAAEwB,EAAIF,EACxBzD,EAAEmC,EAAIqB,EAAYrB,EAAEA,EAAIsB,EACzB,MAIJ9F,EAAAiG,WAAA,SAA2BnF,EAAOoD,EAAOgC,GACrC,OAAOA,EAAK/B,QAAQrD,KAAWoD,kaCvHnC,IAAAvC,EAAA/B,EAAA,GAEAuG,EAAAvG,EAAA,IAIAwG,EAAA,SAAAC,GAoBE,SAAAD,EAAmBE,GAAnB,IAAAC,EACEF,EAAAtH,KAAAyH,MAGEC,YAAa9E,EAAA+E,YAAYC,WACzBC,gBAAiBjF,EAAAoE,MAAMc,SACvBL,YANeD,EAAAD,QAkDnBC,EAAAO,aAAqB/F,EAIvB,OA1E0BgG,EAAAX,EAAAC,GA8BjBD,EAAAvH,UAAAmI,MAAP,WACE,IAAIC,EAAS,IAAItF,EAAAuF,OACjB,IAAK,IAAIC,KAAOhB,EAAAiB,UACdH,EAAOI,YAAYlB,EAAAiB,UAAUD,IAgC/B,OA9BAF,EAAOL,gBAAkB,UAEzBK,EAAOK,KAAO,qzFAGdL,EAAOM,UAAY,IACnBN,EAAOO,WAAa,IAGpBP,EAAOQ,mBAAqB,WAC1B,IAAIC,EAAWC,SAASC,cAAc,UAiBtC,OAhBAF,EAASG,YAAc,kBACvBH,EAASI,MAAMC,OAAS,OACxBL,EAASI,MAAME,QAAU,QACzBN,EAASI,MAAMG,QAAU,OACzBP,EAASI,MAAMI,WAAa9B,EAAK+B,KACjCT,EAASI,MAAMM,MAAQ,QACvBV,EAASI,MAAMO,SAAW,OAC1BX,EAASI,MAAMQ,WAAa,MAE5BZ,EAASI,MAAMlB,gBAAkB,UAGjCc,EAASa,aAAe,WACtBb,EAASI,MAAMlB,gBAAkBjF,EAAAoE,MAAMyC,IAAIC,OAAO,IAAKC,UAEzDhB,EAASiB,aAAe,WAAQjB,EAASI,MAAMlB,gBAAkB,WAC1Dc,GAGFrB,EAAAxH,UAAMmI,MAAKjI,KAAAyH,KAACS,GAAQ2B,KAAK,WAC9BC,QAAQC,IAAI,sBAKT1C,EAAAvH,UAAAkK,gBAAP,WACEvC,KAAKM,WAAaN,KAAKM,WAvElBV,EAAA+B,KAAO,YACP/B,EAAA4C,MAAgB,QAEhB5C,EAAA6C,UAAoB,GAEpB7C,EAAA8C,WAAqB,GACrB9C,EAAA+C,aAAuB,EAAI/C,EAAK8C,WAGhC9C,EAAAgD,YAAsB,EAAIhD,EAAK+C,aAC/B/C,EAAAiD,sBAAgC,KAKhCjD,EAAAkD,iBAA2B,IA0DpClD,EA1EA,CAA0BzE,EAAA4H,QAAbvJ,EAAAoG,sFCNb,IAIYoD,EAJZC,EAAA7J,EAAA,GACA8J,EAAA9J,EAAA,GACM+J,EAAAF,EAAAG,MAAAD,MAAOE,EAAAJ,EAAAG,MAAAC,OAEb,SAAYL,GACRA,IAAAM,KAAA,UACAN,IAAAO,MAAA,WACAP,IAAAQ,OAAA,YACAR,IAAAS,MAAA,WACAT,IAAAU,KAAA,UALJ,CAAYV,EAAAxJ,EAAAwJ,aAAAxJ,EAAAwJ,gBASZxJ,EAAAmK,qBAAA,SAAqCC,GACtBV,EAAAtD,KAAK8C,WAAhB,IACImB,EAAK,GACT,OAAQD,GACJ,KAAKZ,EAAWM,KAAQO,EAAKR,EAAMS,OAAQ,MAC3C,KAAKd,EAAWO,MAAQM,EAAKR,EAAMU,MAAO,MAC1C,KAAKf,EAAWQ,OAAQK,EAAKV,EAAMa,MAAQ,MAC3C,KAAKhB,EAAWS,MAAQI,EAAKV,EAAMW,OAAQ,MAC3C,KAAKd,EAAWU,KAAQG,EAAKV,EAAMc,OAEvC,OAAOJ,kFCvBX,IAAAK,EAAA9K,EAAA,GA+CII,EAAA2K,SA/CKD,EAAAC,SAET,IAAAC,EAAAhL,EAAA,IA+CII,EAAA6K,aA/CKD,EAAAC,aACT,IAAAC,EAAAlL,EAAA,IA0DII,EAAA+K,eA1DKD,EAAAC,eACT,IAAAC,EAAApL,EAAA,IAkDII,EAAAiL,SAlDKD,EAAAC,SACT,IAAAC,EAAAtL,EAAA,IA8CII,EAAAmL,WA9CKD,EAAAC,WACT,IAAAC,EAAAxL,EAAA,IA8DII,EAAAqL,aA9DKD,EAAAC,aACT,IAAAC,EAAA1L,EAAA,IA2CII,EAAAuL,WA3CKD,EAAAC,WACT,IAAAC,EAAA5L,EAAA,IA4CII,EAAAyL,gBA5CKD,EAAAC,gBACT,IAAAC,EAAA9L,EAAA,IA8CII,EAAA2L,mBA9CKD,EAAAC,mBACT,IAAAC,EAAAhM,EAAA,IA8CII,EAAA6L,YA9CKD,EAAAC,YACT,IAAAC,EAAAlM,EAAA,IA8CII,EAAA+L,YA9CKD,EAAAC,YACT,IAAAC,EAAApM,EAAA,IA+CII,EAAAiM,mBA/CKD,EAAAC,mBACT,IAAAC,EAAAtM,EAAA,IAiDII,EAAAmM,eAjDKD,EAAAC,eACT,IAAAC,EAAAxM,EAAA,IAmDII,EAAAqM,cAnDKD,EAAAC,cACT,IAAAC,EAAA1M,EAAA,IAmDII,EAAAuM,aAnDKD,EAAAC,aACT,IAAAC,EAAA5M,EAAA,IA+CII,EAAAyM,oBA/CKD,EAAAC,oBACT,IAAAC,EAAA9M,EAAA,IAqDII,EAAA2M,sBArDKD,EAAAC,sBACT,IAAAC,EAAAhN,EAAA,IAGMiN,GACFhC,aAAYD,EAAAC,aACZU,WAAUD,EAAAC,WACVJ,WAAUD,EAAAC,WACVM,gBAAeD,EAAAC,gBAEfR,SAAQD,EAAAC,SACRU,mBAAkBD,EAAAC,mBAClBE,YAAWD,EAAAC,YACXE,YAAWD,EAAAC,YAEXE,mBAAkBD,EAAAC,mBAElBlB,eAAcD,EAAAC,eACdoB,eAAcD,EAAAC,eACdM,oBAAmBD,EAAAC,oBACnBJ,cAAaD,EAAAC,cACbE,aAAYD,EAAAC,aAEZlB,aAAYD,EAAAC,aACZsB,sBAAqBD,EAAAC,sBAErBG,sBAAqBF,EAAAE,uBA8BrB9M,EAAA6M,gGCzEJ,IAAAnD,EAAA9J,EAAA,GAEMmN,EAA8B,EAAlBrD,EAAAtD,KAAK8C,WACjB8D,EAAYxK,KAAKK,MAAM6G,EAAAtD,KAAK8C,WAAa,GAgB/C,SAAS+D,EAAOC,GACZ,OACI1C,MAAO0C,EACP5C,OAAe,EAAP4C,EACRC,MAAc,EAAPD,EACPE,OAAe,EAAPF,EACRG,MAAc,EAAPH,EACP3C,MAAc,EAAP2C,EACPI,QAAgB,EAAPJ,EACTzC,OAAe,EAAPyC,GAIhB,IAAMK,EAAaN,EAAOF,GACpBS,EAAaP,EAAOD,GAGbhN,EAAA4J,OACTD,MAAO4D,EACP1D,MAAO2D,soBCtCX,IAAAC,EAAA7N,EAAA,GACA+B,EAAA/B,EAAA,GACA8N,EAAA9N,EAAA,GACA+N,EAAA/N,EAAA,KACAgO,EAAAhO,EAAA,GA4CMiO,GACFC,UAzCiBlO,EAAQ,KA0CzBmO,IAzCWnO,EAAQ,KA0CnBoO,MAzCgBpO,EAAQ,KA0CxBqO,MAzCUrO,EAAQ,KA0ClBsO,MAzCUtO,EAAQ,KA0ClBuO,KAzCSvO,EAAQ,KA0CjBwO,IAzCQxO,EAAQ,KA0ChByO,OAzCWzO,EAAQ,KA0CnB0O,OAzCW1O,EAAQ,KA0CnB2O,MAzCU3O,EAAQ,KA0ClB4O,YAzCgB5O,EAAQ,KA2CxBiJ,QAzCYjJ,EAAQ,KA0CpB6O,cAzCkB7O,EAAQ,KA0C1B8O,aAzCiB9O,EAAQ,KA0CzB+O,WAzCe/O,EAAQ,KA0CvBgP,YAzCgBhP,EAAQ,KA2CxBiP,WAzCejP,EAAQ,KA2CvBkP,MAzCUlP,EAAQ,KA0ClBmP,MAzCUnP,EAAQ,KA0ClBoP,MAzCUpP,EAAQ,KA0ClBqP,OAxCWrP,EAAQ,KA0CnBsP,MAzCUtP,EAAQ,KA0ClBuP,SAxCavP,EAAQ,IAyCrBwP,OAxCWxP,EAAQ,IAyCnByP,UAxCczP,EAAQ,IAyCtB0P,MAxCU1P,EAAQ,IAyClB2P,WAvCe3P,EAAQ,IAyCvB4P,GAxCO5P,EAAQ,IAyCf6P,IAxCQ7P,EAAQ,IA0ChB8P,aAxCiB9P,EAAQ,IAyCzB+P,MAvCU/P,EAAQ,KA4Cd4I,EAAA7G,EAAAoE,MAAAyC,IAAKoH,EAAAjO,EAAAoE,MAAA6J,MAAOC,EAAAlO,EAAAoE,MAAA8J,KAAMC,EAAAnO,EAAAoE,MAAA+J,OAAQC,EAAApO,EAAAoE,MAAAgK,OAAQC,EAAArO,EAAAoE,MAAAiK,OAEpCC,EAAAtC,EAAAuC,qBAAAD,MAAOE,EAAAxC,EAAAuC,qBAAAC,SAAUC,EAAAzC,EAAAuC,qBAAAE,OAAQC,EAAA1C,EAAAuC,qBAAAG,MAAOC,EAAA3C,EAAAuC,qBAAAI,eAAgBC,EAAA5C,EAAAuC,qBAAAK,QAEtDC,EAAA,oBAAAA,IACIhK,KAAAlG,KAAe,iBACfkG,KAAAiK,YAAsB,wBACtBjK,KAAA4B,MAAezG,EAAAoE,MAAM2K,UAErBlK,KAAAmK,MAAyBlD,EAAAmD,cAAcC,SAEvCrK,KAAA4D,KAAmBsD,EAAAlE,WAAWO,MAC9BvD,KAAAsK,WAAmCC,KAAM,QACzCvK,KAAAwK,MAAQnD,EAAOE,IACfvH,KAAAyK,WACAzK,KAAA0K,QAAmBzD,EAAA0D,cACnB3K,KAAA4K,WACA5K,KAAA6K,QAIA7K,KAAA8K,aAEA9K,KAAA+K,aACA/K,KAAAgL,mBAEAhL,KAAAiL,eAEAjL,KAAAkL,YAOJ,OALIlB,EAAA3R,UAAA8S,WAAA,WAAwB,OAAOnL,MAE/BgK,EAAA3R,UAAA+S,YAAA,SAAYC,KAGhBrB,EA/BA,GAAaxQ,EAAAwQ,UAiCb,IAAAsB,EAAA,SAAAzL,GAAA,SAAAyL,IAAA,IAAAvL,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,kBACPiG,EAAAkK,YAAc,+BACdlK,EAAAuK,UAAYb,GACPxC,EAAAmD,cAAcC,QAASpD,EAAAmD,cAAcoB,KACtC,IAEJzL,EAAAyK,MAAQnD,EAAOe,YACfrI,EAAA6D,KAAOsD,EAAAlE,WAAWQ,OAClBzD,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHe,OAASC,OAAQ,GAAIC,OAAQ,GAC7BC,QAAUF,OAAQ,GAAIC,OAAQ,GAC9BE,OAASH,OAAQ,GAAIC,OAAQ,GAC7BG,MAAQJ,OAAQ,GAAIC,OAAQ,GAC5BI,SAAWL,OAAQ,GAAIC,OAAQ,KAAAK,EAiBvC,OAhCmC1L,EAAA+K,EAAAzL,GAkB/ByL,EAAAjT,UAAA+S,YAAA,SAAYC,GAER,IAAK,IAAItT,KADTsT,EAAOa,SACO9E,EAAA7K,MAAM,IAChB8O,EAAOc,gBAAgBlF,EAAAmD,cAAcC,SAEnC,IAAA+B,EAAAf,EAAAe,SAIN,IAAK,IAAIC,KAFTD,EAASE,SAASjB,EAAOkB,IAAIC,IAAIJ,EAASG,SAExBnF,EAAA7K,MADD,GAEb6P,EAASE,SAASjB,EAAOkB,IAAIC,IAAIJ,EAASG,UAItDjB,EAhCA,CAAmCtB,GAAtBxQ,EAAA8R,gBAkCb,IAAAmB,EAAA,SAAA5M,GAAA,SAAA4M,IAAA,IAAA1M,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,cACPiG,EAAAkK,YAAc,cACdlK,EAAAuK,UAAYb,GACPxC,EAAAmD,cAAcsC,MACf,GAEJ3M,EAAAyK,MAAQnD,EAAOY,cACflI,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHe,OAASC,OAAQ,EAAGC,OAAQ,IAC5BG,MAAQJ,OAAQ,EAAGC,OAAQ,KAAAK,EAEnC,OAbgC1L,EAAAkM,EAAA5M,GAahC4M,EAbA,CAAgCzC,GAAnBxQ,EAAAiT,aAqBb,IAAAE,EAAA,SAAA9M,GAAA,SAAA8M,IAAA,IAAA5M,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,YACPiG,EAAAkK,YAAc,cACdlK,EAAA6D,KAAOsD,EAAAlE,WAAWM,KAClBvD,EAAA0K,SAAYmC,GACZ7M,EAAAyK,MAASnD,EAAOsB,SAChB5I,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHkC,KAAOlB,OAAQ,EAAGC,OAAQ,GAC1BF,OAASC,OAAQ,EAAGC,OAAQ,MAAAK,EAEpC,OAX8B1L,EAAAoM,EAAA9M,GAW9B8M,EAXA,CAA8B3C,GAAjBxQ,EAAAmT,WAab,IAAAG,EAAA,SAAAjN,GAAA,SAAAiN,IAAA,IAAA/M,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,WACPiG,EAAAkK,YAAc,uBACdlK,EAAA6D,KAAOsD,EAAAlE,WAAWM,KAClBvD,EAAA0K,SAAYmC,GACZ7M,EAAAyK,MAAQnD,EAAOoB,OACf1I,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHoC,QAAUpB,OAAQ,GAAKC,OAAQ,KAAAK,EAEvC,OAV8B1L,EAAAuM,EAAAjN,GAU9BiN,EAVA,CAA8B9C,GAAjBxQ,EAAAsT,WAYb,IAAAE,EAAA,SAAAnN,GAAA,SAAAmN,IAAA,IAAAjN,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,SACPiG,EAAAkK,YAAc,eACdlK,EAAA6D,KAAOsD,EAAAlE,WAAWM,KAClBvD,EAAA0K,SAAYmC,GACZ7M,EAAAyK,MAAQnD,EAAOuB,OACf7I,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHsC,QAAUtB,OAAQ,GAAKC,OAAQ,KAAAK,EAEvC,OAV4B1L,EAAAyM,EAAAnN,GAU5BmN,EAVA,CAA4BhD,GAAfxQ,EAAAwT,SAYb,IAAAE,EAAA,SAAArN,GAAA,SAAAqN,IAAA,IAAAnN,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,QACPiG,EAAAkK,YAAc,+BACdlK,EAAAuK,UAAYX,EAAS1C,EAAAmD,cAAc+C,KAAM,GACzCpN,EAAA6D,KAAOsD,EAAAlE,WAAWM,KAClBvD,EAAA0K,SAAYmC,GACZ7M,EAAAyK,MAAQnD,EAAOyB,MACf/I,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHyC,QAAUzB,OAAQ,GAAKC,OAAQ,KAAAK,EAEvC,OAX2B1L,EAAA2M,EAAArN,GAW3BqN,EAXA,CAA2BlD,GAAdxQ,EAAA0T,QAgBb,IAAAG,EAAA,SAAAxN,GAAA,SAAAwN,IAAA,IAAAtN,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,eACPiG,EAAAkK,YAAc,eACdlK,EAAAyK,MAAQnD,EAAO2B,GACfjJ,EAAA0K,SAAY6C,EAAwBC,GACpCxN,EAAA6K,WACA7K,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHkB,QAAUF,OAAQ,EAAGC,OAAQ,GAC7BF,OAASC,OAAQ,EAAGC,OAAQ,KAAAK,EAEpC,OAXqC1L,EAAA8M,EAAAxN,GAWrCwN,EAXA,CAAqCrD,GAAxBxQ,EAAA6T,kBAab,IAAAE,EAAA,SAAA1N,GAAA,SAAA0N,IAAA,IAAAxN,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,aACPiG,EAAAkK,YAAc,kBACdlK,EAAAyK,MAAQnD,EAAOkB,MACfxI,EAAA0K,SAAY+C,GAEZzN,EAAA6K,WACA7K,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHe,OAASC,OAAQ,GAAIC,OAAQ,KAAAK,EAErC,OAX+B1L,EAAAgN,EAAA1N,GAW/B0N,EAXA,CAA+BvD,GAAlBxQ,EAAA+T,YAcb,IAAAD,EAAA,SAAAzN,GAAA,SAAAyN,IAAA,IAAAvN,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,gBACPiG,EAAAkK,YAAc,eAEdlK,EAAA0K,SAAY8C,EAAWF,GACvBtN,EAAAyK,MAAQnD,EAAO4B,IAEflJ,EAAA6K,WACA7K,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHmB,OAASH,OAAQ,EAAGC,OAAQ,GAC5BF,OAASC,OAAQ,EAAGC,OAAQ,KAAAK,EAEpC,OAb4C1L,EAAA+M,EAAAzN,GAa5CyN,EAbA,CAA4CtD,GAA/BxQ,EAAA8T,yBAeb,IAAAG,EAAA,SAAA5N,GAAA,SAAA4N,IAAA,IAAA1N,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,YACPiG,EAAAkK,YAAc,oBACdlK,EAAA0K,SAAYuC,GACZjN,EAAA6K,WACA7K,EAAAyK,MAAQnD,EAAOwB,UACf9I,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHyC,QAAUzB,OAAQ,EAAGC,OAAQ,KAAAK,EAErC,OAV+B1L,EAAAkN,EAAA5N,GAU/B4N,EAVA,CAA+BzD,GAAlBxQ,EAAAiU,YAeb,IAAAb,EAAA,SAAA/M,GAAA,SAAA+M,IAAA,IAAA7M,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,QACPiG,EAAAkK,YAAc,iBACdlK,EAAAyK,MAAQnD,EAAOG,MACfzH,EAAAiL,mBAEAjL,EAAAgL,aAAYkB,EAChB,OAP2B1L,EAAAqM,EAAA/M,GAO3B+M,EAPA,CAA2B5C,GAAdxQ,EAAAoT,QASb,IAAAc,EAAA,SAAA7N,GAAA,SAAA6N,IAAA,IAAA3N,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,SACPiG,EAAAkK,YAAc,YACdlK,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHoB,MAAQJ,OAAQ,GAAKC,OAAQ,GAC7BmB,QAAUpB,OAAQ,EAAGC,OAAQ,KAEjC7L,EAAAyK,MAAQnD,EAAOoB,OACf1I,EAAA0K,SAAYqC,KAChB,OAV4BvM,EAAAmN,EAAA7N,GAU5B6N,EAVA,CAA4B1D,GAAfxQ,EAAAkU,SAYb,IAAAC,EAAA,SAAA9N,GAAA,SAAA8N,IAAA,IAAA5N,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAuK,UAAYV,GACN3C,EAAAmD,cAAc+C,KAAMlG,EAAAmD,cAAc+C,KAAMlG,EAAAmD,cAAc+C,MACxDlG,EAAAmD,cAAcsC,MAElB3M,EAAA6B,MAAQyH,IAEZ,OAPkC9I,EAAAoN,EAAA9N,GAM9B8N,EAAAtV,UAAA8S,WAAA,WAAwB,OAAO,IAAIyC,GACvCD,EAPA,CAAkC3D,GAArBxQ,EAAAmU,eAiBb,IAAAE,EAAA,SAAAhO,GAAA,SAAAgO,IAAA,IAAA9N,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,QACPiG,EAAAkK,YAAc,kBACdlK,EAAAyK,MAAQnD,EAAOqB,MACf3I,EAAA0K,SAAYqD,GACZ/N,EAAAuK,UAAYb,GAAOxC,EAAAmD,cAAcsC,MAAO,GACxC3M,EAAA6B,MAAQyH,IAEZ,OAR2B9I,EAAAsN,EAAAhO,GAQ3BgO,EARA,CAA2B7D,GAAdxQ,EAAAqU,QAUb,IAAAD,EAAA,SAAA/N,GAAA,SAAA+N,IAAA,IAAA7N,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,cACPiG,EAAAkK,YAAc,eACdlK,EAAA0K,SAAYqD,GACZ/N,EAAAyK,MAAQnD,EAAOW,YACfjI,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHe,OAASC,OAAQ,EAAGC,OAAQ,KAAAK,EAGpC,OAViC1L,EAAAqN,EAAA/N,GAS7B+N,EAAAvV,UAAA8S,WAAA,WAAe,OAAOnL,MAC1B4N,EAVA,CAAiCD,GAApBnU,EAAAoU,cAYb,IAAAG,EAAA,SAAAlO,GAAA,SAAAkO,IAAA,IAAAhO,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,QACPiG,EAAAkK,YAAc,eACdlK,EAAA0K,WACA1K,EAAAyK,MAAQnD,EAAOiB,MACfvI,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHkC,KAAOlB,OAAQ,GAAKC,OAAQ,KAAAK,EAEpC,OAT2B1L,EAAAwN,EAAAlO,GAS3BkO,EATA,CAA2B/D,GAAdxQ,EAAAuU,QAab,IAAAD,EAAA,SAAAjO,GAAA,SAAAiO,IAAA,IAAA/N,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,QACPiG,EAAAkK,YAAc,aACdlK,EAAAuK,UAAYX,EAAS1C,EAAAmD,cAAc+C,MACnCpN,EAAAyK,MAAQnD,EAAOC,UACfvH,EAAA0K,SAAYyC,EAAOW,GACnB9N,EAAA6B,MAAQyH,IACZ,OAP+B9I,EAAAuN,EAAAjO,GAO/BiO,EAPA,CAA+B9D,GAAlBxQ,EAAAsU,YAUb,IAAAE,EAAA,SAAAnO,GAAA,SAAAmO,IAAA,IAAAjO,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,SACPiG,EAAAkK,YAAc,cACdlK,EAAAuK,UAAYb,GAAOxC,EAAAmD,cAAc6D,MAAO,GACxClO,EAAAyK,MAAQnD,EAAOQ,OACf9H,EAAA0K,SAAWqD,GACX/N,EAAA6B,MAAQ4H,EACRzJ,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHe,OAASC,OAAQ,EAAGC,OAAQ,KAAAK,EAEpC,OAX4B1L,EAAAyN,EAAAnO,GAW5BmO,EAXA,CAA4BhE,GAAfxQ,EAAAwU,SAab,IAAAE,EAAA,SAAArO,GAAA,SAAAqO,IAAA,IAAAnO,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,QACPiG,EAAAkK,YAAc,cACdlK,EAAAuK,UAAYV,GACP3C,EAAAmD,cAAc+D,QAASlH,EAAAmD,cAAc+D,SACtClH,EAAAmD,cAAc6D,MAElBlO,EAAAyK,MAAQnD,EAAOI,MAEf1H,EAAA0K,SAAWqD,EAAWE,GACtBjO,EAAA6B,MAAQ4H,EACRzJ,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHe,OAASC,OAAQ,EAAGC,OAAQ,KAAAK,EAEpC,OAf2B1L,EAAA2N,EAAArO,GAe3BqO,EAfA,CAA2BlE,GAAdxQ,EAAA0U,QAiBb,IAAAV,EAAA,SAAA3N,GAAA,SAAA2N,IAAA,IAAAzN,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,MACPiG,EAAAkK,YAAc,eACdlK,EAAAyK,MAAQnD,EAAOO,IACf7H,EAAA0K,SAAY4C,GACZtN,EAAA6B,MAAQ0H,EACRvJ,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHqB,SAAWL,OAAQ,EAAGC,OAAQ,KAAAK,EAEtC,OAVyB1L,EAAAiN,EAAA3N,GAUzB2N,EAVA,CAAyBxD,GAAZxQ,EAAAgU,MAYb,IAAAY,EAAA,SAAAvO,GAAA,SAAAuO,IAAA,IAAArO,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,cACPiG,EAAAkK,YAAc,UACdlK,EAAA0K,SAAY4D,GAAQb,GAEpBzN,EAAAoK,MAASlD,EAAAmD,cAAc+D,SACvBpO,EAAAuK,UAAYX,EAAS1C,EAAAmD,cAAc+D,QAAS,GAC5CpO,EAAA6B,MAAQwH,EACRrJ,EAAAyK,MAAQnD,EAAOU,MACfhI,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHkB,QAAUF,OAAQ,EAAGC,OAAQ,GAC7BE,OAASH,OAAQ,EAAGC,OAAQ,MAAAK,EAEpC,OAdgC1L,EAAA6N,EAAAvO,GAchCuO,EAdA,CAAgCpE,GAAnBxQ,EAAA4U,aAgBb,IAAAE,EAAA,SAAAzO,GAAA,SAAAyO,IAAA,IAAAvO,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,qBACPiG,EAAAkK,YAAc,kBACdlK,EAAA0K,SAAY8D,GACZxO,EAAAuK,UAAYb,GAAOxC,EAAAmD,cAAcsC,MAAO,GACxC3M,EAAA6B,MAAQ4H,EACRzJ,EAAAyK,MAAQnD,EAAOhF,QACftC,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHe,OAASC,OAAQ,EAAGC,OAAQ,IAC5BwB,QAAUzB,OAAQ,EAAGC,OAAQ,KAAAK,EAMrC,OAhBuC1L,EAAA+N,EAAAzO,GAgBvCyO,EAhBA,CAAuCtE,GAA1BxQ,EAAA8U,oBAkBb,IAAAE,EAAA,SAAA3O,GAAA,SAAA2O,IAAA,IAAAzO,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,sBACPiG,EAAAkK,YAAc,wBACdlK,EAAA0K,SAAW8D,GACXxO,EAAAuK,UAAYX,EAAS1C,EAAAmD,cAAcsC,KAAM,GACzC3M,EAAAyK,MAAQnD,EAAOc,WACfpI,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHe,OAASC,OAAQ,EAAGC,OAAQ,IAC5BG,MAAQJ,OAAQ,EAAGC,OAAQ,KAAAK,EAEnC,OAXwC1L,EAAAiO,EAAA3O,GAWxC2O,EAXA,CAAwCxE,GAA3BxQ,EAAAgV,qBAab,IAAAD,EAAA,SAAA1O,GAAA,SAAA0O,IAAA,IAAAxO,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,cACPiG,EAAAkK,YAAc,cAEdlK,EAAAuK,UAAYT,IACZ9J,EAAA0O,eAAiB,KACjB1O,EAAAyK,MAAQnD,EAAOE,IACfxH,EAAA0K,SAAWiE,GACX3O,EAAA6D,KAAOsD,EAAAlE,WAAWO,MAClBxD,EAAA6B,MAAQ2H,EACRxJ,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHe,OAASC,OAAQ,EAAGC,OAAQ,KAAAK,EAEpC,OAdgC1L,EAAAgO,EAAA1O,GAchC0O,EAdA,CAAgCvE,GAAnBxQ,EAAA+U,aAgBb,IAAAI,EAAA,SAAA9O,GAAA,SAAA8O,IAAA,IAAA5O,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,kBACPiG,EAAAkK,YAAc,iBAEdlK,EAAAuK,UAAYV,GACN3C,EAAAmD,cAAc+D,QAASlH,EAAAmD,cAAc+D,SACvClH,EAAAmD,cAAcwE,WAElB7O,EAAA0O,eAAiB,KACjB1O,EAAAyK,MAAQnD,EAAOE,IACfxH,EAAA0K,SAAWoE,GACX9O,EAAA6D,KAAOsD,EAAAlE,WAAWO,MAClBxD,EAAA6B,MAAQ2H,EACRxJ,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHe,OAASC,OAAQ,EAAGC,OAAQ,KAAAK,EAEpC,OAjBoC1L,EAAAoO,EAAA9O,GAiBpC8O,EAjBA,CAAoC3E,GAAvBxQ,EAAAmV,iBAmBb,IAAAE,EAAA,SAAAhP,GAAA,SAAAgP,IAAA,IAAA9O,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,gBACPiG,EAAAkK,YAAc,UACdlK,EAAAuK,UAAYb,GAAQxC,EAAAmD,cAAcwE,YAClC7O,EAAA0K,SAAWiE,GACX3O,EAAA6B,MAAQwH,EACRrJ,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHe,OAASC,OAAQ,EAAGC,OAAQ,KAAAK,EAEpC,OAVgC1L,EAAAsO,EAAAhP,GAUhCgP,EAVA,CAAgC7E,GAAnBxQ,EAAAqV,aAab,IAAAC,EAAA,SAAAjP,GAAA,SAAAiP,IAAA,IAAA/O,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,aACPiG,EAAAkK,YAAc,gBACdlK,EAAAuK,UAAYV,GACP3C,EAAAmD,cAAcC,QAASpD,EAAAmD,cAAcC,SACrCpD,EAAAmD,cAAc2E,OAEnBhP,EAAA6D,KAAOsD,EAAAlE,WAAWO,MAClBxD,EAAA6B,MAAQI,EACRjC,EAAA0K,SAAWmD,GACX7N,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHe,OAASC,OAAQ,EAAGC,OAAQ,KAEhC7L,EAAAyK,MAAQnD,EAAOgB,aACnB,OAfgC9H,EAAAuO,EAAAjP,GAehCiP,EAfA,CAAgC9E,GAAnBxQ,EAAAsV,aAiBb,IAAAJ,EAAA,SAAA7O,GAAA,SAAA6O,IAAA,IAAA3O,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,YACPiG,EAAAkK,YAAc,wBACdlK,EAAAuK,UAAYX,EAAS1C,EAAAmD,cAAc+D,SACnCpO,EAAA0K,SAAY4C,EAAiBS,EAAWE,GACxCjO,EAAA6D,KAAOsD,EAAAlE,WAAWO,MAClBxD,EAAA6B,MAAQ2H,EACRxJ,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHe,OAASC,OAAQ,EAAGC,OAAQ,KAAAK,EAEpC,OAX8B1L,EAAAmO,EAAA7O,GAW9B6O,EAXA,CAA8B1E,GAAjBxQ,EAAAkV,WAab,IAAAM,EAAA,SAAAnP,GAAA,SAAAmP,IAAA,IAAAjP,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,wBACPiG,EAAAkK,YAAc,yBACdlK,EAAAuK,UAAYb,GAAOxC,EAAAmD,cAAc+D,QAASlH,EAAAmD,cAAcsC,MAAO,GAC/D3M,EAAA0K,SAAW2D,EAAYC,IACvBtO,EAAA6B,MAAQwH,EACRrJ,EAAAyK,MAAQnD,EAAOa,aACfnI,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHe,OAASC,OAAQ,EAAGC,OAAQ,MAAAK,EAEpC,OAXyC1L,EAAAyO,EAAAnP,GAWzCmP,EAXA,CAAyChF,GAA5BxQ,EAAAwV,sBAoBb,IAAAC,GAAA,SAAApP,GAAA,SAAAoP,IAAA,IAAAlP,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,mBACPiG,EAAAkK,YAAc,uBACdlK,EAAA6B,MAAQI,EACRjC,EAAA6D,KAAOsD,EAAAlE,WAAWQ,OAClBzD,EAAAyK,MAAQnD,EAAO8B,MACfpJ,EAAAmL,YACAnL,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHe,OAASC,OAAQ,EAAGC,OAAQ,KAAAK,EAEpC,OAX2B1L,EAAA0O,EAAApP,GAW3BoP,EAXA,CAA2BjF,GAAdxQ,EAAAyV,SAab,IAAAC,GAAA,SAAArP,GAAA,SAAAqP,IAAA,IAAAnP,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,gBACPiG,EAAAkK,YAAc,oBAGdlK,EAAAuK,UAAYP,EAAQ9C,EAAAmD,cAAcoB,IAAK,GAEvCzL,EAAA0K,SAAW0E,GAAkBC,IAC7BrP,EAAA6B,MAAQI,EACRjC,EAAA6D,KAAOsD,EAAAlE,WAAWQ,OAClBzD,EAAA+K,aACA/K,EAAAyK,MAAQnD,EAAOmB,QACnB,OAZ2BjI,EAAA2O,EAAArP,GAY3BqP,EAZA,CAA2BlF,GAAdxQ,EAAA0V,SAcb,IAAAG,GAAA,SAAAxP,GAAA,SAAAwP,IAAA,IAAAtP,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,gBACPiG,EAAAkK,YAAc,+BACdlK,EAAAuK,UAAYb,GAAOxC,EAAAmD,cAAcC,QAASpD,EAAAmD,cAAc2E,OAAQ,GAChEhP,EAAA0K,SAAWqD,GACX/N,EAAA6B,MAAQI,EACRjC,EAAA6D,KAAOsD,EAAAlE,WAAWQ,SACtB,OAPkCjD,EAAA8O,EAAAxP,GAOlCwP,EAPA,CAAkCrF,GAArBxQ,EAAA6V,gBASb,IAAAC,GAAA,SAAAzP,GAAA,SAAAyP,IAAA,IAAAvP,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,kBACPiG,EAAAkK,YAAc,YACdlK,EAAAuK,UAAYb,GAAOxC,EAAAmD,cAAcsC,KAAMzF,EAAAmD,cAAcmF,WAAY,IACjExP,EAAAyK,MAAQnD,EAAOS,OACf/H,EAAA0K,SAAWqD,EAAWF,GACtB7N,EAAA6D,KAAOsD,EAAAlE,WAAWQ,OAClBzD,EAAA6B,MAAQyH,EACRtJ,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHe,OAASC,OAAQ,EAAGC,OAAQ,KAAAK,EAEpC,OAZoC1L,EAAA+O,EAAAzP,GAYpCyP,EAZA,CAAoCtF,GAAvBxQ,EAAA8V,kBAcb,IAAAE,GAAA,SAAA3P,GAAA,SAAA2P,IAAA,IAAAzP,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACGD,EAAAjG,KAAO,aACPiG,EAAAkK,YAAc,iBACdlK,EAAAuK,UAAYX,EAAS1C,EAAAmD,cAAc+D,SACnCpO,EAAA6D,KAAOsD,EAAAlE,WAAWQ,OAClBzD,EAAA0K,SAAWiE,GACX3O,EAAA6B,MAAQwH,EACPrJ,EAAA6K,WACA7K,EAAAyK,MAAQnD,EAAO0B,WACfhJ,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHe,OAASC,OAAQ,EAAGC,OAAQ,GAC5BE,OAASH,OAAQ,EAAGC,OAAQ,GAC5BC,QAAUF,OAAQ,EAAGC,OAAQ,KAAAK,EAErC,OAfgC1L,EAAAiP,EAAA3P,GAehC2P,EAfA,CAAgCxF,GAAnBxQ,EAAAgW,cAkBb,IAAAC,GAAA,SAAA5P,GAAA,SAAA4P,IAAA,IAAA1P,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACGD,EAAAjG,KAAO,QACPiG,EAAAkK,YAAc,qBACdlK,EAAAuK,UAAYV,GACN3C,EAAAmD,cAAc+D,QAASlH,EAAAmD,cAAc+D,SACvClH,EAAAmD,cAAc6D,MAElBlO,EAAAyK,MAAQnD,EAAOK,MACf3H,EAAA0K,SAAWiF,IACX3P,EAAA6D,KAAOsD,EAAAlE,WAAWQ,OAClBzD,EAAA6B,MAAQ0H,EACPvJ,EAAA6K,WACA7K,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHe,OAASC,OAAQ,EAAGC,OAAQ,GAC5BE,OAASH,OAAQ,EAAGC,OAAQ,GAC5BI,SAAWL,OAAQ,EAAGC,OAAQ,KAAAK,EAEtC,OAlB2B1L,EAAAkP,EAAA5P,GAkB3B4P,EAlBA,CAA2BzF,GAAdxQ,EAAAiW,SAoBb,IAAAE,GAAA,SAAA9P,GAAA,SAAA8P,IAAA,IAAA5P,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,QACPiG,EAAAkK,YAAc,yBACdlK,EAAAuK,UAAYX,EAAS1C,EAAAmD,cAAc+D,SACnCpO,EAAA0K,SAAWiF,IACX3P,EAAA6D,KAAOsD,EAAAlE,WAAWQ,OAClBzD,EAAA6B,MAAQwH,EACRrJ,EAAA6K,WAAUqB,EACd,OAR2B1L,EAAAoP,EAAA9P,GAQ3B8P,EARA,CAA2B3F,GAAdxQ,EAAAmW,SAWb,IAAAtB,GAAA,SAAAxO,GAAA,SAAAwO,IAAA,IAAAtO,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,SACPiG,EAAAkK,YAAc,YACdlK,EAAAuK,UAAYX,EAAS1C,EAAAmD,cAAc+D,SACnCpO,EAAA0K,SAAY4C,EAAiBS,GAC7B/N,EAAA6D,KAAOsD,EAAAlE,WAAWQ,OAClBzD,EAAA6B,MAAQwH,EACRrJ,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHe,OAASC,OAAQ,EAAGC,OAAQ,KAAAK,EAEpC,OAX4B1L,EAAA8N,EAAAxO,GAW5BwO,EAXA,CAA4BrE,GAAfxQ,EAAA6U,UAcb,IAAAc,GAAA,SAAAtP,GAAA,SAAAsP,IAAA,IAAApP,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,oBACPiG,EAAAkK,YAAc,uBACdlK,EAAAuK,UAAYV,GACP3C,EAAAmD,cAAcoB,IAAKvE,EAAAmD,cAAcoB,IAAKvE,EAAAmD,cAAcoB,KACpDvE,EAAAmD,cAAcC,SAEnBtK,EAAA6D,KAAOsD,EAAAlE,WAAWQ,OAClBzD,EAAA6B,MAAQI,EACRjC,EAAAyK,MAAQnD,EAAO6B,aACfnJ,EAAA0K,SAAWmD,EAAakB,GACxB/O,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHe,OAASC,OAAQ,EAAGC,OAAQ,KAAAK,EAEpC,OAfsC1L,EAAA4O,EAAAtP,GAetCsP,EAfA,CAAsCnF,GAAzBxQ,EAAA2V,oBAiBb,IAAAS,GAAA,SAAA/P,GAAA,SAAA+P,IAAA,IAAA7P,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,oBACPiG,EAAAkK,YAAc,iBACdlK,EAAA6D,KAAOsD,EAAAlE,WAAWQ,OAClBzD,EAAA0K,SAAYoF,GAAWC,GAAgBC,IACvChQ,EAAA6B,MAAQzG,EAAAoE,MAAMyQ,QAAQ,UACtBjQ,EAAAuK,UAAYX,EAAS1C,EAAAmD,cAAc6F,MAAO,GAC1ClQ,EAAAoK,MAAQlD,EAAAmD,cAAc6F,OACtBlQ,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHyC,QAAUzB,OAAQ,EAAGC,OAAQ,GAC7BqB,QAAUtB,OAAQ,EAAGC,OAAQ,KAAAK,EAErC,OAbsC1L,EAAAqP,EAAA/P,GAatC+P,EAbA,CAAsC5F,GAAzBxQ,EAAAoW,oBAeb,IAAAM,GAAA,SAAArQ,GAAA,SAAAqQ,IAAA,IAAAnQ,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,gBACPiG,EAAAkK,YAAc,mBACdlK,EAAA6D,KAAOsD,EAAAlE,WAAWQ,OAClBzD,EAAA0K,SAAYqF,GAAgBD,IAC5B9P,EAAA6B,MAAQzG,EAAAoE,MAAMyQ,QAAQ,UACtBjQ,EAAAuK,UAAYb,GAAOxC,EAAAmD,cAAc+F,QAAS,IAC1CpQ,EAAAoK,MAAQlD,EAAAmD,cAAc2E,MAAO9H,EAAAmD,cAAcmF,WAC3CxP,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHoC,QAAUpB,OAAQ,EAAGC,OAAQ,GAC7BqB,QAAUtB,OAAQ,EAAGC,OAAQ,KAEjC7L,EAAA6K,WAAUqB,EACd,OAdkC1L,EAAA2P,EAAArQ,GAclCqQ,EAdA,CAAkClG,GAArBxQ,EAAA0W,gBAgBb,IAAAE,GAAA,SAAAvQ,GAAA,SAAAuQ,IAAA,IAAArQ,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,eACPiG,EAAAkK,YAAc,OACdlK,EAAA6D,KAAOsD,EAAAlE,WAAWQ,OAClBzD,EAAA6B,MAAQzG,EAAAoE,MAAMyQ,QAAQ,UACtBjQ,EAAAuK,UAAYR,IACZ/J,EAAAoK,MAAQlD,EAAAmD,cAAciG,QACtBtQ,EAAA0K,SAAYqF,GAAgBI,MAChC,OARiC3P,EAAA6P,EAAAvQ,GAQjCuQ,EARA,CAAiCpG,GAApBxQ,EAAA4W,eAUb,IAAAE,GAAA,SAAAzQ,GAAA,SAAAyQ,IAAA,IAAAvQ,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,iBACPiG,EAAAkK,YAAc,8BACdlK,EAAA6D,KAAOsD,EAAAlE,WAAWQ,OAClBzD,EAAA6B,MAAQyH,EACRtJ,EAAAuK,UAAYX,EAAS1C,EAAAmD,cAAcsC,KAAM,GACzC3M,EAAAoK,MAAQlD,EAAAmD,cAAcmF,UAAWtI,EAAAmD,cAAcC,SAC/CtK,EAAA0K,SAAYoF,IACZ9P,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHe,OAASC,OAAQ,EAAGC,OAAQ,GAC5BiB,KAAOlB,OAAQ,EAAGC,OAAQ,KAAAK,EAElC,OAbmC1L,EAAA+P,EAAAzQ,GAanCyQ,EAbA,CAAmCtG,GAAtBxQ,EAAA8W,iBAeb,IAAAC,GAAA,SAAA1Q,GAAA,SAAA0Q,IAAA,IAAAxQ,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,eACPiG,EAAAkK,YAAc,wBACdlK,EAAA6D,KAAOsD,EAAAlE,WAAWQ,OAClBzD,EAAA6K,WACA7K,EAAAoK,MAASlD,EAAAmD,cAAciG,QACvBtQ,EAAA0K,SAAY+F,IACZzQ,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHkB,QAAUF,OAAQ,EAAGC,OAAQ,GAC7BqB,QAAUtB,OAAQ,EAAGC,OAAQ,KAAAK,EAErC,OAZiC1L,EAAAgQ,EAAA1Q,GAYjC0Q,EAZA,CAAiCvG,GAApBxQ,EAAA+W,eAcb,IAAAC,GAAA,SAAA3Q,GAAA,SAAA2Q,IAAA,IAAAzQ,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,kBACPiG,EAAAkK,YAAc,iBACdlK,EAAAuK,UAAYV,GACN3C,EAAAmD,cAAc6F,MAAOhJ,EAAAmD,cAAc+F,QACrClJ,EAAAmD,cAAciG,QAElBtQ,EAAAoK,MAASlD,EAAAmD,cAAc+F,OAAQlJ,EAAAmD,cAAcmF,WAC7CxP,EAAA0K,SAAYmF,GAAkBM,IAC9BnQ,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHe,OAASC,OAAQ,EAAGC,OAAQ,KAAAK,EAEpC,OAboC1L,EAAAiQ,EAAA3Q,GAapC2Q,EAbA,CAAoCxG,GAAvBxQ,EAAAgX,kBAeb,IAAAC,GAAA,SAAA5Q,GAAA,SAAA4Q,IAAA,IAAA1Q,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,mBACPiG,EAAAkK,YAAc,qBAEdlK,EAAAoK,MAASlD,EAAAmD,cAAcC,SACvBtK,EAAA0K,SAAY+F,IACZzQ,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHe,OAASC,OAAQ+E,IAAU9E,OAAQ,GACnCqB,QAAUtB,OAAQ,IAAMC,OAAQ,KAGpC7L,EAAAkL,eAAcgB,EAClB,OAbqC1L,EAAAkQ,EAAA5Q,GAarC4Q,EAbA,CAAqCzG,GAAxBxQ,EAAAiX,mBAkBb,IAAAf,GAAA,SAAA7P,GAAA,SAAA6P,IAAA,IAAA3P,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACGD,EAAAjG,KAAO,UACPiG,EAAAkK,YAAc,iBACdlK,EAAAuK,UAAYX,EAAS1C,EAAAmD,cAAc+D,QAAS,IAC5CpO,EAAA6D,KAAOsD,EAAAlE,WAAWS,MAClB1D,EAAA0K,SAAWiE,GACX3O,EAAA6B,MAAQwH,EACPrJ,EAAA6K,WACA7K,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHe,OAASC,OAAQ,EAAGC,OAAQ,GAC5BE,OAASH,OAAQ,EAAGC,OAAQ,GAC5BC,QAAUF,OAAQ,EAAGC,OAAQ,KAAAK,EAErC,OAd6B1L,EAAAmP,EAAA7P,GAc7B6P,EAdA,CAA6B1F,GAAhBxQ,EAAAkW,WAiBb,IAAAN,GAAA,SAAAvP,GAAA,SAAAuP,IAAA,IAAArP,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,eACPiG,EAAAkK,YAAc,WACdlK,EAAAuK,UAAYX,EAAS1C,EAAAmD,cAAcoB,KACnCzL,EAAA6D,KAAOsD,EAAAlE,WAAWS,MAClB1D,EAAA0K,SAAYqE,GACZ/O,EAAAyK,MAAQnD,EAAOmB,MACfzI,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHe,OAASC,OAAQ,EAAGC,OAAQ,KAAAK,EAEpC,OAXiC1L,EAAA6O,EAAAvP,GAWjCuP,EAXA,CAAiCpF,GAApBxQ,EAAA4V,eAab,IAAAU,GAAA,SAAAjQ,GAAA,SAAAiQ,IAAA,IAAA/P,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,kBACPiG,EAAA6D,KAAOsD,EAAAlE,WAAWS,MAClB1D,EAAA0K,SAAYqE,GACZ/O,EAAA6B,MAAQI,EACRjC,EAAAuK,UAAYV,GACP3C,EAAAmD,cAAc2E,MAAO9H,EAAAmD,cAAcmF,WACpCtI,EAAAmD,cAAc+F,QAElBpQ,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHe,OAASC,OAAQ,EAAGC,OAAQ,KAAAK,EAEpC,OAboC1L,EAAAuP,EAAAjQ,GAapCiQ,EAbA,CAAoC9F,GAAvBxQ,EAAAsW,kBAeb,IAAAC,GAAA,SAAAlQ,GAAA,SAAAkQ,IAAA,IAAAhQ,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,mBACPiG,EAAA6D,KAAOsD,EAAAlE,WAAWS,MAClB1D,EAAA0K,SAAYqF,IACZ/P,EAAA6B,MAAQ2H,EACRxJ,EAAAuK,UAAYV,GACP3C,EAAAmD,cAAcwE,UAAW3H,EAAAmD,cAAcmF,WACxCtI,EAAAmD,cAAc6F,OAElBlQ,EAAAyK,MAAQnD,EAAOe,YACfrI,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHe,OAASC,OAAQ,EAAGC,OAAQ,GAC5BE,OAASH,OAAQ,EAAGC,OAAQ,KAAAK,EAEpC,OAfqC1L,EAAAwP,EAAAlQ,GAerCkQ,EAfA,CAAqC/F,GAAxBxQ,EAAAuW,mBAiBb,IAAAF,GAAA,SAAAhQ,GAAA,SAAAgQ,IAAA,IAAA9P,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,YACPiG,EAAA6D,KAAOsD,EAAAlE,WAAWS,MAClB1D,EAAA6B,MAAQyH,EACRtJ,EAAA0K,SAAW6E,IACXvP,EAAAoK,MAASlD,EAAAmD,cAAcC,QAASpD,EAAAmD,cAAcC,SAC9CtK,EAAAuK,UAAYV,GACN3C,EAAAmD,cAAcsC,KAAMzF,EAAAmD,cAAcsC,MACpCzF,EAAAmD,cAAcmF,WAElBxP,EAAAyK,MAAQnD,EAAOS,OACf/H,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHe,OAASC,OAAQ,EAAGC,OAAQ,KAAAK,EAEpC,OAf+B1L,EAAAsP,EAAAhQ,GAe/BgQ,EAfA,CAA+B7F,GAAlBxQ,EAAAqW,aAiBb,IAAAc,GAAA,SAAA9Q,GAAA,SAAA8Q,IAAA,IAAA5Q,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,kBACPiG,EAAA6D,KAAOsD,EAAAlE,WAAWS,MAClB1D,EAAA0K,SAAYkF,IACZ5P,EAAA6B,MAAQwH,EACRrJ,EAAA6K,WACA7K,EAAAuK,UAAYX,EAAS1C,EAAAmD,cAAc+D,QAAS,IAC5CpO,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHmB,OAASH,OAAQ,EAAGC,OAAQ,GAC5BC,QAAUF,OAAQ,GAAIC,OAAQ,KAAAK,EAEtC,OAZ8B1L,EAAAoQ,EAAA9Q,GAY9B8Q,EAZA,CAA8B3G,GAAjBxQ,EAAAmX,YAcb,IAAAC,GAAA,SAAA/Q,GAAA,SAAA+Q,IAAA,IAAA7Q,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,aACPiG,EAAA6D,KAAOsD,EAAAlE,WAAWS,MAClB1D,EAAA0K,SAAYsF,IACZhQ,EAAA6B,MAAQzG,EAAAoE,MAAMyQ,QAAQ,UACtBjQ,EAAAuK,UAAYb,GAAOxC,EAAAmD,cAAc6F,OAAQ,IACzClQ,EAAAoK,MAAQlD,EAAAmD,cAAcmF,UAAWtI,EAAAmD,cAAcwE,WAC/C7O,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHyC,QAAUzB,OAAQ,EAAGC,OAAQ,GAC7BqB,QAAUtB,OAAQ,EAAGC,OAAQ,KAAAK,EAErC,OAZ+B1L,EAAAqQ,EAAA/Q,GAY/B+Q,EAZA,CAA+B5G,GAAlBxQ,EAAAoX,aAcb,IAAAC,GAAA,SAAAhR,GAAA,SAAAgR,IAAA,IAAA9Q,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,YACPiG,EAAAkK,YAAc,sBACdlK,EAAA6D,KAAOsD,EAAAlE,WAAWS,MAClB1D,EAAA0K,SAAY8F,MAChB,OAL+BhQ,EAAAsQ,EAAAhR,GAK/BgR,EALA,CAA+B7G,GAAlBxQ,EAAAqX,aAUb,IAAAC,GAAA,SAAAjR,GAAA,SAAAiR,IAAA,IAAA/Q,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,YACPiG,EAAA6D,KAAOsD,EAAAlE,WAAWU,KAClB3D,EAAA0K,SAAYqF,IACZ/P,EAAA6B,MAAQ0H,EACRvJ,EAAA6K,WACA7K,EAAA2K,QAAOe,KACAxE,EAAA0D,eACHmB,OAASH,OAAQ,EAAGC,OAAQ,GAC5BF,OAASC,OAAQ,EAAGC,OAAQ,GAC5BiB,KAAOlB,OAAQ,EAAGC,OAAQ,GAC1BG,MAAQJ,OAAQ,EAAGC,OAAQ,GAC3BmB,QAAUpB,OAAQ,EAAGC,OAAQ,GAC7BqB,QAAUtB,OAAQ,EAAGC,OAAQ,KAAAK,EAErC,OAf+B1L,EAAAuQ,EAAAjR,GAe/BiR,EAfA,CAA+B9G,GAAlBxQ,EAAAsX,aAiBb,IAAAC,GAAA,SAAAlR,GAAA,SAAAkR,IAAA,IAAAhR,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,gBACPiG,EAAA6D,KAAOsD,EAAAlE,WAAWU,KAClB3D,EAAA0K,SAAYqF,IACZ/P,EAAA6B,MAAQyH,IACZ,OALkC9I,EAAAwQ,EAAAlR,GAKlCkR,EALA,CAAkC/G,GAArBxQ,EAAAuX,gBASAvX,EAAAwX,aACTtC,EACAiB,GACAnC,EACAM,EACA2B,GACAlB,EAEAO,EACAd,EACAI,EACA0B,GACAV,GACAM,GACArC,EACAsD,GACArB,GACA/B,EACAW,EACAZ,EACAM,EACAkD,GACAC,GACA1C,GAEAc,GACAN,EACAF,EACAU,GACAQ,GAEAvB,EACAyB,GACAH,GACAM,GAEA1B,EACAQ,EAEAoB,GACAQ,GACAN,GACAO,GACAN,GACAC,GAEAzC,EACAL,EACAG,EAEAjB,EACAD,EAEAG,EAEAoC,GACAlC,EACAS,EACAP,EAEAuD,GAEAxB,kCCv+BJ,IAAYgC,mDAAZ,SAAYA,GAAcA,IAAAC,KAAA,UAAMD,IAAAE,GAAA,QAAIF,IAAAG,MAAA,WAAOH,IAAAI,KAAA,UAA3C,CAAYJ,EAAAzX,EAAAyX,cAAAzX,EAAAyX,iBAECzX,EAAA8X,SACTL,EAAYC,KACZD,EAAYG,MACZH,EAAYE,GACZF,EAAYI,MAIhB7X,EAAA+X,KAAA,SAAqBC,GACjB,OAAQA,GACJ,KAAKP,EAAYC,KAAM,OAAOD,EAAYG,MAC1C,KAAKH,EAAYG,MAAO,OAAOH,EAAYC,KAC3C,KAAKD,EAAYE,GAAI,OAAOF,EAAYI,KACxC,KAAKJ,EAAYI,KAAM,OAAOJ,EAAYE,GAE9C,MAAM,IAAIM,MAAM,0BAA2BD,mFClB/C,IAGYE,EAHZvW,EAAA/B,EAAA,GAiDA,SAAgBuY,EAAkBC,EAAiBtX,GAC/C,OAAO0B,KAAKK,MAAMuV,EAAOtX,GAAOqR,OAASiG,EAAOtX,GAAOsR,SA/C3D,SAAY8F,GACRA,EAAAhG,MAAA,QACAgG,EAAA7F,OAAA,SACA6F,EAAA5F,MAAA,QACA4F,EAAA1F,QAAA,UACA0F,EAAA3F,KAAA,OACA2F,EAAA7E,IAAA,MACA6E,EAAAtE,OAAA,SACAsE,EAAAG,OAAA,SACAH,EAAA3E,OAAA,SACA2E,EAAAzE,OAAA,SAVJ,CAAYyE,EAAAlY,EAAAkY,YAAAlY,EAAAkY,eAaClY,EAAAsY,WACTJ,EAAUhG,MACVgG,EAAU7F,OACV6F,EAAU5F,MACV4F,EAAU1F,QACV0F,EAAU3F,KACV2F,EAAU7E,IACV6E,EAAUtE,OACVsE,EAAUG,OACVH,EAAU3E,OACV2E,EAAUzE,QAQdzT,EAAAmR,YAAA,WACI,OACIe,OAASC,OAAQ,EAAGC,OAAQ,GAC5BC,QAAUF,OAAQ,EAAGC,OAAQ,GAC7BE,OAASH,OAAQ,EAAGC,OAAQ,GAC5BI,SAAWL,OAAQ,EAAGC,OAAQ,GAC9BG,MAAQJ,OAAQ,EAAGC,OAAQ,GAC3BiB,KAAOlB,OAAQ,EAAGC,OAAQ,GAC1BiG,QAAUlG,OAAQ,EAAGC,OAAQ,GAC7BwB,QAAUzB,OAAQ,EAAGC,OAAQ,GAC7BmB,QAAUpB,OAAQ,EAAGC,OAAQ,GAC7BqB,QAAUtB,OAAQ,EAAGC,OAAQ,KAIrCpS,EAAAmY,oBAIanY,EAAAuY,WAAoD,SAACC,EAAIC,GAClE,IAAIC,GAlBAxG,OAASC,OAAQ,EAAGC,OAAQ,GAC5BC,QAAUF,OAAQ,EAAGC,OAAQ,GAC7BE,OAASH,OAAQ,EAAGC,OAAQ,GAC5BI,SAAWL,OAAQ,EAAGC,OAAQ,GAC9BG,MAAQJ,OAAQ,EAAGC,OAAQ,GAC3BiB,KAAOlB,OAAQ,EAAGC,OAAQ,GAC1BiG,QAAUlG,OAAQ,EAAGC,OAAQ,GAC7BwB,QAAUzB,OAAQ,EAAGC,OAAQ,GAC7BmB,QAAUpB,OAAQ,EAAGC,OAAQ,GAC7BqB,QAAUtB,OAAQ,EAAGC,OAAQ,IAUjC,IAAK,IAAItR,KAASoX,EAAW,CACrB,IAAAS,EAAAH,EAAA1X,GAAE8X,EAAAD,EAAAxG,OAAY0G,EAAAF,EAAAvG,OACd0G,EAAAL,EAAA3X,GACAqR,EAASyG,EADPE,EAAA3G,OAEFC,EAASyG,EAFKC,EAAA1G,OAGlBsG,EAAU5X,IACNqR,OAAMA,EACNC,OAAMA,GAGd,OAAOsG,GAGE1Y,EAAA+Y,YAAuC,SAAC/U,GACjD,OAAOhE,EAAAsY,UAAUU,MAAM,SAAAlY,GAAS,OAAAqX,EAAkBnU,EAAGlD,IAAU,KAGnE,SAAY8P,GAERA,EAAA+D,QAAA,UACA/D,EAAAoB,IAAA,MACApB,EAAA+C,KAAA,OAGA/C,EAAA6D,KAAA,OACA7D,EAAAsC,KAAA,OACAtC,EAAAC,QAAA,UACAD,EAAAwE,UAAA,YAGAxE,EAAA2E,MAAA,QACA3E,EAAAmF,UAAA,YAGAnF,EAAA+F,OAAA,SACA/F,EAAA6F,MAAA,QAGA7F,EAAAiG,OAAA,SArBJ,CAAY7W,EAAA4Q,gBAAA5Q,EAAA4Q,mBAwBZ,IACMqI,GACFtE,QAAShT,EAAAoE,MAAM6J,MACfsD,KAAMvR,EAAAoE,MAAM8J,KAAKqJ,QAHT,IAIRrI,QAASlP,EAAAoE,MAAMyC,IAEfiM,KAAM9S,EAAAoE,MAAMiK,OAAOvH,OANX,IAORkL,KAAMhS,EAAAoE,MAAM8J,KAAKqJ,QAAQC,IACzBnH,IAAKrQ,EAAAoE,MAAMyC,IAAIC,OARP,IAUR2M,UAAWzT,EAAAoE,MAAMqT,SAEjB7D,MAAO5T,EAAAoE,MAAMsT,SAAS5Q,OAZd,IAaRsN,UAAWpU,EAAAoE,MAAM8J,KAAKpH,OAbd,IAeRkO,OAAQhV,EAAAoE,MAAMuT,KAAKJ,QAfX,IAgBRzC,MAAO9U,EAAAoE,MAAM+J,OAAOoJ,QAhBZ,IAkBRrC,OAAQlV,EAAAoE,MAAMwT,OAGlBvZ,EAAAwZ,WAAA,SAA2BC,GAEvB,OADgBR,EAAYQ,GACXC,WAAW,eAAA1V,EAAAyO,EAAA1R,GAAA,iBAAAxC,EAAAiC,EAAAgG,WAAAO,YAAAxI,EAAA,SAAAyF,EAAAyO,GAAA,OAAAlU,EAAAK,OAAA+a,iBAAAC,wBAAA5W,OAAA,SAAAgB,EAAAyO,GAAAzO,EAAA4V,UAAAnH,IAAA,SAAAzO,EAAAyO,GAAA,QAAA1R,KAAA0R,IAAA3T,eAAAiC,KAAAiD,EAAAjD,GAAA0R,EAAA1R,MAAAiD,EAAAyO,IAAA,SAAAzO,EAAAyO,GAAA,SAAA1R,IAAAyF,KAAAqT,YAAA7V,EAAAzF,EAAAyF,EAAAyO,GAAAzO,EAAAnF,UAAA,OAAA4T,EAAA7T,OAAAkb,OAAArH,IAAA1R,EAAAlC,UAAA4T,EAAA5T,UAAA,IAAAkC,KAAAF,EAAA2F,WAAAyL,UAAA,kBAAApR,EAAAjC,OAAAmb,QAAA,SAAA/V,GAAA,QAAAyO,EAAA1R,EAAA,EAAAxC,EAAAwT,UAAAtT,OAAAsC,EAAAxC,EAAAwC,IAAA,QAAAP,KAAAiS,EAAAV,UAAAhR,GAAAnC,OAAAC,UAAAC,eAAAC,KAAA0T,EAAAjS,KAAAwD,EAAAxD,GAAAiS,EAAAjS,IAAA,OAAAwD,IAAA5E,MAAAoH,KAAAuL,YAAAnT,OAAA6B,eAAAgS,EAAA,cAAA3R,OAAA,ICvHhC,IAAAa,EAAA/B,EAAA,GAIAoa,EAAApa,EAAA,GACA8J,EAAA9J,EAAA,GAEAgO,EAAAhO,EAAA,GACAqa,EAAAra,EAAA,IACA6N,EAAA7N,EAAA,GAEAsa,EAAAta,EAAA,IACA8N,EAAA9N,EAAA,GAEAua,EAAAva,EAAA,GACAwa,EAAAxa,EAAA,IAEAya,EAAAza,EAAA,IACA6J,EAAA7J,EAAA,GAEA0a,EAAA,WACI,SAAAA,EAAoBvH,EAAqB3I,GAArB5D,KAAAuM,MAAqBvM,KAAA4D,OAI7C,OAHIxL,OAAA6B,eAAI6Z,EAAAzb,UAAA,YAAA+B,IAAJ,WAAiB,OAAO4F,KAAKuM,qCAC7BnU,OAAA6B,eAAI6Z,EAAAzb,UAAA,eAAA+B,IAAJ,WAAoB,OAAO8M,EAAAvD,qBAAqB3D,KAAK4D,uCAEzDkQ,EALA,GAAata,EAAAsa,cAOb,IAAA3P,EAAA,SAAAtE,GAsBI,SAAAsE,EAAYoI,EAAoBwH,EAA6BC,GAA7D,IAAAjU,EACIF,EAAAtH,KAAAyH,KACEuM,EAAI0H,EACJ1H,EAAI2H,EACJH,EAAUI,MACVJ,EAAUK,OACVL,EAAUM,MAAQL,EAAOpS,MAAMK,OAAO,IAAO9G,EAAAoE,MAAM+U,cACpDtU,YAP2BD,EAAAgU,YAA6BhU,EAAAiU,SArB7DjU,EAAAwU,UAAoB,EAIpBxU,EAAAyU,UACAzU,EAAA0U,SACA1U,EAAA2U,aACA3U,EAAA4U,OAAsBnB,EAAAvC,YAAYG,MAClCrR,EAAA6U,WAEA7U,EAAA8U,qBAIQ9U,EAAA+U,WAIA/U,EAAAgV,UA2FRhV,EAAAiV,cACAjV,EAAAkV,KAAe,EAjFXlV,EAAKmV,OAAS,IAAI/Z,EAAAga,OAAO,EAAE,GAE3BpV,EAAKqV,QACLrV,EAAKsV,OAAStV,EAAKsV,OAAOnY,OAAO,SAAAoY,GAAS,QAAEA,aAAiBna,EAAAoa,OAAOC,oBAmBpEzV,EAAK0V,cAAgBta,EAAAua,cAAcC,QAEnC5V,EAAK6V,UAAY,IAAIza,EAAA0a,MAAM9V,EAAKgU,UAAUja,KAAM,EAAG,EAAGoJ,EAAAtD,KAAK+B,MAC3D5B,EAAK6V,UAAU/T,SAAW,EAE1B9B,EAAK6V,UAAUhU,MAAQzG,EAAAoE,MAAMwT,MAGzBhT,EAAKgU,UAAUM,QAAStU,EAAKgV,WAAS/a,EA2alD,OAve8BuG,EAAA4D,EAAAtE,GA+D1BsE,EAAA9L,UAAAyd,KAAA,SAAKC,EAA+BC,GAC3BhW,KAAK4U,SACNf,EAAAoC,SAASF,EAAK/V,KAAKkW,OAAQlW,KAAKmW,kBAEpCtW,EAAAxH,UAAMyd,KAAIvd,KAAAyH,KAAC+V,EAAKC,GAEZhW,KAAK0U,WAAa1U,KAAKoW,gBACvBpW,KAAK4V,UAAUrJ,IAAMvM,KAAKuM,IAAIC,IAC1B,IAAIrR,EAAAga,OAAOnV,KAAKqW,WAAW,EAAIrW,KAAK4V,UAAUU,aAAaP,GAAK,EAAG,IAEvE/V,KAAK4V,UAAUE,KAAKC,EAAKC,IAGzBhW,KAAKgV,aACDhV,KAAKuW,QAAQte,OAAS,GAEtB+H,KAAKuW,QAAQ5X,QAAQ,SAAC6X,GAClB,IAAIC,GAAoBxC,EAAGuC,EAAKjK,IAAI0H,EAAGC,EAAGsC,EAAKjK,IAAI2H,EAAGC,MAAO,EAAGC,OAAQ,GACxEP,EAAAoC,SAASF,EAAKU,EAAMtb,EAAAoE,MAAMuT,KAAKJ,QAAQ,OAG3C1S,KAAK0W,QAAQze,OAAS,GAEtB+H,KAAK0W,QAAQ/X,QAAQ,SAACgY,GAClB,IAAIF,GAAoBxC,EAAG0C,EAAK1C,EAAGC,EAAGyC,EAAKzC,EAAGC,MAAO,EAAGC,OAAQ,GAChEP,EAAAoC,SAASF,EAAKU,EAAMtb,EAAAoE,MAAMiK,OAAOkJ,QAAQ,QAK9B1S,KAAKgV,YACJhV,KAAK4W,eAAe3e,OAAS,GAAK+H,KAAK8U,QAAQ7c,OAAS+H,KAAK4W,eAAe3e,QAChG+H,KAAK4W,eAAejY,QAAQ,SAAA/D,GACxB,IAAIic,EAAQjc,EAAEkc,SACVjT,EAAKjJ,EAAEmc,YACXlD,EAAAoC,SAASF,GACH9B,EAAG4C,EAAM5C,EAAIpQ,EAAG,EAAGqQ,EAAG2C,EAAM3C,EAAIrQ,EAAG,EAAGsQ,MAAOtQ,EAAIuQ,OAAQvQ,GAE3D1I,EAAAoE,MAAMwT,UACN,MAUhB5O,EAAA9L,UAAA2e,OAAA,SAAOC,EAAcjB,GAArB,IAAAjW,EAAAC,KACIH,EAAAxH,UAAM2e,OAAMze,KAAAyH,KAACiX,EAAQjB,GAEJhW,KAAKwU,QAElBxU,KAAK8U,QAAQnW,QAAQ,SAAA0M,GACjBA,EAAO6L,WAAWnX,EAAKkV,MACpB5J,EAAO8L,YAAYlf,OAAS,GAC3BoT,EAAO8L,YAAYxY,QAAQ,SAAAyY,GAAc,OAAAA,EAAWF,WAAWnX,EAAKkV,UAMhFjV,KAAKiV,MAAQ,EAETgC,EAAO3W,UACPN,KAAKgV,cAELhV,KAAKgV,eAKb7Q,EAAA9L,UAAAgf,KAAA,WAAS,OAAOrX,KAAKsX,YAGrBlf,OAAA6B,eAAIkK,EAAA9L,UAAA,QAAA+B,IAAJ,WACI,OAAI4F,KAAKoW,cACEpW,KAAKoW,cAActc,KAEnBkG,KAAK+T,UAAUja,sCAI9B1B,OAAA6B,eAAIkK,EAAA9L,UAAA,eAAA+B,IAAJ,WACI,OAAI4F,KAAKoW,cACEpW,KAAKoW,cAAcnM,YAEnBjK,KAAK+T,UAAU9J,6CAI9B7R,OAAA6B,eAAIkK,EAAA9L,UAAA,UAAA+B,IAAJ,WACI,OAAO4F,KAAKuM,IAAI2H,EAAIlU,KAAKuX,6CAG7BpT,EAAA9L,UAAAqS,QAAA,SAAQ8M,GACJ,YADIA,UACAA,IAAsBxX,KAAKyX,SAC3B,OAAOxQ,EAAA0D,cAEP,IAAI+M,EAAmB1X,KAAK8U,QAAQpY,IAAI,SAAA7C,GAAK,OAAAA,EAAE6Q,UAG3CiN,EAAelM,KACZxE,EAAA0D,eACHkB,QAAUD,OAAQ,EAAGD,OAAQ,KAOjC,OAHoB+L,EAAgBpa,QAAEqa,IACjCnc,OAAOyL,EAAA8K,WAAY9K,EAAA0D,gBA6ChCvS,OAAA6B,eAAIkK,EAAA9L,UAAA,YAAA+B,IAAJ,WAAiB,QAAS4F,KAAK+U,wCAG/B5Q,EAAA9L,UAAA+c,MAAA,aAEAjR,EAAA9L,UAAAuf,gBAAA,SAAgB9a,GACZ,OAAOA,EAAO+a,SAElB1T,EAAA9L,UAAAyf,QAAA,SAAQhb,GAEJkD,KAAK+X,YAAYjb,IAGrBqH,EAAA9L,UAAA2f,eAAA,aAEA7T,EAAA9L,UAAA4f,YAAA,SAAYC,GAAiB,UAE7B/T,EAAA9L,UAAAke,MAAA,WACI,UAGJpS,EAAA9L,UAAAqe,MAAA,WACI,IAAIzC,EAAIjU,KAAKuM,IAAI0H,EAAIjU,KAAKqW,WAAW,EACjCnC,EAAIlU,KAAKuM,IAAI2H,EAAIlU,KAAKuX,YAC1B,OACI,IAAIpc,EAAAga,OAAOnZ,KAAKK,MAAM4X,GAAIjY,KAAKK,MAAM6X,MAI7C/P,EAAA9L,UAAAue,aAAA,WACI,UAGJzS,EAAA9L,UAAA8f,wBAAA,WACI,OAAOnY,KAAK4W,eAAela,IAAI,SAAAma,GAE3B,OADAA,EAAMC,SAAS5C,GAAM2C,EAAME,YAAY,EAChCF,EAAMC,YAIrB3S,EAAA9L,UAAA+f,MAAA,SAAMC,kBAAA,IAAgC5E,EAAA6E,OAKlC,IAJA,IAAI9Y,EAAI6Y,EAEJ3B,EAAQ1W,KAAK0W,QACb6B,EAAW/Y,EAAEgZ,aAAa9B,EAAM,GAAItP,EAAArJ,iBACtB0a,EAAA,EAAAtG,EAAAnS,KAAK6U,kBAAL4D,EAAAtG,EAAAla,OAAAwgB,IAAwB,CAArC,IAAIC,EAAKvG,EAAAsG,GACNjC,EAAOhX,EAAEgZ,aAAaE,EAAMC,WAAWpM,IAAKnF,EAAArJ,iBAChDyB,EAAEoZ,KAAKL,EAAU/B,GAEjB,IAAIqC,EAAYrZ,EAAEgZ,aAAaE,EAAMhC,QAAQ,GAAItP,EAAArJ,iBACjDyB,EAAEoZ,KAAKpC,EAAMqC,GAEbH,EAAMN,MAAM5Y,GAEhB,OAAOA,GAIJ2E,EAAA9L,UAAAygB,OAAP,SAAcC,GACV/Y,KAAKgU,OAAOgF,OAAOD,IAGhB5U,EAAA9L,UAAA4gB,MAAP,SAAaF,GACT/Y,KAAKgU,OAAOkF,MAAMH,IAGf5U,EAAA9L,UAAAiU,SAAP,SAAgBC,EAAa4M,sBACzBnZ,KAAKgU,OAAO1H,SAASC,EAAK4M,IAGpBhV,EAAA9L,UAAA6d,KAAV,WACI,OACIjC,EAAGjU,KAAKuM,IAAI0H,EACZC,EAAGlU,KAAKuM,IAAI2H,EACZC,MAAOnU,KAAKqW,WACZjC,OAAQpU,KAAKuX,cAIXpT,EAAA9L,UAAAif,SAAV,WACI,OAAOzD,EAAAuF,aAAapZ,KAAKkW,SAInB/R,EAAA9L,UAAAghB,eAAV,WACI,IAAIC,EAAmBtZ,KAAKuX,YAAc,EAAxB,EAA6B,EAC3CgC,EAAetW,EAAAG,MAAMD,MAAWa,MACpC,QAEMiQ,EAAGjU,KAAKuM,IAAI0H,EAAGC,EAAGlU,KAAKuM,IAAI2H,EAAIlU,KAAKuX,cAGpCtD,EAAGjU,KAAKuM,IAAI0H,EAAGC,EAAGlU,KAAKuM,IAAI2H,EAAIoF,IAC/BrF,EAAGjU,KAAKuM,IAAI0H,EAAIsF,EAAarF,EAAGlU,KAAKuM,IAAI2H,IAGzCD,EAAGjU,KAAKuM,IAAI0H,EAAIjU,KAAKqW,WAAakD,EAAarF,EAAGlU,KAAKuM,IAAI2H,IAC3DD,EAAGjU,KAAKuM,IAAI0H,EAAIjU,KAAKqW,WAAYnC,EAAGlU,KAAKuM,IAAI2H,EAAIoF,IAGjDrF,EAAGjU,KAAKuM,IAAI0H,EAAIjU,KAAKqW,WAAYnC,EAAGlU,KAAKuM,IAAI2H,EAAIlU,KAAKuX,eAKtDpT,EAAA9L,UAAAmhB,SAAV,SAAmBC,GACf,IAAIC,EAAQ1Z,KAAKkW,OAAQyD,EAAQF,EAAMvD,OAOvC,SALIwD,EAAMzF,EAAI0F,EAAM1F,EAAI0F,EAAMxF,OAC1BuF,EAAMzF,EAAIyF,EAAMvF,MAAQwF,EAAM1F,GAC9ByF,EAAMxF,EAAIyF,EAAMzF,EAAIyF,EAAMvF,QAC1BsF,EAAMxF,EAAIwF,EAAMtF,OAASuF,EAAMzF,IAKhC/P,EAAA9L,UAAAuhB,YAAP,eAAA7Z,EAAAC,KACI,QAASA,KAAKgU,OAAO6F,OAAOC,UAAU5a,KAAK,SAAA6a,GAAQ,OAAAA,IAASha,GAAQA,EAAKyZ,SAASO,MAG5E5V,EAAA9L,UAAA2hB,UAAV,WAEI,OADWha,KAAKmW,iBAAiBzD,QAAQ,MAInCvO,EAAA9L,UAAA4hB,UAAV,WAEI,OADWja,KAAKmW,iBAAiBlU,OAAO,MAIlCkC,EAAA9L,UAAA6hB,UAAV,WACI,OAAOla,KAAK4B,OAGNuC,EAAA9L,UAAA8d,eAAV,WACI,IAAIgE,EAAMna,KAAKka,YAAYrC,QAU3B,OATK7X,KAAKwU,SACFxU,KAAK4Z,gBAAiBO,EAAMhf,EAAAoE,MAAMyC,KACtCmY,EAAIte,EAAI,IAEPmE,KAAK+U,SACNoF,EAAMA,EAAIlY,OAAO,KAGjBjC,KAAKyU,QAAS0F,EAAIte,EAAI,IACnBse,GAGX/hB,OAAA6B,eAAIkK,EAAA9L,UAAA,eAAA+B,IAAJ,WACI,OAAO4F,KAAK+T,UAAUqG,6CAIhBjW,EAAA9L,UAAAgiB,SAAV,SACI9N,EACA+N,GAFJ,IAAAva,EAAAC,cAEIsa,MAAmEta,KAAKoa,aAGpE,IADJ,IAAIG,gBACSC,GACL,IAAMC,EAAkBH,EAAiBE,GACrCE,EAAUlH,EAAAjC,KAAKiJ,GACDC,EAAgB/d,IAAI,SAAAqX,GAClC,OAAAhU,EAAKiU,OAAO2G,sBAAsBpO,GAAMwH,MAElCpV,QAAQ,SAAAyN,GACVA,GACoBA,EAASmK,QACfrZ,OAAO,SAAAsZ,GAAQ,OAAAA,EAAK7B,SAAW+F,IAC5C/b,QAAQ,SAAAic,GACLL,EAASpiB,KAAKyiB,QAXdnC,EAAA,EAAAoC,EAAArH,EAAAlC,QAAAmH,EAAAoC,EAAA5iB,OAAAwgB,IAAOze,EAAX6gB,EAAApC,IAiBhB,GAAI8B,EAAStiB,OAAS,EAClB,OAAOmP,EAAAvK,QAAQ0P,EAAKgO,EAAU,SAAC/D,GAAS,OAAAA,EAAKjK,OAM3CpI,EAAA9L,UAAA0f,YAAV,SACIjb,EACAwd,kBAAmEta,KAAKoa,aAExE,IAAIU,EAAU9a,KAAKqa,SAASvd,EAAQwd,GACpC,GAAIQ,EAAS,CACT,IAAIF,EAAe5a,KAAKuW,QACnBrX,KAAK,SAAA7F,GAAK,OAAAA,EAAEsb,QAAUnB,EAAAjC,KAAKuJ,EAAQnG,UACxC,GAAIiG,EAAc,CACd,IAAIG,EAASD,EAAQvO,IAAIyO,IAAIJ,EAAarO,KAI1C,OAHAvM,KAAKuM,IAAI0O,SAASF,GAElB/a,KAAK2Y,WAAamC,EACXA,KAKT3W,EAAA9L,UAAA6iB,UAAV,SAAoBjH,EAAWC,EAAWS,GACtC,gBADsCA,MAAsBnB,EAAAvC,YAAYG,QAEpE7E,IAAK,IAAIpR,EAAAga,OAAOlB,EAAEC,GAClBS,OAAMA,EACNwG,OAAQnb,OAITmE,EAAA9L,UAAA+iB,UAAP,SAAiB/P,GAETA,EAAOe,WAAapM,OACpBqL,EAAOe,SAAWpM,MAEtBA,KAAK8U,QAAQ3c,KAAKkT,GAClBA,EAAOkB,IAAI8O,SAASrb,KAAKuM,KAEzBvM,KAAKwM,IAAInB,GACTrL,KAAKsb,iBACLjQ,EAAOkQ,QAAQnQ,YAAYC,GAG3BA,EAAOmJ,WAGJrQ,EAAA9L,UAAAmjB,kBAAP,WACI,OAAOxb,KAAK8U,QAAQ7c,OAAS+H,KAAK4W,eAAe3e,QAG9CkM,EAAA9L,UAAAojB,gBAAP,WAEI,OAAOzb,KAAK4W,eACR5W,KAAK8U,QAAQ7c,SAIdkM,EAAA9L,UAAAqjB,WAAP,WACI,OAAY1b,KAAK8U,QAAOxX,OAAK8J,EAAA/J,WAAW2C,KAAK8U,QAAQpY,IAAI,SAAA7C,GAAK,OAAAA,EAAEsd,iBAG7DhT,EAAA9L,UAAAijB,eAAP,WACI,IAAIK,GAAmBhI,EAAAhG,cAAYrQ,OAAKqW,EAAA3C,aAAa2C,EAAArI,cAAeqI,EAAAlH,aAChEmP,EAAW5b,KAAK8U,QAAQpY,IACxB,SAAA7C,GAAK,OAAA8hB,EAAezc,KAAK,SAACvF,GAAsB,OAAAE,EAAE0hB,mBAAmB5hB,MAErEoC,EAAK2X,EAAAmI,kBAAkB3c,KAAK,SAAA4c,GAC5B,IAAIC,EAAK,IAAID,EAEb,OAAO1U,EAAAxI,aACLgd,EACAG,EAAGH,YAGT,GAAI7f,EAAI,CAEJ,IAAIggB,EAAK,IAAIhgB,EACbiE,KAAKoW,cAAgB2F,EACrB/b,KAAK4V,UAAUoG,KAAOD,EAAGjiB,OAMjC1B,OAAA6B,eAAIkK,EAAA9L,UAAA,qBAAA+B,IAAJ,WACI,OAAI4F,KAAKoW,cACEpW,KAAKoW,cAAc6F,WAEnBrI,EAAAsI,kBAAkBC,sCAGrChY,EAveA,CAA8BhJ,EAAAihB,OAAjB5iB,EAAA2K,0FC3Bb,IAAAhJ,EAAA/B,EAAA,GAEAwa,EAAAxa,EAAA,IACA8J,EAAA9J,EAAA,GAIA,SAAgBggB,EAAa3C,GAC3B,IAAIlK,GAAQ0H,EAAGwC,EAAKxC,EAAGC,EAAGuC,EAAKvC,GAe/B,QAZYD,EAAG1H,EAAI0H,EAAGC,EAAG3H,EAAI2H,EAAIuC,EAAKrC,SAG1BH,EAAG1H,EAAI0H,EAAGC,EAAG3H,EAAI2H,IAGjBD,EAAG1H,EAAI0H,EAAIwC,EAAKtC,MAAOD,EAAG3H,EAAI2H,IAG9BD,EAAG1H,EAAI0H,EAAIwC,EAAKtC,MAAOD,EAAG3H,EAAI2H,EAAIuC,EAAKrC,SAkCrD,SAAgBiI,EACdtG,EACAuG,EAEAC,EACAvC,YADAuC,MAA6B3I,EAAAsI,kBAAkBC,eAC/CnC,MAAmB7e,EAAAoE,MAAMc,OAEzB,IAAMmc,EAAc5I,EAAA6I,qBAAqB1G,EAAKwG,GAC1CC,IACFzG,EAAI2G,OACJ3G,EAAI4G,UAAUL,EAAK,GAAGrI,EAAGqI,EAAK,GAAGpI,GAEjC6B,EAAI6G,YACJ7G,EAAI8G,OAAO,EAAE,GACbP,EAAK3d,QAAQ,SAAAme,GAAM,OAAA/G,EAAIgH,OAAOD,EAAG7I,EAAIqI,EAAK,GAAGrI,EAAG6I,EAAG5I,EAAEoI,EAAK,GAAGpI,KAC7D6B,EAAIgH,OAAO,EAAE,GACbhH,EAAIiH,YAEJjH,EAAIkH,UAAYT,EAChBzG,EAAItZ,OAGJsZ,EAAImH,YAAclD,EAAUiD,YAC5BlH,EAAIoH,SACJpH,EAAIqH,WAvER5jB,EAAA4f,eAoBA5f,EAAA6jB,SAAA,SAAyBtH,EAA+Bla,EAAWmC,EAAWmc,EAA0BmD,YAA1BnD,MAAahf,EAAAoE,MAAMwT,gBAAOuK,MAAA,GACtGvH,EAAI2G,OACJ,IAAI9iB,EAAIugB,EAAItC,QAEZ9B,EAAI6G,YACJ7G,EAAI8G,OAAOhhB,EAAEoY,EAAGpY,EAAEqY,GAClB6B,EAAIgH,OAAO/e,EAAEiW,EAAGjW,EAAEkW,GAClB6B,EAAImH,YAActjB,EAAEsI,SACpB6T,EAAIuH,UAAYA,EAChBvH,EAAIiH,YACJjH,EAAIoH,SAEJpH,EAAIqH,WAGN5jB,EAAA+jB,kBAAA,SACExH,EACAU,EACA8F,kBAA6B3I,EAAAsI,kBAAkBC,MAE3BvI,EAAA6I,qBAAqB1G,EAAKwG,IAE5CF,EAAkBtG,EAAKqD,EAAa3C,GAAO8F,IAK/C/iB,EAAA6iB,oBAkCA7iB,EAAAyc,SAAA,SACEF,EACAyH,EACA5b,EACA6b,EACAC,YAFA9b,MAAezG,EAAAoE,MAAMwT,gBACrB0K,eAAA,IACAC,UAEM,IAAAzJ,EAAAuJ,EAAAvJ,EAAGC,EAAAsJ,EAAAtJ,EAAGC,EAAAqJ,EAAArJ,MAAOC,EAAAoJ,EAAApJ,OAEnB,GAAIqJ,EAAQ,CACV,IAAIE,EAAO/b,EAAMiW,QAEjB9B,EAAIkH,UAAYU,EAAKzb,SACrB6T,EAAI6H,SACF3J,EACAC,EACAC,EACAC,KAgBN5a,EAAAqkB,SAAA,SACE9H,EACAuG,EACA1a,GAMEmU,EAAI6G,YACJ7G,EAAI8G,OAAOP,EAAK,GAAGrI,EAAGqI,EAAK,GAAGpI,GAC9BoI,EAAK3d,QAAQ,SAAAme,GAAM,OAAA/G,EAAIgH,OAAOD,EAAG7I,EAAG6I,EAAG5I,KACvC6B,EAAIgH,OAAOT,EAAK,GAAGrI,EAAGqI,EAAK,GAAGpI,GAC9B6B,EAAIiH,YAEJjH,EAAIkH,UAAYrb,EAAMqb,YACtBlH,EAAItZ,QAURjD,EAAAskB,SAAA,SAAyB/H,EAAKgI,EAAIC,EAAIC,EAAiBC,EAAiBC,YAAlCF,MAAA,cAAiBC,MAAA,cAAiBC,MAAA,GACpE,IAAIC,EAAMpiB,KAAKqiB,GAAK,EAAI,EACpBpK,EAAI8J,EACJ7J,EAAI8J,EACJ/I,EAAOjZ,KAAKqiB,GAAKF,EAErBpI,EAAI6G,YACJ7G,EAAI8G,OAAOkB,EAAIC,EAAKC,GACpB,IAAK,IAAIlmB,EAAI,EAAGA,EAAIomB,EAAQpmB,IACxBkc,EAAI8J,EAAK/hB,KAAKsiB,IAAIF,GAAOH,EACzB/J,EAAI8J,EAAKhiB,KAAKuiB,IAAIH,GAAOH,EACzBlI,EAAIgH,OAAO9I,EAAGC,GACdkK,GAAOnJ,EAEPhB,EAAI8J,EAAK/hB,KAAKsiB,IAAIF,GAAOF,EACzBhK,EAAI8J,EAAKhiB,KAAKuiB,IAAIH,GAAOF,EACzBnI,EAAIgH,OAAO9I,EAAGC,GACdkK,GAAOnJ,EAEXc,EAAIgH,OAAOgB,EAAIC,EAAKC,GACpBlI,EAAIiH,YACJjH,EAAIuH,UAAY,EAChBvH,EAAImH,YAAc,SAClBnH,EAAIoH,SACJpH,EAAIkH,UAAY,SAChBlH,EAAItZ,QAGRjD,EAAAglB,WAAA,SAA2BzI,EAAKgI,EAAIC,EAAYS,EAAgB7c,EAAc8c,sBAC5E,IAAIC,EAAQD,EAAO1iB,KAAKqiB,GAAM,EAAIriB,KAAKqiB,GACvCtI,EAAI6G,YAEJ7G,EAAI6I,IACFb,EACAC,EACAS,EACA,EACAE,MAGF5I,EAAIiH,YAEJjH,EAAIkH,UAAYrb,EAAMM,SACtB6T,EAAItZ,QAGNjD,EAAAqlB,YAAA,SAA4B9I,EAA+BgI,EAAIC,EAAIc,EAAiBC,EAAiBnd,EAAc8c,sBACjH,IAAIC,EAAQD,EAAO1iB,KAAKqiB,GAAM,EAAIriB,KAAKqiB,GACvCtI,EAAI6G,YAEJ7G,EAAIiJ,QACFjB,EACAC,EACAc,EACAC,EACA,EACA,EACAJ,GAGF5I,EAAIiH,YAEJjH,EAAIkH,UAAYrb,EAAMM,SACtB6T,EAAItZ,QAGNjD,EAAAylB,SAAA,SAAyBlJ,EAA+BmJ,EAAaC,EAAYC,GAC/ErJ,EAAIpU,KAAO,OAAOuB,EAAAtD,KAAK+B,KACvBoU,EAAIkH,UAAY9hB,EAAAoE,MAAMwT,MAAM7Q,SAC5B6T,EAAIsJ,SAASH,EAAKC,EAAIC,6vDCxNxB,IAAAjkB,EAAA/B,EAAA,GAGA6N,EAAA7N,EAAA,GAGAkmB,EAAAlmB,EAAA,IACA8N,EAAA9N,EAAA,GAEAgO,EAAAhO,EAAA,GACAya,EAAAza,EAAA,IAEA8J,EAAA9J,EAAA,GAEAmmB,EAAAnmB,EAAA,IACAoa,EAAApa,EAAA,GACAomB,EAAApmB,EAAA,IACA6J,EAAA7J,EAAA,GAEAqmB,EAAA,SAAA5f,GAoBI,SAAA4f,EACWlE,EACPmE,GAFJ,IAAA3f,EAIIF,EAAAtH,KAAAyH,KACI0f,EAAWzL,EACXyL,EAAWxL,EACXhN,EAAAvD,qBAAqB4X,EAAQ3X,MAC7BsD,EAAAvD,qBAAqB4X,EAAQ3X,MAC7BzI,EAAAoE,MAAM+U,cAETtU,YAVMD,EAAAwb,UAjBXxb,EAAA4f,WAIA5f,EAAA6f,SACA7f,EAAA0U,SAEA1U,EAAA8f,eAEA9f,EAAAmM,SACAnM,EAAA+f,YAEQ/f,EAAAggB,QAA2B,KAEnChgB,EAAAyR,YAA2BgC,EAAAvC,YAAYG,MAyXvCrR,EAAAyU,UAoDOzU,EAAAigB,aAAuB,KAC9BjgB,EAAAoX,eAuBApX,EAAAkgB,UAtbIlgB,EAAKsV,OAAStV,EAAKsV,OAAOnY,OAAO,SAAAoY,GAAS,QAAEA,aAAiBna,EAAAoa,OAAOC,oBAEpEzV,EAAK6V,UAAY,IAAIza,EAAA0a,MAAM9V,EAAKwb,QAAQzhB,KAAM,EAAG,EAAGoJ,EAAAtD,KAAK+B,MACzD5B,EAAK6V,UAAU/T,SAAW9B,EAAKwb,QAAQ3X,OAASsD,EAAAlE,WAAWM,KAAO,EAAI,EACtEvD,EAAK6V,UAAUhU,MAAQzG,EAAAoE,MAAMwT,MAE7BhT,EAAKyK,MAAQ,IAAI0V,MACjBngB,EAAKyK,MAAM2V,OAAS,WAAQpgB,EAAK8f,gBACjC9f,EAAKyK,MAAM4V,IAAM7E,EAAQ/Q,MAqBzBzK,EAAK0V,cAAgBta,EAAAua,cAAcC,QAE/B5V,EAAKwb,QAAQtQ,cACblL,EAAKggB,QAAUR,EAAAc,YAAYllB,EAAAoE,MAAMwT,MAAO5X,EAAAoE,MAAM8J,MAC9CtJ,EAAKggB,QAAQO,cACbvgB,EAAKyM,IAAIzM,EAAKggB,YA4a1B,OA/e4Bxf,EAAAkf,EAAA5f,GAwExBzH,OAAA6B,eAAIwlB,EAAApnB,UAAA,UAAA+B,IAAJ,WAAe,UAAOD,YAAA,EAAAD,cAAA,IAEtB9B,OAAA6B,eAAIwlB,EAAApnB,UAAA,UAAA+B,IAAJ,WAAe,OAAO4F,KAAKuM,IAAI0H,EAAIjU,KAAKqW,WAAa,GAAAlc,YAAA,EAAAD,cAAA,IACrD9B,OAAA6B,eAAIwlB,EAAApnB,UAAA,UAAA+B,IAAJ,WAAe,OAAO4F,KAAKuM,IAAI2H,EAAIlU,KAAKuX,YAAc,GAAApd,YAAA,EAAAD,cAAA,IAEtD9B,OAAA6B,eAAIwlB,EAAApnB,UAAA,WAAA+B,IAAJ,WAAgB,OAAO4F,KAAKkM,MAAQlM,KAAKugB,iBAAmBtZ,EAAA0D,+CAEpD8U,EAAApnB,UAAAkoB,eAAR,WAEI,OADcvgB,KAAKub,QAAQ7Q,SAAOpN,OAAK0C,KAAKmX,YAAYza,IAAI,SAAA7C,GAAK,OAAAA,EAAE6Q,WACtDlP,OAAOyL,EAAA8K,WAAY9K,EAAA0D,gBAGpC8U,EAAApnB,UAAA2e,OAAA,SAAOC,EAAQjB,GAAf,IAAAjW,EAAAC,KACIH,EAAAxH,UAAM2e,OAAMze,KAAAyH,KAACiX,EAAQjB,GACjBhW,KAAKub,QAAQrQ,UAEElL,KAAKoM,SAAS4H,OAAOwM,WAAWC,QACpBC,KAAK,SAAAC,GAAW,OAAA3kB,KAAK4kB,IAAID,EAAQpU,IAAI2H,EAAInU,EAAKwM,IAAI2H,GAAK,OAE9ElU,KAAK2H,QAMjB8X,EAAApnB,UAAAyd,KAAA,SAAKC,EAA+BC,GAChC,GAAIhW,KAAK6f,YAAa,CAClB9J,EAAI2G,OACC1c,KAAKkM,QAAS6J,EAAI8K,YAAc,IACrC9K,EAAI4G,UAAU3c,KAAK8gB,OAAQ9gB,KAAK+gB,QAC5B/gB,KAAKghB,IAAI/M,EAAI,IAEb8B,EAAI4G,UAAU3c,KAAKqW,WAAY,GAC/BN,EAAIkL,OAAO,EAAE,IAEjB,IAAIC,EAAK,EACLlhB,KAAKwR,cAAgBgC,EAAAvC,YAAYC,MACjC6E,EAAIkL,OAAO,EAAE,GACbC,GAAMlhB,KAAKqW,WACXN,EAAIoL,UACAnhB,KAAKwK,MACL0W,EANS,EAUTlhB,KAAKqW,WACLrW,KAAKuX,cAGTxB,EAAIoL,UACAnhB,KAAKwK,MACL0W,EAhBS,EAoBTlhB,KAAKqW,WACLrW,KAAKuX,aAKb,IAAI3d,EAAIuB,EAAAoE,MAAM+U,YAAYuD,QACtB7X,KAAKyU,SACL7a,EAAIuB,EAAAoE,MAAMwT,MAAM8E,SACdhc,EAAI,IAEJmE,KAAK4D,OAASsD,EAAAlE,WAAWM,OAAQtD,KAAKwU,QAAWxU,KAAK4Z,iBACxDhgB,EAAIuB,EAAAoE,MAAMyC,IAAI6V,SACZhc,EAAI,IAGVgY,EAAAoC,SACIF,GACE9B,EAAGiN,EAAIhN,EAtCI,EAsCGC,MAAOnU,KAAKqW,WAAYjC,OAAQpU,KAAKuX,aAErD3d,GAEJmc,EAAIqH,UAGR,IAAIgE,EAAK,IAAIjmB,EAAAga,OAAOnV,KAAK8gB,OAAQ9gB,KAAK+gB,OAAS/gB,KAAKuX,YAAc,GAI9DvX,KAAK4V,UAAUrJ,IAAM6U,EACrBphB,KAAK4V,UAAUE,KAAKC,EAAKC,GAGvB,IAAAqL,EAAAD,EAAAnN,EAAOqN,EAAAF,EAAAlN,EAETqN,EAAOvhB,KAAK4V,UAAU/T,SAC1B7B,KAAK2f,QAAQhhB,QAAQ,SAAC6iB,EAAU9jB,GAC5BqY,EAAIkH,UAAYhW,EAAA+L,WAAWwO,GAAUtf,SACrC6T,EAAI6H,SAASyD,EAJD,EAIkB3jB,EAAO4jB,EAJzB,EAI0CC,EAAME,EAAaA,KAG7E5hB,EAAAxH,UAAMyd,KAAIvd,KAAAyH,KAAC+V,EAAKC,IAIpB5d,OAAA6B,eAAIwlB,EAAApnB,UAAA,QAAA+B,IAAJ,WAAa,OAAO4F,KAAKub,QAAQzhB,sCACjC1B,OAAA6B,eAAIwlB,EAAApnB,UAAA,eAAA+B,IAAJ,WAAoB,OAAO4F,KAAKub,QAAQtR,6CACxC7R,OAAA6B,eAAIwlB,EAAApnB,UAAA,QAAA+B,IAAJ,WAAa,OAAO4F,KAAKub,QAAQ3X,sCACjCxL,OAAA6B,eAAIwlB,EAAApnB,UAAA,aAAA+B,IAAJ,WAAkB,OAAO4F,KAAKub,QAAQjR,2CAEhCmV,EAAApnB,UAAAqpB,SAAN,SAAeC,yGACPA,EAAQC,iBAAiB5hB,KAAKub,QAAQpR,MAAtC,YAAA8B,EAAA,EACgBkG,EAAAnS,KAAKub,QAAQpR,6BAAbsO,EAAAtG,EAAAla,QAAP8gB,EAAG5G,EAAAsG,GACRkJ,EAAQE,KAAK9I,IACb,EAAM4I,EAAQG,YAAY,QAFG,YAE7BxP,EAAAyP,+BAFYtJ,iBAIhBzY,KAAKkM,SAAQlS,EAAAgoB,MAAA,yBAIfvC,EAAApnB,UAAA4pB,SAAN,SAAeN,EAAkBO,mHAC7B,OAAIliB,KAAK4f,QAAU5f,KAAKkM,OACpB,OAGAiW,KAEY,YADZC,EAAKpiB,KAAKsK,WACPC,MAAsC,SAAjB2X,EAAQ3X,MAAhC,MACI8X,EAAiBD,EAEjBT,EAAQW,SAAS5B,KAAK,SAAA6B,GAAM,OAAAF,EAAOG,SAASC,SAASF,MACrDviB,KAAK4f,SACD+B,EAAQC,iBAAiBS,EAAOG,WAChCH,EAAOG,SAAS7jB,QAAQ,SAAA+jB,GAAY,OAAAf,EAAQE,KAAKa,KAC7CC,EAAW3iB,KAAK4iB,qBAAqBP,IACzC,EAAMV,EAAQG,YAAYa,MAH1B,OAFJ,qBAKIxQ,EAAA4P,OACAJ,EAAQkB,MAAMR,EAAOS,UAErBX,MAAS,YAET9f,QAAQ0gB,KAAK,kCAAoCC,SAAUX,EAAOG,SAAUS,IAAKtB,EAAQW,4BAE7FtiB,KAAK4f,SAAQvmB,EAAA2oB,MAAA,mCAEG,UAAZI,EAAG7X,MAAgC,YAAZ6X,EAAG7X,MAAyC,aAAjB2X,EAAQ3X,MAAwC,UAAjB2X,EAAQ3X,MAA1F,MAEH2Y,EAAuDd,EACvDF,GAA4B,aAAjBA,EAAQ3X,MACnBvK,KAAK4f,UACL,EAAM+B,EAAQG,YAAY,QAF1B,oBAEA3P,EAAA4P,OACAI,EAASniB,KAAKmjB,SAASxB,EAASO,GAIhCliB,KAAK4f,UAAQ,YAEe,UAAxBsD,EAAe3Y,MACX6Y,EAAyBF,EACR,UAAjBhB,EAAQ3X,MACRoX,EAAQW,SAAS5B,KAAK,SAAA6B,GAAM,OAAAa,EAAMC,OAAOZ,SAASF,MAC9CviB,KAAK2f,QAAQ1nB,OAAS+H,KAAKsjB,gCAAgCF,KACvDG,EAAM,KACNH,EAAMC,OAAO3C,KAAK,SAAA8C,GAAwC,OAA5BD,EAAM5B,EAAQE,KAAK2B,MAC7CD,IACAvjB,KAAKmM,gBAAgBoX,GAGrBpB,SAMhB9f,QAAQ0gB,KAAK,+BACbZ,MAAS9oB,EAAA2oB,MAAA,mCAGE,cAAZI,EAAG7X,MAAH,OACPvK,KAAK4f,UACLuC,EAASniB,KAAKmjB,SAASxB,EAASO,KAE5B,EAAMP,EAAQG,YAAY,OAD1B,eACA3P,EAAA4P,iCAEJ/hB,KAAK4f,UAAQ,oBACM,YAAZwC,EAAG7X,MAAH,OACPvK,KAAK4f,SACD6D,EAAQzjB,KAAKuM,IAAI0H,EACjByP,EAAkC,EAApBxgB,EAAAtD,KAAK+C,aACvBgf,EAAQgC,MAAM3jB,MACV4jB,EAAO,MAAS5nB,KAAKM,SAAW,IAAO,EAAI,IAC/C,EAAM0D,KAAK6jB,QAAQhH,OAAO7c,KAAKuM,IAAI0H,EAAI2P,EAAM5jB,KAAKuM,IAAI2H,EAAGwP,GAAaI,sBACtE,OADA3R,EAAA4P,QACA,EAAMJ,EAAQG,YAAY,cAE1B,OAFA3P,EAAA4P,OACA/hB,KAAKmM,gBAAgBiW,EAAG2B,UACxB,EAAM/jB,KAAK6jB,QAAQhH,OAAO4G,EAAOzjB,KAAKuM,IAAI2H,EAAGwP,GAAaI,qBAA1D3R,EAAA4P,OACAI,KACAR,EAAQqC,cACRhkB,KAAK4f,SAAQvmB,EAAA2oB,MAAA,WAGjB,SAAOG,SAKX1C,EAAApnB,UAAAirB,gCAAA,SAAgClB,GAC5B,IAAI6B,EAAQjkB,KAAKoM,SAASgK,cACpBpW,KAAKoM,SAASgK,cAAc8N,QAAQC,SACxC,EACF,OAAO/B,EAAG+B,SAAWF,GAGzBxE,EAAApnB,UAAAuqB,qBAAA,SAAqBR,GACjB,IAAI6B,EAAQjkB,KAAKoM,SAASgK,cACvBpW,KAAKoM,SAASgK,cAAc8N,QAAQE,UACpC,EAEH,OAAOpoB,KAAKqoB,MAAMjC,EAAGO,UAAY,EAAEsB,KAI/BxE,EAAApnB,UAAA8qB,SAAR,SAAiBxB,EAAkBO,GAC/B,SAAIA,GAA4B,aAAjBA,EAAQ3X,OACFvK,KAAK2f,QAAQzgB,KAAK,SAAAtE,GAAK,OAAAA,IAAMsnB,EAAQoC,cAElDld,EAAA3J,kBAAkBuC,KAAK2f,QAASuC,EAAQoC,UACxC3C,EAAQkB,MAAMX,EAAQoC,UACtBtkB,KAAKoM,SAAS6M,MAAMiJ,EAAQoC,eAOjC7E,EAAApnB,UAAA6e,WAAP,SAAkBjC,GAAlB,IAAAlV,EAAAC,KACQA,KAAKoM,SAASqL,UAAYzX,KAAKkM,QACK,cAAhClM,KAAKub,QAAQjR,UAAUC,KACnB0K,EAAOjV,KAAKub,QAAQjR,UAAUia,gBAAmB,GAC7CvkB,KAAK2f,QAAQ1nB,OAAS+H,KAAKub,QAAQjR,UAAU6Z,UAC7CnkB,KAAKmM,gBAAgBnM,KAAKub,QAAQjR,UAAUka,WAIb,UAAhCxkB,KAAKub,QAAQjR,UAAUC,MAC1B0K,EAAO,KAAQ,GAEf5W,WAAW,WAAM,OAAA0B,EAAKqM,SAASE,SAASvM,EAAKwM,IAAIC,IAAIzM,EAAKqM,SAASG,OAAO,OAOnFkT,EAAApnB,UAAA8T,gBAAP,SAAuB4M,GACnB/Y,KAAK2f,QAAQxnB,KAAK4gB,GAClB/Y,KAAKoM,SAAS0M,OAAOC,IAGzB0G,EAAApnB,UAAAosB,KAAA,SAAKzQ,EAAgBzH,GAArB,IAAAxM,EAAAC,KACI,YADiBuM,MAAcvM,KAAKuM,KAChCvM,KAAK4D,OAASsD,EAAAlE,WAAWM,KACzB,OAAOtD,KAAK0kB,SAAS1Q,EAAQzH,GAE7BlK,QAAQC,IAAI,6BACZ,IAAIyX,EAAO/F,EAAO6F,OAAOc,sBAAsBpO,EAC3C+S,EAAAqF,cACA,SAAC5K,GAGG,OADiBA,EAAKhG,UAAU6H,SAAS8E,KAAK,SAAA1W,GAAW,OAAAjK,EAAKwb,mBAAmBvR,MAMrF4a,KACAC,EAAW3d,EAAAvD,qBAAqB3D,KAAK4D,MAAQ,EACjD,GAAImW,EAAM,CAEN,IAAI+K,EAAO/K,EAAKgL,YAEhBH,EADQE,EAAK1nB,SAASmP,GACR,EAAIwN,EAAK1D,YAAera,KAAK4kB,IAAIkE,EAAK5Q,EAAI3H,EAAI2H,GAAK,EAAE6F,EAAK1D,WAK5E,GAAIuO,EAAS,CACT5kB,KAAKoM,SAAW2N,EAChB/Z,KAAKuM,IAAMA,EACX,IAAIyY,EAAYH,EAChB7kB,KAAKuM,IAAI0H,GAAK8F,EAAK9F,EACnBjU,KAAKuM,IAAI0H,EAAIjY,KAAKK,MAAM2D,KAAKuM,IAAI0H,EAAI+Q,GAAaA,EAClDhlB,KAAKuM,IAAI0H,GAAK8F,EAAK9F,EACnBjU,KAAKuM,IAAI0H,EAAIjY,KAAKG,IACd4d,EAAK9F,EAAI,EAAE4Q,EACX7kB,KAAKuM,IAAI0H,GAEbjU,KAAKuM,IAAI0H,EAAIjY,KAAKC,IACd8d,EAAK9F,EAAI8F,EAAK1D,WAAawO,EAC3B7kB,KAAKuM,IAAI0H,GAEbjU,KAAKuM,IAAI2H,EAAI6F,EAAKkL,OAAS/d,EAAAvD,qBAAqB3D,KAAK4D,MAAM,OAE3D5D,KAAKuM,IAAMA,EAKf,OAAOqY,GAIRnF,EAAApnB,UAAAuhB,YAAP,eAAA7Z,EAAAC,KACI,OAAIA,KAAKoM,YACIpM,KAAKoM,SAAS4H,OAAO6F,OAAOqL,iBAAiBhmB,KAAK,SAAAmM,GAAU,OAAAA,IAAWtL,GAAQA,EAAKyZ,SAASnO,MAMtGoU,EAAApnB,UAAAmhB,SAAR,SAAiBC,GACb,IAAIC,EAAQ1Z,KAAKkW,OAAQyD,EAAQF,EAAMvD,OAOvC,SALIwD,EAAMzF,EAAI0F,EAAM1F,EAAI0F,EAAMxF,OAC1BuF,EAAMzF,EAAIyF,EAAMvF,MAAQwF,EAAM1F,GAC9ByF,EAAMxF,EAAIyF,EAAMzF,EAAIyF,EAAMvF,QAC1BsF,EAAMxF,EAAIwF,EAAMtF,OAASuF,EAAMzF,IAM/BuL,EAAApnB,UAAA6d,KAAR,WACI,IAAI3J,EAAMvM,KAAKuM,IAAIsL,QAInB,OAHI7X,KAAKwU,QACLjI,EAAI0O,SAASjb,KAAKoM,SAASG,MAG3B0H,EAAG1H,EAAI0H,EACPC,EAAG3H,EAAI2H,EACPC,MAAOnU,KAAKqW,WACZjC,OAAQpU,KAAKuX,cAKbkI,EAAApnB,UAAAqsB,SAAR,SAAiB1Q,EAAgBzH,GAE7B,IAAIwN,EAAO/F,EAAO6F,OAAOc,sBAAsBpO,EAC3C+S,EAAAqF,cACA,SAAC5K,GAAmB,OAAAA,EAAK2B,aAAagF,KAClC,SAACrV,GAAmB,OAAAA,EAAOa,OAASb,EAAO8Z,mBAInD,IAAKpL,EACD,SAIJ,IAAI1O,EAAiBjE,EAAAvK,QACjB0P,EACAwN,EAAK2B,aAAaxe,OAAO,SAACrD,GAAc,OAAAA,EAAEqS,OAASrS,EAAEsrB,iBACrD,SAACtrB,GAAc,OAAAA,EAAE0S,MAGrBvM,KAAKuM,IAAMA,EACX,IAAIqY,KACJ,GAAIvZ,EAAQ,CACR,IAAIyZ,EAAOzZ,EAAO+Z,gBAAgB5Y,IAAInB,EAAOkB,KAAKC,IAAInB,EAAOe,SAASG,MAEtEqY,EADQE,EAAK1nB,SAASmP,GACRtJ,EAAAG,MAAMC,MAAMwD,SAGtB7G,KAAKoM,SAAWf,EAAOe,SACvBpM,KAAKggB,aAAe3U,EACpBrL,KAAKuM,IAAMuY,GAInB,OAAOF,GAKHnF,EAAApnB,UAAA8sB,aAAR,WACI,QAAKnlB,KAAKub,QAAQxQ,WAGP/K,KAAKmX,YAAYlf,OAAS,GAIjCwnB,EAAApnB,UAAA+sB,cAAR,WACI,IAAIC,GAAOrlB,KAAKqW,WAAW,EACvBiP,EAAMtlB,KAAKmX,YAAYlf,OAC3B,OAAO,IAAIkD,EAAAga,OAAOkQ,EAAa,GAANC,GAFY,IAKlC7F,EAAApnB,UAAAktB,cAAP,SAAqBla,GAEjBA,EAAOkB,IAAMvM,KAAKolB,gBAElBplB,KAAKmX,YAAYhf,KAAKkT,GACtBrL,KAAKwM,IAAInB,IAICoU,EAAApnB,UAAAsP,KAAd,kBAAAtN,EAAA2F,UAAA,wBAAAxC,EAAAyO,EAAA1R,EAAAxC,EAAAiC,EAAAK,EAAAT,EAAA,OAAAP,EAAA2G,KAAA,SAAAwlB,GAAA,OAAAA,EAAAxD,OAAA,UAEShiB,KAAKigB,OAAN,gBAAAjmB,KACAgG,KAAKigB,UACDwF,EAAWre,EAAA7K,MAAM6K,EAAAhL,OAAOgL,EAAA7K,MAAM,KAAA0P,EAAA,SACzBI,0DACL,SAAMjF,EAAAnJ,MAAM,oBAAZkU,EAAA4P,QACI2D,EAAS,IAAIlG,EAAAmG,UAASC,EAAOA,EAAKpU,cAAgBgC,EAAAvC,YAAYC,MAAQ,EAAI,IACvEtP,MAAQzG,EAAAoE,MAAMyC,IACrB0jB,EAAOG,UAAU,GACjBH,EAAOI,SAAS,IAChBJ,EAAOzR,GAAK,GACZyR,EAAO1E,IAAI/M,GAAK,IAChByR,EAAOxR,GAAK,GAEZ0R,EAAKG,MAAMvZ,IAAIkZ,GACfA,EAAOM,EAAI,EACXJ,EAAKG,MAAME,SAAS,IAAI9qB,EAAA+qB,MAAM,WAAQR,EAAOS,QAAU,eAAA5rB,EAAAyF,KAAAjI,KAZzC0tB,gEAATpZ,oEAcT,SAAMjF,EAAAnJ,MAAM,cAAZmoB,EAAArE,OACA/hB,KAAKigB,UAASuF,EAAAxD,MAAA,yBAG1BvC,EA/eA,CAA4BtkB,EAAAihB,OAAf5iB,EAAAimB,wFCnBb,IAAAtkB,EAAA/B,EAAA,GACA8J,EAAA9J,EAAA,GAEAI,EAAA6sB,eAAA,SAA+BrE,EAAepgB,kBAAezG,EAAAoE,MAAM2K,WAC/D,IAAIoc,EAAYnlB,SAASC,cAAc,UACvCklB,EAAUjlB,YAAc2gB,EAExBsE,EAAUhlB,MAAME,QAAU,QAC1B8kB,EAAUhlB,MAAMO,SAAW,MAC3BykB,EAAUhlB,MAAMI,WAAawB,EAAAtD,KAAK+B,KAClC2kB,EAAUhlB,MAAMQ,WAAa,MAC7BwkB,EAAUhlB,MAAMG,QAAU,MAC1B6kB,EAAUhlB,MAAM6S,MAAQ,QAExBmS,EAAUhlB,MAAMilB,cAAgB,YAChCD,EAAUhlB,MAAMC,OAAS,OAEzB,IAAI3H,EAAIgI,EAAMiW,QACV2O,EAAK5sB,EAAEqI,OAAO,IAAKiR,WAAW,IAAK2E,QACvC2O,EAAG3qB,EAAI,GACP,IAAI4qB,EAAK7sB,EAAE8Y,QAAQ,IAAKQ,WAAW,IAAK2E,QAYxC,OAXAyO,EAAUhlB,MAAM2a,WAAauK,EAAGtkB,SAChCokB,EAAUhlB,MAAMM,MAAQ6kB,EAAGvkB,SAE3BokB,EAAUI,YAAc,WACpBJ,EAAUhlB,MAAM2a,WAAauK,EAAGG,SAAS,IAAKjU,QAAQ,KAAMxQ,SAC5DokB,EAAUhlB,MAAMM,MAAQ6kB,EAAG/T,QAAQ,IAAKxQ,UAE5CokB,EAAUnkB,aAAe,WACrBmkB,EAAUhlB,MAAM2a,WAAauK,EAAGtkB,SAChCokB,EAAUhlB,MAAMM,MAAQ6kB,EAAGvkB,UAExBokB,GAGX9sB,EAAAotB,eAAA,SAA+B5E,EAAe6E,GAC1C,IAAIP,EAAYnlB,SAASC,cAAc,UACvCklB,EAAUjlB,YAAc2gB,EAExBsE,EAAUhlB,MAAME,QAAU,QAC1B8kB,EAAUhlB,MAAMO,SAAW,MAC3BykB,EAAUhlB,MAAMI,WAAawB,EAAAtD,KAAK+B,KAClC2kB,EAAUhlB,MAAMQ,WAAa,MAC7BwkB,EAAUhlB,MAAMG,QAAU,MAC1B6kB,EAAUhlB,MAAM6S,MAAQ,QAExBmS,EAAUhlB,MAAMilB,cAAgB,YAChCD,EAAUhlB,MAAMC,OAAS,OAEzB,IAAI3H,EAAIitB,IAAWhP,QACf2O,EAAK5sB,EAAEqI,OAAO,IAAKiR,WAAW,IAAK2E,QACvC2O,EAAG3qB,EAAI,GACP,IAAI4qB,EAAK7sB,EAAE8Y,QAAQ,IAAKQ,WAAW,IAAK2E,QAsBxC,OArBAyO,EAAUhlB,MAAM2a,WAAauK,EAAGtkB,SAChCokB,EAAUhlB,MAAMM,MAAQ6kB,EAAGvkB,SAE3BokB,EAAUI,YAAc,WACpB,IAAI9sB,EAAIitB,IAAWhP,QACf2O,EAAK5sB,EAAEqI,OAAO,IAAKiR,WAAW,IAAK2E,QACvC2O,EAAG3qB,EAAI,GACP,IAAI4qB,EAAK7sB,EAAE8Y,QAAQ,IAAKQ,WAAW,IAAK2E,QAExCyO,EAAUhlB,MAAM2a,WAAauK,EAAGtkB,SAChCokB,EAAUhlB,MAAMM,MAAQ6kB,EAAGvkB,UAE/BokB,EAAUnkB,aAAe,WACrB,IAAIvI,EAAIitB,IAAWhP,QACf2O,EAAK5sB,EAAEqI,OAAO,IAAKiR,WAAW,IAAK2E,QACvC2O,EAAG3qB,EAAI,GACP,IAAI4qB,EAAK7sB,EAAE8Y,QAAQ,IAAKQ,WAAW,IAAK2E,QAExCyO,EAAUhlB,MAAM2a,WAAauK,EAAGtkB,SAChCokB,EAAUhlB,MAAMM,MAAQ6kB,EAAGvkB,UAExBokB,kFC1EX,IAAAnrB,EAAA/B,EAAA,GACA8J,EAAA9J,EAAA,GAEA0tB,EAAA,WAUI,SAAAA,EAAsBhtB,EAAsBma,EAAmBC,GAA/D,IAAAnU,EAAAC,KAAsBA,KAAAlG,OAAsBkG,KAAAiU,IAAmBjU,KAAAkU,IAP/DlU,KAAA+mB,YACA/mB,KAAA4jB,KAAe,EACf5jB,KAAAuhB,KAAe,EA2EPvhB,KAAAgnB,UAAY,SAACxpB,GACbA,EAAEypB,SAAWlnB,EAAKyC,QAElBzC,EAAKmnB,SAAW1pB,EAAE2pB,QAAUpnB,EAAK6jB,KACjC7jB,EAAKqnB,SAAW5pB,EAAE6pB,QAAUtnB,EAAKwhB,KACjCxhB,EAAKgnB,cAIL/mB,KAAAsnB,KAAO,SAAC9pB,GACZ,GAAIuC,EAAKgnB,SAAU,CACfvpB,EAAE+pB,iBAEF,IAAIC,EAAWhqB,EAAE2pB,QAAUpnB,EAAKmnB,SAC5BO,EAAWjqB,EAAE6pB,QAAUtnB,EAAKqnB,SAChCrnB,EAAK6jB,KAAO4D,EACZznB,EAAKwhB,KAAOkG,IAKZznB,KAAA0nB,QAAU,SAAClqB,GACXuC,EAAKgnB,WAELhnB,EAAKgnB,cA7FT/mB,KAAK2nB,kBAmGb,OA/FIb,EAAAzuB,UAAAwS,KAAA,WACI7K,KAAK4nB,SAAStmB,MAAME,QAAU,QAGlCslB,EAAAzuB,UAAAwvB,KAAA,WACI7nB,KAAK4nB,SAAStmB,MAAME,QAAU,QAGxBslB,EAAAzuB,UAAAsvB,gBAAV,eAAA5nB,EAAAC,KAkBI,GAjBIA,KAAK4nB,UACL5nB,KAAK4nB,SAASE,cAAcC,YAAY/nB,KAAK4nB,UAIjD5nB,KAAK4nB,SAAWzmB,SAASC,cAAc,OACvCpB,KAAK4nB,SAAStmB,MAAMwV,SAAW,WAC/B9W,KAAK4nB,SAAStmB,MAAME,QAAU,OAC9BxB,KAAK4nB,SAAStmB,MAAM0mB,SAAW,OAC/BhoB,KAAK4nB,SAAStmB,MAAM6S,MAAQ,QAC5BnU,KAAK4nB,SAAStmB,MAAMC,OAAS,OAI7BJ,SAAS8mB,KAAKC,YAAYloB,KAAK4nB,UAG3B5nB,KAAKlG,KAAM,CACX,IAAIquB,EAAYhnB,SAASC,cAAc,OACvC+mB,EAAU7mB,MAAM6S,MAAQ,QAGxBgU,EAAU7mB,MAAMlB,gBAAkBjF,EAAAoE,MAAMgK,OAAOtH,OAAO,KAAMC,SAE5DlC,KAAKwC,MAAQrB,SAASC,cAAc,OACpCpB,KAAKwC,MAAMnB,YAAcrB,KAAKlG,KAC9BkG,KAAKwC,MAAMlB,MAAMI,WAAawB,EAAAtD,KAAK+B,KACnC3B,KAAKwC,MAAMlB,MAAMC,OAAS,OAC1BvB,KAAKwC,MAAMlB,MAAMO,SAAW,MAC5B7B,KAAKwC,MAAMlB,MAAMQ,WAAa,MAC9B9B,KAAKwC,MAAMlB,MAAMM,MAAQzG,EAAAoE,MAAMwT,MAAM7Q,SACrClC,KAAKwC,MAAMlB,MAAMG,QAAU,MAC3BzB,KAAKwC,MAAMlB,MAAM8mB,OAAS,MAE1BD,EAAUD,YAAYloB,KAAKwC,OAC3BxC,KAAK4nB,SAASM,YACVC,GAIJhnB,SAASknB,iBAAiB,cAAe,SAAC7qB,GAAQuC,EAAKinB,UAAUxpB,QACjE2D,SAASknB,iBAAiB,YAAa,SAAC7qB,GAAQuC,EAAK2nB,QAAQlqB,QAC7D2D,SAASknB,iBAAiB,cAAe,SAAC7qB,GAAQuC,EAAKunB,KAAK9pB,UAMpEspB,EAAAzuB,UAAAyd,KAAA,SAAKC,GACD,GAAI/V,KAAK4nB,SAAU,CACf,IAAIU,EAAOvS,EAAIwS,OAAOC,WAClBC,EAAM1S,EAAIwS,OAAOG,UACrB1oB,KAAK4nB,SAAStmB,MAAMgnB,KAAUA,EAAOtoB,KAAKiU,EAAIjU,KAAK4jB,KAAI,KACvD5jB,KAAK4nB,SAAStmB,MAAMqnB,IAASF,EAAMzoB,KAAKkU,EAAIlU,KAAKuhB,KAAI,OAiCjEuF,EA9GA,GAAattB,EAAAstB,o7CCAb,IAAA1f,EAAAhO,EAAA,GAEAwvB,EAAAxvB,EAAA,IAGAyvB,EAAA,WAGI,SAAAA,EAAsBC,GAAA9oB,KAAA8oB,OAFd9oB,KAAA+oB,cAAwB,IACtB/oB,KAAAyX,YAiMd,OA1LIrf,OAAA6B,eAAc4uB,EAAAxwB,UAAA,UAAA+B,IAAd,WAAiC,OAAO4F,KAAK8oB,KAAKE,+CAClD5wB,OAAA6B,eAAc4uB,EAAAxwB,UAAA,WAAA+B,IAAd,WAAoC,OAAO4F,KAAKgU,OAAO6F,OAAOoP,sDAC9D7wB,OAAA6B,eAAc4uB,EAAAxwB,UAAA,cAAA+B,IAAd,WAAoD,OAAO4F,KAAK8U,QAAQpY,IAAI,SAAA7C,GAAK,OAAAA,EAAEyQ,6CACnFlS,OAAA6B,eAAc4uB,EAAAxwB,UAAA,WAAA+B,IAAd,WACI,IAAI8uB,KAMJ,OALAlpB,KAAKmpB,WAAWxqB,QAAQ,SAAAyjB,GACJ,WAAZA,EAAG7X,MACH2e,EAAQ/wB,KAAKiqB,KAGd8G,mCAGX9wB,OAAA6B,eAAc4uB,EAAAxwB,UAAA,aAAA+B,IAAd,WACI,IAAIgvB,KAMJ,OALAppB,KAAKmpB,WAAWxqB,QAAQ,SAAAyjB,GACJ,YAAZA,EAAG7X,MACH6e,EAASjxB,KAAKiqB,KAGfgH,mCAILP,EAAAxwB,UAAAgxB,QAAN,kBAAAtxB,EAAAiI,UAAA,2BAAAhG,EAAAgG,KAAA,SAAAxC,GAAA,OAAAA,EAAAwkB,OAAA,OACI,OAAIhiB,KAAKyX,UACL,GAECzX,KAAKyX,UAAN,MACAzX,KAAKyX,aAEL,EAAMzX,KAAKpH,iBAAXuZ,EAAA4P,OACA/hB,KAAKyX,YAAWja,EAAAwkB,MAAA,yBAOR6G,EAAAxwB,UAAAixB,MAAhB,kBAAAvxB,EAAAiI,UAAA,2BAAAhG,EAAAgG,KAAA,SAAAxC,GAAA,OAAAA,EAAAwkB,OAAA,OACI,SAAM5a,EAAAnJ,MAAM+B,KAAK+oB,8BAAjB5W,EAAA4P,iBAGY8G,EAAAxwB,UAAAkxB,YAAhB,SAA4BxQ,oHACpByQ,KACAC,EAAwB,SAAC5vB,GAAc,MAAsB,cAArBA,EAAEyQ,UAAUC,MACpD1Q,EAAE8lB,QAAQe,KAAK,SAAA8C,GAAU,OAAAzK,IAAQyK,KACjCkG,EAAc1pB,KAAKgU,OAAO6F,OAAO8P,oBAAoB3pB,KAAK8oB,KAAKvc,OAASkd,GAExEG,EAAqB,SAAC/vB,GAAc,MAAsB,UAArBA,EAAEyQ,UAAUC,MAC/C1Q,EAAE8lB,QAAQe,KAAK,SAAA8C,GAAU,OAAAzK,IAAQyK,KACnC/Z,EAAgBzJ,KAAKgU,OAAO6F,OAAO8P,oBAAoB3pB,KAAK8oB,KAAKvc,OAASqd,IAE1Eve,EAAiBqe,GAAOjgB,IAIxB,EAAMzJ,KAAK6pB,YAAYxe,KAFvB,eAEA8G,EAAA4P,QAEI1W,EAAOuU,MAAP,YAEIkK,EAAY,EAAA9vB,EAAAgoB,MAAA,gBACT3W,EAAOuU,OACV,EAAM5f,KAAKspB,UADI,YAEf,OADAnX,EAAA4P,OACI+H,IAAc,IACd,OAAO,YAKf,SAAMze,EAAO4W,SAASjiB,KAAK8oB,KAAMF,EAAAmB,iBAAiBhR,mBAAlD5G,EAAA4P,SACAyH,OAAW,YAGfnnB,QAAQ0gB,KAAK,oBAAA/oB,EAAAgoB,MAAA,SASjB,SAAOwH,SAGKX,EAAAxwB,UAAAwxB,YAAhB,SAA4Bxe,2FACxB,SAAMrL,KAAK8oB,KAAKkB,MAAM3e,kBAAtB8G,EAAA4P,iBAGY8G,EAAAxwB,UAAA4xB,gBAAhB,SAAgCC,4GACxBC,EAAW,SAACtwB,GAAc,OAAAA,EAAEyQ,YAAc4f,IAAcrwB,EAAEimB,UAC1DsK,EAAUpqB,KAAKgU,OAAO6F,OAAO8P,oBAAoB3pB,KAAK8oB,KAAKvc,OAAS4d,GACpEE,KACAD,GACAA,EAAQtK,aACJ,EAAM9f,KAAK2jB,MAAMyG,EAASF,MAF9B,YAEI/X,EAAA4P,SACAsI,MAGJD,EAAQtK,YAAW9lB,EAAAgoB,MAAA,SAEvB,SAAOqI,SAGGxB,EAAAxwB,UAAAsrB,MAAd,SAAoByG,EAAiBF,oGAC7BI,KACCF,EAAQ7O,QAAQzQ,UAAjB,YACA,MAAM,IAAI2G,MAAM,yDAEhB,SAAMzR,KAAK6pB,YAAYO,WACnB,OADJjY,EAAA4P,QACI,EAAMqI,EAAQnI,SAASjiB,KAAK8oB,KAAMF,EAAAjF,wBAAlCxR,EAAA4P,QACI,EAAMqI,EAAQnI,SAASjiB,KAAK8oB,KAAMF,EAAAmB,iBAAiBG,EAAUnG,YADjE,YACI5R,EAAA4P,SACAuI,MAASvyB,EAAAiqB,MAAA,SAIrB,SAAOsI,SAGKzB,EAAAxwB,UAAAkyB,WAAhB,SAA2B3gB,4GACvBvH,QAAQmoB,MAAM,kBAAoB7K,QAAS/V,EAAOkZ,WAC9C2H,EAAc,SAAC5wB,GAAc,OAAAA,EAAEyQ,YAAcV,IAAW/P,EAAEimB,UAC1D4K,EAAQ1qB,KAAKgU,OAAO6F,OAAO8P,oBAAoB3pB,KAAK8oB,KAAKvc,OAASke,GAClEE,KACAD,GACAA,EAAM5K,aAEF,EAAM9f,KAAK4qB,kBAAkBhhB,EAAO4Y,aAHxC,mBAGIrQ,EAAA4P,QACA,EAAM/hB,KAAK6pB,YAAYa,KADvB,YAEI,OADJvY,EAAA4P,QACI,EAAM/hB,KAAK6qB,kBAAkBH,EAAO9gB,WAApCuI,EAAA4P,SACA4I,MAAO3wB,EAAAgoB,MAAA,SAGf0I,EAAM5K,YAAW9lB,EAAAgoB,MAAA,SAKrB,SAAO2I,SAGK9B,EAAAxwB,UAAAuyB,kBAAhB,SAAkCE,4GACzB9qB,KAAK8oB,KAAKlH,iBAAiBkJ,GAA5B,YACAzoB,QAAQmoB,MAAM,uBAAAve,EAAA,EACS8e,EAAAD,wBAAArS,EAAAsS,EAAA9yB,QAAM,YAApB+yB,EAAUD,EAAAtS,GACXwS,EAAQ,EACRzB,KAAWxvB,EAAAgoB,MAAA,gBACPwH,GAAYyB,EAAQ,IACxBA,GAAS,GACL,EAAMjrB,KAAKupB,YAAYyB,MAFD,mBAEtB7Y,EAAA4P,QACAyH,MAAW,OADX,YAGA,SAAMxpB,KAAKspB,gBAAXnX,EAAA4P,2CAIR,IAAKyH,EAED,OADAnnB,QAAQ0gB,KAAK,6CACb,MAAO/oB,EAAAgoB,MAAA,gBAdQvJ,iBAsB3B,mBAGYoQ,EAAAxwB,UAAAwyB,kBAAhB,SAAkCH,EAAe9gB,EAAgBshB,yBAAA,GAAAnzB,EAAAiI,UAAA,wBAAAjI,EAAAsC,EAAA,OAAAL,EAAAgG,KAAA,SAAAhG,GAAA,OAAAA,EAAAgoB,OAAA,OAEhD,OADb3f,QAAQmoB,MAAM,iCAAmC1H,SAAUlZ,EAAOkZ,YACrD,EAAM4H,EAAMzI,SAASjiB,KAAK8oB,MAAQve,KAAM,OAAQX,OAAMA,eAA/DuY,EAAShQ,EAAA4P,OACT,YAEA1f,QAAQ0gB,KAAK,8CACJhrB,EAAI,EAAAiC,EAAAgoB,MAAA,gBAAGjqB,EAAImzB,GAChB,EAAMlrB,KAAKspB,UADmB,YAE1B,OADJnX,EAAA4P,QACI,EAAM/hB,KAAK6qB,kBAAkBH,EAAO9gB,WAAxC,GAAIuI,EAAA4P,OAEA,OADAI,MACA,KAAAnoB,EAAAgoB,MAAA,gBAJ4BjqB,iBAQxC,SAAOoqB,SAEf0G,EAnMA,GAAsBrvB,EAAAqvB,owDCRtB,IAAA1tB,EAAA/B,EAAA,GAGA6N,EAAA7N,EAAA,GACA8J,EAAA9J,EAAA,GACAgO,EAAAhO,EAAA,GAEA6J,EAAA7J,EAAA,GAEA+xB,EAAA/xB,EAAA,IACAya,EAAAza,EAAA,IAEAgyB,EAAAhyB,EAAA,IAEAiyB,EAAAjyB,EAAA,IAEAkyB,EAAAlyB,EAAA,IACA8N,EAAA9N,EAAA,GAEAmyB,EAAAnyB,EAAA,IAEAomB,EAAApmB,EAAA,IAGAmmB,EAAAnmB,EAAA,IAEAoyB,EAAApyB,EAAA,IAQAqyB,EAAA,SAAA5rB,GAuCI,SAAA4rB,EACW3xB,EACP4xB,EACU1X,EACF2X,sBAJZ,IAAA5rB,EAMIF,EAAAtH,KAAAyH,KACI0rB,EAAKzX,EAAGyX,EAAKxX,EACbyX,EAAQC,MAAc,EAAI1oB,EAAAtD,KAAK8C,WAAa,EAA3B,EAAkC,EAAIQ,EAAAtD,KAAK8C,WAAa,EACzEipB,EAAQC,MAAS,EAAI1oB,EAAAtD,KAAK8C,WAAcQ,EAAAtD,KAAK8C,aAEhD1C,KAVMD,EAAAjG,OAEGiG,EAAAiU,SACFjU,EAAA4rB,UA1CZ5rB,EAAA8rB,SACA9rB,EAAA+rB,cACA/rB,EAAAuiB,YACAviB,EAAAuc,QAEQvc,EAAAgsB,gBAEAhsB,EAAAisB,kBAIAjsB,EAAAksB,YAQRlsB,EAAAmsB,OAAiB,EACjBnsB,EAAAosB,OAAiB,IACjBpsB,EAAAqsB,OAAiB,IACjBrsB,EAAAssB,UAAoB,IAEZtsB,EAAAusB,QAAkB,KAU1BvsB,EAAA0U,SAEQ1U,EAAAwsB,aA0SRxsB,EAAAysB,gBAA4B,KAyD5BzsB,EAAA0sB,WAAuB,KA2Bf1sB,EAAA2sB,WAAsB,KAoBtB3sB,EAAA4sB,SAAmB3wB,KAAKK,MAAwB,GAAlB6G,EAAAtD,KAAK8C,YAsB3C3C,EAAA6sB,mBAA6C,EAAhB7sB,EAAK4sB,SAClC5sB,EAAA8sB,kBAAsD,EAA1B9sB,EAAK6sB,mBA6CjC7sB,EAAAkgB,UAsBAlgB,EAAA+sB,YA7dI/sB,EAAKssB,UAAYV,EAAQC,MAAQ,IAAM,IACvC7rB,EAAKqsB,OAASrsB,EAAKssB,UAEnBtsB,EAAKsV,OAAStV,EAAKsV,OAAOnY,OAAO,SAAAoY,GAAS,QAAEA,aAAiBna,EAAAoa,OAAOC,oBAEpEzV,EAAKgtB,mBAAqB,IAAI5B,EAAA6B,wBAAwBjtB,GACtDA,EAAKktB,qBAAuB,IAAI7B,EAAA8B,0BAA0BntB,GAC1DA,EAAKotB,iBAAmB,IAAI9B,EAAA+B,uBAAuBrtB,GACnDA,EAAKstB,eAAiB,IAAI/B,EAAAgC,yBAAyBvtB,GACnDA,EAAKwtB,iBAAmB,IAAIhC,EAAAiC,6BAA6BztB,GAEzD,IAAI0tB,EAAc1tB,EAAK4rB,QAAQxS,MAAQqS,EAAAkC,OAAOC,QAAUnC,EAAAkC,OAAOE,UAE3D7tB,EAAK8tB,SACLJ,EAAcjC,EAAAkC,OAAOI,SAASpxB,IAAI,SAAA9C,GAAK,OAAAA,EAAEie,QAAQ5V,OAAO,QAG5DlC,EAAKguB,WAAa3mB,EAAAhL,OAAOqxB,GAAa5V,QAAQ3E,WAAW,KAAMR,QAAQ,KAEvE,IAAIsb,EAAQhyB,KAAKM,SAAW,IAExB2xB,EAAcD,GAAU7yB,EAAAoE,MAAM6J,MAAM8J,WAAW,IAAM/X,EAAAoE,MAAM8J,KAAK6J,WAAW,IAAKR,QAAQ,MAASvX,EAAAoE,MAAM+J,QAE3GvJ,EAAKmuB,UAAY9mB,EAAAhL,OAAO6xB,GAAYvb,QAAQ,IAa5C3S,EAAKouB,OAAS/mB,EAAAhL,OAAOgL,EAAA7K,MAAM,IAE3BwD,EAAK0V,cAAgBta,EAAAua,cAAcC,QACnC,IAAIyY,EAAaJ,EAAQ7yB,EAAAoE,MAAM6J,MAAQjO,EAAAoE,MAAMyC,WAC7CjC,EAAKsuB,aAAe9O,EAAAc,YAAY+N,EAAYA,EAAWnsB,OAAO,KAC9DlC,EAAKyM,IAAIzM,EAAKsuB,gBAkftB,OA/kB6B9tB,EAAAkrB,EAAA5rB,GA4GzBzH,OAAA6B,eAAIwxB,EAAApzB,UAAA,SAAA+B,IAAJ,WAEI,OADY4F,KAAK2rB,QAAQxS,MAAQ,SAAW,IAAAhf,YAAA,EAAAD,cAAA,IAIhD9B,OAAA6B,eAAIwxB,EAAApzB,UAAA,YAAA+B,IAAJ,WAAiB,OAAO4F,KAAKksB,OAAS,IAAA/xB,YAAA,EAAAD,cAAA,IACtC9B,OAAA6B,eAAIwxB,EAAApzB,UAAA,WAAA+B,IAAJ,WAAiB,OAAO4F,KAAKmsB,OAAS,IAAAhyB,YAAA,EAAAD,cAAA,IAEtC9B,OAAA6B,eAAIwxB,EAAApzB,UAAA,iBAAA+B,IAAJ,WAAsB,OAAO4F,KAAKgU,wCAElC5b,OAAA6B,eAAIwxB,EAAApzB,UAAA,aAAA+B,IAAJ,WACI,IAAIk0B,EAAkBtuB,KAAKgU,OAAOua,YAAcvuB,KAAK2rB,QAAQxS,MAAQ,IAAM,GAC3E,OAAOjW,EAAAtD,KAAK+C,aAAe2rB,mCAG/Bl2B,OAAA6B,eAAIwxB,EAAApzB,UAAA,UAAA+B,IAAJ,WAAwB,QAAS4F,KAAK2rB,QAAQ6C,sCAE9Cp2B,OAAA6B,eAAIwxB,EAAApzB,UAAA,eAAA+B,IAAJ,WAAoB,OAAO4F,KAAK6tB,OAAS,aAAe,eAAA1zB,YAAA,EAAAD,cAAA,IAExDuxB,EAAApzB,UAAA2e,OAAA,SAAOC,EAAQjB,GAGX,GAFAnW,EAAAxH,UAAM2e,OAAMze,KAAAyH,KAACiX,EAAQjB,GAEjBhW,KAAKgsB,eAAgB,CACrB,IAAIyC,OAAWC,MAAQC,UACvB3uB,KAAK4uB,SACH5yB,KAAKC,KACAwyB,EAAMzuB,KAAK6uB,aAAe7uB,KAAK8uB,aAChC,GAGN9uB,KAAK+uB,eACE/uB,KAAKsc,KAAKrkB,OAAS,GAG1B+H,KAAKgvB,OAGLhvB,KAAKssB,UACLtsB,KAAKuM,IAAMvM,KAAKssB,QAAQ/f,IAAIC,IAAIxM,KAAKssB,QAAQlgB,SAASG,MAGtDvM,KAAK0sB,aAAe1sB,KAAK0sB,WAAWb,QACpC7rB,KAAK0sB,WAAa,MAGlB1sB,KAAKisB,WACLjsB,KAAKosB,OAASpwB,KAAKC,IAAI+D,KAAKqsB,UAAWrsB,KAAKosB,OAAO,IACnDpsB,KAAKmsB,OAASnwB,KAAKC,IAAI,IAAK+D,KAAKmsB,OAAO,KAexClV,EAAO3W,UACPN,KAAKusB,aAELvsB,KAAKusB,cAKbd,EAAApzB,UAAAyd,KAAA,SAAKC,EAA+BC,GAE5B,IAAE/B,EAAFjU,KAAEiU,EAAGC,EAALlU,KAAKkU,EAIT,GAHA6B,EAAI2G,OAEJ3G,EAAI4G,UAAU1I,EAAGC,GACblU,KAAK6rB,MAAO,CACZ,IAAI3K,GAAMlhB,KAAKqW,WAAY4Y,GAAMjvB,KAAKuX,YAAY,EAAItU,EAAAG,MAAMC,MAAMW,MAAQ,EAQ1E,GAPIhE,KAAKyU,QACLZ,EAAAoC,SAASF,GAAO9B,EAAGiN,EAAK,EAAGhN,EAAG+a,EAAK,GAAI9a,MAAO,GAAuB,EAAlBnU,KAAKqW,WAAgBjC,OAAQ,IAC5EjZ,EAAAoE,MAAMsT,SAASgF,QAAQ5V,OAAO,KAElC4R,EAAAoL,SAASlJ,EAAK/V,KAAKlG,KAAMonB,EAAI+N,EAAK,IAGlCjvB,KAAKosB,OAASpsB,KAAKqsB,UAAW,CAC9B,IAAI6C,EAAQlvB,KAAKosB,OAASpsB,KAAKqsB,UAC3B8C,EAAcD,EAAQ,IAAO/zB,EAAAoE,MAAM6J,MAAQjO,EAAAoE,MAAMiK,OACjD0lB,EAAQ,MACRC,EAAcD,EAAQ,GAAM/zB,EAAAoE,MAAMyC,IAAM7G,EAAAoE,MAAM+J,QAElDtJ,KAAKovB,QAAQrZ,EAAKmL,EAAG,EAAG+N,EAAG,EAAmB,EAAhBjvB,KAAKqW,WAAc,EAAG6Y,EAAOC,GAG/D,GAAInvB,KAAK8sB,SAAU,CACf,IAAIlzB,EAAIuB,EAAAoE,MAAM8vB,KAAKxX,QACnBje,EAAEiC,EAAI,GACNgY,EAAA2K,WAAWzI,EAAK,EAAG,EAAG,GAAInc,IAsBlC,IAlBIoG,KAAKisB,UAAajsB,KAAK6rB,QACvB9V,EAAIuZ,QAAQtzB,KAAKqiB,GAAK,GAClBre,KAAKisB,SACLlW,EAAI4G,UAAU,GAAI,IAElB5G,EAAI4G,WAAW,GAAI,IAG3B3c,KAAKuvB,SAASxZ,GACV/V,KAAKsiB,UAELtiB,KAAKsiB,SAAS3jB,QAAQ,SAAC6wB,EAAS5yB,GAC5BmZ,EAAIkH,UAAYhW,EAAA+L,WAAWwc,GAAS3X,QAAQ8O,SAAS,IAAKzkB,SAC1D6T,EAAI6H,SAHC,EAGY,EAAI,EAAIhhB,EAAK,EAAG,KAGzCmZ,EAAIqH,UAEApd,KAAKgsB,eAAgB,CACrBjW,EAAIuH,UAAY,EAChB,IAAImS,EAAKzvB,KAAKqW,WACVqZ,EAAK1vB,KAAKiU,EAAIwb,EAAG,EAAGE,EAAK3vB,KAAKkU,EAAI,GACtClU,KAAKovB,QAAQrZ,EAAK2Z,EAAIC,EAAIF,EAFK,EAEGzvB,KAAK4uB,UAG3C,GAAI5uB,KAAKsc,MAAQtc,KAAKusB,UAAW,CAC7B,IAAIqD,EAAIz0B,EAAAoE,MAAMwT,MAAM8E,QAEpBzQ,EAAAxJ,SAASoC,KAAKsc,KAAM,GAAG3d,QAAQ,SAACwT,OAACtW,EAAAsW,EAAA,GAAEnU,EAAAmU,EAAA,GAC/B0B,EAAAwJ,SAAStH,EAAKla,EAAEmC,EAAE4xB,EAAE,MAKxB5vB,KAAK0sB,WAUT7sB,EAAAxH,UAAMyd,KAAIvd,KAAAyH,KAAC+V,EAAKC,IAGZyV,EAAApzB,UAAA+2B,QAAR,SAAgBrZ,EAA+B2Z,EAAYC,EAAYF,EAAYI,EAAYjB,EAAkBhtB,kBAAezG,EAAAoE,MAAMgK,QAClI,IAAI3P,EAAIgI,EAAMiW,QACd9B,EAAImH,YAAc/hB,EAAAoE,MAAMwT,MAAM7Q,SAC9B6T,EAAI+Z,WAAWJ,EAAIC,EAAIF,EAAII,GAC3B9Z,EAAIkH,UAAYrjB,EAAEqI,OAAO,IAAKC,SAC9B6T,EAAI6H,SAAS8R,EAAIC,EAAIF,EAAII,GACzB9Z,EAAIkH,UAAYrjB,EAAEsI,SAClB6T,EAAI6H,SAAS8R,EAAIC,EAAIf,EAAWa,EAAII,IAIhCpE,EAAApzB,UAAAk3B,SAAR,SAAiBxZ,GACb,IAAIga,EAAY/vB,KAAKqW,WAAW,EAC5B2Z,EAAahwB,KAAKuX,YAAY,EAE9B0Y,EAAQjwB,KAAK+tB,WAAWlW,QAC5BhE,EAAAgL,YACI9I,EACA,EAAiB,IAAbia,EACJD,EAAY/vB,KAAKmuB,OACH,GAAb6B,EACDC,GAIJ,IAAIC,EAAOlwB,KAAKkuB,UAAUrW,QACtBsY,EAAyB,IAAZJ,EACjBlc,EAAA2K,WACIzI,EACA,EAAiBoa,EAAW,EAAxBH,EACJG,EAEAD,GAGAlwB,KAAK2rB,QAAQxS,OACbtF,EAAAiK,SAAS/H,EAAK,IAAK,IAIrB0V,EAAApzB,UAAAypB,YAAN,SAAkBsO,2FAId,OAHApwB,KAAKgsB,kBACLhsB,KAAK6uB,iBAAmBH,MAAQC,UAChC3uB,KAAK8uB,aAAesB,GACpB,EAAM,IAAIjyB,QAAQ,SAACC,EAASiyB,GAAW,OAAAhyB,WAAWD,EAASgyB,oBAA3Dje,EAAA4P,OACA/hB,KAAKgsB,mBAAiB,SAG1BP,EAAApzB,UAAAsrB,MAAA,SAAM9pB,GACFmG,KAAKssB,QAAUzyB,EACfmG,KAAKgmB,GAAK,GAGdyF,EAAApzB,UAAA2rB,YAAA,WACIhkB,KAAKssB,QAAU,KACftsB,KAAKgmB,EAAI,GAGb5tB,OAAA6B,eAAIwxB,EAAApzB,UAAA,aAAA+B,IAAJ,WAA2B,QAAS4F,KAAKssB,yCAEzCb,EAAApzB,UAAAwqB,MAAA,SAAMjpB,GACFoG,KAAKsiB,SAASnqB,KAAKyB,IAGvB6xB,EAAApzB,UAAAupB,iBAAA,SAAiB0O,GAEb,OADiBlpB,EAAAxI,aAAaoB,KAAKsiB,SAAUgO,IAIjD7E,EAAApzB,UAAAwpB,KAAA,SAAK9I,GACD,OAAI/Y,KAAKsiB,SAASrqB,OAAS,GACnB+H,KAAKsiB,SAASpjB,KAAK,SAAA7E,GAAK,OAAAA,IAAM0e,KAC9B3R,EAAA3J,kBAAkBuC,KAAKsiB,SAAUvJ,GAC1BA,GAGR,MAIL0S,EAAApzB,UAAA2xB,MAAN,SAAY3e,wGACJ4b,EAASjnB,KAAKuwB,gBAAgBllB,IACvBjO,SAAS4C,KAAKuM,KAAOtJ,EAAAG,MAAMC,MAAMW,OACxC,EAAMhE,KAAKwwB,OAAOvJ,KADlB,YACA9U,EAAA4P,wBAEJ,SAAM/hB,KAAKywB,QAAQxJ,kBAAnB9U,EAAA4P,OACA/hB,KAAKwsB,gBAAkBnhB,EAAOe,mBAG5Bqf,EAAApzB,UAAAm4B,OAAN,SAAajkB,iGAGT,OAFM+P,EAAOtc,KAAKgU,OAAO0c,kBAAkB1wB,KAAKuM,IAAIsL,QAAStL,IAE7D,EAAMvM,KAAK2wB,WAAWrU,kBAAtBnK,EAAA4P,iBAGI0J,EAAApzB,UAAAk4B,gBAAR,SAAwBllB,GACpB,IAAI4b,EAAS5b,EAAOkB,IAAIC,IAAInB,EAAOe,SAASG,KAQ5C,OAPIlB,EAAO2U,eACPiH,EAAU5b,EAAO2U,aAAgBzT,IAAEC,IAAInB,EAAOe,SAASG,MAChD0H,GAAK5I,EAAOkB,IAAI0H,EACvBgT,EAAO/S,GAAKhN,EAAAvD,qBAAqB0H,EAAO2U,aAAapc,MAAQ,GAE7DqjB,EAAO/S,GAAKhN,EAAAvD,qBAAqB0H,EAAOzH,MAAQ,EAE7CqjB,GAGLwE,EAAApzB,UAAAo4B,QAAN,SAAclkB,kGACNA,GACA,EAAMvM,KAAK6jB,QAAQhH,OAAOtQ,EAAI0H,EAAG1H,EAAI2H,EAAGlU,KAAK4wB,WAAW9M,cADxD,YACA3R,EAAA4P,wCAIF0J,EAAApzB,UAAAs4B,WAAN,SAAiBrU,sFACTA,EAAKrkB,OAAS,IACd+H,KAAKsc,KAAOA,EAAK5f,IAAI,SAAAm0B,GAAK,OAAAA,EAAE7V,IAAI,IAAI7f,EAAAga,OAAO,EAAElS,EAAAG,MAAMC,MAAMS,WAIrD9D,KAAKsc,KAAK3d,QAAQ,SAAMsW,GAAI,OAAA6b,EAAA/wB,cAAA,oBAAAgxB,EAAA/wB,KAAA,SAAAmS,0BAAI,SAAMnS,KAAKywB,QAAQxb,WAAnB,SAAA9C,EAAA4P,eAEpC/hB,KAAKsc,kBAIblkB,OAAA6B,eAAcwxB,EAAApzB,UAAA,cAAA+B,IAAd,WACU,IAAAo0B,EAAAxuB,KAAA2rB,QAAA6C,KACN,OACIxuB,KAAKutB,yBACDiB,MAAaxuB,KAAKmtB,kBAClBqB,MAAaxuB,KAAKqtB,gBAClBmB,MAAaxuB,KAAKitB,sBAClBuB,MAAaxuB,KAAK+sB,sDAKxBtB,EAAApzB,UAAA22B,KAAN,kBAAA30B,EAAA2F,UAAA,wBAAAxC,EAAA,OAAAnE,EAAA2G,KAAA,SAAAiM,GAAA,OAAAA,EAAA+V,OAAA,OACI,OAAIhiB,KAAK8rB,YAAc9rB,KAAKisB,WAAajsB,KAAK6rB,OAAS,IACvD7rB,KAAK8rB,cACD9rB,KAAKsiB,SAASrqB,OAAS,IAAK+H,KAAKsiB,cACjC0O,EAAShxB,KAAKixB,WAAW/xB,KAAK,SAAAgyB,GAAS,OAAAA,EAAMC,eAE7CnxB,KAAKysB,WAAauE,GAClB,EAAMA,EAAO3H,aAFb,aAEAlX,EAAA4P,+BAEJ/hB,KAAK8rB,eAAa,SAGhBL,EAAApzB,UAAA+4B,SAAN,SAAehB,yBAAmB,IAASltB,EAAAtD,KAAKkD,mGAE5C,OADA9C,KAAKisB,aACL,EAAMjsB,KAAK8hB,YAAYsO,kBAAvBje,EAAA4P,OACA/hB,KAAKisB,aAAW,SAIdR,EAAApzB,UAAAg5B,IAAN,kBAAAh3B,EAAA2F,UAAA,wBAAAxC,EAAA,OAAAnE,EAAA2G,KAAA,SAAAiM,GAAA,OAAAA,EAAA+V,OAAA,OAEI,OADIsP,EAAoB,GAAKpuB,EAAAtD,KAAKkD,kBAClC,EAAM9C,KAAK8hB,YAAYwP,kBAAvBnf,EAAA4P,OACA3a,EAAA3J,kBAAkBuC,KAAKsiB,SAAUrb,EAAAmD,cAAc6D,MAC/CjO,KAAKksB,OAAS,YAKlBT,EAAApzB,UAAAk5B,cAAA,SAAc5Q,GACV3gB,KAAK0sB,WAAa/L,GAGtBvoB,OAAA6B,eAAIwxB,EAAApzB,UAAA,kBAAA+B,IAAJ,WAAuB,OAAO4F,KAAK0sB,4CAEnCt0B,OAAA6B,eAAIwxB,EAAApzB,UAAA,mBAAA+B,IAAJ,WACI,OAA2B,OAApB4F,KAAK0sB,4CAGhBjB,EAAApzB,UAAAm5B,kBAAA,WACI,OAAIxxB,KAAK0sB,WACE1sB,KAAK0sB,WAAW+E,cAAcr0B,SAAS4C,KAAKyxB,eAE5C,GAKfr5B,OAAA6B,eAAIwxB,EAAApzB,UAAA,oBAAA+B,IAAJ,WAEI,OADoB,GAAK4F,KAAK2sB,0CAIlCv0B,OAAA6B,eAAIwxB,EAAApzB,UAAA,wBAAA+B,IAAJ,WACI,GAAI4F,KAAK0sB,WAAY,CACjB,IAAIgF,EAAQ1xB,KAAK0sB,WAAW+E,cACxBE,EAAO3xB,KAAKyxB,cAChB,OAAIC,EAAMzd,EAAI0d,EAAK1d,EACR,GAEC,EAGZ,OAAO,GAAA9Z,YAAA,EAAAD,cAAA,IAIf9B,OAAA6B,eAAIwxB,EAAApzB,UAAA,iBAAA+B,IAAJ,WAAsB,OAAO4F,KAAK0sB,WAAW+E,cAAc5Z,yCAK3D4T,EAAApzB,UAAAu5B,oBAAA,WAEI,OADS51B,KAAK4kB,IAAI5gB,KAAK6xB,cAAc5d,EAAIjU,KAAKiU,GAClCjU,KAAK8xB,iBAAmB9xB,KAAK6sB,mBAG7CpB,EAAApzB,UAAA05B,oBAAA,WAEI,OADS/1B,KAAK4kB,IAAI5gB,KAAK6xB,cAAc5d,EAAIjU,KAAKiU,GAClCjU,KAAK8xB,iBAAmB9xB,KAAK6sB,mBAG7CpB,EAAApzB,UAAA25B,kBAAA,WACI,QAAShyB,KAAK4xB,uBAAyB5xB,KAAK+xB,wBAG1CtG,EAAApzB,UAAA45B,oBAAN,kBAAA53B,EAAA2F,UAAA,wBAAAxC,EAAAyO,EAAA,OAAA5S,EAAA2G,KAAA,SAAAzF,GAAA,OAAAA,EAAAynB,OAAA,cACQkQ,EAAWlyB,KAAKyxB,cAAc5Z,QAC9BnR,EAAO1G,KAAK4sB,mBACZ5sB,KAAK+xB,uBACLrrB,GAAQ1G,KAAKmyB,qBAEbD,EAASje,GAAKvN,GACd,EAAM1G,KAAKywB,QAAQyB,MAJnB,mBAIA/f,EAAA4P,2BACO/hB,KAAK4xB,uBACZlrB,IAAS1G,KAAKmyB,qBAEdD,EAASje,GAAKvN,GACd,EAAM1G,KAAKywB,QAAQyB,MAJZ,YAIP/f,EAAA4P,wCAIF0J,EAAApzB,UAAA+5B,eAAN,SAAqBnL,mGASjB,OARIoL,EAAOpL,EAAOpP,SACb3D,EAAIlU,KAAKuM,IAAI2H,EACdxN,EAAO1G,KAAK4sB,mBACZ3F,EAAOhT,EAAIjU,KAAKuM,IAAI0H,EACpBoe,EAAKpe,EAAIjU,KAAKuM,IAAI0H,EAAIvN,EAEtB2rB,EAAKpe,EAAIjU,KAAKuM,IAAI0H,EAAIvN,GAE1B,EAAM1G,KAAKywB,QAAQ4B,kBAAnBlgB,EAAA4P,iBAKE0J,EAAApzB,UAAAsP,KAAN,kBAAAtN,EAAA2F,UAAA,wBAAAxC,EAAAyO,EAAA1R,EAAAxC,EAAAiC,EAAAK,EAAAT,EAAA,OAAAP,EAAA2G,KAAA,SAAAwlB,GAAA,OAAAA,EAAAxD,OAAA,UACShiB,KAAKigB,OAAN,gBAAAjmB,KAIQgG,KAAKigB,UACTwF,EAAWre,EAAA7K,MAAM6K,EAAAhL,OAAOgL,EAAA7K,MAAM,KAAA0P,EAAA,SACzBI,0DACL,SAAMuZ,EAAK9D,YAAY,oBAAvB3P,EAAA4P,OACI6D,EAAKiG,OAASjG,EAAK8G,YAAc9G,EAAK8G,WAAWb,QAC7CyG,EAAS1M,EAAK2M,iBAClB3M,EAAKG,MAAMvZ,IAAI8lB,GACf1M,EAAKG,MAAME,SAAS,IAAI9qB,EAAA+qB,MAAM,WAAQoM,EAAOnM,QAAU,gBAAA5rB,EAAAyF,KAAAjI,KAL7C0tB,gEAATpZ,oEAQT,SAAMjF,EAAAnJ,MAAM,aAAZmoB,EAAArE,OACQ/hB,KAAKigB,UAASuF,EAAAxD,MAAA,yBAMxByJ,EAAApzB,UAAAm6B,MAAN,kBAAAn4B,EAAA2F,UAAA,wBAAAxC,EAAA,OAAAnE,EAAA2G,KAAA,SAAAiM,GAAA,OAAAA,EAAA+V,OAAA,cACShiB,KAAK8sB,UAAN,KAEI9sB,KAAK6rB,OAAS7rB,KAAK0sB,YACnB1sB,KAAK8sB,YAED2F,EAASz2B,KAAKM,SAAW,GAAM,IAAO,MAC1C,EAAM8K,EAAAnJ,MAAMw0B,MAJZ,YAIAtgB,EAAA4P,OACA/hB,KAAK8sB,YAAW7gB,EAAA+V,MAAA,yBAKpByJ,EAAApzB,UAAAk6B,eAAR,WACI,IAAIG,EAAa1yB,KAAKmyB,qBAEtB,OADa,IAAI3S,EAAAmG,UAAU3lB,KAAM0yB,IAIrCjH,EAAApzB,UAAAs6B,OAAA,SAAOC,EAAaC,GACZ7yB,KAAK2rB,QAAQxS,QAEbyZ,GAAY,IAEhB5yB,KAAKosB,QAAUwG,EACX5yB,KAAKosB,QAAU,GACfpsB,KAAK8yB,MAET9yB,KAAK+yB,QAEDF,aAAoBpH,GACpBzrB,KAAKuxB,cAAcsB,IAI3BpH,EAAApzB,UAAAy6B,IAAA,eAAA/yB,EAAAC,KACIA,KAAKgzB,YAAYC,eACjBjzB,KAAKsc,QACLtc,KAAK6rB,SACL7rB,KAAK8sB,YACL9sB,KAAKisB,YACLjsB,KAAKyV,cAAgBta,EAAAua,cAAcC,QACnC3V,KAAK+lB,MAAME,SAAS,IAAI9qB,EAAA+qB,MAAM,WAAQnmB,EAAKomB,QAAU,OAGzDsF,EAAApzB,UAAA06B,MAAA,eAAAhzB,EAAAC,KAEIA,KAAKquB,aAAa/N,cAClBtgB,KAAK+lB,MAAME,SAAS,IAAI9qB,EAAA+qB,MAAM,WAAQnmB,EAAKsuB,aAAa/N,eAAsB,MAI1EmL,EAAApzB,UAAA02B,QAAR,WAEI/uB,KAAKmsB,QADM,KAEXnsB,KAAKksB,QAFM,MAKfT,EAAApzB,UAAAiK,IAAA,SAAI4c,GACA7c,QAAQmoB,MAASxqB,KAAKlG,KAAI,KAAKolB,IAEvCuM,EA/kBA,CAA6BtwB,EAAAihB,OAAhB5iB,EAAAiyB,yaClCb,IAAAtwB,EAAA/B,EAAA,GACA6J,EAAA7J,EAAA,GACAoa,EAAApa,EAAA,GACAua,EAAAva,EAAA,GACA8N,EAAA9N,EAAA,GAEQ+J,EAAAF,EAAAG,MAAAD,MAAOE,EAAAJ,EAAAG,MAAAC,MAET6vB,EAAgBvf,EAAA3C,YAAY9T,OAAO,SAAAqe,GAAW,WAAKA,GAAW3X,OAASsD,EAAAlE,WAAWO,QAClF4vB,EAAiBxf,EAAA3C,YAAY9T,OAAO,SAAAqe,GAAW,WAAKA,GAAW3X,OAASsD,EAAAlE,WAAWQ,SACnF4vB,EAAgBzf,EAAA3C,YAAY9T,OAAO,SAAAqe,GAAW,WAAKA,GAAW3X,OAASsD,EAAAlE,WAAWS,QAClF4vB,EAAe1f,EAAA3C,YAAY9T,OAAO,SAAAqe,GAAW,WAAKA,GAAW3X,OAASsD,EAAAlE,WAAWU,OAEjF4vB,EAAYJ,EAAch2B,OAAO,SAAAqe,GAAW,WAAKA,GAAW3Q,UAC5D2oB,EAAaL,EAAch2B,OAAO,SAAAqe,GAAW,YAAMA,GAAW3Q,UAE9D4oB,EAAUL,EAAej2B,OAAO,SAAAqe,GAAW,WAAKA,GAAW3Q,UAC3D6oB,EAAWN,EAAej2B,OAAO,SAAAqe,GAAW,YAAMA,GAAW3Q,eAAiB2Q,GAAWzQ,YAEzF4oB,EAAYN,EAAcl2B,OAAO,SAAAqe,GAAW,WAAKA,GAAW3Q,UAC5D+oB,EAAaP,EAAcl2B,OAAO,SAAAqe,GAAW,YAAMA,GAAW3Q,UAE9DgpB,EAAWP,EAAan2B,OAAO,SAAAqe,GAAW,WAAKA,GAAW3Q,UAC1DipB,EAAYR,EAAan2B,OAAO,SAAAqe,GAAW,YAAMA,GAAW3Q,UAE5DkpB,EAAoBX,EAAej2B,OAAO,SAAAqe,GAAW,WAAKA,GAAWzQ,YAE3EipB,EAAA,eAAAv2B,EACIwC,KAAAlG,KAAe,mBACfkG,KAAAiK,YAAsB,0BACtBjK,KAAAg0B,KAAe,0BACfh0B,KAAAmU,MAAgB,GAChBnU,KAAAoU,OAAiB,GACjBpU,KAAAi0B,KAAe,EACfj0B,KAAA4B,MAAezG,EAAAoE,MAAMuT,KACrB9S,KAAAqU,SAEArU,KAAAoa,cAAWjI,MACNqB,EAAAvC,YAAYC,OAASgjB,GACtB/hB,EAACqB,EAAAvC,YAAYG,QAAU8iB,GACvB/hB,EAACqB,EAAAvC,YAAYE,KAAOgjB,GACpBhiB,EAACqB,EAAAvC,YAAYI,OAAS8iB,MAG1Bn0B,KAAA4b,YACA5b,KAAAyK,WAGAzK,KAAA6K,SArBSrR,EAAAu6B,YAyBb,IAAAK,EAAA,SAAAv0B,GAAA,SAAAu0B,UAAAr0B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAe,cACfiG,EAAAkK,YAAsB,YACtBlK,EAAAi0B,KAAe,aACfj0B,EAAAoU,MAAgBhR,EAAMwD,MACtB5G,EAAAqU,OAAiBjR,EAAMc,OACvBlE,EAAAk0B,KAAO,IACPl0B,EAAAqa,cAAWjI,MACNqB,EAAAvC,YAAYC,OAASgjB,GACtB/hB,EAACqB,EAAAvC,YAAYG,QAAU8iB,GACvB/hB,EAACqB,EAAAvC,YAAYE,KAAOkjB,GACpBliB,EAACqB,EAAAvC,YAAYI,YAEjBtR,EAAAsU,SAAQ9Z,EACZ,OAdgCgG,EAAA6zB,EAAAv0B,GAchCu0B,EAdA,CAAgCL,GAAnBv6B,EAAA46B,aAiBb,IAAAE,EAAA,SAAAz0B,GAAA,SAAAy0B,UAAAv0B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAe,OACfiG,EAAAkK,YAAsB,gBACtBlK,EAAAi0B,KAAe,kBACfj0B,EAAAoU,MAAgB9Q,EAAMwD,MACtB9G,EAAAqU,OAAiB/Q,EAAMW,MACvBjE,EAAAqa,cAAWjI,MACNqB,EAAAvC,YAAYC,OAASqjB,EAAMF,GAC5BliB,EAACqB,EAAAvC,YAAYG,QAAWmjB,EAAMF,GAC9BliB,EAACqB,EAAAvC,YAAYE,OACbgB,EAACqB,EAAAvC,YAAYI,YAEjBtR,EAAAsU,SAAQ9Z,EACZ,OAbiCgG,EAAA+zB,EAAAz0B,GAajCy0B,EAbA,CAAiCP,GAApBv6B,EAAA86B,cAeb,IAAAJ,EAAA,SAAAr0B,GAAA,SAAAq0B,UAAAn0B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAe,WACfiG,EAAAkK,YAAsB,iBACtBlK,EAAAi0B,KAAe,eACfj0B,EAAAoU,MAAgB9Q,EAAMwD,MACtB9G,EAAAqU,OAAiBjR,EAAMa,MACvBjE,EAAAk0B,KAAO,GACPl0B,EAAAqa,cAAWjI,MACNqB,EAAAvC,YAAYC,OACTkjB,EACAI,EACAL,GAEJhiB,EAACqB,EAAAvC,YAAYG,QACTgjB,EACAI,EACAL,GAEJhiB,EAACqB,EAAAvC,YAAYE,OACbgB,EAACqB,EAAAvC,YAAYI,YAEjBtR,EAAA0K,SAAW6pB,GACXv0B,EAAAsU,SAAQ9Z,EACZ,OAvB8BgG,EAAA2zB,EAAAr0B,GAuB9Bq0B,EAvBA,CAA8BH,GAAjBv6B,EAAA06B,WAyBb,IAAAC,EAAA,SAAAt0B,GAAA,SAAAs0B,UAAAp0B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,SACPiG,EAAAkK,YAAc,qBACdlK,EAAAi0B,KAAO,aACPj0B,EAAAoU,MAAQhR,EAAMW,OACd/D,EAAAqU,OAASjR,EAAMwD,MACf5G,EAAAk0B,KAAO,GACPl0B,EAAAqa,cAAWjI,MACNqB,EAAAvC,YAAYE,KAAOqjB,GACpBriB,EAACqB,EAAAvC,YAAYI,OAASmjB,GACtBriB,EAACqB,EAAAvC,YAAYC,SACbiB,EAACqB,EAAAvC,YAAYG,aAEjBrR,EAAA0K,SAAWypB,EAAUO,GACrB10B,EAAAsU,SAAQ9Z,EACZ,OAf4BgG,EAAA4zB,EAAAt0B,GAe5Bs0B,EAfA,CAA4BJ,GAAfv6B,EAAA26B,SAmBb,IAAAI,EAAA,SAAA10B,GAAA,SAAA00B,UAAAx0B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAkK,YAAsB,oBAEtBlK,EAAAi0B,KAAe,WACfj0B,EAAAoU,MAAiBhR,EAAMY,MACvBhE,EAAAqU,OAAiBjR,EAAMyD,OACvB7G,EAAAk0B,KAAO,GACPl0B,EAAAqa,cAAWjI,MACNqB,EAAAvC,YAAYC,OAASojB,GACtBniB,EAACqB,EAAAvC,YAAYG,QAAUkjB,GACvBniB,EAACqB,EAAAvC,YAAYE,OACbgB,EAACqB,EAAAvC,YAAYI,YAGjBtR,EAAA6b,UACIjI,EAAApG,UACAoG,EAAAtG,gBAAiBsG,EAAArG,0BAEzB,OAlBmB/M,EAAAg0B,EAAA10B,GAkBnB00B,EAlBA,CAAmBR,GAqBnBS,EAAA,SAAA30B,GAAA,SAAA20B,UAAAz0B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAe,UACfiG,EAAAkK,YAAsB,cACtBlK,EAAAi0B,KAAe,iBACfj0B,EAAAoU,MAAgBhR,EAAMwD,MACtB5G,EAAAqU,OAAiBjR,EAAMwD,MAEvB5G,EAAAqa,cAAWjI,MACNqB,EAAAvC,YAAYC,OACTgjB,EAAUM,GAEdriB,EAACqB,EAAAvC,YAAYG,QACT8iB,EACAM,GAEJriB,EAACqB,EAAAvC,YAAYE,KAAOgjB,GACpBhiB,EAACqB,EAAAvC,YAAYI,OAAS8iB,MAG1Bp0B,EAAA6b,YAEA7b,EAAA0K,aAEJ,OAvByBlK,EAAAi0B,EAAA30B,GAuBzB20B,EAvBA,CAAyBT,GAyBzBW,EAAA,SAAA70B,GAAA,SAAA60B,IAAA,IAAA30B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,YAEPiG,EAAAqU,OAASjR,EAAMa,MACfjE,EAAAoU,MAAQhR,EAAMwD,MACd5G,EAAA0K,SAAYkqB,GACZ50B,EAAA6b,SAAW2X,IACf,OAPkChzB,EAAAm0B,EAAA70B,GAOlC60B,EAPA,CAAkCF,GAArBh7B,EAAAk7B,eASb,IAAAD,EAAA,SAAA50B,GAAA,SAAA40B,IAAA,IAAA10B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,eACPiG,EAAA0K,SAAWiqB,GACX30B,EAAAi0B,KAAO,qBAIPj0B,EAAAoU,MAAgBhR,EAAMyD,OACtB7G,EAAAqU,OAAiBjR,EAAMW,OAEvB/D,EAAA6b,SAAgB2X,EAAUr4B,UAC9B,OAXoCqF,EAAAk0B,EAAA50B,GAWpC40B,EAXA,CAAoCD,GAAvBh7B,EAAAi7B,iBAab,IAAAG,EAAA,SAAA/0B,GAAA,SAAA+0B,IAAA,IAAA70B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,WACPiG,EAAA0K,SAAYgqB,GACZ10B,EAAAi0B,KAAO,iBACPj0B,EAAAoU,MAAQ,EAAIhR,EAAMc,OAClBlE,EAAA6b,SAAgB6X,EAAQn2B,OAAKi2B,KACjC,OANgChzB,EAAAq0B,EAAA/0B,GAMhC+0B,EANA,CAAgCJ,GAAnBh7B,EAAAo7B,aAQb,IAAAC,EAAA,SAAAh1B,GAAA,SAAAg1B,IAAA,IAAA90B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,eACPiG,EAAA0K,SAAYmqB,GACZ70B,EAAAi0B,KAAO,sBACPj0B,EAAAoU,MAAQ,EAAIhR,EAAMc,OAClBlE,EAAAqU,OAASjR,EAAMc,OAEflE,EAAA6b,SAAgB6X,EAAQn2B,OAAKi2B,KACjC,OARqChzB,EAAAs0B,EAAAh1B,GAQrCg1B,EARA,CAAqCL,GAAxBh7B,EAAAq7B,kBAUb,IAAAC,EAAA,SAAAj1B,GAAA,SAAAi1B,IAAA,IAAA/0B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,WACPiG,EAAAi0B,KAAO,gBACPj0B,EAAA0K,SAAYmqB,GACZ70B,EAAAoU,MAAQ,EAAIhR,EAAMc,OAClBlE,EAAAqU,OAAS,EAAEjR,EAAMc,OACjBlE,EAAA6b,SAAgB+X,EAAUr2B,OAAKm2B,EAAaF,KAChD,OAP+BhzB,EAAAu0B,EAAAj1B,GAO/Bi1B,EAPA,CAA+BN,GAAlBh7B,EAAAs7B,YASb,IAAAC,EAAA,SAAAl1B,GAAA,SAAAk1B,IAAA,IAAAh1B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,YACPiG,EAAAi0B,KAAO,eACPj0B,EAAAoU,MAAQ,GAAKhR,EAAMc,OACnBlE,EAAAqU,OAAS,EAAIjR,EAAMc,OAEnBlE,EAAA0K,SAAWqqB,GACX/0B,EAAA6b,SAAWiY,IACf,OAR8BtzB,EAAAw0B,EAAAl1B,GAQ9Bk1B,EARA,CAA8BP,GAAjBh7B,EAAAu7B,WAkBb,IAAAV,EAAA,SAAAx0B,GAAA,SAAAw0B,UAAAt0B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,gBACPiG,EAAAkK,YAAc,sBAEdlK,EAAAi0B,KAAe,wBAEfj0B,EAAAoU,MAAiB,EAAIhR,EAAM0D,MAC3B9G,EAAAqU,OAAiBjR,EAAMyD,OAEvB7G,EAAAk0B,KAAO,GAEPl0B,EAAA0K,SAAYkqB,GAEZ50B,EAAAqa,cAAWjI,MACNqB,EAAAvC,YAAYC,OAASojB,GACtBniB,EAACqB,EAAAvC,YAAYG,QAAUkjB,GACvBniB,EAACqB,EAAAvC,YAAYE,KAAOijB,EAAYC,GAChCliB,EAACqB,EAAAvC,YAAYI,OAAS+iB,EAAYC,MAGtCt0B,EAAA6b,SACO6X,EAAQn2B,OACRi2B,KAIX,OA1BuChzB,EAAA8zB,EAAAx0B,GA0BvCw0B,EA1BA,CAAuCE,GAA1B/6B,EAAA66B,oBA4Bb,IAAAM,EAAA,SAAA90B,GAAA,SAAA80B,IAAA,IAAA50B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,WACPiG,EAAAoU,MAAQhR,EAAMwD,MACd5G,EAAAqU,OAASjR,EAAMwD,MACf5G,EAAA6b,SAAW0X,IACf,OAL+B/yB,EAAAo0B,EAAA90B,GAK/B80B,EALA,CAA+BJ,GAAlB/6B,EAAAm7B,YAOb,IAAAK,EAAA,SAAAn1B,GAAA,SAAAm1B,IAAA,IAAAj1B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,eACPiG,EAAAi0B,KAAO,qBACPj0B,EAAAoU,MAAQhR,EAAMyD,OACd7G,EAAAqU,OAASjR,EAAMyD,OAGf7G,EAAA6b,SAAW0X,IACf,OARoC/yB,EAAAy0B,EAAAn1B,GAQpCm1B,EARA,CAAoCT,GAAvB/6B,EAAAw7B,iBAUb,IAAAC,EAAA,SAAAp1B,GAAA,SAAAo1B,IAAA,IAAAl1B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,WACPiG,EAAAi0B,KAAO,cACPj0B,EAAAoU,MAAQ,EAAIhR,EAAM2D,QAElB/G,EAAA0K,SAAYkqB,EAAWC,GACvB70B,EAAA6b,SAAgB4X,EAAOl2B,OAAKg2B,KAChC,OAP6B/yB,EAAA00B,EAAAp1B,GAO7Bo1B,EAPA,CAA6BV,GAAhB/6B,EAAAy7B,UASb,IAAAC,EAAA,SAAAr1B,GAAA,SAAAq1B,IAAA,IAAAn1B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,WACPiG,EAAAi0B,KAAO,cACPj0B,EAAAoU,MAAQ,EAAIhR,EAAMc,OAElBlE,EAAA0K,SAAWwqB,GACXl1B,EAAA6b,SAAgB8X,EAASp2B,OAAKk2B,EAAYF,KAC9C,OAP+B/yB,EAAA20B,EAAAr1B,GAO/Bq1B,EAPA,CAA+BX,GAAlB/6B,EAAA07B,YASb,IAAAC,EAAA,SAAAt1B,GAAA,SAAAs1B,IAAA,IAAAp1B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,WACPiG,EAAAi0B,KAAO,eACPj0B,EAAAoU,MAAQ,GAAKhR,EAAMc,OACnBlE,EAAAqU,OAAS,GAAKjR,EAAMc,OACpBlE,EAAA0K,SAAWyqB,GACXn1B,EAAA6b,SAAWgY,IAEf,OAR8BrzB,EAAA40B,EAAAt1B,GAQ9Bs1B,EARA,CAA8BZ,GAAjB/6B,EAAA27B,WAYb,IAAAC,EAAA,SAAAv1B,GAAA,SAAAu1B,IAAA,IAAAr1B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAjG,KAAO,YACPiG,EAAAkK,YAAc,qBACdlK,EAAAi0B,KAAO,wBACPj0B,EAAAoU,MAAQ,EAAIhR,EAAMc,OAClBlE,EAAAqU,OAAS/Q,EAAMS,OACf/D,EAAA6b,SAAWkY,IACf,OAPuCvzB,EAAA60B,EAAAv1B,GAOvCu1B,EAPA,CAAuCb,GAA1B/6B,EAAA47B,oBAUA57B,EAAAmrB,eAELgQ,EACAK,EACAC,EAGAZ,EAEAK,EACAD,EAMAW,kaCtVR,IAAAzhB,EAAAva,EAAA,GACA+B,EAAA/B,EAAA,GACAkmB,EAAAlmB,EAAA,IACAwa,EAAAxa,EAAA,IAEAi8B,EAAA,WACKr1B,KAAAlG,KAAe,YACfkG,KAAAiK,YAAsB,wBACtBjK,KAAA4b,YACA5b,KAAA4B,MAAezG,EAAAoE,MAAMuT,KAErB9S,KAAAyK,WAEAzK,KAAA+T,UAA8B,KAC9B/T,KAAA6K,QACA7K,KAAAic,WAAgCrI,EAAAsI,kBAAkBoZ,MAElDt1B,KAAAkkB,SAIKC,SAAU,EACVC,UAAW,IAjBR5qB,EAAA67B,aAqBb,IAAAE,EAAA,SAAA11B,GAAA,SAAA01B,IAAA,IAAAx1B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACKD,EAAA8K,QACA9K,EAAAjG,KAAO,kBACPiG,EAAAkK,YAAc,8BACdlK,EAAAgU,UAAYuL,EAAA+U,kBACZt0B,EAAA0K,WACA1K,EAAA6b,UAAajI,EAAArI,cAAeqI,EAAAlH,YAC5B1M,EAAAkc,WAAarI,EAAAsI,kBAAkBsZ,SACpC,OARoCj1B,EAAAg1B,EAAA11B,GAQpC01B,EARA,CAAoCF,GAAvB77B,EAAA+7B,iBAUb,IAAAE,EAAA,SAAA51B,GAAA,SAAA41B,IAAA,IAAA11B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACKD,EAAAjG,KAAO,kBACPiG,EAAAkK,YAAc,aACdlK,EAAA6b,UAAajI,EAAAnG,OAClB,OAJoCjN,EAAAk1B,EAAA51B,GAIpC41B,EAJA,CAAoCJ,GAAvB77B,EAAAi8B,iBAMb,IAAAC,EAAA,SAAA71B,GAAA,SAAA61B,IAAA,IAAA31B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACKD,EAAAjG,KAAO,WACPiG,EAAAkK,YAAc,cACdlK,EAAA6b,UAAajI,EAAAnG,IAAKmG,EAAAnG,IAAKmG,EAAAnG,OAC5B,OAJuBjN,EAAAm1B,EAAA71B,GAIvB61B,EAJA,CAAuBL,GAMvBM,EAAA,SAAA91B,GAAA,SAAA81B,IAAA,IAAA51B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACKD,EAAAjG,KAAO,UACPiG,EAAAkK,YAAc,gBACdlK,EAAA6b,UAAajI,EAAAzF,MAAOyF,EAAA3F,QACpBjO,EAAAmkB,SACKC,SAAU,EACVC,UAAW,KAEhBrkB,EAAAkc,WAAarI,EAAAsI,kBAAkB0Z,UACpC,OAT6Br1B,EAAAo1B,EAAA91B,GAS7B81B,EATA,CAA6BN,GAAhB77B,EAAAm8B,UAWb,IAAAE,EAAA,SAAAh2B,GAAA,SAAAg2B,IAAA,IAAA91B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACKD,EAAAjG,KAAO,eACPiG,EAAAkK,YAAc,gBACdlK,EAAA6b,UAAajI,EAAAtG,gBAAiBsG,EAAArG,0BACnC,OAJoC/M,EAAAs1B,EAAAh2B,GAIpCg2B,EAJA,CAAoCR,GAAvB77B,EAAAq8B,iBAMb,IAAAC,EAAA,SAAAj2B,GAAA,SAAAi2B,IAAA,IAAA/1B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACKD,EAAAjG,KAAO,UACPiG,EAAAkK,YAAc,eACdlK,EAAA6b,UAAajI,EAAAlE,MAAOkE,EAAAlE,SACzB,OAJsBlP,EAAAu1B,EAAAj2B,GAItBi2B,EAJA,CAAsBT,GAMtBU,EAAA,SAAAl2B,GAAA,SAAAk2B,IAAA,IAAAh2B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACKD,EAAAjG,KAAO,eACPiG,EAAAkK,YAAc,aACdlK,EAAA6b,UAAajI,EAAApF,WAAYoF,EAAApF,cAC9B,OAJiChO,EAAAw1B,EAAAl2B,GAIjCk2B,EAJA,CAAiCV,GAApB77B,EAAAu8B,cAMb,IAAAC,EAAA,SAAAn2B,GAAA,SAAAm2B,IAAA,IAAAj2B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACKD,EAAAjG,KAAO,kBACPiG,EAAAkK,YAAc,gBACdlK,EAAA6b,UAAajI,EAAApF,WAAYoF,EAAAnF,mBAAoBmF,EAAArF,qBAClD,OAJoC/N,EAAAy1B,EAAAn2B,GAIpCm2B,EAJA,CAAoCX,GAAvB77B,EAAAw8B,iBAMb,IAAAC,EAAA,SAAAp2B,GAAA,SAAAo2B,IAAA,IAAAl2B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACKD,EAAAjG,KAAO,eACPiG,EAAAkK,YAAc,yBACdlK,EAAA6b,UAAajI,EAAA7F,UAAW6F,EAAA7F,aAC7B,OAJ0BvN,EAAA01B,EAAAp2B,GAI1Bo2B,EAJA,CAA0BZ,GAM1Ba,EAAA,SAAAr2B,GAAA,SAAAq2B,IAAA,IAAAn2B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACKD,EAAAjG,KAAO,UACPiG,EAAAkK,YAAc,cACdlK,EAAA6b,UAAajI,EAAA7F,UAAW6F,EAAA7F,UAAW6F,EAAA7F,WACnC/N,EAAAkc,WAAarI,EAAAsI,kBAAkBhP,QACpC,OAL6B3M,EAAA21B,EAAAr2B,GAK7Bq2B,EALA,CAA6Bb,GAAhB77B,EAAA08B,UAOb,IAAAC,EAAA,SAAAt2B,GAAA,SAAAs2B,IAAA,IAAAp2B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACKD,EAAAjG,KAAO,QACPiG,EAAAkK,YAAc,cACdlK,EAAA6b,UAAajI,EAAAhG,aAAcgG,EAAA7F,WAC3B/N,EAAAkc,WAAarI,EAAAsI,kBAAkBka,OACpC,OAL2B71B,EAAA41B,EAAAt2B,GAK3Bs2B,EALA,CAA2Bd,GAAd77B,EAAA28B,QAOb,IAAAE,EAAA,SAAAx2B,GAAA,SAAAw2B,IAAA,IAAAt2B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACKD,EAAAjG,KAAO,eACPiG,EAAAkK,YAAc,iBACdlK,EAAA6b,UAAajI,EAAA/F,YAAa+F,EAAA/F,YAAa+F,EAAA/F,eAC5C,OAJ0BrN,EAAA81B,EAAAx2B,GAI1Bw2B,EAJA,CAA0BhB,GAM1BiB,EAAA,SAAAz2B,GAAA,SAAAy2B,IAAA,IAAAv2B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACKD,EAAAjG,KAAO,UACPiG,EAAAkK,YAAc,gBACdlK,EAAA6b,UAAajI,EAAArE,eAAgBqE,EAAArE,kBAClC,OAJ6B/O,EAAA+1B,EAAAz2B,GAI7By2B,EAJA,CAA6BjB,GAAhB77B,EAAA88B,UAMb,IAAAC,EAAA,SAAA12B,GAAA,SAAA02B,IAAA,IAAAx2B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACKD,EAAAjG,KAAO,YACPiG,EAAAkK,YAAc,cACdlK,EAAA6b,UAAajI,EAAAhE,MAAOgE,EAAAhE,SACzB,OAJwBpP,EAAAg2B,EAAA12B,GAIxB02B,EAJA,CAAwBlB,GAMxBmB,EAAA,SAAA32B,GAAA,SAAA22B,IAAA,IAAAz2B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACKD,EAAAjG,KAAO,aACPiG,EAAAkK,YAAc,UACdlK,EAAA6b,UAAajI,EAAAjF,SAAUiF,EAAAjF,YAC5B,OAJwBnO,EAAAi2B,EAAA32B,GAIxB22B,EAJA,CAAwBnB,GAMxBoB,EAAA,SAAA52B,GAAA,SAAA42B,IAAA,IAAA12B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACKD,EAAAjG,KAAO,cACPiG,EAAAkK,YAAc,UACdlK,EAAA6b,UAAajI,EAAApG,UAAWoG,EAAApG,aAC7B,OAJgChN,EAAAk2B,EAAA52B,GAIhC42B,EAJA,CAAgCpB,GAAnB77B,EAAAi9B,aAMb,IAAAC,EAAA,SAAA72B,GAAA,SAAA62B,IAAA,IAAA32B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACKD,EAAAjG,KAAO,WACPiG,EAAAkK,YAAc,YACdlK,EAAA6b,UAAajI,EAAA7E,WAAY6E,EAAA7E,cAC9B,OAJ8BvO,EAAAm2B,EAAA72B,GAI9B62B,EAJA,CAA8BrB,GAAjB77B,EAAAk9B,WAMb,IAAAC,EAAA,SAAA92B,GAAA,SAAA82B,IAAA,IAAA52B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACKD,EAAAjG,KAAO,UACPiG,EAAAkK,YAAc,eACdlK,EAAA6b,UAAajI,EAAAvF,WAAYuF,EAAAvF,WAAYuF,EAAAvF,YACrCrO,EAAAkc,WAAarI,EAAAsI,kBAAkB0a,QACpC,OALsBr2B,EAAAo2B,EAAA92B,GAKtB82B,EALA,CAAsBtB,GAOtBwB,EAAA,SAAAh3B,GAAA,SAAAg3B,IAAA,IAAA92B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACKD,EAAAjG,KAAO,OACPiG,EAAAkK,YAAc,sBACdlK,EAAA6b,UAAajI,EAAAjE,QAASiE,EAAAjE,WAC3B,OAJmBnP,EAAAs2B,EAAAh3B,GAInBg3B,EAJA,CAAmBxB,GAMnByB,EAAA,SAAAj3B,GAAA,SAAAi3B,IAAA,IAAA/2B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACKD,EAAAjG,KAAO,UACPiG,EAAAkK,YAAc,mBACdlK,EAAA6b,UAAajI,EAAA7D,eAAgB6D,EAAA7D,kBAClC,OAJsBvP,EAAAu2B,EAAAj3B,GAItBi3B,EAJA,CAAsBzB,GAOtB0B,EAAA,SAAAl3B,GAAA,SAAAk3B,IAAA,IAAAh3B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACKD,EAAAjG,KAAO,gBACPiG,EAAAkK,YAAc,mBACdlK,EAAA6b,UAAajI,EAAA9D,UAAW8D,EAAA9D,WACxB9P,EAAAkc,WAAarI,EAAAsI,kBAAkB8a,OACpC,OALkCz2B,EAAAw2B,EAAAl3B,GAKlCk3B,EALA,CAAkC1B,GAArB77B,EAAAu9B,eAOb,IAAAE,EAAA,SAAAp3B,GAAA,SAAAo3B,IAAA,IAAAl3B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACKD,EAAAjG,KAAO,oBACPiG,EAAAkK,YAAc,uBACdlK,EAAA6b,UAAajI,EAAAtF,OAAQsF,EAAAtF,UAC1B,OAJqC9N,EAAA02B,EAAAp3B,GAIrCo3B,EAJA,CAAqC5B,GAAxB77B,EAAAy9B,kBAMb,IAAAC,EAAA,SAAAr3B,GAAA,SAAAq3B,IAAA,IAAAn3B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACKD,EAAAjG,KAAO,WACPiG,EAAAkK,YAAc,aACdlK,EAAA6b,UAAajI,EAAAxE,oBAClB,OAJ8B5O,EAAA22B,EAAAr3B,GAI9Bq3B,EAJA,CAA8B7B,GAAjB77B,EAAA09B,WAMb,IAAAC,EAAA,SAAAt3B,GAAA,SAAAs3B,IAAA,IAAAp3B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACKD,EAAAjG,KAAO,OACPiG,EAAAkK,YAAc,qBACdlK,EAAA6b,UAAajI,EAAAvE,eAClB,OAJ0B7O,EAAA42B,EAAAt3B,GAI1Bs3B,EAJA,CAA0B9B,GAAb77B,EAAA29B,OAMb,IAAAC,EAAA,SAAAv3B,GAAA,SAAAu3B,IAAA,IAAAr3B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACKD,EAAAjG,KAAO,kBACPiG,EAAAkK,YAAc,WACdlK,EAAA6b,UAAajI,EAAArD,cAAeqD,EAAArD,iBACjC,OAJgC/P,EAAA62B,EAAAv3B,GAIhCu3B,EAJA,CAAgC/B,GAAnB77B,EAAA49B,aAMb,IAAAC,EAAA,SAAAx3B,GAAA,SAAAw3B,IAAA,IAAAt3B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACKD,EAAAjG,KAAO,eACPiG,EAAAkK,YAAc,aACdlK,EAAA6b,UAAajI,EAAAvD,YAAauD,EAAAvD,eAC/B,OAJiC7P,EAAA82B,EAAAx3B,GAIjCw3B,EAJA,CAAiChC,GAApB77B,EAAA69B,cAQb,IAAAC,EAAA,SAAAz3B,GAAA,SAAAy3B,IAAA,IAAAv3B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACKD,EAAAjG,KAAO,cACPiG,EAAAkK,YAAc,aACdlK,EAAA6b,UAAajI,EAAA5F,MAAO4F,EAAA5F,SACzB,OAJgCxN,EAAA+2B,EAAAz3B,GAIhCy3B,EAJA,CAAgCjC,GAAnB77B,EAAA89B,aAMb,IAAAC,EAAA,SAAA13B,GAAA,SAAA03B,IAAA,IAAAx3B,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACKD,EAAAjG,KAAO,WACPiG,EAAAkK,YAAc,cACdlK,EAAA6b,UAAajI,EAAAjG,OAAQiG,EAAAjG,OAAQiG,EAAAjG,UAClC,OAJ8BnN,EAAAg3B,EAAA13B,GAI9B03B,EAJA,CAA8BlC,GAAjB77B,EAAA+9B,WAMA/9B,EAAAqiB,mBACT0Z,EAEAW,EACAR,EACAG,EACAE,EACAN,EACAE,EACAa,EACAF,EACAC,EACAE,EACAX,EACAK,EACAO,EACAT,EACAU,EACAE,EACAC,EACAT,EAEAU,EAEAE,EAEAjB,EAEAkB,EACAC,EACAC,EACAC,EAEAC,EACAC,kFCnPJ,IAAAp8B,EAAA/B,EAAA,GACAoa,EAAApa,EAAA,GAEAo+B,EAAA,WASI,SAAAA,EAAoBC,EAAsBC,GAAtB13B,KAAAy3B,OAAsBz3B,KAAA03B,SAPlC13B,KAAA+mB,YAER/mB,KAAA23B,oBAA4C,KAC5C33B,KAAA43B,kBAAiE,KACjE53B,KAAA63B,kBAA+B,KAC/B73B,KAAA83B,iBAAiC,KAwHrC,OAlHIN,EAAAn/B,UAAA0/B,OAAA,SAAOC,GACHh4B,KAAK23B,oBAAsBK,GAG/BR,EAAAn/B,UAAA4/B,YAAA,SAAYD,GACRh4B,KAAK43B,kBAAoBI,GAG7BR,EAAAn/B,UAAA6/B,YAAA,SAAYF,GACRh4B,KAAK63B,kBAAoBG,GAG7BR,EAAAn/B,UAAA8/B,WAAA,SAAWH,GACPh4B,KAAK83B,iBAAmBE,GAI5BR,EAAAn/B,UAAA+/B,SAAA,eAAAr4B,EAAAC,KACIA,KAAKy3B,KAAKY,MAAMC,SAAS3K,QAAQ4K,GAAG,OAAQ,SAAC/6B,GAErCuC,EAAKgnB,SACLhnB,EAAK23B,OAAOnrB,IAAMxM,EAAK23B,OAAOnrB,IAAIC,IAC9BzM,EAAKy4B,WAAWxd,IAAIxd,EAAE+O,MAGtBxM,EAAK43B,qBACL53B,EAAK43B,oBAAoBn6B,EAAE+O,OAMvCvM,KAAKy3B,KAAKY,MAAMC,SAAS3K,QAAQ4K,GAAG,KAAM,WAClCx4B,EAAKgnB,WAAYhnB,EAAKgnB,eAG9B/mB,KAAKy3B,KAAKY,MAAMC,SAAS3K,QAAQ4K,GAAG,OAAQ,SAAC/6B,GACrCA,EAAEi7B,QAAUt9B,EAAAu9B,MAAMC,cAAcznB,KAC5BnR,EAAK63B,mBACL73B,EAAK63B,kBACDp6B,EAAE+O,IACFxM,EAAK03B,KAAKY,MAAMO,SAASC,OAAO19B,EAAAu9B,MAAMI,KAAKC,QAI5Cv7B,EAAEi7B,SAAWt9B,EAAAu9B,MAAMC,cAAcK,SACxCj5B,EAAKgnB,YACLhnB,EAAKy4B,WAAah7B,EAAE+O,OAI5BvM,KAAKy3B,KAAKY,MAAMC,SAAS3K,QAAQ4K,GAAG,QAAS,SAAC/6B,GAC1C,IAAIwoB,EAAIjmB,EAAK23B,OAAOuB,UAGhBz7B,EAAE07B,OAAS,EACXn5B,EAAK23B,OAAOzD,KAAKj4B,KAAKC,IAAI+pB,EAHnB,IACW,IAGXxoB,EAAE07B,OAAS,GAClBn5B,EAAK23B,OAAOzD,KAAKj4B,KAAKG,IAAI6pB,EALnB,IACD,QAQR,IAAA7U,EAAAqC,EAAAvC,YAAAE,GAAIE,EAAAmC,EAAAvC,YAAAI,KAAMH,EAAAsC,EAAAvC,YAAAC,KAAME,EAAAoC,EAAAvC,YAAAG,MAClB+nB,EAAU,SAACC,GACPr5B,EAAK83B,mBACL93B,EAAK83B,oBAET,IAAIwB,EAAqB,EAAIt5B,EAAK23B,OAAOuB,UAAtB,GACfK,EAAK,IAAIn+B,EAAAga,OAAO,EAAG,GACvB,OAAQikB,GACJ,KAAKloB,EAAMooB,EAAGrlB,GAAKolB,EAAc,MACjC,KAAKjoB,EAAOkoB,EAAGrlB,EAAIolB,EAAc,MACjC,KAAKloB,EAAImoB,EAAGplB,GAAKmlB,EAAc,MAC/B,KAAKhoB,EAAMioB,EAAGplB,EAAImlB,EAEtBt5B,EAAK23B,OAAO6B,KAAKx5B,EAAK23B,OAAOnrB,IAAIC,IAAI8sB,GAAK,IAI9Ct5B,KAAKy3B,KAAKY,MAAMO,SAASL,GAAG,QAAS,SAAC/6B,GAC9BA,EAAEmD,MAAQxF,EAAAu9B,MAAMI,KAAK3nB,IAAM3T,EAAEmD,MAAQxF,EAAAu9B,MAAMI,KAAKU,EAChDL,EAAQhoB,GACD3T,EAAEmD,MAAQxF,EAAAu9B,MAAMI,KAAK5nB,MAAQ1T,EAAEmD,MAAQxF,EAAAu9B,MAAMI,KAAKW,EACzDN,EAAQjoB,GACD1T,EAAEmD,MAAQxF,EAAAu9B,MAAMI,KAAKznB,MAAQ7T,EAAEmD,MAAQxF,EAAAu9B,MAAMI,KAAKY,EACzDP,EAAQ9nB,GACD7T,EAAEmD,MAAQxF,EAAAu9B,MAAMI,KAAK1nB,OAAS5T,EAAEmD,MAAQxF,EAAAu9B,MAAMI,KAAKa,EAC1DR,EAAQ/nB,GAEJrR,EAAK+3B,kBACL/3B,EAAK+3B,iBAAiBt6B,EAAEmD,OAIpCX,KAAKy3B,KAAKY,MAAMO,SAASL,GAAG,OAAQ,SAAC/6B,GAC7BA,EAAEmD,MAAQxF,EAAAu9B,MAAMI,KAAK3nB,IAAM3T,EAAEmD,MAAQxF,EAAAu9B,MAAMI,KAAKU,EAChDL,EAAQhoB,GACD3T,EAAEmD,MAAQxF,EAAAu9B,MAAMI,KAAK5nB,MAAQ1T,EAAEmD,MAAQxF,EAAAu9B,MAAMI,KAAKW,EACzDN,EAAQjoB,GACD1T,EAAEmD,MAAQxF,EAAAu9B,MAAMI,KAAKznB,MAAQ7T,EAAEmD,MAAQxF,EAAAu9B,MAAMI,KAAKY,EACzDP,EAAQ9nB,GACD7T,EAAEmD,MAAQxF,EAAAu9B,MAAMI,KAAK1nB,OAAS5T,EAAEmD,MAAQxF,EAAAu9B,MAAMI,KAAKa,GAC1DR,EAAQ/nB,MAKpBomB,EAAAn/B,UAAAuhC,WAAA,WACI55B,KAAKy3B,KAAKY,MAAMO,SAASiB,IAAI,SAC7B75B,KAAKy3B,KAAKY,MAAMO,SAASiB,IAAI,QAC7B75B,KAAKy3B,KAAKY,MAAMC,SAAS3K,QAAQkM,IAAI,SACrC75B,KAAKy3B,KAAKY,MAAMC,SAAS3K,QAAQkM,IAAI,QACrC75B,KAAKy3B,KAAKY,MAAMC,SAAS3K,QAAQkM,IAAI,OAE7CrC,EA/HA,GAAah+B,EAAAg+B,gGCJb,IAAAv0B,EAAA7J,EAAA,GAEM0gC,EAAe1gC,EAAQ,IACvB2gC,EAAQ3gC,EAAQ,IAChB4gC,EAAU5gC,EAAQ,IAClB6gC,EAAU7gC,EAAQ,IAClB8gC,EAAO9gC,EAAQ,IACf+gC,EAAU/gC,EAAQ,IAClBghC,EAAQhhC,EAAQ,IAChB0B,EAAS1B,EAAQ,IACjBihC,EAAOjhC,EAAQ,IACfkhC,EAAOlhC,EAAQ,IAQfmhC,EAAS,SAACje,EAAM2E,kBAAA,GAClB,IAAIhF,GAA2BzR,MAAO,KAAM+R,QAAS,KAAMie,YAM3D,OALAve,EAAWzR,MAAQ,IAAI0V,MACvBjE,EAAWzR,MAAM4V,IAAM9D,EACvBL,EAAWzR,MAAM2V,OAAS,WACxBlE,EAAWue,aAEJve,WAAUA,EAAEgF,MAAKA,KAG9B,SAAY/E,GACRA,EAAA0a,MAAA,QACA1a,EAAAC,KAAA,OACAD,EAAAhP,MAAA,QACAgP,EAAAue,OAAA,SACAve,EAAA8a,KAAA,OACA9a,EAAA0Z,QAAA,UACA1Z,EAAAoZ,MAAA,QACApZ,EAAAsZ,OAAA,SACAtZ,EAAAwe,KAAA,OACAxe,EAAAka,KAAA,OAVJ,CAAY58B,EAAA0iB,oBAAA1iB,EAAA0iB,uBAaZ,IAAMye,GACF/D,MAAO2D,EAAOR,GACd5d,KAAMoe,EAAOT,GACb5sB,MAAOqtB,EAAOP,GACdS,OAAQF,EAAON,GACfjD,KAAMuD,EAAOL,GACbtE,QAAS2E,EAAOJ,GAChB7E,MAAOiF,EAAOH,GACd5E,OAAQ+E,EAAOz/B,GACf4/B,KAAMH,EAAOF,EAAM,IACnBjE,KAAMmE,EAAOD,IAGJ9gC,EAAAijB,qBAAuB,SAAC1G,EAA+Bnb,GAChE,IAAI2hB,EAAUoe,EAAmB//B,GAC7B4rB,EAAKjK,EAAQN,WACjB,IAAKuK,EAAGgU,QAAS,CACb,IAAKhU,EAAGjK,QAAS,CACb,IAAIqe,EAAS,IAAIC,UAIjBrU,EAAGjK,QAAUxG,EAAI+kB,cAActU,EAAGhc,MAAO,UACzCgc,EAAGjK,QAAQwe,aAAaH,EAAO3Z,MAAM1E,EAAQ0E,OAAShe,EAAAG,MAAMD,MAAMa,MAAQ,MAG9E,OAAOwiB,EAAGjK,yFCpElB,IAAAphB,EAAA/B,EAAA,GACAgO,EAAAhO,EAAA,GAEAs0B,EAAA,oBAAAA,KAuBA,OALSA,EAAAsN,QAAP,SAAephC,GACb,OAAOA,EAAEie,QACN3E,WAAW,KACXR,QAAQ,MApBNgb,EAAAC,SACLxyB,EAAAoE,MAAMyC,IAAK7G,EAAAoE,MAAM8J,KAAMlO,EAAAoE,MAAMiK,QAGxBkkB,EAAAE,WACLzyB,EAAAoE,MAAM6J,MAAOjO,EAAAoE,MAAM+J,OAAQnO,EAAAoE,MAAMgK,QAG5BmkB,EAAAI,UACL3yB,EAAAoE,MAAM07B,WAAY9/B,EAAAoE,MAAM27B,WAAY//B,EAAAoE,MAAM47B,QAAShgC,EAAAoE,MAAM67B,MAEzD,IAAIjgC,EAAAoE,MAAM,GAAI,IAAK,KAGnB,IAAIpE,EAAAoE,MAAM,IAAK,IAAK,IAQxBmuB,EAvBA,GAAal0B,EAAAk0B,SAyBb,IAAA2N,EAAA,oBAAAA,KAkDA,OAjDWA,EAAAC,YAAP,WACE,OAAOl0B,EAAAhL,QAEL,UAAW,QAAS,SAAU,OAAQ,OAAQ,SAAU,QAAS,MAAO,OAAQ,QAAS,UAAW,SAAU,SAAU,SAAU,SAClI,MAAO,SAAU,UAAW,QAAS,OAAQ,UAAW,QAAS,QAAS,SAAU,OAAQ,MAAO,MAAO,OAAQ,aAAc,YAChI,WAAY,OAAQ,OAAQ,MAAO,SAGnC,UAAW,QAAS,YAAa,UAAW,OAAQ,OAAQ,OAAQ,MAAO,QAAS,SAAU,QAAS,QAAS,OAAQ,QAAS,QACjI,WAAY,UAAW,UAAW,UAAW,WAAY,UAAW,QAAS,aAAc,WAAY,YAAa,UAAW,UAC/H,QAAS,SAAU,UAAW,SAAU,SAAU,UAAW,UAAW,WAAY,UAAW,WAAY,SAAU,WAAY,YACjI,SAAU,SAAU,MAAO,MAAO,QAAU,UAAW,SAAU,SAAU,QAAS,UAAW,YAAa,YAAa,WAAY,QACrI,OAAQ,OAAQ,WAAY,WAAY,UAAW,WAAY,UAAW,UAAW,UAAW,QAAS,SAAU,SAAU,QAAS,QACtI,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,MAAO,MAAO,MAAO,MAAO,OAAQ,QAAS,QAAS,OAAQ,OAAQ,UAAW,QACzI,SAAU,SAAU,SAAU,UAAW,SAAU,SAAU,UAAW,SAAU,UAAW,UAAW,OAAQ,QAAS,QAAS,QAAS,YAC3I,WAAY,OAAQ,QAAS,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,UAAW,UACxI,UAAW,UAAW,UAAW,UAAW,UAAW,WAAY,WAAY,SAAU,UAAW,MAAO,SAAU,YAAa,WAAY,OAG9I,WAAY,UAAW,OAAQ,QAAS,YAAa,SAAU,SAAU,WAAY,WAAY,YACjG,YAAa,YAAa,QAAS,SAAU,UAAW,UAAW,QAAS,SAAU,QAAS,OAAQ,QAAS,SAChH,UAAW,UAAW,UAAW,UAAW,WAAY,WAAY,WAAY,UAAW,WAAY,UAAW,UAmBjHi/B,EAAAE,UAAP,WACE,OAAO7N,EAAOsN,QAAQ5zB,EAAAhL,OAAOi/B,EAAMG,SAASv5B,OAAO,KAG9Co5B,EAAAI,aAAP,WACE,OAAO/N,EAAOsN,QACZ5zB,EAAAhL,OAAOi/B,EAAMK,YACbhpB,QAAQ,KAfL2oB,EAAAG,OACF9N,EAAOC,QAAOzyB,QAGZmgC,EAAAK,UACFhO,EAAOE,UAAS1yB,QAYvBmgC,EAlDA,GAAa7hC,EAAA6hC,iwDC5Bb,IAAAM,EAAAviC,EAAA,GACA+B,EAAA/B,EAAA,GACA8K,EAAA9K,EAAA,GACAgO,EAAAhO,EAAA,GAGA6N,EAAA7N,EAAA,GACAwiC,EAAAxiC,EAAA,IACAyiC,EAAAziC,EAAA,IAEA0iC,EAAA1iC,EAAA,IAEAoyB,EAAApyB,EAAA,IACA2iC,EAAA3iC,EAAA,IACA4iC,EAAA5iC,EAAA,IACA8J,EAAA9J,EAAA,GAEA6iC,EAAA,SAAAp8B,GASI,SAAAo8B,EACWlW,EACCmW,EACAC,YADAD,MAAA,cACAC,MAAA,KAHZ,IAAAp8B,EAKIF,EAAAtH,KAAAyH,KAAM,EAAGm8B,EAAQ,EAAGD,EAAGC,EAAO3Q,EAAA6P,MAAME,cAAYv7B,KAJzCD,EAAAgmB,QACChmB,EAAAm8B,IACAn8B,EAAAo8B,QATZp8B,EAAAq8B,YAgRAr8B,EAAAs8B,YAAsB,EApQlBt8B,EAAKsV,OAAStV,EAAKsV,OAAOnY,OAAO,SAAAoY,GAAS,QAAEA,aAAiBqmB,EAAGpmB,OAAOC,oBAEvEzV,EAAKu8B,aAAe9Q,EAAA6P,MAAMI,eAC1B17B,EAAKw8B,IAAM,IAAIphC,EAAAihB,MAAM,GAAI+f,EAAOD,EAAGC,EAAOp8B,EAAKu8B,cAC/Cv8B,EAAKyM,IAAIzM,EAAKw8B,KAEd,IAAIC,GAASL,EAAQ,EACjBM,EAAgC,EAAlBv5B,EAAAtD,KAAK8C,WACvB3C,EAAK28B,YAAYF,EAAOC,EAAa18B,EAAK6B,MAAM8Q,QAAQ,MAKxD,IAFA,IACIiqB,EAAcR,EADD,GAEH1jB,EAAA,EAAAtG,EAAA/K,EAAA7K,MAFG,IAEHkc,EAAAtG,EAAAla,OAAAwgB,IAAmB,CAA5B,IAAI1gB,EAACoa,EAAAsG,GACN1Y,EAAK28B,YACDF,EAAQC,EAAeE,EAAc,EAAMA,GAAe5kC,EAAI,GAC9D4kC,EACA58B,EAAK6B,MAAMK,OAAO,IAAO,IAAOlK,IAGrB8f,OAAX9X,EAAK6B,MAAMiW,QAEnB9X,EAAK68B,UAAW,IAAIb,EAAAc,WAChBV,EAAM,EACPp8B,EAAKsW,WACLtW,EAAK6B,MAAM8Q,QAAQ,KACnB3S,EAAKu8B,aAAa5pB,QAAQ,MAG7B3S,EAAKyM,IAAIzM,EAAK68B,WAGd78B,EAAK+8B,6BAwQb,OAvT4Bv8B,EAAA07B,EAAAp8B,GAmDxBo8B,EAAA5jC,UAAA0kC,QAAA,SAAQC,GAAYh9B,KAAKg9B,IAAMA,GAE/Bf,EAAA5jC,UAAA4kC,SAAA,WACQj9B,KAAK6Z,SACL7Z,KAAK6Z,OAAOqjB,WAEZl9B,KAAKm9B,OAAOn9B,KAAK6Z,SAGjB7Z,KAAKwgB,aACLxgB,KAAKwgB,WAAW0c,WAEhBl9B,KAAKm9B,OAAOn9B,KAAKwgB,cAKzByb,EAAA5jC,UAAAykC,yBAAA,WACI98B,KAAKi9B,WAGLj9B,KAAK6Z,OAAS,IAAI+hB,EAAAwB,OAAO,GAAIp9B,KAAKm8B,MAAQ,GAC1Cn8B,KAAKwM,IAAIxM,KAAK6Z,QAKd7Z,KAAKwgB,WAAa,IAAIqb,EAAAwB,WAAWr9B,KAAMA,KAAK+lB,OAC5C/lB,KAAKwM,IAAIxM,KAAKwgB,aAOlBpoB,OAAA6B,eAAIgiC,EAAA5jC,UAAA,QAAA+B,IAAJ,WAAa,OAAO4F,KAAKs9B,6CACzBllC,OAAA6B,eAAIgiC,EAAA5jC,UAAA,QAAA+B,IAAJ,WAAa,OAAO4F,KAAKu9B,6CAEzBtB,EAAA5jC,UAAAmlC,QAAA,SAAQC,GACJz9B,KAAKu9B,YAAcE,EACnBz9B,KAAKs9B,YAAethC,KAAKK,MAAMohC,EAAO,IAAO,GAE7C,IAAIC,EAAW19B,KAAK29B,KAAO,EAGvBC,EADS5hC,KAAKK,MAAMohC,EAAO,IACX,GAGhBI,EAAO79B,KAAK89B,gBAAgB99B,KAAK29B,MACjCI,EAAO/9B,KAAK89B,gBAAgBJ,GAC5BM,EAAO52B,EAAAjI,UAAU4+B,EAAMF,EAAMD,GACjC59B,KAAKi+B,aAAaD,IAGd/B,EAAA5jC,UAAA4lC,aAAR,SAAqBC,GACjBl+B,KAAKu8B,IAAI36B,MAAQs8B,EAEjB,IAAItkC,EACAoG,KAAKu8B,IAAI36B,MAAM8Q,QAAQ,KAI3B1S,KAAK48B,UAAUuB,MAAMvkC,IAGzBqiC,EAAA5jC,UAAAylC,gBAAA,SAAgBH,GACZ,IAAI/jC,EAAIoG,KAAKs8B,aAAazkB,QACtBumB,GACAC,MAAOzkC,EAAEqI,OAAO,IAChBq8B,KAAM1kC,EAAEqI,OAAO,IACfs8B,QAAS3kC,EAAE8Y,QAAQ,IACnB8rB,UAAW5kC,EAAE8Y,QAAQ,IAAKQ,WAAW,IACrCurB,QAAS7kC,GAETd,EAAgB,KACpB,GAAI6kC,GAAQ,GAAKA,EAAO,EAAG,CACvB,IAAIC,GAAOD,EAAO,GAAK,EACvB7kC,EAASslC,EAASE,KAAK5rB,QAAQkrB,QACxBD,GAAQ,GAAKA,EAAO,IACvBC,GAAOD,EAAO,GAAK,GACvB7kC,EAASslC,EAASG,QAAQ7rB,QAAQkrB,IAC3BD,GAAQ,IAAMA,EAAO,GAC5B7kC,EAASslC,EAASI,UACXb,GAAQ,IAAMA,EAAO,IACxBC,GAAOD,EAAO,IAAM,GACxB7kC,EAASslC,EAASI,UAAUv8B,OAAO27B,IAC5BD,GAAQ,IAAMA,EAAO,IACxBC,GAAOD,EAAO,IAAM,GACxB7kC,EAASslC,EAASK,QAAQx8B,OAAO27B,IAC1BD,GAAQ,GACf7kC,EAASslC,EAASC,MACXV,EAAO,IACd7kC,EAASslC,EAASC,OAEtB,OAAOvlC,GAOXV,OAAA6B,eAAIgiC,EAAA5jC,UAAA,oBAAAqmC,IAAJ,SAAqBC,GACjB,GAAIA,aAA4Bz6B,EAAAC,SAAU,CACtC,IAAInG,EAAc2gC,EACd3+B,KAAKg9B,KACLh9B,KAAKg9B,IAAI4B,SAAS5gC,QAEnB,GAAI2gC,aAA4B7C,EAAArc,OAAQ,CAC3C,IAAI5lB,EAAY8kC,EACZ3+B,KAAKg9B,KACLh9B,KAAKg9B,IAAI4B,SAAS/kC,qCAKtBoiC,EAAA5jC,UAAAqkC,YAAR,SAAoBxoB,EAAWtQ,EAAchC,GACzC,IAAIi9B,EAAW,IAAI1jC,EAAAihB,MAAM,EAAGlI,EAAGlU,KAAKqW,WAAYzS,EAAMhC,GACtD5B,KAAKwM,IAAIqyB,IAGb5C,EAAA5jC,UAAAyd,KAAA,SAAKC,EAA+BC,GAChCnW,EAAAxH,UAAMyd,KAAIvd,KAAAyH,KAAC+V,EAAKC,GAEZhW,KAAK8+B,uBACL9+B,KAAK8+B,sBAAsBhpB,KAAKC,EAAKC,IAI7C5d,OAAA6B,eAAIgiC,EAAA5jC,UAAA,WAAA+B,IAAJ,WAII,IAEI2kC,EAFY/+B,KAAK6Z,OAAOC,UACFpd,IAAI,SAAAsB,GAAK,OAAAA,EAAE0M,YACVlP,OAAOyL,EAAA8K,WAAY9K,EAAA0D,eAE1Cq0B,EAAgBh/B,KAAKwgB,WAAWye,SAAShnC,OAI7C,OAHA8mC,EAAoB/yB,QAAEJ,OAASozB,EAC/BD,EAAmBlzB,OAAED,QAAUozB,EAC/BD,EAAkBjzB,MAAEF,QAAUozB,EACvBD,mCAGX9C,EAAA5jC,UAAA2e,OAAA,SAAOC,EAAQjB,GACXnW,EAAAxH,UAAM2e,OAAMze,KAAAyH,KAACiX,EAAQjB,GAErBhW,KAAK6Z,OAAOC,UAAUnb,QAAQ,SAAAyN,GAAY,OAAAA,EAAS4K,OAAOC,EAAQjB,KAClEhW,KAAKwgB,WAAWye,SAAStgC,QAAQ,SAAAgjB,GAAW,OAAAA,EAAQ3K,OAAOC,EAAQjB,MAGvE5d,OAAA6B,eAAIgiC,EAAA5jC,UAAA,yBAAA+B,IAAJ,WACI,OAAO4F,KAAK6Z,OAAOilB,uDAGvB7C,EAAA5jC,UAAA2gB,OAAA,SAAOsL,GACCtkB,KAAKg9B,KACLh9B,KAAKg9B,IAAIkC,iBAAiB5a,IAIlC2X,EAAA5jC,UAAA6gB,MAAA,SAAMoL,GACEtkB,KAAKg9B,KACLh9B,KAAKg9B,IAAImC,iBAAiB7a,IAIlC2X,EAAA5jC,UAAA+mC,cAAA,SAAchzB,GACVpM,KAAK6Z,OAAOulB,cAAchzB,IAG9B6vB,EAAA5jC,UAAAiU,SAAA,SAASC,EAAa4M,sBACdnZ,KAAKwgB,WAAWye,SAAShnC,OAAS+H,KAAKq/B,OAGvCr/B,KAAKwgB,WAAW8e,SAAS/yB,EAAK4M,GAE9B9W,QAAQ0gB,KAAK,gDAIrB3qB,OAAA6B,eAAIgiC,EAAA5jC,UAAA,UAAA+B,IAAJ,WACI,IAEImlC,EAFUv/B,KAAK6Z,OAAOoP,qBACFvsB,IAAI,SAAC7C,GAAc,OAAAA,EAAE0hB,QAAQ7Q,UACblP,OAAOyL,EAAA8K,WAAY9K,EAAA0D,eAEvD60B,GAAUv4B,EAAAyK,UAAU1F,QAAS/E,EAAAyK,UAAU5F,MAAO7E,EAAAyK,UAAU7F,QAC5D,OAAO7P,KAAKG,IAAI,EAAGH,KAAKC,IAAGrD,MAARoD,KACZwjC,EAAO9iC,IAAI,SAAA+iC,GAAO,OAAAx4B,EAAA0K,kBAAkB4tB,EAAyBE,wCAIxExD,EAAA5jC,UAAAsiB,sBAAA,SAAsB7d,EAAgB4iC,EAAsC1iC,GACxE,gBADwEA,MAAA,WAAyC,WAC1GgD,KAAK6Z,OAAOc,sBAAsB7d,EAAQ4iC,EAAgB1iC,IAGrEi/B,EAAA5jC,UAAAsnC,cAAA,SAAc7iC,EAAgB8iC,EAAuC5iC,GACjE,gBAD0B4iC,mBAAuC5iC,MAAA,WAAuC,WACjGgD,KAAK6Z,OAAO8P,oBAAoB7sB,EAAQ8iC,EAAc5iC,IAGjEi/B,EAAA5jC,UAAAwnC,YAAA,SAAYC,EAAgBC,GACxB,OAAO//B,KAAK6Z,OAAOgmB,YAAYC,EAAQC,IAG3C9D,EAAA5jC,UAAAq4B,kBAAA,SAAkBoP,EAAgBC,GAC9B,OAAO//B,KAAK6Z,OAAO6W,kBAAkBoP,EAAQC,IAGjD3nC,OAAA6B,eAAIgiC,EAAA5jC,UAAA,cAAA+B,IAAJ,WAGI,OAFc4F,KAAK6Z,OAAOoP,qBACevsB,IAAI,SAAA7C,GAAK,OAAAA,EAAEyQ,YAE/C5N,IAAI,SAAA0lB,GAAM,MAAY,eAAZA,EAAG7X,KAAwB6X,EAAGhjB,OAAS,IACjD5D,OAAO,SAACwkC,EAAKP,GAAQ,OAAAA,EAAMO,GAAK,IAAA7lC,YAAA,EAAAD,cAAA,IAGzC9B,OAAA6B,eAAIgiC,EAAA5jC,UAAA,mBAAA+B,IAAJ,WACI,IAAI0a,EAAU9U,KAAK6Z,OAAOqL,iBAC1B,OAAO9d,EAAA/J,WAAWyX,EAAQpY,IAAI,SAAA7C,GAAK,OAAAA,EAAE8lB,4CAGzCsc,EAAA5jC,UAAA4nC,eAAA,SAAeC,GACX,OAAOlgC,KAAK6Z,OAAOoP,qBAAqB/pB,KAAK,SAAArF,GAAK,OAAAA,EAAE0hB,mBAAmB2kB,KAIrEjE,EAAA5jC,UAAA8nC,iBAAN,kBAAA9lC,EAAA2F,UAAA,wBAAAxC,EAAAyO,EAAA1R,EAAA,OAAAlB,EAAA2G,KAAA,SAAAjI,GAAA,OAAAA,EAAAiqB,OAAA,cAC6B,IAArBhiB,KAAKq8B,aAAL,MACA,EAAMj1B,EAAAnJ,MAAM,aAAZkU,EAAA4P,wBAEJ,GAAI/hB,KAAKwgB,YAAcxgB,KAAKwgB,WAAWye,UAAYj/B,KAAKwgB,WAAWye,SAAShnC,OAAS,EAAG,CAIpF,IAASoU,KAHTrM,KAAKq8B,aAAe,EAChB+D,EAAe,EAAIpkC,KAAKK,MAAM2D,KAAKq8B,YAAc,GACjDgE,EAAY,EAAIj5B,EAAAhL,OAAOgL,EAAA7K,MAAM6jC,IACfh5B,EAAA7K,MAAM8jC,GACpBrgC,KAAKsgC,aAETj+B,QAAQ0gB,KAAK,QAAQsd,EAAS,6BAIxBpE,EAAA5jC,UAAAioC,WAAd,kBAAAjmC,EAAA2F,UAAA,wBAAAxC,EAAAyO,EAAA1R,EAAAxC,EAAAiC,EAAAK,EAAAwB,EAAA2pB,EAAA,OAAAnsB,EAAA2G,KAAA,SAAA3G,GAAA,OACQm1B,KACArV,EAAQnd,KAAKM,SAAW,IACxBsvB,EAAQ5rB,KAAKq8B,YAAc,EAAIrgC,KAAKM,SAAW,GAAMN,KAAKM,SAAW,IACrEikC,GAAY/R,KAAIA,EAAErV,MAAKA,EAAEyS,MAAKA,IAE9BkU,EAAS9/B,KAAK6Z,OAAOimB,OAAOjoB,SACzB3D,EAAIlU,KAAKwgC,SAAW,EACvB5c,EAAuB,GAAhB5nB,KAAKM,SACZmkC,EACA,IAAIzE,EAAAvQ,QAAQ,SAAUqU,EAAOtzB,IAAI,IAAIrR,EAAAga,OAAO,IAAOyO,EAAM,IAAK5jB,KAAMugC,GAExEvgC,KAAKwgB,WAAWC,QAAQtoB,KACpBsoC,GAGJzgC,KAAK+lB,MAAMvZ,IAAIi0B,GACXxZ,EAAS7f,EAAAvK,QAAQ4jC,EAAOl0B,IAAKvM,KAAKwgB,WAAWye,SAAU,SAACrlC,GAAM,OAAAA,EAAE2S,MACpEk0B,EAAOlP,cAActK,YAE7BgV,EAvTA,CAA4B9gC,EAAAihB,OAAf5iB,EAAAyiC,waCjBb,IAAA9gC,EAAA/B,EAAA,GACA8K,EAAA9K,EAAA,GAEA0iC,EAAA1iC,EAAA,IACAsnC,EAAAtnC,EAAA,IAEAua,EAAAva,EAAA,GACAsa,EAAAta,EAAA,IACAkmB,EAAAlmB,EAAA,IACAgO,EAAAhO,EAAA,GACA8N,EAAA9N,EAAA,GAEAunC,EAAAvnC,EAAA,IAOAwnC,EAAA,SAAA/gC,GAmBI,SAAA+gC,EAAoB5sB,EAAwByjB,EAAoBoJ,GAAhE,IAAA9gC,EACIF,EAAAtH,KAAAyH,YADgBD,EAAAiU,SAAwBjU,EAAA03B,OAAoB13B,EAAA8gC,eAlBxD9gC,EAAA+gC,cASA/gC,EAAAghC,QACAhhC,EAAAihC,SAAqB,IAAIL,EAAAM,SACzBlhC,EAAAmhC,gBAA2B,KAC3BnhC,EAAAohC,kBACAphC,EAAAqhC,eAAyB,oCACjCrhC,EAAAshC,iBACAthC,EAAAuhC,gBAA8B,KA6R9BvhC,EAAAwhC,gBAxRI,IAAIC,EAAU,SAAChkC,GAAM,OAAAuC,EAAK0hC,kBAAkBjkC,WAE5CuC,EAAKi9B,IAAM,IAAI0D,EAAAgB,IAAI3hC,EAAK03B,KAAM+J,EAASA,EAASA,EADjC,SAAC5nC,GAAM,OAAAmG,EAAK4hC,gBAAgB/nC,KAE3CmG,EAAKiU,OAAO+oB,QAAQh9B,EAAKi9B,OAsVjC,OA9WkCz8B,EAAAqgC,EAAA/gC,GA2B9B+gC,EAAAvoC,UAAAupC,QAAA,SAAQC,GACJ7hC,KAAK+lB,MAAMvZ,IAAIxM,KAAKg9B,KACpBh9B,KAAKg9B,IAAInV,OACL7nB,KAAK+gC,MACL/gC,KAAK8hC,UAET9hC,KAAK+hC,YAAYF,IAGrBjB,EAAAvoC,UAAA4kC,SAAA,WACIj9B,KAAK+lB,MAAMoX,OAAOn9B,KAAKg9B,KACvBh9B,KAAKg9B,IAAInyB,OACT7K,KAAKgiC,qBACLhiC,KAAKiiC,iBAGTrB,EAAAvoC,UAAA2e,OAAA,SAAOC,EAAgBjB,GAAvB,IAAAjW,EAAAC,KACQ8U,EAAU9U,KAAKgU,OAAO6F,OAAOoP,qBAC7BrN,EAAWjI,EAAA3C,YAAY9T,OAAO,SAAAqe,GAAW,OAAAzG,EAAQ4L,KAAK,SAAArV,GAAU,OAAAA,EAAOkQ,mBAAmBA,MAC1F2mB,EAAaliC,KAAKghC,SAASmB,uBAAuBvmB,GACtD,GAAIsmB,EAAY,CACZ,IAAIE,EAAOpiC,KAAKghC,SAASqB,OAAOH,GAChCliC,KAAKqiC,OAAOD,GAEhBpiC,KAAKg9B,IAAIsF,cAActiC,KAAKgU,OAAQhU,KAAKghC,SAAUhhC,KAAKkhC,mBAAuBlhC,KAAKgU,OAAOypB,MACtFz9B,KAAK+gC,MAAS/gC,KAAKqhC,eAA4D,IAA3CrhC,KAAKgU,OAAOwM,WAAWye,SAAShnC,SACrE+H,KAAK+gC,QACL/gC,KAAKuiC,SAAS,sCAAuC,WAAM,OAAAxiC,EAAK+hC,WAAW,WAAM,OAAA7qB,EAAOurB,UAAU,WAGtG,IAAIj2B,EAAM0K,EAAOohB,MAAMC,SAAS3K,QAAQ8U,aACpCC,EACG1iC,KAAKgU,OAAO6F,OAAOqL,iBAAgB5nB,OACnC0C,KAAKgU,OAAO6F,OAAOC,WAG1B,GAAI4oB,EAAWzqC,OAAS,EAAG,CACvByqC,EAAW/jC,QAAQ,SAAAgkC,GAAK,OAAAA,EAAEluB,WAC1B,IAAImuB,EAAS,SAAC/oC,GACV,IAAI0S,EAAM1S,EAAE43B,cAIZ,OAHI53B,aAAaqK,EAAAC,UACboI,EAAI0O,SAAS,IAAI9f,EAAAga,OAAOtb,EAAEwc,WAAW,EAAGxc,EAAE0d,YAAY,IAEnDhL,GAGPs2B,EAA+Bz7B,EAAAvK,QAC/B0P,EACAm2B,EACAE,GAEAC,GAAaD,EAAOC,GAAWzlC,SAASmP,GAAOs2B,EAAUxsB,aAEzDwsB,EAAUpuB,SAEVzU,KAAKg9B,IAAI4B,SAASiE,MAM9BzqC,OAAA6B,eAAI2mC,EAAAvoC,UAAA,UAAA+B,IAAJ,WAAe,OAAO4F,KAAKy3B,KAAKqL,aAAapL,wCAC7CkJ,EAAAvoC,UAAA0pC,YAAA,SAAYgB,GAAZ,IAAAhjC,EAAAC,KACI+iC,EAAW7K,YAAY,WAAM,OAAAn4B,EAAKkiC,kBAClCc,EAAWhL,OAAO,SAACxrB,GACf,IAAIxM,EAAKohC,eAAT,CAGA,IAAI6B,EAAoBjjC,EAAKiU,OAAO8qB,sBACpC,GAAIkE,aAA6B9+B,EAAAC,SAAU,CACvC,IAAI8+B,EAAcD,EAAkBprB,gBAAgBrL,GACpDy2B,EAAkBlrB,QAAQmrB,QAErBD,aAA6BlH,EAAArc,QAClCujB,EAAkBve,KAAK1kB,EAAKiU,OAAQzH,MAG5Cw2B,EAAW9K,YAAY,SAAC1rB,EAAa7T,GACjC,IAAIqH,EAAKohC,eAAT,CAGA,IAAM6B,EAAoBjjC,EAAKiU,OAAO8qB,sBACtC,GAAIkE,EACA,GAAIA,aAA6B9+B,EAAAC,SAAU,CACvC,IAAI++B,EAA4BF,EAC5BG,GAAkBD,EAA0BtpB,cAChD,GAAIspB,GAA6BC,GAAkBD,EAA0BjrB,YAAY1L,GAAM,CAE3F,GADAxM,EAAKiU,OAAOorB,cAAc8D,GACtBnjC,EAAKuhC,gBAAiB,CACtB,IAAIvlC,EAAKgE,EAAKuhC,gBACdl6B,EAAA5I,IAAIzC,EAAG6f,SAAUsnB,EAA0BtsB,gBAAgBjY,QAAQ,SAACwT,OAACoJ,EAAApJ,EAAA,GAAS0E,EAAA1E,EAAA,GACtExY,OAAS4hB,GAAWpQ,aACpBE,EAAS,IAAIywB,EAAArc,OAAO9lB,EAAGkd,EAAMC,UACjCosB,EAA0B9nB,UAAU/P,KAExCtL,EAAKuhC,gBAAkB,KAE3BvhC,EAAKi9B,IAAIoG,UAAUrjC,EAAKqhC,gBACxBrhC,EAAKiU,OAAO6F,OAAOilB,sBAAwB,KAC3C/+B,EAAKsjC,oBAAoB92B,QAG5B,CACD,IAAI+2B,EAA0BN,EAC1BG,EAAkBG,EAAwB1/B,OAASsD,EAAAlE,WAAWM,OAC7DggC,EAAwB1pB,cACf0pB,EAAwB7e,KAAK1kB,EAAKiU,SACjCmvB,IACPG,EAAwB1/B,OAASsD,EAAAlE,WAAWM,KAC/BggC,EAAwBtjB,aAC9BuF,cAAc+d,GAGVA,EAAwBl3B,SAC9BgP,UAAUkoB,GAEnBvjC,EAAKiU,OAAO6F,OAAOilB,sBAAwB,KAC3C/+B,EAAKi9B,IAAIoG,UAAUrjC,EAAKqhC,gBACpB1oC,GACAqH,EAAK0hC,kBAAkB6B,EAAwB/nB,cAMnEwnB,EAAW5K,WAAW,SAACx3B,GACfZ,EAAKohC,iBAGLxgC,IAAQxF,EAAAu9B,MAAMI,KAAKyK,EACfxjC,EAAK+Z,WAAa/Z,EAAK+Z,UAAU,KACjC/Z,EAAKkiC,gBACLliC,EAAK23B,OAAO6B,KAAKx5B,EAAK+Z,UAAU,GAAGvN,IAAK,KACxCxM,EAAK23B,OAAOzD,KAAK,GAAK,MAGrBtzB,IAAQxF,EAAAu9B,MAAMI,KAAK0K,MACxBzjC,EAAKiU,OAAO6F,OAAOilB,sBAAwB,KAC3C/+B,EAAKuhC,gBAAkB,KACvBvhC,EAAKkiC,kBACLliC,EAAKi9B,IAAIoG,UAAUrjC,EAAKqhC,qBAKpCR,EAAAvoC,UAAAorC,gBAAA,WACIzjC,KAAK8gC,cACL9gC,KAAKg9B,IAAIyG,mBAGbrrC,OAAA6B,eAAI2mC,EAAAvoC,UAAA,aAAA+B,IAAJ,WAAkB,OAAO4F,KAAKgU,OAAO6F,OAAOC,2CAC5C8mB,EAAAvoC,UAAAypC,QAAA,eAAA/hC,EAAAC,KACIA,KAAKgU,OAAO8oB,2BACZ98B,KAAK+gC,QACL/gC,KAAKqhC,iBACLrhC,KAAK0jC,YAAY1jC,KAAK6gC,aAAc,WAAM,OAAA9gC,EAAKsjC,wBAC/CrjC,KAAK03B,OAAOzD,KAAK,MAGrB2M,EAAAvoC,UAAAsrC,eAAA,SAAehiB,GACX3hB,KAAKiiC,gBACLjiC,KAAK4jC,eAAiB,IAAIzoC,EAAA0oC,0BAA0BliB,GACpD3hB,KAAK03B,OAAOzD,KAAK,IAAK,KACtBj0B,KAAK03B,OAAOoM,YAAY9jC,KAAK4jC,gBAC7B5jC,KAAKkhC,gBAAkBvf,GAE3Bif,EAAAvoC,UAAA4pC,cAAA,SAAc8B,sBACN/jC,KAAK4jC,iBACL5jC,KAAK03B,OAAOsM,eAAehkC,KAAK4jC,gBAC5BG,GACA/jC,KAAK03B,OAAOzD,KAAK,GAAK,KAE1Bj0B,KAAKkhC,gBAAkB,OAG/BN,EAAAvoC,UAAAopC,kBAAA,SAAkBwC,EAAsD13B,kBAAA,IAAkBpR,EAAAga,OAAO,EAAG,IAChGnV,KAAKg9B,IAAI4B,SAASqF,GAClB,IAAIC,EAAa,KACjB,GAAID,aAA8B3kB,EAAAyU,UAAW,CACzC,IAAIhgB,EAAYkwB,EAChBjkC,KAAKg9B,IAAIoG,UAAU,SAASrvB,EAAUja,KAAI,KAAKia,EAAU9J,YAAW,KACpEi6B,EAAalkC,KAAKmkC,cAAcpwB,EAAWxH,GACvCvM,KAAKqhC,gBACLrhC,KAAK03B,OAAOzD,KAAKlgB,EAAUkgB,KAAM,KACjCj0B,KAAK03B,OAAOnrB,IAAM23B,EAAW33B,IAC7BvM,KAAKqhC,uBAGR,GAAI4C,aAA8BtwB,EAAA3J,QAAS,CAC5C,IAAIuR,EAAU0oB,EACdjkC,KAAKg9B,IAAIoG,UAAU,WAAW7nB,EAAQzhB,KAAI,KAAKyhB,EAAQtR,YAAW,KAClEi6B,EAAalkC,KAAKokC,YAAY7oB,EAAShP,QAEtC,GAAI03B,aAA8BvwB,EAAA2hB,WAAY,CAC/C,IAAIt5B,EAAiBkoC,EACrBjkC,KAAKg9B,IAAIoG,UAAU,SAASrnC,EAAGjC,KAAI,KAAKiC,EAAGkO,YAAW,KACtDi6B,EAAalkC,KAAKqkC,cAActoC,EAAIwQ,GACpCvM,KAAKshC,gBAAkBvlC,EAE3BiE,KAAKgU,OAAO6F,OAAOilB,sBAAwB,KACvCoF,IACAlkC,KAAKgU,OAAO6F,OAAOilB,sBAAwBoF,IAGzCtD,EAAAvoC,UAAA+rC,YAAV,SAAsB7oB,EAAkBhP,GACpC,IAAIlB,EAAS,IAAIywB,EAAArc,OAAOlE,EAAShP,GAIjC,OAHIlB,EAAOoZ,KAAKzkB,KAAKgU,UACjBhU,KAAK03B,OAAOnrB,IAAMlB,EAAOkB,KAEtBlB,GAEHu1B,EAAAvoC,UAAA8rC,cAAR,SAAsBpwB,EAAsBxH,GACxC,IAAI+3B,EAAkBtkC,KAAKukC,8BAA8BxwB,EAAWxH,GAEpE,OADA+3B,EAAgBxsB,QAAQwsB,EAAgB1sB,gBAAgBrL,IACjD+3B,GAEH1D,EAAAvoC,UAAAksC,8BAAR,SAAsCxwB,EAAsBxH,GAGxD,OADe,MADJrI,EAAAmC,eAAe0N,EAAUigB,OACZznB,EAAKwH,EAAW/T,KAAKgU,SAGzC4sB,EAAAvoC,UAAAgsC,cAAR,SAAsBtoC,EAAgBwQ,GAClC,IAAIi4B,EAA2BzoC,EAAGgY,WAAa,IAAIhY,EAAGgY,UACtD,IAAKywB,EAAc,CACfA,EAAe,IAAIllB,EAAAmV,eACnB,IAAI7Y,EAAW7f,EAAG6f,SAASlf,IAAI,SAAA/C,GAAK,WAAIA,IACpCiiB,EAAS8E,KAAK,SAAA/mB,GAAK,OAAAA,EAAEiK,OAASsD,EAAAlE,WAAWQ,WACzCghC,EAAe,IAAIllB,EAAAuV,iBAEnBjZ,EAAS8E,KAAK,SAAA/mB,GAAK,OAAAA,EAAEiK,OAASsD,EAAAlE,WAAWS,UACzC+gC,EAAe,IAAIllB,EAAAwV,WAEnBlZ,EAAS8E,KAAK,SAAA/mB,GAAK,OAAAA,EAAEiK,OAASsD,EAAAlE,WAAWU,SACzC8gC,EAAe,IAAIllB,EAAAyV,UAEnBnZ,EAAS8E,KAAK,SAAA/mB,GAAK,OAAAA,EAAEiR,YACrB45B,EAAe,IAAIllB,EAAAqV,WAG3B,IAAIvoB,EAAWpM,KAAKukC,8BAA8BC,EAAcj4B,GAEhE,OADAH,EAAS0L,QAAQ1L,EAASwL,gBAAgBxL,EAASG,MAC5CH,GAEHw0B,EAAAvoC,UAAAosC,+BAAR,WACI,IAAIC,EAAO9D,EAAa+D,+BAA+BjoC,IAAI,SAAAkoC,GAAO,WAAIA,IAClEC,EAAuB7kC,KAAK8Z,UAAUpd,IAAI,SAAA0P,GAAY,OAAAA,EAAS2H,UAAUja,OACzEgrC,EAAsB19B,EAAA/J,WAAW2C,KAAK8Z,UAAUpd,IAAI,SAAA0P,GAAY,OAAAA,EAASgK,eAAiBhK,EAASgK,cAActc,QACjHirC,EAAkBF,EAAoBvnC,OAAKwnC,GAC/C,OAAOJ,EAAKxlC,KAAK,SAAA0lC,GAAO,OAACG,EAAYtiB,SAASmiB,EAAI9qC,SAE5C8mC,EAAAvoC,UAAAgrC,oBAAV,SAA8B92B,kBAAA,IAAkBpR,EAAAga,OAAO,EAAG,IACtD,IAAIpB,EAAY,KACZixB,EAAchlC,KAAKykC,iCAIvB,GAHIO,IACAjxB,EAAYixB,GAEZjxB,EAAW,CACX,IAAIkxB,EAAW79B,EAAAhL,QAAQ,WAAY,WAAY,cAAe,aAAc,QAAS,cAAe,QAAS,aAAc,sBAAuB,mBAC9I8oC,EAAS99B,EAAAhL,QAAQ,8BAA+B,uBAAwB,uBAAwB,yBACpG4D,KAAKmlC,gBAAmBF,EAAQ,IAAIC,EAAM,IAAInxB,EAAUja,KAAI,OAC5DkG,KAAKyhC,kBAAkB1tB,EAAWxH,QAGlCvM,KAAKg9B,IAAIoI,gBAGjBxE,EAAAvoC,UAAAspC,gBAAA,SAAgBhgB,GACR3hB,KAAKkhC,kBAAoBvf,EACzB3hB,KAAKiiC,kBAGLjiC,KAAK2jC,eAAehiB,IAIpBif,EAAAvoC,UAAAqrC,YAAR,SAAoB2B,EAAiBC,GAArC,IAAAvlC,EAAAC,cAAqCslC,MAAA,MACjCtlC,KAAKmhC,kBACLnhC,KAAKg9B,IAAIuI,cAAcF,EAAS,IAC5BG,SAAU,WACNzlC,EAAKiiC,qBAA0BsD,GAC3BA,QAKR1E,EAAAvoC,UAAAkqC,SAAR,SAAiB8C,EAAiBI,EAAkBC,GAApD,IAAA3lC,EAAAC,KACIA,KAAKmhC,kBACLnhC,KAAKg9B,IAAIuI,cAAcF,EAAS,IAC5BM,IAAK,WACD5lC,EAAKiiC,qBAA0ByD,GAC3BA,KAGRG,GAAI,WACA7lC,EAAKiiC,qBAA0B0D,GAC3BA,QAKR9E,EAAAvoC,UAAA8sC,gBAAR,SAAwBE,GAAxB,IAAAtlC,EAAAC,KACQA,KAAKuhC,eACLvhC,KAAKmhC,kBACLnhC,KAAKg9B,IAAIuI,cAAcF,EAAS,IAC5BQ,aAAc,WACV9lC,EAAKiiC,qBACLjiC,EAAKwhC,iBAETiE,SAAU,WAAQzlC,EAAKiiC,0BAI3BpB,EAAAvoC,UAAAgqC,OAAR,SAAeD,GAAf,IAAAn2B,EAAAlM,EAAAC,KACI,IAAIA,KAAK+gC,MAAS/gC,KAAK8gC,WAAvB,CAGI9gC,KAAKmhC,gBACLnhC,KAAKgiC,qBAEThiC,KAAKmhC,kBACL,IAEI2E,EAAO1+B,EAAAhL,QAAQ,aAAc,SAAU,UAAW,YAAa,OAAQ,YAAa,YAAa,kCAAmC,wBAAyB,qBAC7J2pC,EAAQ/lC,KAAKg9B,IAAIuI,cAHD,qHAG8B,YAASpzB,MACtD2zB,GAAO,WAAQ/lC,EAAKiiC,0BAEzB+D,EAAMC,WAAW5D,EAAKtoC,KAAM,GAAIqB,EAAAoE,MAAM+J,QACtCy8B,EAAMC,WAAW5D,EAAKn4B,YAAa,IACnC87B,EAAME,cAAc7D,EAAK8D,QAAQxpC,IAAI,SAAA/C,GAAK,WAAIA,IAAK+C,IAAI,SAAA6e,GACnD,OACI/Q,MAAO+Q,EAAQ/Q,MACfwX,MAAOzG,EAAQzhB,WAInB8mC,EAAAvoC,UAAA2pC,mBAAR,WACIhiC,KAAKg9B,IAAIgF,qBACThiC,KAAKmhC,mBA1WFP,EAAA+D,gCACHjxB,EAAA6hB,eACAjW,EAAAgV,YACA5gB,EAAA+iB,WACAnX,EAAA8U,WACA9U,EAAA4U,SACAxgB,EAAA+hB,gBAsWRmL,EA9WA,CAAkCzlC,EAAAgrC,SAArB3sC,EAAAonC,8aCnBb,IAAAzlC,EAAA/B,EAAA,GACAgO,EAAAhO,EAAA,GACAgtC,EAAAhtC,EAAA,IACA6J,EAAA7J,EAAA,GACAitC,EAAA,SAAAxmC,GAAA,SAAAwmC,IAAA,IAAAtmC,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAumC,UAIAvmC,EAAAm+B,SAAkB/iC,EAAAoE,MAAM8J,KAAKwO,QAG7B9X,EAAAwmC,UAAY,IAAAt6B,EA0DhB,OAlEoC1L,EAAA8lC,EAAAxmC,GAShCzH,OAAA6B,eAAIosC,EAAAhuC,UAAA,aAAA+B,IAAJ,WACI,OAAO4B,KAAKK,MAAM2D,KAAKqW,WAAarW,KAAKumC,4CAE7CF,EAAAhuC,UAAAmuC,aAAA,WAEI,IADA,IAAI5sC,EAAIysC,EAAeI,WACAhuB,EAAA,EAAAtG,EAAA/K,EAAA7K,MAAM3C,GAAN6e,EAAAtG,EAAAla,OAAAwgB,IAAU,CAA5B,IAAIiuB,EAAUv0B,EAAAsG,GACfzY,KAAKsmC,OAAOK,SACRC,OAAQF,EAAa,IAAkC,EAA3BL,EAAe1J,aAC3CkK,OAAQ7mC,KAAK8mC,SAASJ,OAIlCL,EAAAhuC,UAAAyd,KAAA,SAAKC,EAAKC,GAKN,IAJA,IAAI+wB,EAAK/mC,KAAK4B,MAAMiW,QAChBmvB,EAAKhnC,KAAKk+B,SAASrmB,QAAQnF,QAAQ,IACnC4S,EAAM,EAEQ7M,EAAA,EAAAwuB,EADTjnC,KAAKsmC,OAAOprC,QACHud,EAAAwuB,EAAAhvC,OAAAwgB,IAAI,CAAjB,IAAIyuB,EAAKD,EAAAxuB,GACN7e,EAAIwN,EAAAjI,UAAU4nC,EAAIC,EAAK1hB,EAAOtlB,KAAKsmC,OAAaruC,QACpD+H,KAAKmnC,UAAUpxB,EAAKmxB,EAAOttC,GAC3B0rB,GAAO,IAGP+gB,EAAAhuC,UAAA8uC,UAAR,SAAkBpxB,EAAKmxB,EAAOtlC,GAC1B,IAAIwlC,GAAMpnC,KAAKqW,WAAa,EAAGgxB,EAAKrnC,KAAKuM,IAAI2H,EAAIgzB,EAAMN,MACnDhtC,EAAIgI,EAAMiW,QACd9B,EAAI6G,YACJ7G,EAAI8G,OAAOuqB,EAAIC,GAEf,IADA,IAAI/hB,EAAM,EACQ7M,EAAA,EAAAtG,EAAA+0B,EAAML,OAANpuB,EAAAtG,EAAAla,OAAAwgB,IAAc,CAA3B,IAAIzC,EAAK7D,EAAAsG,GACV1C,EAAIgH,OAAOqqB,EAAM9hB,EAAMtlB,KAAKsnC,UAAYD,EAAKrxB,GAC7CsP,GAAO,EAEXvP,EAAIgH,OAAOqqB,EAAMpnC,KAAKumC,UAAYvmC,KAAKsnC,UAAYD,GACnD,IAAI1E,EAAI0D,EAAe1J,YACvB5mB,EAAIgH,OAAOqqB,EAAMpnC,KAAKumC,UAAYvmC,KAAKsnC,UAAYD,EAAK1E,GACxD5sB,EAAIgH,OAAOqqB,EAAIC,EAAK1E,GACpB5sB,EAAIiH,YACJpjB,EAAEiC,EAAI,EACNka,EAAIkH,UAAYrjB,EAAEsI,SAClB6T,EAAItZ,QAEA4pC,EAAAhuC,UAAAyuC,SAAR,SAAiBvsC,GACb,IAAIooC,EAAI0D,EAAe1J,YACnB4K,EAAY5E,EAAI,EAAT,EACPkE,KAEAW,EAAO,EACPC,EAAW9E,EAAE,EACjB,IAAK,IAAIt2B,KAASjF,EAAA7K,MAAMyD,KAAKumC,WAAY,CACrC,IAAImB,EAJiB1rC,KAAKM,SAAWvE,EAAWwvC,EAAO,EAKnDI,EAAO3rC,KAAKG,IAAIqrC,EAAOC,EAASzrC,KAAKC,IAAIyrC,EAAMF,EAAOC,IAC1DZ,EAAO1uC,KAAKwvC,GACZH,EAAOG,EAEX,OAAOd,GA1DJR,EAAA1J,YAAsB15B,EAAAG,MAAMC,MAAMsD,MAClC0/B,EAAAI,WAAa,EA2DxBJ,EAlEA,CAAoCD,EAAAwB,kBAAvBpuC,EAAA6sC,gbCJb,IAEAuB,EAAA,SAAA/nC,GACI,SAAA+nC,EAAY1zB,EAAWC,EAAevS,UAClC/B,EAAAtH,KAAAyH,KAAM,EAAGkU,EAAGC,EAAO,KAAMvS,IAAM5B,KAEvC,OAJsCO,EAAAqnC,EAAA/nC,GAItC+nC,EAJA,CAFAxuC,EAAA,GAEsCgjB,OAAzB5iB,EAAAouC,kGCFb,IAAAzsC,EAAA/B,EAAA,GACA6J,EAAA7J,EAAA,GAEAI,EAAA6mB,YAAA,SAA4BwnB,EAAeC,EAAalkC,kBAAeX,EAAAG,MAAMC,MAAMW,OAC/E,IAAI+b,EAAU,IAAI5kB,EAAA4sC,gBAgBlB,OAfAhoB,EAAQioB,YAAc7sC,EAAA8sC,YAAYC,OAClCnoB,EAAQtB,OAAS7a,EACjBmc,EAAQooB,OAAS,GACjBpoB,EAAQqoB,OAAS,GACjBroB,EAAQsoB,SAAW,EACnBtoB,EAAQuoB,SAAqB,EAAVtsC,KAAKqiB,GACxB0B,EAAQwoB,SAAW,IACnBxoB,EAAQyoB,QAAU,GAClBzoB,EAAQ0oB,YACR1oB,EAAQ2oB,aAAe,IACvB3oB,EAAQ4oB,QAAU,EAClB5oB,EAAQ6oB,QAAU,EAClB7oB,EAAQ8oB,WAAahB,EACrB9nB,EAAQ+oB,SAAWhB,EACnB/nB,EAAQO,cACDP,kaCpBX,IAAA5kB,EAAA/B,EAAA,GACA8J,EAAA9J,EAAA,GACA4iC,EAAA5iC,EAAA,IAEA6J,EAAA7J,EAAA,GAEAusB,EAAA,SAAA9lB,GAEI,SAAA8lB,EAAoBojB,EAAkCC,GAAtD,IAAAjpC,EACIF,EAAAtH,KAAAyH,KACI+oC,EAAOx8B,IAAI0H,EAAI,EAAI+0B,EACnBD,EAAOx8B,IAAI2H,EAAK60B,EAAOxxB,YAAc,EACrCtU,EAAAG,MAAMC,MAAMsD,MACZ,IACH3G,KAK+BgpC,OAXhBjpC,EAAAgpC,SAAkChpC,EAAAipC,sBAoBtDjpC,EAAAkpC,gBAAkB,SAACC,GAEVA,EAAUzvB,iBAAiBuiB,EAAAvQ,SAAWyd,EAAUzvB,MAAMoS,OAIzC9rB,EAAKyuB,OAAS0a,EAAUzvB,MAAMoU,QAG5Cqb,EAAUzvB,iBAAiBuiB,EAAAvQ,SAC3B1rB,EAAKopC,UAAUD,EAAUzvB,QAtB7B1Z,EAAKyuB,KAAOua,EAAOlb,OAEnB9tB,EAAK6B,OAAS7B,EAAKyuB,KAAOrzB,EAAAoE,MAAM6J,MAAQjO,EAAAoE,MAAM8vB,MAAMxX,QAAQnF,QAAQ,IACpE3S,EAAKihB,IAAI/M,EAAI/Q,EAAAtD,KAAKgD,YAAcomC,EAGhCjpC,EAAKihB,IAAI9M,EADG,GACElY,KAAKM,SAAoB,EACvCyD,EAAKw4B,GAAG,iBAAkBx4B,EAAKkpC,iBAC/BlpC,EAAK0V,cAAgBta,EAAAua,cAAcC,QACnC5V,EAAKsV,OAAStV,EAAKsV,OAAOnY,OAAO,SAAAoY,GAAS,QAAEA,aAAiBna,EAAAoa,OAAOC,sBA2C5E,OA9D+BjV,EAAAolB,EAAA9lB,GAsCnB8lB,EAAAttB,UAAA8wC,UAAR,SAAkBxnB,GACd,GAAIA,EAAQmL,SAEJ9wB,KAAKM,SAAW,IAChB0D,KAAKghB,IAAI/M,GAAKjU,KAAKghB,IAAI/M,EACvBjU,KAAKwuB,MAAQxuB,KAAKwuB,KAEdxyB,KAAKM,SAAW,KAChB0D,KAAKghB,IAAI9M,GAAsB,GAAhBlY,KAAKM,SAAiB,KAElCN,KAAKM,SAAW,IAEvB0D,KAAKmmB,YAEN,GAAInqB,KAAKM,SAAW,GAAK,CAC5B0D,KAAKmmB,OACL,IAAIijB,EAAS,EAAqB,EAAhBptC,KAAKM,SACvBqlB,EAAQgR,OAAOyW,EAAQppC,KAAK+oC,UAOxCpjB,EA9DA,CAA+BxqB,EAAAihB,OAAlB5iB,EAAAmsB,2aCNb,IAEA0jB,EAAA,SAAAxpC,GAAA,SAAAwpC,mDAEA,OAF6C9oC,EAAA8oC,EAAAxpC,GACzCwpC,EAAAhxC,UAAAixC,SAAA,WAAa,MAAO,YACxBD,EAFA,CAFAjwC,EAAA,IAE6CyvB,UAAvBrvB,EAAA6vC,gGCFtB,IAAAjiC,EAAAhO,EAAA,GAEA6J,EAAA7J,EAAA,GAEAkf,EAAA,oBAAAA,IACYtY,KAAAupC,SACDvpC,KAAA0W,SACC1W,KAAAwpC,SACAxpC,KAAAypC,gBA+IZ,OA7IWnxB,EAAAjgB,UAAAqxC,QAAP,WACI,OAAO1pC,KAAKupC,OAGhBnxC,OAAA6B,eAAWqe,EAAAjgB,UAAA,QAAA+B,IAAX,WAAoB,OAAO4F,KAAK0W,MAAMze,wCAE/BqgB,EAAAjgB,UAAAse,KAAP,SAAYgzB,GACR3pC,KAAKupC,SACAvpC,KAAK4pC,SAASD,IACf3pC,KAAK0W,MAAMve,KAAKwxC,IAIjBrxB,EAAAjgB,UAAAuxC,SAAP,SAAgBC,GACZ,OAAO7pC,KAAK0W,MAAM+L,SAASonB,IAGxBvxB,EAAAjgB,UAAAmgB,aAAP,SAAoBqxB,EAAaC,EAAiCC,kBAAoB9mC,EAAAG,MAAMC,MAAMS,QAC9F,IAAI4S,EAAQ1W,KAAKgqC,MACbntC,EAAUuK,EAAAtL,MAAM4a,EAAO,SAACC,GAAY,OAAAmzB,EAAQD,EAAUlzB,KAC1D,OAAI9Z,GAAWitC,EAAQjtC,EAASgtC,GAAYE,EACjCltC,EAEJgtC,GAGJvxB,EAAAjgB,UAAAugB,KAAP,SAAYwH,EAAQ6pB,GAChBjqC,KAAK2W,KAAKyJ,GACVpgB,KAAK2W,KAAKszB,GAEV,IAAI5wC,EAAI2G,KAAKrC,QAAQyiB,GAAMvmB,EAAImG,KAAKrC,QAAQssC,GAC5CjqC,KAAKwpC,MAAMnwC,GAAK2G,KAAKwpC,MAAMnwC,OAC3B2G,KAAKwpC,MAAMnwC,GAAGlB,KAAK0B,GAEnBmG,KAAKypC,aAAa5vC,GAAKmG,KAAKypC,aAAa5vC,OACzCmG,KAAKypC,aAAa5vC,GAAG1B,KAAKkB,IAGvBif,EAAAjgB,UAAA6xC,MAAP,SAAaC,GAAb,IAAApqC,EAAAC,KACGmqC,EAAWC,WAAWzrC,QAAQ,SAACwT,OAACtW,EAAAsW,EAAA,GAAEnU,EAAAmU,EAAA,GAAO,OAAApS,EAAK6Y,KAAK/c,EAAEmC,MAGjDsa,EAAAjgB,UAAA+xC,SAAP,WAEI,IADA,IAAIC,KACa5xB,EAAA,EAAAtG,EAAAnS,KAAK0W,MAAL+B,EAAAtG,EAAAla,OAAAwgB,IAAY,CAAxB,IAAI9B,EAAIxE,EAAAsG,GACL/a,EAAQsC,KAAKrC,QAAQgZ,GACzB,GAAI3W,KAAKwpC,MAAM9rC,GACX,IAAuB,IAAA4U,EAAA,EAAA8T,EAAApmB,KAAKwpC,MAAM9rC,GAAX4U,EAAA8T,EAAAnuB,OAAAqa,IAAmB,CAArC,IAAIg4B,EAAUlkB,EAAA9T,GACXi4B,EAAYvqC,KAAK0W,MAAM4zB,GACtBD,EAAS5nB,UAAU8nB,EAAW5zB,KAC/B0zB,EAASlyC,MAAMwe,EAAM4zB,KAKrC,OAAOF,GAGJ/xB,EAAAjgB,UAAAmyC,SAAP,SAAgBX,GAAhB,IAAA9pC,EAAAC,KACQtC,EAAQsC,KAAKrC,QAAQksC,GAEzB,OADa7pC,KAAKyqC,gBAAgB/sC,GACpBhB,IAAI,SAACnC,GAAM,OAAAwF,EAAK2W,MAAMnc,MAGhC+d,EAAAjgB,UAAAoyC,gBAAR,SAAwBC,GACpB,IAAIC,EAAK3qC,KAAKwpC,MAAMkB,OAChBE,EAAQ5qC,KAAKypC,aAAaiB,OAE9B,OADiBC,EAAErtC,OAAKstC,IAIrBtyB,EAAAjgB,UAAA2xC,IAAP,SAAWa,EAAaC,GAAxB,IAAA/qC,EAAAC,cAAW6qC,MAAA,eAAaC,UACpB,IAAIC,EAASF,EAAO7qC,KAAKrC,QAAQktC,GAAQ,EACzC,OAAO7qC,KAAKgrC,SAASD,GAAQruC,IAAI,SAAAnC,GAAK,OAAAwF,EAAK2W,MAAMnc,MAG7C+d,EAAAjgB,UAAA2yC,SAAR,SAAiBC,EAAoBH,GAArC,IAAA/qC,EAAAC,KASI,gBATairC,MAAA,YAAoBH,UACjCA,EAAQ3yC,KAAK8yC,GACEjrC,KAAKyqC,gBAAgBQ,GAC3BtsC,QAAQ,SAACusC,GACTJ,EAAQroB,SAASyoB,IAClBnrC,EAAKirC,SAASE,EAAYJ,KAI3BA,GAGJxyB,EAAAjgB,UAAA8yC,IAAP,SAAWN,EAAa7S,GAAxB,IAAAj4B,EAAAC,cAAW6qC,MAAA,eAAa7S,MAAA,WAAyC,WAC7D,IAAI+S,EAASF,EAAO7qC,KAAKrC,QAAQktC,GAAQ,EACzC,OAAO7qC,KAAKorC,SAASL,EAAQ/S,GAAIt7B,IAAI,SAAAnC,GAAK,OAAAwF,EAAK2W,MAAMnc,MAGjD+d,EAAAjgB,UAAA+yC,SAAR,SAAiBH,EAAuBjT,YAAvBiT,MAAA,eAAuBjT,MAAA,WAA8C,WAClF,IAAIqT,KACAP,KACJA,EAAQ3yC,KAAK8yC,GAEb,IADA,IAAIhgB,EAAQ,EACL6f,EAAQ7yC,OAAS+H,KAAK0W,MAAMze,QAAUgzB,IAA8B,GAApBjrB,KAAK0W,MAAMze,QAAa,CAC3E,IAAwB,IAAAwgB,EAAA,EAAA6yB,EAAAR,EAAAryB,EAAA6yB,EAAArzC,OAAAwgB,IAAS,CAE7B,IAFC,IAAI8yB,EAAWD,EAAA7yB,GAEStG,EAAA,EAAAq5B,EADLxrC,KAAKyqC,gBAAgBc,GAChBp5B,EAAAq5B,EAAAvzC,OAAAka,IAAK,CAAzB,IAAIs5B,EAAYD,EAAAr5B,GACjB,IAAK24B,EAAQroB,SAASgpB,GAAe,CACjC,IAAKzT,EAAGuT,EAAaE,GAAe,CAChCJ,KACA,MAEJP,EAAQ3yC,KAAKszC,IAGrB,GAAIJ,EAAM,MAEd,GAAIA,EAAM,MAEd,OAAOP,GAGJxyB,EAAAjgB,UAAAqzC,aAAP,SAAoBtrB,EAAQ6pB,EAAQ0B,GAApC,IAAA5rC,EAAAC,cAAoC2rC,MAAA,KAChC,IAAIC,KACAC,EAAW7rC,KAAKrC,QAAQssC,GAC5BjqC,KAAKmrC,IAAI/qB,EAAK,SAAC0rB,EAAMpE,GAEjB,OADAkE,EAASlE,GAAQoE,EACVpE,IAASmE,IAMpB,IAJA,IAAIvvB,KACAorB,EAAOmE,EACPE,EAAQ,EACRC,EAAWhsC,KAAKrC,QAAQyiB,IACpB9D,EAAKmG,SAASupB,IAAaD,EAAQJ,GACvCrvB,EAAKnkB,KAAKuvC,GACVA,EAAOkE,EAASlE,GAChBqE,GAAS,EAGb,OADgBzvB,EAAK5f,IAAI,SAAAnC,GAAK,OAAAwF,EAAK2W,MAAMnc,KACxB0xC,WAGb3zB,EAAAjgB,UAAAsF,QAAR,SAAgBgZ,GACZ,OAAO3W,KAAK0W,MAAM/Y,QAAQgZ,IAGlC2B,EAnJA,GAAa9e,EAAA8e,uFCJb,IAAAnd,EAAA/B,EAAA,GACM8yC,EAAQ9yC,EAAQ,KAEhB+yC,GADa/yC,EAAQ,KACTA,EAAQ,MAGpBgzC,GAFahzC,EAAQ,KACLA,EAAQ,KACVA,EAAQ,MAIxBwH,GACAyrC,MAAO,IAAIlxC,EAAAmxC,QAAQJ,GAGnBK,UAAW,IAAIpxC,EAAAqxC,MAAML,GAGrBM,YAAa,IAAItxC,EAAAqxC,MAAMJ,IAOlB5yC,EAAAoH,2aCxBT,IAAAzF,EAAA/B,EAAA,GACAszC,EAAAtzC,EAAA,IACAuzC,EAAAvzC,EAAA,IACAwzC,EAAAxzC,EAAA,IAGAyzC,EAAA,SAAAhtC,GAAA,SAAAgtC,mDA2BA,OA3B6BtsC,EAAAssC,EAAAhtC,GAKlBgtC,EAAAx0C,UAAAmuC,aAAP,SAAoB/O,GAChBz3B,KAAKgU,OAAS,IAAI04B,EAAAzQ,OAAOj8B,MACzBA,KAAKwM,IAAIxM,KAAKgU,QACdhU,KAAK8sC,aAAe,IAAIF,EAAAhM,aAAa5gC,KAAKgU,OAAQyjB,EAC9C,2HAIJz3B,KAAK8sC,aAAarJ,mBAGfoJ,EAAAx0C,UAAA00C,WAAP,WACI/sC,KAAKwM,IAAIxM,KAAK8sC,cACd9sC,KAAK+iC,WAAa,IAAI4J,EAAAnV,eAAex3B,KAAKiX,OAAQjX,KAAK03B,QACvD13B,KAAK8sC,aAAalL,QAAQ5hC,KAAK+iC,YAC/B/iC,KAAK+iC,WAAW3K,YAGbyU,EAAAx0C,UAAA20C,aAAP,WACIhtC,KAAK8sC,aAAa7P,WAClBj9B,KAAK+iC,WAAWnJ,cAExBiT,EA3BA,CAA6B1xC,EAAA8xC,OAAhBzzC,EAAAqzC,mwDCNb,IAAAK,EAAA9zC,EAAA,IACA+B,EAAA/B,EAAA,GACA+zC,EAAA/zC,EAAA,IACAuzC,EAAAvzC,EAAA,IACAya,EAAAza,EAAA,IACA8J,EAAA9J,EAAA,GACAgO,EAAAhO,EAAA,GAEAg0C,EAAA,SAAAvtC,GAAA,SAAAutC,IAAA,IAAArtC,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YAEID,EAAAstC,cAAsBphC,EAiB1B,OAnBwB1L,EAAA6sC,EAAAvtC,GAGpButC,EAAA/0C,UAAA+c,MAAA,SAAMk4B,EAA0Cr2B,GAAhD,IAAAlX,EAAAC,KACIstC,EAAK3uC,QAAQ,SAAA4uC,GACT,IAAIjnB,EAAY6mB,EAAA9mB,eAAeknB,EAAIvrB,MAAO7mB,EAAAoE,MAAM8J,MAChDid,EAAUknB,QAAU,kBAAA1c,EAAA/wB,cAAA,oBAAA1G,EAAA2G,KAAA,SAAAzF,GAAA,OAAAA,EAAAynB,OAAA,cACXhiB,KAAKqtC,YAAN,MACArtC,KAAKqtC,cACLp2B,EAAO6rB,aAAapL,OAAOzD,KAAK,MAAQ,MACxC,EAAM7sB,EAAAnJ,MAAM,cAAZkU,EAAA4P,OACA9K,EAAOurB,UAAU+K,EAAIxnB,OACrB/lB,KAAKqtC,cAAa9yC,EAAAynB,MAAA,yBAG1BjiB,EAAK6nB,SAASM,YAAY5B,MAItC8mB,EAnBA,CAAwBF,EAAApmB,MAqBxB2mB,EAAA,SAAA5tC,GAAA,SAAA4tC,mDAmGA,OAnG0BltC,EAAAktC,EAAA5tC,GAOtB4tC,EAAAp1C,UAAAmuC,aAAA,WACI,IAAIkH,EAAe1tC,KAAKiX,OAAOy2B,aAAe5yC,OAAO6yC,iBACjDC,EAAc5tC,KAAKiX,OAAO22B,YAAc9yC,OAAO6yC,iBAE/C3d,EAAah0B,KAAKK,MAAMqxC,EAAa,GACrC3d,EAAY/zB,KAAKK,MAAMuxC,EAAY,GAEvC5tC,KAAK6tC,UAAY,IAAIT,EACjB,+BACArd,EAAW,EACXC,EAAa,IAEjBhwB,KAAK6tC,UAAUz4B,QACT4M,MAAO,OAAQ+D,MAAO,SACtB/D,MAAO,QAAS+D,MAAO,UACvB/D,MAAO,UAAW+D,MAAO,YAC5B/lB,KAAKiX,QAERjX,KAAK8tC,YAAc9tC,KAAK+tC,mBACpBH,EAAc,GAEd5d,EAAa,GACb70B,EAAAoE,MAAM8vB,KAAK3c,QAAQ,KAEvB1S,KAAKwM,IAAIxM,KAAK8tC,aACd9tC,KAAKguC,WAAahuC,KAAK+tC,mBACnBH,EAAc,GAEd5d,EAAa,GACb70B,EAAAoE,MAAM+J,OAAOrH,OAAO,KAExBjC,KAAKwM,IAAIxM,KAAKguC,YAEdhuC,KAAK+iC,WAAa,IAAI4J,EAAAnV,eAAex3B,KAAKiX,OAAQjX,KAAK03B,SAG3D+V,EAAAp1C,UAAA00C,WAAA,WAEI/sC,KAAK6tC,UAAUhmB,OAIf7nB,KAAK03B,OAAOzD,KAAK,IAAK,MACtBj0B,KAAK8tC,YAAYxtB,cACjBtgB,KAAKguC,WAAW1tB,cAEhBtgB,KAAK+iC,WAAa,IAAI4J,EAAAnV,eAAex3B,KAAKiX,OAAQjX,KAAK03B,QACvD13B,KAAK+iC,WAAW3K,YAGpBqV,EAAAp1C,UAAA20C,aAAA,WACIhtC,KAAK8tC,YAAYxtB,cACjBtgB,KAAKguC,WAAW1tB,cAChBtgB,KAAK+iC,WAAWnJ,aAChB55B,KAAK6tC,UAAUhjC,QAGnB4iC,EAAAp1C,UAAAyd,KAAA,SAAKC,EAAKC,GACN,IAAI03B,EAAe1tC,KAAKiX,OAAOy2B,aAAe5yC,OAAO6yC,iBACjDC,EAAc5tC,KAAKiX,OAAO22B,YAAc9yC,OAAO6yC,iBACnD9tC,EAAAxH,UAAMyd,KAAIvd,KAAAyH,KAAC+V,EAAKC,GAChBhW,KAAK6tC,UAAU/3B,KAAKC,GACpBlC,EAAAoL,SAASlJ,EACF7S,EAAAtD,KAAK4C,MAAK,sBACborC,EAAc,IAAKF,EAAe,IACtC75B,EAAAoL,SAASlJ,EACL,SAAS/V,KAAK03B,OAAOuB,UAAS,WAAWj5B,KAAK03B,OAAOnrB,IAAI0H,EAAC,KAAKjU,KAAK03B,OAAOnrB,IAAI2H,EAC/E,IAAM,MAGNu5B,EAAAp1C,UAAA01C,mBAAR,SAA2B95B,EAAEC,EAAEta,GAC3B,IAAImmB,EAAU,IAAI5kB,EAAA4sC,gBACd9zB,EACAC,GAiBJ,OAfA6L,EAAQ+oB,SAAWlvC,EAAEie,QACrBkI,EAAQ8oB,WAAa1tC,EAAAoE,MAAMwT,MAAM9Q,OAAO,KACxC8d,EAAQtB,OAAS,GACjBsB,EAAQooB,OAAS,GACjBpoB,EAAQqoB,OAAS,IACjBroB,EAAQsoB,SAAW,EACnBtoB,EAAQuoB,SAAqB,EAAVtsC,KAAKqiB,GACxB0B,EAAQwoB,SAAW,GACnBxoB,EAAQyoB,QAAU,IAClBzoB,EAAQ0oB,YACR1oB,EAAQ2oB,aAAe,KACvB3oB,EAAQ4oB,QAAU,IAClB5oB,EAAQ6oB,QAAU,EAElB7oB,EAAQO,cACDP,GAEf0tB,EAnGA,CAA0BtyC,EAAA8xC,OAAbzzC,EAAAi0C,saC7Bb,IAAAtyC,EAAA/B,EAAA,GACA4iC,EAAA5iC,EAAA,IACA8J,EAAA9J,EAAA,GACAszC,EAAAtzC,EAAA,IACA8zC,EAAA9zC,EAAA,IACA+zC,EAAA/zC,EAAA,IACAgO,EAAAhO,EAAA,GACAuzC,EAAAvzC,EAAA,IACAua,EAAAva,EAAA,GACA0iC,EAAA1iC,EAAA,IACAoa,EAAApa,EAAA,GAGA60C,EAAA,SAAApuC,GACI,SAAAouC,EAAYh6B,EAAWC,EAAWg6B,GAAlC,IAAAnuC,EACIF,EAAAtH,KAAAyH,KAAM,SAAUiU,EAAGC,IAAElU,YACrBD,EAAK4nB,kBACLumB,EAAQvvC,QAAQ,SAAA4uC,GACN,IAAAvrB,EAAAurB,EAAAvrB,MAAOpgB,EAAA2rC,EAAA3rC,MAAOo2B,EAAAuV,EAAAvV,GAChB1R,EAAY6mB,EAAA9mB,eAAerE,EAAOpgB,GACtC0kB,EAAUknB,QAAUxV,EACpBj4B,EAAK6nB,SAASM,YAAY5B,OAGtC,OAX2B/lB,EAAA0tC,EAAApuC,GAW3BouC,EAXA,CAA2Bf,EAAApmB,MAa3BqnB,EAAA,SAAAtuC,GAAA,SAAAsuC,IAAA,IAAApuC,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YAKYD,EAAAquC,eAAyB,IACzBruC,EAAAsuC,eAAyB,IACzBtuC,EAAAuuC,WAAqB,IAErBvuC,EAAA6b,YAiER7b,EAAAwuC,uBAAyB,WACrB,IACIC,EAAWpnC,EAAAhL,QAAQ,QAAS,YAAa,SAAU,WAAY,SAAU,SAAU,SAAU,SAAU,OAAQ,YAAa,OAAQ,QAAS,QAC7IqyC,EAAW,IAAIzS,EAAAvQ,QAAQ+iB,EAAU,IAAIrzC,EAAAga,OAAQnZ,KAAKM,SAAWyD,EAAKuuC,WAAcvuC,EAAKquC,eAAgBruC,EAAKklB,QAASllB,EAAKiU,QAAUmF,WAEtIpZ,EAAKiU,OAAOwM,WAAWye,SAAS9mC,KAAKs2C,GACrC1uC,EAAKyM,IAAIiiC,GACTA,EAASzoB,EAAI,GAGjBjmB,EAAA2uC,cAAgB,WACZ,IAAIC,EAAWvnC,EAAAhL,QACX,QAAS,QAAS,OAAQ,OAAQ,SAClC,QAAS,OAAQ,SAAU,SAAU,UACrC,OAAQ,UAAW,OAAQ,OAAQ,OAAQ,OAC3C,MAAO,MAAO,OAAQ,SAEtBqyC,EAAW,IAAIzS,EAAAvQ,QAAQkjB,EAAU5uC,EAAK6uC,aAAc7uC,EAAKiU,QAC7DjU,EAAKiU,OAAOwM,WAAWye,SAAS9mC,KAAKs2C,GACrC1uC,EAAKyM,IAAIiiC,GACTA,EAASzoB,EAAI,GAGjBjmB,EAAA8uC,aAAe,WACX,IACIluB,EAAU,IAAIqb,EAAAvQ,QAAQ,SAAU1rB,EAAK6uC,eAAmB7uC,EAAKiU,QAAUwa,UAC3EzuB,EAAKiU,OAAOwM,WAAWC,QAAQtoB,KAAKwoB,GACpC5gB,EAAKyM,IAAImU,GACTA,EAAQqF,EAAI,GAGhBjmB,EAAA+uC,gBAAkB,WACd,IAEInuB,EAAU,IAAIqb,EAAAvQ,QAAQ,eAAgB1rB,EAAK6uC,eAAmB7uC,EAAKiU,QAAUwa,QAAM5C,WACvFjL,EAAQzM,GAAKyM,EAAQpJ,YAAY,EACjCxX,EAAKiU,OAAOwM,WAAWC,QAAQtoB,KAAKwoB,GACpC5gB,EAAKyM,IAAImU,GACTA,EAAQqF,EAAI,GAIhBjmB,EAAAgvC,sBAAwB,WACpB,IACIP,EAAWpnC,EAAAhL,QAAS,OAAQ,OAAQ,QAAS,QAAS,UAAW,SACjEukB,EAAU,IAAIqb,EAAAvQ,QAAQ+iB,EAAUzuC,EAAK6uC,eAAmB7uC,EAAKiU,QAAUmF,SAAOqV,UAClFzuB,EAAKiU,OAAOwM,WAAWC,QAAQtoB,KAAKwoB,GACpC5gB,EAAKyM,IAAImU,GACTA,EAAQqF,EAAI,GAAA/Z,EAuBpB,OAjJ2B1L,EAAA4tC,EAAAtuC,GAWhBsuC,EAAA91C,UAAAmuC,aAAP,SAAoB/O,GAApB,IAAA13B,EAAAC,KACIA,KAAKgU,OAAS,IAAI04B,EAAAzQ,OAAOj8B,MACzBA,KAAKwM,IAAIxM,KAAKgU,QACdhU,KAAKgU,OAAOgS,GAAK,IACjBhmB,KAAKilB,OAASjlB,KAAKgU,OAAOwsB,SAAWt9B,EAAAtD,KAAK8C,WAAW,EAErD,IAAIkrC,EAAc5tC,KAAKiX,OAAO22B,YAAc9yC,OAAO6yC,iBAC/C5d,EAAY/zB,KAAKK,MAAMuxC,EAAY,GAGvC5tC,KAAKgvC,aAAe,IAAIf,EAAale,EAAU,IAAI,KAC7C/N,MAAO,SAAUpgB,MAAOzG,EAAAoE,MAAMyC,IAAKg2B,GAAIh4B,KAAK6uC,eAC5C7sB,MAAO,UAAWpgB,MAAOzG,EAAAoE,MAAM6J,MAAO4uB,GAAIh4B,KAAK0uC,gBAC/C1sB,MAAO,eAAgBpgB,MAAOzG,EAAAoE,MAAMyC,IAAKg2B,GAAIh4B,KAAK+uC,wBAClD/sB,MAAO,YAAapgB,MAAOzG,EAAAoE,MAAM6J,MAAO4uB,GAAIh4B,KAAKuuC,yBACjDvsB,MAAO,aAAcpgB,MAAOzG,EAAAoE,MAAMyC,IAAKg2B,GAAIh4B,KAAK8uC,kBAChD9sB,MAAO,QAASpgB,MAAOzG,EAAAoE,MAAM6J,MAAO4uB,GAAI,WAAQj4B,EAAKkvC,gBACrDjtB,MAAO,cAAepgB,MAAOzG,EAAAoE,MAAMwT,MAAOilB,GAAI,WAAQj4B,EAAKmvC,gBAC3DltB,MAAO,YAAapgB,MAAOzG,EAAAoE,MAAMwT,MAAOilB,GAAI,WAAQP,EAAK+K,UAAU,aAI7E2L,EAAA91C,UAAA00C,WAAA,WACI/sC,KAAK+iC,WAAa,IAAI4J,EAAAnV,eAAex3B,KAAKiX,OAAQjX,KAAK03B,QACvD13B,KAAK+iC,WAAW3K,WAChBp4B,KAAKgvC,aAAannB,OAClB7nB,KAAKmvC,mBAELnvC,KAAK03B,OAAO6B,KAAKv5B,KAAKgU,OAAOwM,WAAWye,SAAS,GAAG1yB,IAAK,IAG7D4hC,EAAA91C,UAAA20C,aAAA,WACIhtC,KAAKgvC,aAAankC,OAClB7K,KAAK+iC,WAAWnJ,cAIpBuU,EAAA91C,UAAAyd,KAAA,SAAKC,EAAKC,GACNnW,EAAAxH,UAAMyd,KAAIvd,KAAAyH,KAAC+V,EAAIC,GACfhW,KAAKgvC,aAAal5B,KAAKC,IAG3Bo4B,EAAA91C,UAAA62C,WAAA,eAAAnvC,EAAAC,KACIA,KAAK4b,SAASjd,QAAQ,SAAA4c,GAAYxb,EAAKo9B,OAAO5hB,GAAWA,EAAQ4K,SAEjEnmB,KAAKgU,OAAOipB,WACZj9B,KAAKm9B,OAAOn9B,KAAKgU,QACjBhU,KAAKgU,OAAS,IAAI04B,EAAAzQ,OAAOj8B,MACzBA,KAAKgU,OAAOgS,GAAK,IACjBhmB,KAAKwM,IAAIxM,KAAKgU,QACdhU,KAAKmvC,oBAGThB,EAAA91C,UAAA82C,iBAAA,WACmD,IAA3CnvC,KAAKgU,OAAOwM,WAAWye,SAAShnC,QAChC+H,KAAK0uC,gBAEqC,IAA1C1uC,KAAKgU,OAAOwM,WAAWC,QAAQxoB,QAC/B+H,KAAK6uC,gBAwDbV,EAAA91C,UAAA42C,WAAA,WAEI,IAAI1iC,EAAMvM,KAAK4uC,aACfriC,EAAI2H,EAAIlU,KAAKilB,OACb,IAAI9b,EAAQ,IAAI2yB,EAAArc,OAAO,IAAI9L,EAAA1E,MAAS1C,GACpCpD,EAAMqI,YAAcgC,EAAAvC,YAAYC,KAChC/H,EAAM+C,SACN/C,EAAMqL,UAENrL,EAAMiD,UAAa4H,OAAQhU,KAAKgU,QAChChU,KAAKwM,IAAIrD,GACTA,EAAM6c,EAAI,EAGVhmB,KAAK4b,SAASzjB,KAAKgR,IAGfglC,EAAA91C,UAAAu2C,WAAR,SAAmBH,GACf,gBADeA,UACR,IAAItzC,EAAAga,OAAQnZ,KAAKM,SAAW0D,KAAKsuC,YAAeG,EAAWzuC,KAAKouC,eAAiBpuC,KAAKquC,eAAgBruC,KAAKilB,SAE1HkpB,EAjJA,CAA2BhzC,EAAA8xC,OAAdzzC,EAAA20C,6FC1Bb,IAEYiB,EAFZz7B,EAAAva,EAAA,IAEA,SAAYg2C,GACRA,EAAAC,SAAA,wBACAD,EAAAE,YAAA,kBACAF,EAAAG,eAAA,kBACAH,EAAAI,QAAA,mBAIAJ,EAAAK,kBAAA,qBARJ,CAAYL,EAAA51C,EAAA41C,aAAA51C,EAAA41C,gBAmBC51C,EAAAk2C,iBAAcv9B,MACtBi9B,EAAWC,YAEJv1C,KAAM,aACN61C,MAAO,EACP1lC,YAAa,gBACbQ,SAAWkJ,EAAAnG,IAAKmG,EAAApG,WAChB24B,SAAWvyB,EAAAtG,gBAAiBsG,EAAArG,0BAIpC6E,EAACi9B,EAAWE,eAGJx1C,KAAM,eACN61C,MAAO,EACP1lC,YAAa,qBACbQ,SAAUkJ,EAAAtF,QACV63B,SAAUvyB,EAAAvF,WAAYuF,EAAAnE,WAAYmE,EAAAjE,WAI1CyC,EAACi9B,EAAWI,WAEJ11C,KAAM,eACN61C,MAAO,EACP1lC,YAAa,MACbQ,SAAUkJ,EAAA3F,QACVk4B,SAAUvyB,EAAAzF,SAIlBiE,EAACi9B,EAAWG,kBAEJz1C,KAAM,oBACN61C,MAAO,EACP1lC,YAAa,oBACbQ,SAAWkJ,EAAAzG,OACXg5B,SAAWvyB,EAAA7F,UAAW6F,EAAA/F,YAAa+F,EAAA9F,SAI3CsE,EAACi9B,EAAWK,qBAEJ31C,KAAM,uBACN61C,MAAO,EACP1lC,YAAa,eACbQ,SAAWkJ,EAAA/G,OACXs5B,SAAWvyB,EAAAzE,MAAOyE,EAAAxE,sGCpE9B,IAAA/H,EAAAhO,EAAA,GACAw2C,EAAAx2C,EAAA,IAEA6nC,EAAA,oBAAAA,UACIjhC,KAAA6vC,gBAAa19B,MAGJy9B,EAAAR,WAAWC,WAAY,EACxBl9B,EAACy9B,EAAAR,WAAWG,iBAAkB,EAC9Bp9B,EAACy9B,EAAAR,WAAWE,cAAe,EAC3Bn9B,EAACy9B,EAAAR,WAAWI,UAAW,EACvBr9B,EAACy9B,EAAAR,WAAWK,oBAAqB,EAAAjyC,GAkD7C,OA/CIyjC,EAAA5oC,UAAA8pC,uBAAA,SAAuBvmB,GACnB,IAA2B,IAAAnD,EAAA,EAAAtG,EAAA/Z,OAAO03C,KAAKF,EAAAR,YAAZ32B,EAAAtG,EAAAla,OAAAwgB,IAAyB,CAA/C,IAAIs3B,EAAc59B,EAAAsG,GACfypB,EAAyB0N,EAAAR,WAAWW,GACxC,GAAI/vC,KAAKgwC,UAAU9N,EAAYtmB,GAC3B,OAAOsmB,EAGf,OAAO,MAGXjB,EAAA5oC,UAAAgqC,OAAA,SAAOH,GAEH,OADAliC,KAAK6vC,cAAc3N,IAAe,EAC3BliC,KAAKiwC,YAAY/N,IAGpBjB,EAAA5oC,UAAA43C,YAAR,SAAoB/N,GAChB,OAAO0N,EAAAF,eAAexN,GAAYliC,KAAK6vC,cAAc3N,KAGjDjB,EAAA5oC,UAAA23C,UAAR,SAAkB9N,EAAwBtmB,GACtC,IAAI+zB,EAAQ3vC,KAAK6vC,cAAc3N,GAC3BgO,EAA4BN,EAAAF,eAAexN,GAAYyN,EAAQ,GACnE,SAAIO,IACIA,EAAUzlC,QAAQ+H,MAAM,SAAA+I,GAAW,OAAAK,EAAS6G,SAASlH,OAOjE0lB,EAAA5oC,UAAA83C,oBAAA,WAEI,IADA,IAAIC,KACuB33B,EAAA,EAAAtG,EAAA/Z,OAAO03C,KAAKF,EAAAR,YAAZ32B,EAAAtG,EAAAla,OAAAwgB,IAAyB,CAA/C,IAAIs3B,EAAc59B,EAAAsG,GACnB23B,EAASj4C,KAAIS,MAAbw3C,EAAiBpwC,KAAKqwC,oBAAoBT,EAAAR,WAAWW,KAEzD,OAAOK,GAGHnP,EAAA5oC,UAAAg4C,oBAAR,SAA4BnO,GACxB,IAAIoO,EAAOV,EAAAF,eAAexN,GACtBkO,KACAT,EAAQ3vC,KAAK6vC,cAAc3N,GAAc,EAC7C,IAAK,IAAInqC,KAAKqP,EAAA7K,MAAMozC,GAChBS,EAASj4C,KAAIS,MAAbw3C,EAAiBE,EAAKv4C,GAAGmuC,SAE7B,OAAOkK,GAEfnP,EA1DA,GAAaznC,EAAAynC,0aCJb,IAAA9lC,EAAA/B,EAAA,GACA8zC,EAAA9zC,EAAA,IAEA8J,EAAA9J,EAAA,GACA+zC,EAAA/zC,EAAA,IACAm3C,EAAAn3C,EAAA,IAEAo3C,EAAA,WAUI,SAAAA,EAAoB7uB,EAA0B8uB,GAA1BzwC,KAAA2hB,UAA0B3hB,KAAAywC,WAFtCzwC,KAAA0wC,YAGJ1wC,KAAK2wC,YAkGb,OA/FIv4C,OAAA6B,eAAIu2C,EAAAn4C,UAAA,QAAA+B,IAAJ,WAAa,OAAO4F,KAAK4wC,uCAEzBJ,EAAAn4C,UAAA2e,OAAA,SAAO65B,EAAqBC,EAAiBC,GACrCF,IAAe7wC,KAAK0wC,WACpB1wC,KAAK0wC,SAAWG,EAEhB7wC,KAAK4wC,MAAM7oB,YAAY/nB,KAAKy4B,QAC5Bz4B,KAAKy4B,OAASz4B,KAAKgxC,aACnBhxC,KAAK4wC,MAAM1oB,YAAYloB,KAAKy4B,SAMhCz4B,KAAKixC,OAAO3vC,MAAME,QAAUuvC,GAAS/wC,KAAK2hB,QAAQuvB,cAAgB,SAAW,OACzElxC,KAAK2hB,QAAQuvB,cACblxC,KAAKixC,OAAO5vC,YAAc,WAE1BrB,KAAKixC,OAAO5vC,YAAc,QAI9BrB,KAAKksB,OAAO5qB,MAAME,QAAUsvC,EAAS,SAAW,OAKhD9wC,KAAKmxC,KAAK7vC,MAAME,QAAUxB,KAAK2hB,QAAQmK,WAAa,SAAW,OAC3D9rB,KAAK2hB,QAAQ8K,aACbzsB,KAAKmxC,KAAK9vC,YAAcrB,KAAK2hB,QAAQ8K,WAAW6c,WAC5CtpC,KAAK2hB,QAAQ8K,sBAAsB8jB,EAAAlH,eACnCrpC,KAAKmxC,KAAK7vC,MAAMM,MAAQzG,EAAAoE,MAAMyC,IAAIE,SAElClC,KAAKmxC,KAAK7vC,MAAMM,MAAQzG,EAAAoE,MAAM2K,UAAUhI,WAKpDsuC,EAAAn4C,UAAAs4C,UAAA,WACI3wC,KAAK4wC,MAAQzvC,SAASC,cAAc,OACpCpB,KAAK4wC,MAAMtvC,MAAMI,WAAawB,EAAAtD,KAAK+B,KACnC3B,KAAK4wC,MAAMtvC,MAAMM,MAAQ,QACzB5B,KAAK4wC,MAAMtvC,MAAMlB,gBAAkB,UACnCJ,KAAK4wC,MAAMtvC,MAAME,QAAU,OAG3BxB,KAAK4wC,MAAMtvC,MAAM8vC,eAAiB,gBAClCpxC,KAAK4wC,MAAMtvC,MAAM+vC,YAAc,MAC/BrxC,KAAK4wC,MAAMtvC,MAAMO,SAAW,MAE5B,IAAI+T,EAAYzU,SAASC,cAAc,QAEvCwU,EAAUvU,aAAerB,KAAK2hB,QAAQnf,MAAOxC,KAAK2hB,QAAQ7nB,MAAMw3C,KAAK,KACrE17B,EAAUtU,MAAMiwC,UAAY,SAC5BvxC,KAAK4wC,MAAM1oB,YAAYtS,GAEvB5V,KAAKwxC,QAAUrwC,SAASC,cAAc,OACtCpB,KAAKwxC,QAAQlwC,MAAME,QAAU,OAC7BxB,KAAKwxC,QAAQlwC,MAAMmwC,cAAgB,SACnCzxC,KAAK4wC,MAAM1oB,YAAYloB,KAAKwxC,SAE5BxxC,KAAKmxC,KAAOhwC,SAASC,cAAc,QACnCpB,KAAKmxC,KAAK9vC,YAAc,GACxBrB,KAAKmxC,KAAK7vC,MAAMM,MAAQ,QACxB5B,KAAKmxC,KAAK7vC,MAAMG,QAAU,MAC1BzB,KAAKwxC,QAAQtpB,YAAYloB,KAAKmxC,MAE9BnxC,KAAKksB,OAAS/qB,SAASC,cAAc,QACrCpB,KAAKksB,OAAO7qB,YAAc,SAC1BrB,KAAKksB,OAAO5qB,MAAMM,MAAQ,SAC1B5B,KAAKksB,OAAO5qB,MAAMG,QAAU,MAC5BzB,KAAKwxC,QAAQtpB,YAAYloB,KAAKksB,QAE9BlsB,KAAKixC,OAAS9vC,SAASC,cAAc,QACrCpB,KAAKixC,OAAO5vC,YAAc,SAC1BrB,KAAKixC,OAAO3vC,MAAMM,MAAQ,OAC1B5B,KAAKixC,OAAO3vC,MAAMG,QAAU,MAC5BzB,KAAKwxC,QAAQtpB,YAAYloB,KAAKixC,QAE9BjxC,KAAKy4B,OAASz4B,KAAKgxC,aACnBhxC,KAAK4wC,MAAM1oB,YAAYloB,KAAKy4B,SAGhC+X,EAAAn4C,UAAA24C,WAAA,eAAAjxC,EAAAC,KACQkf,EAAMlf,KAAK0wC,SAAW,YAAc,SACpCv2B,EAAMna,KAAK0wC,SAAWv1C,EAAAoE,MAAMgK,OAASpO,EAAAoE,MAAMsT,SAC3C4lB,EAAS0U,EAAA9mB,eAAenH,EAAK/E,GAOjC,OANAse,EAAOn3B,MAAMG,QAAU,OACnBzB,KAAKywC,WACLhY,EAAO+U,QAAU,WACbztC,EAAK0wC,SAAS1wC,EAAK4hB,WAGpB8W,GAEf+X,EA7GA,GA+GAkB,EAAA,SAAA7xC,GAMI,SAAA6xC,EACIz9B,EACAC,EACQy9B,kBAAA,MAHZ,IAAA5xC,EAKIF,EAAAtH,KAAAyH,KAAM,gBAAiBiU,EAAGC,IAAElU,YAFpBD,EAAA4xC,kBAPJ5xC,EAAAk/B,YACRl/B,EAAA6xC,UAAqB,KACb7xC,EAAA8xC,aAA0C,IAAIC,MAoD1D,OAxDiCvxC,EAAAmxC,EAAA7xC,GAc7B6xC,EAAAr5C,UAAA05C,aAAA,SAAa9S,EAAqB2S,GAAlC,IAAA7xC,EAAAC,KACQgyC,EAAkB/S,EAASve,KAAK,SAAA9mB,GAAK,OAACmG,EAAKkyC,kBAAkBr4C,KAC7Ds4C,EAAelyC,KAAKi/B,SAASve,KAAK,SAAA9mB,GAAK,OAACqlC,EAASxc,SAAS7oB,MAC1Do4C,GAAmBE,KACnBlyC,KAAKi/B,SAAWA,EAChBj/B,KAAKmyC,cAGTnyC,KAAK4xC,UAAYA,EACjB5xC,KAAKoyC,uBAGTV,EAAAr5C,UAAA+5C,oBAAA,eAAAryC,EAAAC,KACIA,KAAKi/B,SAAStgC,QAAQ,SAAAgjB,GACM5hB,EAAK8xC,aAAaz3C,IAAIunB,GACzC3K,OAAOjX,EAAK6xC,YAAcjwB,EAASA,EAAQ0wB,SAAU1wB,EAAQ2wB,YAI1EZ,EAAAr5C,UAAA45C,kBAAA,SAAkBtwB,GACd,OAAO3hB,KAAKi/B,SAASxc,SAASd,IAG1B+vB,EAAAr5C,UAAA85C,WAAR,eAAApyC,EAAAC,KACIA,KAAK2nB,kBACL3nB,KAAK4nB,SAAStmB,MAAM8S,OAAS,QAC7BpU,KAAKuyC,SAAWpxC,SAASC,cAAc,OACvCpB,KAAKuyC,SAASjxC,MAAMkxC,SAAW,OAE/BxyC,KAAKuyC,SAASjxC,MAAM8S,OAAS,QAC7BpU,KAAKuyC,SAASjxC,MAAM6S,MAAQ,OAC5BnU,KAAK4nB,SAASM,YAAYloB,KAAKuyC,UAC/BvyC,KAAKi/B,SAAStgC,QAAQ,SAAA/E,GAAK,OAAAmG,EAAK0yC,gBAAgB74C,MAK5C83C,EAAAr5C,UAAAo6C,gBAAR,SAAwB9wB,GACpB,IAAI+wB,EAAO,IAAIlC,EAAY7uB,EAAS3hB,KAAK2xC,iBACzC3xC,KAAK6xC,aAAanT,IAAI/c,EAAS+wB,GAC/B1yC,KAAKuyC,SAASrqB,YAAYwqB,EAAK7H,OAEvC6G,EAxDA,CAAiCxE,EAAApmB,MAApBttB,EAAAk4C,6FCtHb,IAAAv2C,EAAA/B,EAAA,GACA8J,EAAA9J,EAAA,GACAu5C,EAAA,WAQI,SAAAA,EAAoBnwC,EAAuB6iC,EAAyBpxB,EAAmBC,EAAmBC,kBAAA,KAAtFnU,KAAAwC,QAAuBxC,KAAAqlC,UAAyBrlC,KAAAiU,IAAmBjU,KAAAkU,IAAmBlU,KAAAmU,QACtGnU,KAAK4yC,aAiKb,OA7JID,EAAAt6C,UAAAyd,KAAA,SAAKC,GAED,GAAI/V,KAAK4nB,SAAU,CACf,IAAIU,EAAOvS,EAAIwS,OAAOC,WAAaxoB,KAAKmU,MAAM,EAC1CsU,EAAM1S,EAAIwS,OAAOG,UAAY1oB,KAAK4nB,SAASirB,aAAa,EAC5D7yC,KAAK4nB,SAAStmB,MAAMgnB,KAAUA,EAAOtoB,KAAKiU,EAAC,KAC3CjU,KAAK4nB,SAAStmB,MAAMqnB,IAASF,EAAMzoB,KAAKkU,EAAC,OAIjDy+B,EAAAt6C,UAAAy6C,WAAA,SAAWC,GAAX,IAAAhzC,EAAAC,KAIQkuC,EAAU91C,OAAO46C,QAAQD,GAC7B7E,EAAQvvC,QAAQ,SAACwT,OAAC8gC,EAAA9gC,EAAA,GAAQ6lB,EAAA7lB,EAAA,GAClBo7B,EAAMxtC,EAAKmzC,cAAcD,EAAQ93C,EAAAoE,MAAMuT,KAAM/S,EAAKoU,MAAO+5B,EAAcj2C,QAC3Es1C,EAAIC,QAAUxV,EACdj4B,EAAKozC,QAAQjrB,YAAYqlB,MAIjCoF,EAAAt6C,UAAA4kC,SAAA,WACI97B,SAAS8mB,KAAKF,YAAY/nB,KAAK4nB,WAI3B+qB,EAAAt6C,UAAAu6C,WAAR,WACI5yC,KAAK4nB,SAAWzmB,SAASC,cAAc,OACvCpB,KAAK4nB,SAAStmB,MAAMwV,SAAW,WAC/B9W,KAAK4nB,SAAStmB,MAAME,QAAU,OAC9BxB,KAAK4nB,SAAStmB,MAAM0mB,SAAW,OAC/BhoB,KAAK4nB,SAAStmB,MAAM6S,MAAWnU,KAAKmU,MAAK,KACzCnU,KAAK4nB,SAAStmB,MAAMC,OAAS,OAC7BJ,SAAS8mB,KAAKC,YAAYloB,KAAK4nB,UAE/B,IAAIpB,EAAKrrB,EAAAoE,MAAMgK,OAAOsO,QAAQ5V,OAAO,KACrCukB,EAAG3qB,EAAI,IAEP,IAAI2G,EAAQrB,SAASC,cAAc,OACnCoB,EAAMnB,YAAcrB,KAAKwC,MACzBA,EAAMlB,MAAMI,WAAawB,EAAAtD,KAAK+B,KAC9Ba,EAAMlB,MAAMO,SAAW,OACvBW,EAAMlB,MAAMQ,WAAa,MACzBU,EAAMlB,MAAMilB,cAAgB,YAC5B/jB,EAAMlB,MAAM8xC,UAAY,SACxB5wC,EAAMlB,MAAM6S,MAAWnU,KAAKmU,MAAK,KACjC3R,EAAMlB,MAAMM,MAAQzG,EAAAoE,MAAMwT,MAAM7Q,SAChCM,EAAMlB,MAAMlB,gBAAkBomB,EAAGtkB,SACjCM,EAAMlB,MAAMG,QAAU,OACtBe,EAAMlB,MAAM8mB,OAAS,MACrBpoB,KAAK4nB,SAASM,YAAY1lB,GAE1BxC,KAAKqzC,QAAUlyC,SAASC,cAAc,OACtCpB,KAAKqzC,QAAQ/xC,MAAM6S,MAAWnU,KAAKmU,MAAK,KACxCnU,KAAKqzC,QAAQ/xC,MAAMlB,gBAAkBomB,EAAGtkB,SACxClC,KAAK4nB,SAASM,YAAYloB,KAAKqzC,SAE/BrzC,KAAKszC,MAAQnyC,SAASC,cAAc,OACpCpB,KAAKszC,MAAMjyC,YAAcrB,KAAKqlC,QAC9BrlC,KAAKszC,MAAMhyC,MAAMI,WAAawB,EAAAtD,KAAK+B,KACnC3B,KAAKszC,MAAMhyC,MAAMO,SAAW,MAC5B7B,KAAKszC,MAAMhyC,MAAMQ,WAAa,MAC9B9B,KAAKszC,MAAMhyC,MAAM6S,MAAWnU,KAAKmU,MAAK,KACtCnU,KAAKszC,MAAMhyC,MAAMM,MAAQzG,EAAAoE,MAAMwT,MAAM7Q,SACrClC,KAAKszC,MAAMhyC,MAAMlB,gBAAkBomB,EAAGtkB,SACtClC,KAAKszC,MAAMhyC,MAAMG,QAAU,OAC3BzB,KAAKszC,MAAMhyC,MAAMiyC,cAAgB,OACjCvzC,KAAKszC,MAAMhyC,MAAM8mB,OAAS,MAC1BpoB,KAAK4nB,SAASM,YAAYloB,KAAKszC,OAE/BtzC,KAAKmzC,QAAUhyC,SAASC,cAAc,OACtCpB,KAAKmzC,QAAQ7xC,MAAM6S,MAAWnU,KAAKmU,MAAK,KACxCnU,KAAKmzC,QAAQ7xC,MAAME,QAAU,OAC7BxB,KAAKmzC,QAAQ7xC,MAAM0mB,SAAW,OAC9BhoB,KAAK4nB,SAASM,YAAYloB,KAAKmzC,UAGnCR,EAAAt6C,UAAA2tC,WAAA,SAAWwN,EAAiB5vC,EAAmBhC,YAAnBgC,MAAA,aAAmBhC,MAAezG,EAAAoE,MAAMwT,OAChE,IAAI0gC,EAAgBtyC,SAASC,cAAc,OAC3CqyC,EAAcpyC,YAAcmyC,EAC5BC,EAAcnyC,MAAMI,WAAawB,EAAAtD,KAAK+B,KACtC8xC,EAAcnyC,MAAMO,SAAc+B,EAAI,KACtC6vC,EAAcnyC,MAAMQ,WAAa,MACjC2xC,EAAcnyC,MAAM8xC,UAAY,SAChCK,EAAcnyC,MAAM6S,MAAWnU,KAAKmU,MAAK,KACzCs/B,EAAcnyC,MAAMM,MAAQA,EAAMiW,QAAQ3V,SAE1CuxC,EAAcnyC,MAAMG,QAAU,MAC9BgyC,EAAcnyC,MAAM8mB,OAAS,MAC7BpoB,KAAKqzC,QAAQnrB,YAAYurB,IAG7Bd,EAAAt6C,UAAA4tC,cAAA,SAAcyN,sBAEV,IAAI9Y,EAASz5B,SAASC,cAAc,OACpCw5B,EAAOt5B,MAAME,QAAU,OACvBo5B,EAAOt5B,MAAM0mB,SAAW,OACxB4S,EAAOt5B,MAAMG,QAAU,OACvBm5B,EAAOt5B,MAAM6S,MAAQ,OAErBymB,EAAOt5B,MAAM8vC,eAAiB,eAE9BsC,EAAQ/0C,QAAQ,SAACwT,OAAE6P,EAAA7P,EAAA6P,MAAOxX,EAAA2H,EAAA3H,MAClBmpC,EAAM,IAAIzzB,MACdyzB,EAAIx/B,MAAQ,GACZw/B,EAAIv/B,OAAS,GACbu/B,EAAIvzB,IAAM5V,EACVmpC,EAAIryC,MAAMG,QAAU,MAEpB,IAAImyC,EAAMzyC,SAASC,cAAc,QACjCwyC,EAAIvyC,YAAc2gB,EAClB4xB,EAAItyC,MAAM8xC,UAAY,SACtBQ,EAAItyC,MAAMG,QAAU,MACpBmyC,EAAItyC,MAAMO,SAAW,MACrB+xC,EAAItyC,MAAMI,WAAawB,EAAAtD,KAAK+B,KAE5B,IAAIkyC,EAAO1yC,SAASC,cAAc,OAClCyyC,EAAKvyC,MAAME,QAAU,OACrBqyC,EAAKvyC,MAAMmwC,cAAgB,SAC3BoC,EAAKvyC,MAAMG,QAAU,MACrBoyC,EAAK3rB,YAAYyrB,GACjBE,EAAK3rB,YAAY0rB,GAEjBhZ,EAAO1S,YAAY2rB,KAIvB7zC,KAAKszC,MAAMprB,YAAY0S,IAGnB+X,EAAAt6C,UAAA66C,cAAR,SAAsBlxB,EAAepgB,EAA+BuS,YAA/BvS,MAAezG,EAAAoE,MAAMsT,mBAAUsB,MAAgBnU,KAAKmU,MAAM,GAC3F,IAAIqS,EAAK5kB,EAAMK,OAAO,IAAKiR,WAAW,IAAK2E,QAC3C2O,EAAG3qB,EAAI,GACP,IAAI4qB,EAAK7kB,EAAM8Q,QAAQ,IAAKQ,WAAW,IAAK2E,QACxCi8B,EAAc3yC,SAASC,cAAc,UAoBzC,OAnBA0yC,EAAYzyC,YAAc2gB,EAC1B8xB,EAAYxyC,MAAME,QAAU,QAC5BsyC,EAAYxyC,MAAMO,SAAW,MAC7BiyC,EAAYxyC,MAAMI,WAAawB,EAAAtD,KAAK+B,KACpCmyC,EAAYxyC,MAAMQ,WAAa,MAC/BgyC,EAAYxyC,MAAMG,QAAU,OAC5BqyC,EAAYxyC,MAAM6S,MAAWA,EAAK,KAClC2/B,EAAYxyC,MAAMilB,cAAgB,YAClCutB,EAAYxyC,MAAMC,OAAS,OAC3BuyC,EAAYxyC,MAAM2a,WAAauK,EAAGtkB,SAClC4xC,EAAYxyC,MAAMM,MAAQ6kB,EAAGvkB,SAC7B4xC,EAAYptB,YAAc,WACtBotB,EAAYxyC,MAAM2a,WAAauK,EAAGG,SAAS,IAAKjU,QAAQ,KAAMxQ,SAC9D4xC,EAAYxyC,MAAMM,MAAQ6kB,EAAG/T,QAAQ,IAAKxQ,UAE9C4xC,EAAY3xC,aAAe,WACvB2xC,EAAYxyC,MAAM2a,WAAauK,EAAGtkB,SAClC4xC,EAAYxyC,MAAMM,MAAQ6kB,EAAGvkB,UAE1B4xC,GAEfnB,EA1KA,GAAan5C,EAAAm5C,uaCAb,IAAAvrC,EAAAhO,EAAA,GACA8zC,EAAA9zC,EAAA,IACA+zC,EAAA/zC,EAAA,IAEA26C,EAAA,SAAAl0C,GAKI,SAAAk0C,EACIj6C,EACAma,EACAC,EACQ8/B,EACAC,EACAC,EACAC,YAFAF,MAAA,eACAC,MAAA,eACAC,UAPZ,IAAAp0C,EASIF,EAAAtH,KAAAyH,KAAMlG,EAAMma,EAAGC,IAAElU,YALTD,EAAAi0C,MACAj0C,EAAAk0C,gBACAl0C,EAAAm0C,gBACAn0C,EAAAo0C,aAXZp0C,EAAAmM,SACAnM,EAAAq0C,gBACAr0C,EAAAs0C,cAYIt0C,EAAKu0C,gBAwDb,OAvE6B/zC,EAAAwzC,EAAAl0C,GAkBzBk0C,EAAA17C,UAAAorC,gBAAA,WACIzjC,KAAKq0C,eAGTN,EAAA17C,UAAAk8C,YAAA,SAAYroC,EAAuBkkC,GAAnC,IAAArwC,EAAAC,KAEI,YAF+BowC,UAC/BpwC,KAAKkM,MAAQA,EACTlM,KAAKq0C,WACLr0C,KAAKo0C,aAAep0C,KAAKg0C,SACtB,GAAIh0C,KAAKm0C,WAAY,CACxB,IAAIK,EAAkBx0C,KAAKg0C,IAAI92C,OAAO,SAACM,GAGnC,WAFYA,GACoBiN,QACjB+H,MAAM,SAACiiC,GAElB,OADY10C,EAAKmM,MAAMwU,KAAK,SAACrnB,GAAkB,OAAAA,IAAMo7C,QAI7Dz0C,KAAKo0C,aACEI,EAAel3C,OACf8yC,GACLlzC,OAAOkK,EAAA3H,iBAETO,KAAKo0C,aAAoBp0C,KAAKkM,MAAK5O,OAAK8yC,GAAWlzC,OAAOkK,EAAA3H,YAE9DO,KAAKs0C,eAGDP,EAAA17C,UAAAi8C,YAAR,eAAAv0C,EAAAC,KAEIA,KAAK2nB,kBAGL3nB,KAAKo0C,aACA13C,IAAI,SAACS,GAAqB,WAAIA,IAC9BoB,KAAK,SAAC1C,EAAGmC,GAAM,OAAAnC,EAAE+F,MAAQ5D,EAAE4D,OAAS,EAAI,IACxCjD,QAAQ,SAAAxB,GACL,IAAIA,EAAK0N,KAAT,CACA,IAAImX,EAAQ7kB,EAAKrD,KACZiG,EAAKmM,MAAMxP,IAAI,SAAA/C,GAAK,WAAIA,GAAIG,OAAM2oB,SAAStlB,EAAKrD,QACjDkoB,GAAS,MAEb,IAAI7H,EAAMhd,EAAKyE,MACX2rC,EAAMJ,EAAA9mB,eAAerE,EAAO7H,GAChCpa,EAAK6nB,SAASM,YAAYqlB,GACtBxtC,EAAKm0C,gBACL3G,EAAIxrC,aAAe,WAAQhC,EAAKm0C,cAAc/2C,KAE9C4C,EAAKk0C,gBACL1G,EAAIC,QAAU,WAAQztC,EAAKk0C,cAAc92C,SAK7D42C,EAvEA,CAA6B7G,EAAApmB,MAAhBttB,EAAAu6C,yaCNb,IAAA54C,EAAA/B,EAAA,GAEAua,EAAAva,EAAA,GACA6N,EAAA7N,EAAA,GACAsa,EAAAta,EAAA,IACA8K,EAAA9K,EAAA,GACA0iC,EAAA1iC,EAAA,IACAgO,EAAAhO,EAAA,GACA8J,EAAA9J,EAAA,GAGAs7C,EAAA,SAAA70C,GAMI,SAAA60C,EACYC,EACR1gC,EAAWC,GAFf,IAAAnU,EAIIF,EAAAtH,KAAAyH,KAAMiU,EAAGC,EAAG,EAAG,IAAElU,YAHTD,EAAA40C,SA4BZ50C,EAAA60C,kBAAoB,SAACv5C,GACjB,IAAIw5C,EAAQztC,EAAA3I,iBAAiBpD,GAC7B,OAAOjD,OAAO03C,KAAK+E,GACdn4C,IAAI,SAAAS,GAAQ,OAAGA,EAAI,KAAK03C,EAAM13C,KAC9Bm0C,KAAK,QA1BVvxC,EAAKy/B,OAAS,IAAIrkC,EAAA0a,MAAM,GAAI,EAAG,EAAG3S,EAAAtD,KAAK+B,MACvC5B,EAAKy/B,OAAO39B,SAAW,GACvB9B,EAAKyM,IAAIzM,EAAKy/B,QAEdz/B,EAAK+0C,MAAQ,IAAI35C,EAAA0a,MAAM,mBAAoB,EAAG,GAAI3S,EAAAtD,KAAK+B,MACvD5B,EAAK+0C,MAAMjzC,SAAW,GACtB9B,EAAKyM,IAAIzM,EAAK+0C,OAEd/0C,EAAKkK,YAAc,IAAI9O,EAAA0a,MAAM,cAAe,EAAG,GAAI3S,EAAAtD,KAAK+B,MACxD5B,EAAKkK,YAAYpI,SAAW,GAC5B9B,EAAKkK,YAAY8qC,UAAY55C,EAAA65C,UAAUC,OACvCl1C,EAAKkK,YAAYrI,MAAQzG,EAAAoE,MAAMsT,SAC/B9S,EAAKyM,IAAIzM,EAAKkK,aAEdlK,EAAKm1C,OAAS,IAAI/5C,EAAA0a,MAAM,SAAU,GAAI,GAAI3S,EAAAtD,KAAK+B,MAC/C5B,EAAKm1C,OAAOrzC,SAAW,GACvB9B,EAAKm1C,OAAOH,UAAY55C,EAAA65C,UAAUC,OAClCl1C,EAAKyM,IAAIzM,EAAKm1C,QAEdn1C,EAAK8nB,KAAK8sB,KAuFlB,OAvH8Bp0C,EAAAm0C,EAAA70C,GA0C1B60C,EAAAr8C,UAAAwvB,KAAA,SAAK8sB,GACD,GAAIA,EAGA,GAFA30C,KAAKiK,YAAY+R,KAAO24B,EAAO1qC,YAE3B0qC,aAAkBhhC,EAAA3J,SAAW2qC,aAAkB7Y,EAAArc,OAAQ,CACvDzf,KAAKw/B,OAAOxjB,KAAQhc,KAAKm1C,gBAAgBR,EAAOjqC,SAEhD,IAAI0qC,EAAsBT,aAAkBhhC,EAAA3J,QACtC,SAAShK,KAAK40C,kBAAkBD,EAAOxqC,MACtCwqC,EAAOzoC,MAAQlM,KAAK40C,kBAAkBD,EAAOh1B,SAAW,qBAE3D01B,EAAa,eADHV,aAAkBhhC,EAAA3J,QAAU2qC,EAAO/pC,QAAU+pC,EAAOp5B,QAAQ3Q,SAClC,MAAQ,MAChD5K,KAAKk1C,OAAOl5B,KAA+B,KAAxBo5B,EACbC,GACCD,EAAqBC,GAAY/D,KAAK,OAC7CtxC,KAAK80C,MAAM94B,KAAO,GAClB,IAAIoG,EAAKuyB,EAAOrqC,UACZ8X,IACgB,WAAZA,EAAG7X,KACHvK,KAAK80C,MAAM94B,KAAO,SAASoG,EAAGI,SAAS8uB,KAAK,OAAM,OAAOlvB,EAAGU,SAAQ,IACjD,cAAZV,EAAG7X,KACVvK,KAAK80C,MAAM94B,KAAO,aAAaoG,EAAGoC,UAAS,IACxB,UAAZpC,EAAG7X,KACVvK,KAAK80C,MAAM94B,KAAO,UAAUoG,EAAGiB,OAAOiuB,KAAK,OACxB,UAAZlvB,EAAG7X,OACVvK,KAAK80C,MAAM94B,KAAO,oBAGtB24B,aAAkB7Y,EAAArc,QAAUk1B,EAAO/0B,QACnC5f,KAAK80C,MAAM94B,MAAQ,kBAEpB,GAAI24B,aAAkBjhC,EAAA2hB,WAAY,CACjC,IAAAljB,EAAAwiC,EAAAzwB,QAAEC,EAAAhS,EAAAgS,SAAUC,EAAAjS,EAAAiS,UACZkxB,KACAnxB,EAAW,GACXmxB,EAAcn9C,KAAK,IAAIgsB,EAAQ,QAE/BC,EAAY,GACZkxB,EAAcn9C,KAAK,IAAI6D,KAAKK,MAAiB,IAAV+nB,EAAe,KAAI,gBAE1DpkB,KAAKw/B,OAAOxjB,KAAOs5B,EAAchE,KAAK,MACtCtxC,KAAK80C,MAAM94B,KAAO24B,EAAO/4B,SAASlf,IAAI,SAAA/C,GAAK,WAAKA,GAAKG,OAAMw3C,KAAK,OAChEtxC,KAAKk1C,OAAOl5B,KAAO,QAChB,GAAI24B,aAAkBzwC,EAAAC,SAAU,CACnCnE,KAAKw/B,OAAOxjB,KAAQhc,KAAKm1C,gBAAgBR,EAAOjqC,aAChD1K,KAAK80C,MAAM94B,KAAO24B,EAAOj5B,aAAahf,IAAI,SAAA7C,GAAK,OAAAA,EAAE0hB,QAAQzhB,OAAMw3C,KAAK,OAEpE,IAAI3xB,EAAUg1B,EAAOj5B,aAChBhf,IAAI,SAAA7C,GAAK,OAAAA,EAAE8lB,UACXnkB,OAAO,SAACK,EAAGmC,GAAM,OAAAnC,EAAEyB,OAAOU,QAC/BgC,KAAKk1C,OAAOl5B,KAAO2D,EAAQ1nB,OAAS,EAC9B,uBAAyB+H,KAAK40C,kBAAkBj1B,GAChD,QAEN3f,KAAKw/B,OAAOxjB,KAAO,GACnBhc,KAAK80C,MAAM94B,KAAO,GAClBhc,KAAKk1C,OAAOl5B,KAAO,IAOvB04B,EAAAr8C,UAAA88C,gBAAR,SAAwB33C,GACpB,IAAIgiC,KACA+V,EAAO/3C,EACX,IAAK,IAAIlD,KAAS2M,EAAAyK,UAAW,CACrB,IAAAS,EAAAojC,EAAAj7C,GACA0b,EADE7D,EAAAxG,OAAQwG,EAAAvG,OAEVoK,EAAQ,EACRwpB,EAAOrnC,KAAK,IAAI6d,EAAMw/B,UAAS,IAAIl7C,GAC5B0b,EAAQ,GACfwpB,EAAOrnC,KAAQ6d,EAAMw/B,UAAS,IAAIl7C,GAG1C,OAAOklC,EAAO8R,KAAK,QAE3BoD,EAvHA,CAA8Bv5C,EAAAihB,OAAjB5iB,EAAAk7C,0aCXb,IAAAv5C,EAAA/B,EAAA,GACAkmB,EAAAlmB,EAAA,IACAua,EAAAva,EAAA,GACA8N,EAAA9N,EAAA,GACAsa,EAAAta,EAAA,IACA8K,EAAA9K,EAAA,GACA0iC,EAAA1iC,EAAA,IACA8J,EAAA9J,EAAA,GACA4iC,EAAA5iC,EAAA,IACAq8C,EAAA,SAAA51C,GAII,SAAA41C,EACYd,EACR1gC,EAAWC,GAFf,IAAAnU,EAIIF,EAAAtH,KAAAyH,KAAMiU,EAAGC,EAAG,GAAI,GAAIygC,GAAUA,EAAO/yC,OAASzG,EAAAoE,MAAMuT,OAAK9S,YAHjDD,EAAA40C,SAIR50C,EAAKjG,KAAO,IAAIqB,EAAA0a,MAAM8+B,GAAUA,EAAO76C,MAAQ,KAAM,GAAI,GAAIoJ,EAAAtD,KAAK+B,MAClE5B,EAAKjG,KAAK+H,SAAW,GACrB9B,EAAKjG,KAAK8H,MAAQzG,EAAAoE,MAAMc,MACxBN,EAAKyM,IAAIzM,EAAKjG,MAEdiG,EAAKwK,KAAO,IAAIpP,EAAA0a,MAAM,KAAM,IAAK,GAAI3S,EAAAtD,KAAK+B,MAC1C5B,EAAKwK,KAAK1I,SAAW,GACrB9B,EAAKwK,KAAK3I,MAAQzG,EAAAoE,MAAMuT,KACxB/S,EAAKwK,KAAKwqC,UAAY55C,EAAA65C,UAAUC,OAChCl1C,EAAKyM,IAAIzM,EAAKwK,MAEVoqC,GACA50C,EAAK21C,SAASf,KAc1B,OAnC+Bp0C,EAAAk1C,EAAA51C,GAyB3B41C,EAAAp9C,UAAAq9C,SAAA,SAASf,GACL30C,KAAKlG,KAAKkiB,KAAO24B,EAAO76C,KACxBkG,KAAK4B,MAAQ+yC,EAAO/yC,MAAMsR,WAAW,IAAKjR,OAAO,IAC7C0yC,aAAkBhhC,EAAA3J,UAAWhK,KAAKuK,KAAKyR,KAAU9U,EAAAlE,WAAW2xC,EAAO/wC,MAAK,iBACxE+wC,aAAkBr1B,EAAAyU,YAAa/zB,KAAKuK,KAAKyR,KAAO,aAChD24B,aAAkBjhC,EAAA2hB,aAAcr1B,KAAKuK,KAAKyR,KAAO,YACjD24B,aAAkBzwC,EAAAC,WAAYnE,KAAKuK,KAAKyR,KAAO,YAC/C24B,aAAkB7Y,EAAArc,SAAUzf,KAAKuK,KAAKyR,KAAU9U,EAAAlE,WAAW2xC,EAAO/wC,MAAK,YACvE+wC,aAAkB3Y,EAAAvQ,UAAWzrB,KAAKuK,KAAKyR,KAAO,gBAE1Dy5B,EAnCA,CAA+Bt6C,EAAAihB,OAAlB5iB,EAAAi8C,2aCTb,IAAAt6C,EAAA/B,EAAA,GAEAua,EAAAva,EAAA,GACAu8C,EAAAv8C,EAAA,IACAw8C,EAAAx8C,EAAA,IAGA0iC,EAAA1iC,EAAA,IAGAy8C,EAAA,SAAAh2C,GAKI,SAAAg2C,EAAoBlB,EAAwE1gC,EAAWC,GAAvG,IAAAnU,EACIF,EAAAtH,KAAAyH,KAAMiU,EAAI,IAAKC,EAAI,GAAI,IAAK,IAAK/Y,EAAAoE,MAAMwT,QAAM/S,KAD7B20C,OAAA50C,EAAA40C,SAGhB50C,EAAKyC,MAAQ,IAAImzC,EAAAF,UAAUd,GAAQmB,KADf,IAEpB/1C,EAAKyM,IAAIzM,EAAKyC,OACdzC,EAAKg2C,SAAW,IAAIH,EAAAlB,SAASC,GAAQmB,KAASE,IAC9Cj2C,EAAKyM,IAAIzM,EAAKg2C,UAEdh2C,EAAKyK,MAAQ,IAAI0V,QAmCzB,OAhD0B3f,EAAAs1C,EAAAh2C,GAgBtBg2C,EAAAx9C,UAAAyd,KAAA,SAAKC,EAA+BC,GAEhC,GADAnW,EAAAxH,UAAMyd,KAAIvd,KAAAyH,KAAC+V,EAAKC,GACZhW,KAAK20C,SACD30C,KAAK20C,kBAAkBhhC,EAAA3J,SAAWhK,KAAK20C,kBAAkB7Y,EAAArc,QAAQ,CAE7D,IAAIyB,EAAKlhB,KAAKuM,IAAI0H,EAAI,GAAIgb,EAAKjvB,KAAKuM,IAAI2H,EAAI,GAI5C6B,EAAIoL,UAAUnhB,KAAKwK,MAAO0W,EAAI+N,EAHpB,SAS1B4mB,EAAAx9C,UAAA49C,QAAA,SAAQtB,GACJ30C,KAAKwC,MAAMkzC,SAASf,GACpB30C,KAAK+1C,SAASluB,KAAK8sB,GAEnB30C,KAAK20C,OAASA,EACd,IAAIv0B,EAAM,KACNpgB,KAAK20C,kBAAkBhhC,EAAA3J,QACvBoW,EAAMpgB,KAAK20C,OAAOnqC,MACXxK,KAAK20C,kBAAkB7Y,EAAArc,SAC9BW,EAAMpgB,KAAK20C,OAAOp5B,QAAQ/Q,OAG1B4V,IACApgB,KAAKwK,MAAM4V,IAAMA,IAI7By1B,EAhDA,CAA0B16C,EAAAihB,OAAb5iB,EAAAq8C,sFCVb,IAAA16C,EAAA/B,EAAA,GACAgO,EAAAhO,EAAA,GACA8J,EAAA9J,EAAA,GAQA88C,EAAA,WAQI,SAAAA,EAAoBjiC,EAAmBC,EAAmBiiC,GAA1D,IAAAp2C,EAAAC,KAAoBA,KAAAiU,IAAmBjU,KAAAkU,IAAmBlU,KAAAm2C,WAF1Dn2C,KAAAo2C,UAKIp2C,KAAKq2C,aACLh4C,WAAW,WAAQ0B,EAAKu2C,cAAgB,KACxCt2C,KAAKu2C,WAAWl1C,YAAc,mBAC9BrB,KAAKw2C,aAAepvC,EAAAhL,OAAOhE,OAAO03C,KAAK9vC,KAAKm2C,WAyHpD,OAtHID,EAAA79C,UAAAwS,KAAA,WACI7K,KAAKuyC,SAASjxC,MAAME,QAAU,QAGlC00C,EAAA79C,UAAAwvB,KAAA,WACI7nB,KAAKuyC,SAASjxC,MAAME,QAAU,SAG1B00C,EAAA79C,UAAAi+C,WAAR,eAAAv2C,EAAAC,KACIA,KAAKu2C,WAAWl1C,YAAc,YAAYrB,KAAKw2C,aAC/Cx2C,KAAKm2C,SAASn2C,KAAKw2C,cAAcC,OAChCr0C,KAAK,WACErC,EAAK22C,qBAIjBR,EAAA79C,UAAAs+C,KAAA,WACI32C,KAAK42C,cAAcrsC,KAAM,WAI7B2rC,EAAA79C,UAAAyd,KAAA,SAAKC,GACD,GAAI/V,KAAK4nB,SAAU,CACf,IAAIU,EAAOvS,EAAIwS,OAAOC,WAClBC,EAAM1S,EAAIwS,OAAOG,UACrB1oB,KAAKuyC,SAASjxC,MAAMgnB,KAAUA,EAAOtoB,KAAKiU,EAAC,KAC3CjU,KAAKuyC,SAASjxC,MAAMqnB,IAASF,EAAMzoB,KAAKkU,EAAC,OAIzCgiC,EAAA79C,UAAAg+C,WAAR,WACIr2C,KAAKuyC,SAAWpxC,SAASC,cAAc,OACvCpB,KAAKuyC,SAASjxC,MAAMwV,SAAW,WAC/B9W,KAAKuyC,SAASjxC,MAAM6S,MAAQ,MAC5BnU,KAAKuyC,SAASjxC,MAAMu1C,UAAY,OAChC72C,KAAKuyC,SAASjxC,MAAM8xC,UAAY,OAChCpzC,KAAKuyC,SAASjxC,MAAMC,OAAS,OAC7BvB,KAAKuyC,SAASjxC,MAAMkxC,SAAW,SAC/BrxC,SAAS8mB,KAAKC,YAAYloB,KAAKuyC,UAE/BvyC,KAAK4nB,SAAWzmB,SAASC,cAAc,OACvCpB,KAAK4nB,SAAStmB,MAAME,QAAU,eAC9BxB,KAAK4nB,SAAStmB,MAAMC,OAAS,OAC7BvB,KAAKuyC,SAASrqB,YAAYloB,KAAK4nB,UAE/B5nB,KAAKu2C,WAAap1C,SAASC,cAAc,QACzCpB,KAAKu2C,WAAWj1C,MAAMI,WAAawB,EAAAtD,KAAK+B,KACxC3B,KAAKu2C,WAAWj1C,MAAMO,SAAW,MACjC7B,KAAKu2C,WAAWj1C,MAAMG,QAAU,OAChCzB,KAAKu2C,WAAWj1C,MAAMM,MAAQ,QAC9B5B,KAAKuyC,SAASrqB,YAAYloB,KAAK82C,YAAY92C,KAAKu2C,aAEhD,IAAIE,EAAOz2C,KAAK+2C,aAAcxsC,KAAM,QAAU,WAC9CvK,KAAKuyC,SAASrqB,YAAYloB,KAAK82C,YAAYL,IAE3C,IAAIntB,EAAQtpB,KAAK+2C,aAAcxsC,KAAM,SAAW,qBAChDvK,KAAKuyC,SAASrqB,YAAYloB,KAAK82C,YAAYxtB,IAE3C,IAAI5tB,EAAOsE,KAAK+2C,aAAcxsC,KAAM,QAAU,UAC9CvK,KAAKuyC,SAASrqB,YAAYloB,KAAK82C,YAAYp7C,KAI/Cw6C,EAAA79C,UAAAu+C,aAAA,SAAaI,GACW,UAAhBA,EAAOzsC,MACPvK,KAAKi3C,KAAK3tB,QACVtpB,KAAKo2C,UACLp2C,KAAKu2C,WAAWl1C,YAAc,WAAWrB,KAAKw2C,cACvB,SAAhBQ,EAAOzsC,MACdvK,KAAKi3C,KAAKR,OACVz2C,KAAKo2C,UACLp2C,KAAKu2C,WAAWl1C,YAAc,YAAYrB,KAAKw2C,cACxB,SAAhBQ,EAAOzsC,OACVvK,KAAKo2C,SACLp2C,KAAKi3C,KAAKR,OACVz2C,KAAKo2C,WAETp2C,KAAKi3C,KAAKN,SAIlBT,EAAA79C,UAAAq+C,gBAAA,WACI,IAAIpxB,EAAMtlB,KAAKk3C,WAAWv5C,QAAQqC,KAAKw2C,cACvClxB,GAAOA,EAAM,GAAKtlB,KAAKk3C,WAAWj/C,OAClC+H,KAAKw2C,aAAex2C,KAAKk3C,WAAW5xB,GACpCtlB,KAAKs2C,cAGTl+C,OAAA6B,eAAIi8C,EAAA79C,UAAA,cAAA+B,IAAJ,WAAmB,OAAOhC,OAAO03C,KAAK9vC,KAAKm2C,2CAC3C/9C,OAAA6B,eAAIi8C,EAAA79C,UAAA,QAAA+B,IAAJ,WAAa,OAAO4F,KAAKm2C,SAASn2C,KAAKw2C,+CAE/BN,EAAA79C,UAAAy+C,YAAR,SAAoB35C,GAChB,IAAI8V,EAAQ9R,SAASC,cAAc,OAInC,OAHA6R,EAAM3R,MAAME,QAAU,eACtByR,EAAM3R,MAAMC,OAAS,OACrB0R,EAAMkkC,OAAOh6C,GACN8V,GAGHijC,EAAA79C,UAAA0+C,YAAR,SACIC,EACAI,GAFJ,IAAAr3C,EAAAC,KAIQwmB,EAAKrrB,EAAAoE,MAAM+U,YACXmS,EAAKtrB,EAAAoE,MAAMwT,MACX8gC,EAAO1yC,SAASC,cAAc,UAUlC,OATAyyC,EAAKwD,UAAYD,EACjBvD,EAAKvyC,MAAME,QAAU,QACrBqyC,EAAKvyC,MAAMO,SAAW,MACtBgyC,EAAKvyC,MAAMI,WAAawB,EAAAtD,KAAK+B,KAC7BkyC,EAAKvyC,MAAMC,OAAS,OACpBsyC,EAAKvyC,MAAMG,QAAU,MACrBoyC,EAAKvyC,MAAM2a,WAAauK,EAAGtkB,SAC3B2xC,EAAKvyC,MAAMM,MAAQ6kB,EAAGvkB,SACtB2xC,EAAKrG,QAAU,WAAQztC,EAAK62C,aAAaI,IAClCnD,GAGfqC,EAvIA,GAAa18C,EAAA08C,6aCVb,IAAA/6C,EAAA/B,EAAA,GACA8J,EAAA9J,EAAA,GACAk+C,EAAA,SAAAz3C,GAGI,SAAAy3C,EAAYx9C,EAAcma,EAAWC,GAArC,IAAAnU,EACIF,EAAAtH,KAAAyH,KAAMiU,EAAGC,EAAG,EAAG,IAAElU,YACjBD,EAAK6V,UAAY,IAAIza,EAAA0a,MAAM/b,EAAMma,EAAGC,EAAGhR,EAAAtD,KAAK+B,MAC5C5B,EAAK6V,UAAU/T,SAAW,GAC1B9B,EAAK6V,UAAUhU,MAAQzG,EAAAoE,MAAMwT,MAAM9Q,OAAO,IAC1ClC,EAAKyM,IAAIzM,EAAK6V,WAEd7V,EAAKw3C,WAAa,IAAIp8C,EAAA0a,MAAM,IAAK5B,EAAI,GAAIC,EAAGhR,EAAAtD,KAAK+B,MACjD5B,EAAKw3C,WAAW11C,SAAW,GAC3B9B,EAAKw3C,WAAW31C,MAAQzG,EAAAoE,MAAMwT,MAAM9Q,OAAO,IAC3ClC,EAAKyM,IAAIzM,EAAKw3C,cAqBtB,OAlCmCh3C,EAAA+2C,EAAAz3C,GAgB/By3C,EAAAj/C,UAAAm/C,SAAA,SAASC,GACLz3C,KAAKu3C,WAAWv7B,KAAO,GAAGy7B,EAC1B,IAAI79C,EAAIuB,EAAAoE,MAAMuT,KACV2kC,IAAUC,OAAOC,mBACjB/9C,EAAIuB,EAAAoE,MAAMgK,OACVvJ,KAAKu3C,WAAWv7B,KAAO,YAGvBpiB,EADO69C,EAAQ,EACXt8C,EAAAoE,MAAM6J,MAELquC,EAAQ,EACTt8C,EAAAoE,MAAMyC,IAEN7G,EAAAoE,MAAMsT,SAGd7S,KAAKu3C,WAAW31C,MAAQhI,GAEhC09C,EAlCA,CAAmCn8C,EAAAihB,OAAtB5iB,EAAA89C,+aCFb,IAAAn8C,EAAA/B,EAAA,GACA6N,EAAA7N,EAAA,GACAw+C,EAAAx+C,EAAA,IACAgO,EAAAhO,EAAA,GAEAy+C,EAAA,SAAAh4C,GAcI,SAAAg4C,EAAYjmC,EAAiBqC,EAAWC,GAAxC,IAAAnU,EACIF,EAAAtH,KAAAyH,KAAMiU,EAAGC,EAAG,EAAG,IAAAlU,KAdXD,EAAA+3C,aACJpsC,MAAO,KACPG,OAAQ,KACRC,MAAO,KACPE,QAAS,KACTD,KAAM,KACNc,IAAK,KACLO,OAAQ,KACRyE,OAAQ,KACR9E,OAAQ,KACRE,OAAQ,MAOR,IADA,IAAIvP,EAAQ,EACa+a,EAAA,EAAAtG,EAAA/K,EAAAvJ,UAAUoJ,EAAA6K,UAAW,GAArB2G,EAAAtG,EAAAla,OAAAwgB,IAAyB,CAAzC,IAAAnG,EAAAH,EAAAsG,GAACs/B,EAAAzlC,EAAA,GAAM0lC,EAAA1lC,EAAA,GACZvS,EAAKk4C,SAAiB,GAARv6C,EAAY,EAAGq6C,GAC7Bh4C,EAAKk4C,SAAiB,GAARv6C,EAAY,EAAGs6C,GAC7Bt6C,GAAS,SAGbqC,EAAKm4C,WAAWtmC,KAmBxB,OA3CiCrR,EAAAs3C,EAAAh4C,GA2BrBg4C,EAAAx/C,UAAA4/C,SAAR,SAAiBhkC,EAAWC,EAAW5Z,GACnC,IAAIi9C,EAA4B,IAAIK,EAAAN,cAAch9C,EAAO2Z,EAAGC,GAC5DlU,KAAK83C,YAAYx9C,GAASi9C,EAC1Bv3C,KAAKwM,IAAI+qC,IAGbM,EAAAx/C,UAAA6/C,WAAA,SAAWC,GAGP,IAFA,IAAIvmC,EAASumC,EAEK1/B,EAAA,EAAA2/B,EAAAnxC,EAAA6K,UAAA2G,EAAA2/B,EAAAngD,OAAAwgB,IAAW,CAAxB,IAAIne,EAAK89C,EAAA3/B,GACVzY,KAAK83C,YAAYx9C,GAAOk9C,SACpBvwC,EAAA0K,kBAAkBC,EAAQtX,MAK1Cu9C,EA3CA,CAAiC18C,EAAAihB,OAApB5iB,EAAAq+C,6aCLb,IAAA18C,EAAA/B,EAAA,GACA6N,EAAA7N,EAAA,GACA8J,EAAA9J,EAAA,GACAi/C,EAAA,SAAAx4C,GAEI,SAAAw4C,EAAYpkC,EAAWC,EAAWmxB,GAAlC,IAAAtlC,EACIF,EAAAtH,KAAAyH,KAAMiU,EAAGC,EAAG,GAAI,GAAI/Y,EAAAoE,MAAMc,QAAML,YAChCD,EAAKu4C,aAAe,IAAIn9C,EAAA0a,MAAMwvB,GAAU,GAAI,EAAGniC,EAAAtD,KAAK+B,MACpD5B,EAAKu4C,aAAa12C,MAAQzG,EAAAoE,MAAMwT,MAChChT,EAAKyM,IAAIzM,EAAKu4C,gBAEtB,OARsB/3C,EAAA83C,EAAAx4C,GAQtBw4C,EARA,CAAsBl9C,EAAAihB,OAUtBm8B,EAAA,SAAA14C,GAMI,SAAA04C,EAAYtkC,EAAWC,EAAWskC,EAAwCl+C,GAA1E,IAAAyF,EACIF,EAAAtH,KAAAyH,KAAMiU,EAAE,EAAGC,EAAE,EAAG,GAAI,KAAGlU,KAD+CD,EAAAzF,QAH1EyF,EAAA04C,YAKI,IAAI5E,EAAO,IAAI14C,EAAAihB,MAAM,EAAG,EAAG,GAAI,GAAInV,EAAA+L,WAAWwlC,WAC9Cz4C,EAAKyM,IAAIqnC,GACT9zC,EAAK03C,MAAQ,IAAIt8C,EAAA0a,MAAM,IAAIvb,EAAS,GAAI,GAAI4I,EAAAtD,KAAK+B,MACjD5B,EAAK03C,MAAM51C,SAAW,GACtB9B,EAAK03C,MAAM71C,MAAQzG,EAAAoE,MAAMwT,MACzBhT,EAAKyM,IAAIzM,EAAK03C,OAEd13C,EAAK24C,QAAU,IAAIL,EAAQ,EAAG,EAAGpxC,EAAAmD,cAAcouC,IAC/Cz4C,EAAK24C,QAAQC,WACb54C,EAAKyM,IAAIzM,EAAK24C,SAGd34C,EAAKw4B,GAAG,eAAgB,WACpBx4B,EAAK24C,QAAQC,aAGjB54C,EAAKw4B,GAAG,eAAgB,WACpBx4B,EAAK24C,QAAQC,aAAUnzB,EAcnC,OAvCuCjlB,EAAAg4C,EAAA14C,GA8BnC04C,EAAAlgD,UAAAugD,OAAA,SAAOhmB,GACH5yB,KAAK1F,OAASs4B,EACd5yB,KAAKy3C,MAAMz7B,KAAO,IAAIhc,KAAK1F,OAG/Bi+C,EAAAlgD,UAAA4gB,MAAA,SAAM2Z,GACF5yB,KAAK1F,OAASs4B,EACd5yB,KAAKy3C,MAAMz7B,KAAO,IAAIhc,KAAK1F,OAEnCi+C,EAvCA,CAAuCp9C,EAAAgrC,SAA1B3sC,EAAA++C,mbCbb,IAAAp9C,EAAA/B,EAAA,GACA6N,EAAA7N,EAAA,GACAy/C,EAAAz/C,EAAA,IACAgO,EAAAhO,EAAA,GACA0/C,EAAA,SAAAj5C,GAkBI,SAAAi5C,EAAY7kC,EAAWC,SAAvBnU,EACIF,EAAAtH,KAAAyH,KAAMiU,EAAEC,EAAE,EAAE,IAAElU,KAlBlBD,EAAAizC,UAAO7gC,MAGElL,EAAAmD,cAAc+D,SAAU,KACzBgE,EAAClL,EAAAmD,cAAc+C,MAAO,KACtBgF,EAAClL,EAAAmD,cAAcoB,KAAM,KACrB2G,EAAClL,EAAAmD,cAAc6D,MAAO,KACtBkE,EAAClL,EAAAmD,cAAcC,SAAU,KACzB8H,EAAClL,EAAAmD,cAAcsC,MAAO,KACtByF,EAAClL,EAAAmD,cAAc2E,OAAQ,KACvBoD,EAAClL,EAAAmD,cAAcwE,WAAY,KAC3BuD,EAAClL,EAAAmD,cAAcmF,WAAY,KAC3B4C,EAAClL,EAAAmD,cAAc+F,QAAS,KACxBgC,EAAClL,EAAAmD,cAAc6F,OAAQ,KACvBkC,EAAClL,EAAAmD,cAAciG,QAAS,KAAAtY,GAK5B,IACIu4B,GACArpB,EAAAmD,cAAc6D,KACdhH,EAAAmD,cAAcwE,UAEd3H,EAAAmD,cAAcsC,KACdzF,EAAAmD,cAAcmF,UAEdtI,EAAAmD,cAAcC,QACdpD,EAAAmD,cAAc2E,MAEd9H,EAAAmD,cAAc+F,OACdlJ,EAAAmD,cAAc6F,cAGlB7I,EAAAvJ,UAAUyyB,EAAW,GAAG3xB,QAAQ,SAACwT,EAAczU,OAAbq7C,EAAA5mC,EAAA,GAAM6mC,EAAA7mC,EAAA,GAChC8mC,EAhBE,EAgBiB,GAARv7C,EAAYw7C,EAAmB,EAARx7C,EAhBvB,EAiBfqC,EAAKo5C,SAASF,EAAIC,EAAIH,GACtBh5C,EAAKo5C,SAASF,EAAIC,EAAK,GAAIF,OAuBvC,OA7DmCz4C,EAAAu4C,EAAAj5C,GA0CvBi5C,EAAAzgD,UAAA8gD,SAAR,SAAiBllC,EAAWC,EAAW6E,GACnC,IAAIqgC,EAAQ,IAAIP,EAAAN,kBAAkBtkC,EAAGC,EAAG6E,EAAK,GAC7C/Y,KAAKwM,IAAI4sC,GACTp5C,KAAKgzC,QAAQj6B,GAAOqgC,GAGxBN,EAAAzgD,UAAAghD,UAAA,SAAU/0B,GACN,IAAIvL,EAAM/Y,KAAKgzC,QAAQ1uB,GACnBvL,GACAA,EAAI6/B,OAAO,IAInBE,EAAAzgD,UAAAihD,UAAA,SAAUh1B,GACN,IAAIvL,EAAM/Y,KAAKgzC,QAAQ1uB,GACnBvL,GACAA,EAAIE,MAAM,IAGtB6/B,EA7DA,CAAmC39C,EAAAihB,OAAtB5iB,EAAAs/C,+aCJb,IAAA39C,EAAA/B,EAAA,GAEAmgD,EAAAngD,EAAA,IACAogD,EAAApgD,EAAA,IACAqgD,EAAArgD,EAAA,IACAuG,EAAAvG,EAAA,IAEA8J,EAAA9J,EAAA,GAEAsgD,EAAA,SAAA75C,GAUI,SAAA65C,EAAY9nC,EAAiBsqB,EAAWyG,GAAxC,IAAA5iC,EACIF,EAAAtH,KAAAyH,KAAM,EAAE,EAAK,EAAFk8B,EAAIyG,EAAGxnC,EAAAoE,MAAMsT,SAASgF,QAAQ5V,OAAO,OAAMjC,KAIlD25C,EAAQ,IAAIx+C,EAAA0a,MAAM3S,EAAAtD,KAAK4C,MAAO,EAAG4c,GAAOlc,EAAAtD,KAAK+B,MACjDg4C,EAAM93C,SAAW,GACjB83C,EAAM/3C,MAAQzG,EAAAoE,MAAMuT,KACpB6mC,EAAM5E,UAAY55C,EAAA65C,UAAUC,OAC5Bl1C,EAAKyM,IAAImtC,GAET,IAAIC,EAAU,IAAIz+C,EAAA0a,MAAM,OAAQ,IAAKuJ,GAASlc,EAAAtD,KAAK+B,aACnDi4C,EAAQ/3C,SAAW,EACnB+3C,EAAQh4C,MAAQzG,EAAAoE,MAAMuT,KAAK7Q,OAAO,IAClClC,EAAKyM,IAAIotC,GAGT75C,EAAKuwB,UAAY,IAAIipB,EAAAT,cAAc,IAd1B,IAeT/4C,EAAKyM,IAAIzM,EAAKuwB,WAEdvwB,EAAK2K,QAAU,IAAI8uC,EAAA3B,YAAYjmC,EAAQ,IAjB9B,IAkBT7R,EAAKyM,IAAIzM,EAAK2K,SAEd3K,EAAK85C,MAAQ,IAAI1+C,EAAA0a,MAAM,eAAgB,IApB9B,GAoBuC3S,EAAAtD,KAAK+B,MACrD5B,EAAK85C,MAAMj4C,MAAQzG,EAAAoE,MAAMwT,MACzBhT,EAAKyM,IAAIzM,EAAK85C,OAEd95C,EAAK+5C,SAAW,IAAI3+C,EAAA0a,MAAM,GAAI,IAAKuJ,GAASlc,EAAAtD,KAAK+B,MACjD5B,EAAK+5C,SAASj4C,SAAW,GACzB9B,EAAK+5C,SAASl4C,MAAQzG,EAAAoE,MAAMwT,MAC5BhT,EAAKyM,IAAIzM,EAAK+5C,UAEd/5C,EAAKu4C,aAAe,IAAIn9C,EAAA0a,MAAM,KAAM,IA7B3B,GA6BoC3S,EAAAtD,KAAK+B,MAClD5B,EAAKu4C,aAAaz2C,SAAW,GAC7B9B,EAAKu4C,aAAa12C,MAAQzG,EAAAoE,MAAMwT,MAChChT,EAAKu4C,aAAavD,UAAY55C,EAAA65C,UAAUC,OACxCl1C,EAAKyM,IAAIzM,EAAKu4C,cAEdv4C,EAAKg6C,YAAc,IAAIN,EAAAvD,YAAY,IAAK,IAGpC8D,eAAgBr6C,EAAAiB,UAAU6rC,YAI1BF,UAAa5sC,EAAAiB,UAAU2rC,cAwDnC,OA/GwChsC,EAAAm5C,EAAA75C,GAgEpC65C,EAAArhD,UAAAyd,KAAA,SAAKC,EAAKC,GACNnW,EAAAxH,UAAMyd,KAAIvd,KAAAyH,KAAC+V,EAAKC,GAChBhW,KAAK+5C,YAAYjkC,KAAKC,IAS1B2jC,EAAArhD,UAAAwvB,KAAA,WACI7nB,KAAK+5C,YAAYlyB,QAGrB6xB,EAAArhD,UAAAwS,KAAA,WACI7K,KAAK+5C,YAAYpD,OACjB32C,KAAK+5C,YAAYlvC,QAGrB6uC,EAAArhD,UAAA4hD,kBAAA,SAAkBlhC,GACd/Y,KAAKswB,UAAU+oB,UAAUtgC,IAG7B2gC,EAAArhD,UAAA6hD,kBAAA,SAAkBnhC,GACd/Y,KAAKswB,UAAUgpB,UAAUvgC,IAG7B2gC,EAAArhD,UAAA8hD,WAAA,SAAWn+B,GAAgBhc,KAAKs4C,aAAat8B,KAAOA,GAEpD09B,EAAArhD,UAAA+hD,YAAA,SAAYjC,GACRn4C,KAAK0K,QAAQwtC,WAAWC,IAG5BuB,EAAArhD,UAAAgiD,WAAA,SAAW3S,EAAW4S,GAClBt6C,KAAK85C,SAAS99B,KAAO,QAAQ0rB,EAAI,IAAI4S,GAGzCZ,EAAArhD,UAAAkiD,SAAA,SAAS9c,kBAAA,GACL,IAAI+c,GAAQx+C,KAAKK,MAAMohC,EAAO,MAAW,GAAGgd,WACxCC,EAAK1+C,KAAKK,MAAMohC,EAAO,IAAM,GAC7Bkd,EAAQ3+C,KAAKK,OAAOq+C,EAAK,IAAM,GAAK,GAAGD,WACvCG,EAAU5+C,KAAKK,MAAMohC,EAAO,IAAIgd,WAChCI,EAAOH,EAAK,GAAK,KAAO,KAC5B16C,KAAK65C,MAAM79B,KAAO,OAAOw+B,EAAI,KAAKG,EAAK,IAAIC,EAAQE,SAAS,EAAG,KAAI,IAAID,GAG/EnB,EA/GA,CAAwCv+C,EAAAihB,OAA3B5iB,EAAAkgD,obCTb,IAAAv+C,EAAA/B,EAAA,GACAkmB,EAAAlmB,EAAA,IAEA6N,EAAA7N,EAAA,GACAua,EAAAva,EAAA,GACAgO,EAAAhO,EAAA,GAEA2hD,EAAA3hD,EAAA,IAGA4hD,EAAA5hD,EAAA,IACAsa,EAAAta,EAAA,IACA6hD,EAAA7hD,EAAA,IAEA8hD,EAAA9hD,EAAA,IAEA+hD,EAAA/hD,EAAA,IAEA+zC,EAAA/zC,EAAA,IAGAgiD,EAAA,SAAAv7C,GAAA,SAAAu7C,mDAiBA,OAjByB76C,EAAA66C,EAAAv7C,GAErBu7C,EAAA/iD,UAAA+c,MAAA,SAAMk4B,GAAN,IAAAvtC,EAAAC,KACIstC,EAAK3uC,QAAQ,SAAA4uC,GACT,IAAIjnB,EAAYinB,EAAI1mB,SACdsmB,EAAAvmB,eAAe2mB,EAAIvrB,MAAOurB,EAAI1mB,UAC9BsmB,EAAA9mB,eAAeknB,EAAIvrB,MAAO7mB,EAAAoE,MAAMwT,OACtCuT,EAAUknB,QAAU,WAChBD,EAAIyJ,SACAzJ,EAAI1mB,WACJP,EAAUhlB,MAAMlB,gBAAkBmtC,EAAI1mB,WAAW3kB,WAGzDnC,EAAK6nB,SAASM,YAAY5B,MAItC80B,EAjBA,CAFAhiD,EAAA,IAEyB0tB,MAqBzB4a,EAAA,SAAA7hC,GA2BI,SAAA6hC,EACYjK,EACA4jB,EACAC,EACAC,EACA5J,YAHA0J,MAAA,eACAC,MAAA,eACAC,MAAA,eACA5J,MAAA,MALZ,IAAA5xC,EAOIF,EAAAtH,KAAAyH,KAAM,EAAG,EAAGy3B,EAAKmW,YAAanW,EAAKiW,eAAa1tC,KANxCD,EAAA03B,OACA13B,EAAAs7C,mBACAt7C,EAAAu7C,kBACAv7C,EAAAw7C,mBACAx7C,EAAA4xC,kBA9BJ5xC,EAAAy7C,gBAKAz7C,EAAA07C,mBAQA17C,EAAAgmC,MAAe,KAoBnB,IAAI2H,EAAejW,EAAKiW,aAAe5yC,OAAO6yC,iBAC1CC,EAAcnW,EAAKmW,YAAc9yC,OAAO6yC,iBAE5C5tC,EAAK27C,OAAS,IAAIX,EAAArB,mBAAmBzyC,EAAA0D,cAAe8sB,EAAKmW,YAAa,IACtE7tC,EAAKyM,IAAIzM,EAAK27C,QAEd,IAAIC,EAAc,SAACn+C,GAAM,OAAAuC,EAAK6+B,SAASphC,WACvCuC,EAAK67C,eAAiB,IAAIX,EAAAlH,QAAQ,UAAWnG,EAAc,IAAK,GAAIj6B,EAAA3C,YAAasqC,EAAiBK,GAClG57C,EAAK87C,iBAAmB,IAAIZ,EAAAlH,QAAQ,YAAa,GAAI,IAAKrS,EAAIoa,qBAAsBT,EAAkBM,GACtG57C,EAAKg8C,gBAAkB,IAAId,EAAAlH,QAAQ,cAAe,GAAI,GAAIrS,EAAIsa,oBAAqBT,EAAkBI,MAErG57C,EAAKk8C,YAAc,IAAId,EAAAzJ,YAAY9D,EAAc,IAAKF,EAAa,IAAKiE,GAExE5xC,EAAKm8C,KAAO,IAAIlB,EAAAnF,KAAK,KAAM,GAAInI,EAAe,KAC9C3tC,EAAKyM,IAAIzM,EAAKm8C,MAEdn8C,EAAKo8C,WAAa,IAAIf,EAAW,UAAWxN,EAAY,EAAI,IAAKF,EAAe,KAChF3tC,EAAKo8C,WAAW/mC,QACV4M,MAAO,YAAag1B,OAAQ,WAAOvf,EAAK+K,UAAU,WAClDxgB,MAAO,aAAcg1B,OAAQ,WAC3Bvf,EAAKl1B,mBACNskB,SAAU,WAAM,OAAA4Q,EAAKn3B,UAAYnF,EAAAoE,MAAMgK,OAASpO,EAAAoE,MAAM2K,gBAqKrE,OA7NyB3J,EAAAmhC,EAAA7hC,GA6DrB6hC,EAAArpC,UAAAwS,KAAA,WACI7K,KAAK47C,eAAe/wC,OACpB7K,KAAK67C,iBAAiBhxC,OACtB7K,KAAK+7C,gBAAgBlxC,OACrB7K,KAAKi8C,YAAYpxC,OACjB7K,KAAKm8C,WAAWtxC,OAEhB7K,KAAK07C,OAAO7wC,QAGhB62B,EAAArpC,UAAAwvB,KAAA,WACI7nB,KAAK47C,eAAe/zB,OACpB7nB,KAAK67C,iBAAiBh0B,OACtB7nB,KAAK+7C,gBAAgBl0B,OACrB7nB,KAAKi8C,YAAYp0B,OACjB7nB,KAAKm8C,WAAWt0B,OAEhB7nB,KAAK07C,OAAO7zB,QAGhB6Z,EAAArpC,UAAAorC,gBAAA,WACIzjC,KAAK47C,eAAenY,kBACpBzjC,KAAK67C,iBAAiBpY,kBACtBzjC,KAAK+7C,gBAAgBtY,mBAGzB/B,EAAArpC,UAAAktC,cAAA,SACIF,EACA7iC,EACA0rC,YADA1rC,MAAA,gBAIA,IAAIkrC,EAAe1tC,KAAKy3B,KAAKiW,aAAe5yC,OAAO6yC,iBAC/CC,EAAc5tC,KAAKy3B,KAAKmW,YAAc9yC,OAAO6yC,iBAQjD,OAPA3tC,KAAK+lC,MAAQ,IAAImV,EAAAvI,MACbnwC,EACA6iC,EACAuI,EAAY,EACZF,EAAa,GAEjB1tC,KAAK+lC,MAAM+M,WAAW5E,GACfluC,KAAK+lC,OAIhBrE,EAAArpC,UAAA2pC,mBAAA,WACI3/B,QAAQC,IAAI,uBACRtC,KAAK+lC,QACL/lC,KAAK+lC,MAAM9I,WACXj9B,KAAK+lC,MAAQ,OAKrBrE,EAAArpC,UAAA+sC,aAAA,WACIplC,KAAKw7C,iBAGT9Z,EAAArpC,UAAA+qC,UAAA,SAAUpnB,GAAgBhc,KAAK07C,OAAOvB,WAAWn+B,IAEjD0lB,EAAArpC,UAAAyd,KAAA,SAAKC,EAA+BC,GAChCnW,EAAAxH,UAAMyd,KAAIvd,KAAAyH,KAAC+V,EAAKC,GACXhW,KAAKw7C,eACNx7C,KAAK67C,iBAAiB/lC,KAAKC,GAC3B/V,KAAK+7C,gBAAgBjmC,KAAKC,GAEtB/V,KAAK47C,eAAexH,aAAan8C,OAAS,GAC1C+H,KAAK47C,eAAe9lC,KAAKC,IAI7B/V,KAAK+lC,OACL/lC,KAAK+lC,MAAMjwB,KAAKC,GAGhB/V,KAAKy7C,iBACLz7C,KAAKi8C,YAAYnmC,KAAKC,GAG1B/V,KAAKm8C,WAAWrmC,KAAKC,IAGzB2rB,EAAArpC,UAAA2e,OAAA,SAAOygB,EAAYzhB,GACfnW,EAAAxH,UAAM2e,OAAMze,KAAAyH,KAACy3B,EAAMzhB,IAGvB0rB,EAAArpC,UAAA6mC,iBAAA,SAAiB5a,GACbtkB,KAAK07C,OAAOzB,kBAAkB31B,IAGlCod,EAAArpC,UAAA8mC,iBAAA,SAAiB7a,GACbtkB,KAAK07C,OAAOxB,kBAAkB51B,IAGlCod,EAAArpC,UAAAiqC,cAAA,SAActuB,EAAgBgtB,EAAoB4Q,EAAoBwK,EAAiC3e,YAAjC2e,eAAA,IAAiC3e,MAAA,GAC9FzpB,IACDooC,GACAp8C,KAAKq8C,eAAeroC,EAAO6F,OAAQmnB,GAEvChhC,KAAKs8C,cAActoC,GACnBhU,KAAKu8C,aAAavoC,EAAOtJ,QAAQzD,EAAAyK,UAAU1F,SAASJ,OAAQoI,EAAOqrB,QAEnEr/B,KAAK07C,OAAOnB,SAAS9c,GAKrBz9B,KAAKi8C,YAAYlK,aAAa/9B,EAAOwM,WAAWye,SAAS/hC,OAAO,SAAAtD,GAAK,OAAAA,EAAEiyB,QAAQ+lB,IAG1E5xC,KAAKy7C,iBAAmBznC,EAAOisB,eAAetsB,EAAArF,qBAC/CtO,KAAKy7C,sBAIb/Z,EAAArpC,UAAAumC,SAAA,SAAS+V,GACL30C,KAAKk8C,KAAKjG,QAAQtB,IAGdjT,EAAArpC,UAAAkkD,aAAR,SAAqB7U,EAAM4S,GACvBt6C,KAAK07C,OAAOrB,WAAW3S,EAAM4S,IAGzB5Y,EAAArpC,UAAAikD,cAAR,SAAsBtoC,GAClBhU,KAAK07C,OAAOtB,YAAYpmC,EAAOtJ,UAG3Bg3B,EAAArpC,UAAAgkD,eAAR,SAAuBxiC,EAAgBmnB,GACnChhC,KAAKw8C,sBAAsB3iC,GAC3B7Z,KAAKy8C,qBAAqB5iC,EAAQmnB,GAClChhC,KAAK08C,sBAAsB7iC,IAGvB6nB,EAAArpC,UAAAmkD,sBAAR,SAA8B3iC,GAA9B,IAAA9Z,EAAAC,KACQ28C,EACAjb,EAAIoa,qBAAqB5+C,OAAO,SAAC6W,GAAc,OAAA8F,EAAOC,UAAU4G,KAAK,SAAA1iB,GAAK,OAAAA,EAAE+V,qBAAqBA,MAChG4oC,EAAgBnqC,MAAM,SAAAnZ,GAAK,OAAA0G,EAAK87C,iBAAiB3vC,MAAMuW,SAASppB,MACjE2G,KAAK67C,iBAAiBtH,YAAYoI,IAIlCjb,EAAArpC,UAAAokD,qBAAR,SAA6B5iC,EAAgBmnB,GAA7C,IAAAjhC,EAAAC,KACQ8U,EAAU+E,EAAOqL,iBACjB03B,EACGlb,EAAImb,mBAAmB3/C,OAAO,SAACqe,GAAY,OAAAzG,EAAQ4L,KAAK,SAAA7mB,GAAK,OAAAA,EAAE0hB,mBAAmBA,GAAW1hB,EAAEqS,UAAOhR,QAGxG0hD,EAAcpqC,MAAM,SAAA+I,GAAW,OAAAxb,EAAK67C,eAAe1vC,MAAMuW,SAASlH,MACnEvb,KAAK47C,eAAerH,YAAYqI,EAAe5b,EAASmP,wBAIxDzO,EAAArpC,UAAAqkD,sBAAR,SAA8B7iC,GAA9B,IAAA9Z,EAAAC,KACQ88C,EAAwB11C,EAAA/J,WAAWwc,EAAOC,UAAUpd,IAAI,SAAAsB,GAAK,OAAAA,EAAEoY,iBAC/D2mC,EAAiBrb,EAAIsa,oBAAoB9+C,OAAO,SAACnB,GAAO,OAAA+gD,EAAsBp8B,KAAK,SAAAs8B,GAAM,OAAAA,aAAcjhD,MACtGghD,EAAevqC,MAAM,SAAAzW,GAAM,OAAAgE,EAAKg8C,gBAAgB7vC,MAAMuW,SAAS1mB,MAChEiE,KAAK+7C,gBAAgBxH,YAAYwI,IAxMlCrb,EAAAoa,sBACHx8B,EAAAgV,YACAhV,EAAA4U,SACA5U,EAAA6U,eACG7U,EAAAqF,eAEA+c,EAAAmb,mBAAqBlpC,EAAA3C,YACrB0wB,EAAAsa,oBAAsBtoC,EAAAmI,kBAqMjC6lB,EA7NA,CAAyBvmC,EAAAgrC,SAAZ3sC,EAAAkoC,qaC1Cb,IAAAt6B,EAAAhO,EAAA,GACAgtC,EAAAhtC,EAAA,IACA8J,EAAA9J,EAAA,GACA6jD,EAAA,SAAAp9C,GAAA,SAAAo9C,IAAA,IAAAl9C,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAm9C,WA4CJ,OA7C+B38C,EAAA08C,EAAAp9C,GAK3Bo9C,EAAA5kD,UAAAmuC,aAAA,WAQI,IAPA,IACI2W,EAAa,GAAKj6C,EAAAtD,KAAK8C,WACvBkhB,EAAO5jB,KAAKqW,WAAa,EACzB+mC,EAAep9C,KAAKqW,WAHR,EAKZgnC,EAAc,EAAIn6C,EAAAtD,KAAK8C,WACvB46C,EAAaF,EAAe,EAApB,EACE3kC,EAAA,EAAAtG,EAAA/K,EAAA7K,MAPE,GAOFkc,EAAAtG,EAAAla,OAAAwgB,IAAkB,CAA3B,IAAI1gB,EAACoa,EAAAsG,GACFkqB,EACAnlC,EAAgBxB,KAAKM,SAAW+gD,EACpCr9C,KAAKk9C,MAAM/kD,MACP8b,EAAGjY,KAAKC,IAAI+D,KAAKqW,WAAa,EAAIssB,EAAI,EAAW5qC,EAAIqlD,EAAXx5B,EAA4B5nB,KAAKM,SAAWghD,GACtFlpC,OAAQuuB,MAKpBsa,EAAA5kD,UAAAyd,KAAA,SAAKC,EAA+BC,GAChC,IAAIunC,EAAYv9C,KAAK4B,MAAMsR,WAAW,KAClCsqC,EAAcD,EAAU7qC,QAAQ,IACpCqD,EAAIkH,UAAYsgC,EAAUr7C,SAC1B,IAAIs6B,EAAQx8B,KAAKuM,IAAI2H,EAAI,EACzBlU,KAAKk9C,MAAMv+C,QAAQ,SAAA8+C,GACf,IAAIzH,EAAKxZ,EAAQihB,EAAKrpC,OAClBspC,EAAyB,IAAdD,EAAKrpC,OACpB2B,EAAI6G,YACJ7G,EAAI8G,OAAO4gC,EAAKxpC,EAAG+hC,GACnBjgC,EAAIgH,OAAO0gC,EAAKxpC,EAAIypC,EAAUlhB,GAC9BzmB,EAAIgH,OAAO0gC,EAAKxpC,EAAIypC,EAAUlhB,GAC9BzmB,EAAIkH,UAAYsgC,EAAUr7C,SAC1B6T,EAAItZ,OACJsZ,EAAI6G,YACJ7G,EAAI8G,OAAO4gC,EAAKxpC,EAAG+hC,GACnBjgC,EAAIgH,OAAO0gC,EAAKxpC,EAASypC,EAAW,EAAhB,EAAoBlhB,GACxCzmB,EAAIgH,OAAO0gC,EAAKxpC,EAAIypC,EAAUlhB,GAC9BzmB,EAAIkH,UAAYugC,EAAYt7C,SAC5B6T,EAAItZ,UAGhBwgD,EA7CA,CAA+B7W,EAAAwB,kBAAlBpuC,EAAAyjD,2aCHb,IAAA9hD,EAAA/B,EAAA,GACAgO,EAAAhO,EAAA,GACAukD,EAAAvkD,EAAA,IACAwkD,EAAAxkD,EAAA,IACAykD,EAAA,SAAAh+C,GAII,SAAAg+C,EAAY3pC,EAAWC,EAAe2pC,EAAWC,GAAjD,IAAAh+C,EACIF,EAAAtH,KAAAyH,KAAM,EAAGkU,EAAGC,EAAO,OAAKnU,KACpBg+C,EAAM52C,EAAAjI,UAAU2+C,EAAIC,GACpBE,EAASL,EAAAvX,eAAe1J,YAAc,EACtCuhB,GAAMN,EAAAvX,eAAe1J,YAAcshB,GAAUL,EAAAvX,eAAeI,kBAChE1mC,EAAKo+C,mBAAqB,IAAIP,EAAAvX,gBAAgB6X,EAAI/pC,EAAO6pC,GACzDj+C,EAAKo+C,mBAAmBjgB,SAAW6f,EACnCh+C,EAAKyM,IAAIzM,EAAKo+C,oBACdp+C,EAAKq+C,UAAY,IAAIT,EAAAV,UAAU,EAAG9oC,EAAO6pC,GACzCj+C,EAAKyM,IAAIzM,EAAKq+C,WACdr+C,EAAKs+C,eAAiB,IAAIT,EAAAvX,eAAe,EAAGtmC,EAAKsW,WAAYynC,GAC7D/9C,EAAKs+C,eAAengB,SAAW8f,EAC/Bj+C,EAAKyM,IAAIzM,EAAKs+C,kBAUtB,OA1B8B99C,EAAAs9C,EAAAh+C,GAkB1Bg+C,EAAAxlD,UAAAimD,QAAA,SAAQR,EAAWC,GACf,IAAIC,EAAM52C,EAAAjI,UAAU2+C,EAAIC,GACxB/9C,KAAKm+C,mBAAmBv8C,MAAQo8C,EAChCh+C,KAAKm+C,mBAAmBjgB,SAAW6f,EACnC/9C,KAAKo+C,UAAUx8C,MAAQo8C,EACvBh+C,KAAKq+C,eAAez8C,MAAQk8C,EAC5B99C,KAAKq+C,eAAengB,SAAW8f,GAEvCH,EA1BA,CAA8B1iD,EAAAihB,OAAjB5iB,EAAAqkD,0aCJb,IAAA1iD,EAAA/B,EAAA,GACAgO,EAAAhO,EAAA,GACAmlD,EAAAnlD,EAAA,IACAwkD,EAAAxkD,EAAA,IACAyjC,EAAA,SAAAh9B,GAEI,SAAAg9B,EAAY3oB,EAAWC,EAAuB2pC,EAAWC,EAAmBtX,kBAAA,GAA5E,IAAA1mC,EACIF,EAAAtH,KAAAyH,KAAM,EAAGkU,EAAGC,EAAO,OAAKnU,KADkBD,EAAA+9C,KAA8B/9C,EAAA0mC,aAD5E1mC,EAAAumC,UAII,IADA,IAAI3D,EAAKib,EAAAvX,eAAe1J,YAAcihB,EAAAvX,eAAeI,WAAemX,EAAAvX,eAAe1J,YAAc,EACnFlkB,EAAA,EAAAtG,EAAA/K,EAAA7K,MAAMkqC,GAANhuB,EAAAtG,EAAAla,OAAAwgB,IAAmB,CAA5B,IAAI1gB,EAACoa,EAAAsG,GACF+lC,EAAKp3C,EAAAjI,UAAU2+C,EAAIC,EAAKhmD,GAAK0uC,EAAa,IAC1CgY,EAAKr3C,EAAAjI,UAAU2+C,EAAIC,GAAMhmD,EAAI,IAAM0uC,EAAa,IAChDS,EAAQ,IAAIqX,EAAAV,UAAU,GAAMnkD,GAAO+sC,EAAa1uC,EAAI,GAAKgI,EAAKsW,WAAYooC,EAAID,GAClFz+C,EAAKumC,OAAOnuC,KAAK+uC,GACjBnnC,EAAKyM,IAAI06B,YAYrB,OAtB+B3mC,EAAAs8B,EAAAh9B,GAa3Bg9B,EAAAxkC,UAAA8lC,MAAA,SAAM4f,GAEF,IADA,IAAID,EAAK99C,KAAK89C,GACArlC,EAAA,EAAAtG,EAAA/K,EAAA7K,MAAMyD,KAAKymC,YAAXhuB,EAAAtG,EAAAla,OAAAwgB,IAAwB,CAAjC,IAAI1gB,EAACoa,EAAAsG,GACF+lC,EAAKp3C,EAAAjI,UAAU2+C,EAAIC,EAAKhmD,GAAKiI,KAAKymC,WAAa,IAC/CgY,EAAKr3C,EAAAjI,UAAU2+C,EAAIC,GAAMhmD,EAAI,IAAMiI,KAAKymC,WAAa,IACzDzmC,KAAKsmC,OAAOvuC,GAAGumD,QAAQG,EAAID,KAIvC3hB,EAtBA,CAA+B1hC,EAAAihB,OAAlB5iB,EAAAqjC,qwDCJb,IAAA0T,EAAAn3C,EAAA,IACAgO,EAAAhO,EAAA,GAEAua,EAAAva,EAAA,GAEAo0B,EAAA,SAAA3tB,GAAA,SAAA2tB,IAAA,IAAAztB,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAA2+C,eAAyB,IAAAzyC,EAsE7B,OAvEkD1L,EAAAitB,EAAA3tB,GAM9B2tB,EAAAn1B,UAAAO,MAAhB,kBAAAyB,EAAA2F,UAAA,wBAAAxC,EAAAyO,EAAA1R,EAAA,OAAAlB,EAAA2G,KAAA,SAAAjI,GAAA,OAAAA,EAAAiqB,OAAA,cACQiF,EAAS7f,EAAAvK,QACTmD,KAAK8oB,KAAKvc,IACVvM,KAAKo8B,SAASl/B,OAAO,SAAAylC,GAAK,OAAAA,EAAE9W,QAAU8W,EAAEgc,YACxC,SAAChc,GAAM,OAAAA,EAAEp2B,OAITvM,KAAK8oB,KAAKyI,cAActK,GAExBjnB,KAAK8oB,KAAKxmB,IAAI,mBAGdovB,EAAQ1xB,KAAK8oB,KAAK81B,eACb5iD,KAAK4kB,IAAI5gB,KAAK8oB,KAAKvc,IAAI2H,EAAIwd,EAAMxd,GACjC,IACLlU,KAAK8oB,KAAKxmB,IAAI,2BACVtC,KAAK8oB,KAAK+E,QACV7tB,KAAK8oB,KAAKxmB,IAAI,kBACd,EAAMtC,KAAK8oB,KAAKsJ,eAAepyB,KAAKgU,OAAO6F,OAAOimB,WAFlD,OAFJ,mBAII3tB,EAAA4P,oBAIA,OAFA/hB,KAAK8oB,KAAKxmB,IAAI,iBACVu8C,EAAY7+C,KAAKgU,OAAO6F,OAAOqL,iBAAiBhmB,KAAK,SAAAmM,GAAU,OAAAA,EAAOkQ,mBAAmB5H,EAAArI,iBAC7F,EAAMtL,KAAK8oB,KAAKkB,MAAM60B,WAAtB1sC,EAAA4P,kDAGA/hB,KAAK8oB,KAAKkJ,qBACV,EAAMhyB,KAAK8+C,WADX,mBACA3sC,EAAA4P,oBAEA,SAAM/hB,KAAK8oB,KAAKmJ,8BAAhB9f,EAAA4P,wCAMNyL,EAAAn1B,UAAAymD,OAAN,kBAAAzkD,EAAA2F,UAAA,2BAAA3G,EAAA2G,KAAA,SAAAxC,GAAA,OAAAA,EAAAwkB,OAAA,cACIhiB,KAAK8oB,KAAK5U,EAAIlU,KAAK8oB,KAAK81B,eAAe1qC,EACjClU,KAAK8oB,KAAKgE,UAAY9sB,KAAK8oB,KAAK7I,QAAlC,KACIjgB,KAAK8oB,KAAK+E,QAAU7tB,KAAK8oB,KAAKsD,OAAS,IACvC,EAAMpsB,KAAK8oB,KAAKnhB,SADhB,mBACAwK,EAAA4P,2BAEK/hB,KAAK8oB,KAAKsD,OAAS,IAAMpwB,KAAKM,SAAW,KAASN,KAAKM,SAAW,KACnE,EAAM0D,KAAK8oB,KAAK0J,UADhB,mBACArgB,EAAA4P,oBAEA,SAAM/hB,KAAK8oB,KAAKnhB,eAAhBwK,EAAA4P,wCAMhByL,EAAAn1B,UAAA84B,SAAA,eAAApxB,EAAAC,KACQ++C,EAAe/+C,KAAKgU,OAAO6F,OAAOimB,OAAS9/B,KAAKgU,OAAO6F,OAAOimB,OAAS9/B,KAAK8oB,KAAKvc,IAKrF,OAJiBvM,KAAKo8B,SAAS1b,KAAK,SAAAC,GAAW,OAAAA,EAAQkL,UAClD9rB,EAAK+oB,KAAK+E,QAAgBkxB,EAAa3hD,SAASujB,EAAQpU,KAAOxM,EAAK2+C,kBACjE/9B,EAAQg+B,aAMpBvmD,OAAA6B,eAAIuzB,EAAAn1B,UAAA,YAAA+B,IAAJ,WACI,OAAO4F,KAAK8oB,KAAK+E,OACX7tB,KAAKgU,OAAOwM,WAAWye,SACvBj/B,KAAKgU,OAAOwM,WAAWC,yCAErC+M,EAvEA,CAAkD+iB,EAAAlH,gBAArC7vC,EAAAg0B,8bCLb,IAEAwxB,EAAA,SAAAn/C,GAAA,SAAAm/C,mDAEA,OAF6Cz+C,EAAAy+C,EAAAn/C,GACzCm/C,EAAA3mD,UAAAixC,SAAA,WAAa,MAAO,UACxB0V,EAFA,CAFA5lD,EAAA,IAE6CyvB,UAAvBrvB,EAAAwlD,0wDCFtB,IAAAC,EAAA7lD,EAAA,IACA6N,EAAA7N,EAAA,GAEAk0B,EAAA,SAAAztB,GAAA,SAAAytB,mDAkCA,OAlC8C/sB,EAAA+sB,EAAAztB,GAC1CytB,EAAAj1B,UAAA84B,SAAA,WACI,OAAOnxB,KAAK8oB,KAAKupB,UACbryC,KAAKgU,OAAOkrC,gBAAgBz8B,SAASxb,EAAAmD,cAAc6D,OAK3Cqf,EAAAj1B,UAAAO,MAAhB,kBAAAyB,EAAA2F,UAAA,wBAAAxC,EAAAyO,EAAA,OAAA5S,EAAA2G,KAAA,SAAAzF,GAAA,OAAAA,EAAAynB,OAAA,cAEQna,EAAS7H,KAAK8U,QAAQ5V,KAAK,SAAArF,GAAK,MAA6B,UAA7BA,EAAE0hB,QAAQjR,UAAUC,MACtD1Q,EAAE0hB,QAAQjR,UAAU+Y,OAAOZ,SAASxb,EAAAmD,cAAc6D,OAClDpU,EAAE8lB,QAAQ8C,SAASxb,EAAAmD,cAAc6D,QAChCpU,EAAEimB,aAIDjY,EAAOiY,aAEP,EAAM9f,KAAK6pB,YAAYhiB,MAHvB,YAIA,OADAsK,EAAA4P,QACA,EAAMla,EAAOoa,SAASjiB,KAAK8oB,MAAQve,KAAM,WAAY+Z,SAAUrd,EAAAmD,cAAc6D,sBAA7EkE,EAAA4P,OACAla,EAAOiY,aAEHq/B,EAAOn/C,KAAK8U,QAAQ5V,KAAK,SAAArF,GAAK,OAAAA,EAAE0hB,QAAQvQ,oBAExC,EAAMhL,KAAK6pB,YAAYs1B,KADvB,YACAhtC,EAAA4P,wBAEJ,SAAM/hB,KAAK8oB,KAAKuI,cAAhBlf,EAAA4P,wCAOZuL,EAlCA,CAA8C2xB,EAAAD,gBAAjCxlD,EAAA8zB,0bCHb,IAEA8xB,EAAA,SAAAv/C,GAAA,SAAAu/C,mDAEA,OAF+C7+C,EAAA6+C,EAAAv/C,GAC3Cu/C,EAAA/mD,UAAAixC,SAAA,WAAa,MAAO,YACxB8V,EAFA,CAFAhmD,EAAA,IAE+CyvB,UAAzBrvB,EAAA4lD,4wDCFtB,IAAAC,EAAAjmD,EAAA,IACAua,EAAAva,EAAA,GACAgO,EAAAhO,EAAA,GAEAg0B,EAAA,SAAAvtB,GAAA,SAAAutB,mDA+CA,OA/C4C7sB,EAAA6sB,EAAAvtB,GACxCutB,EAAA/0B,UAAA84B,SAAA,eAAApxB,EAAAC,KACI,QAAKA,KAAK4H,MAKN5H,KAAKgU,OAAOwM,WAAWC,QAAQC,KAAK,SAAA+f,GAAU,OAAAA,EAAOl0B,IAAInP,SAAS2C,EAAK+oB,KAAKvc,KAAO,QAKnFvM,KAAK8oB,KAAKsD,OAAS,OAIlBpsB,KAAK8oB,KAAKwpB,UAIDtyC,KAAKgU,OAAO2pB,KAAO,IAAM39B,KAAKgU,OAAO2pB,KAAO,KAI9CvQ,EAAA/0B,UAAAO,MAAhB,kBAAAyB,EAAA2F,UAAA,wBAAAxC,EAAA,OAAAnE,EAAA2G,KAAA,SAAAiM,GAAA,OAAAA,EAAA+V,OAAA,cACIhiB,KAAK8oB,KAAKxmB,IAAI,kBAGVsF,EAAM5H,KAAK4H,MAEX5H,KAAK8oB,KAAKxmB,IAAI,gBACdsF,EAAIgY,SACJ5f,KAAK8oB,KAAKooB,cAAgBtpC,EAC1B5H,KAAK8oB,KAAKxmB,IAAI,kBACd,EAAMtC,KAAK6pB,YAAYjiB,MALvB,YAOA,OAFAuK,EAAA4P,OACA/hB,KAAK8oB,KAAKxmB,IAAI,mBACd,EAAMtC,KAAK8oB,KAAKsI,mBAAhBjf,EAAA4P,OACA/hB,KAAK8oB,KAAKxmB,IAAI,iBACdsF,EAAIgY,SAAQ3T,EAAA+V,MAAA,SAEhB,mBAIJ5pB,OAAA6B,eAAYmzB,EAAA/0B,UAAA,OAAA+B,IAAZ,WACI,OAAOgN,EAAA9I,QAAQ0B,KAAK8U,SAAS5V,KAAK,SAAArF,GAAK,OAAAA,EAAE0hB,mBAAmB5H,EAAAnG,MAAQ3T,EAAE+lB,yCAE9EwN,EA/CA,CAA4CiyB,EAAAD,kBAA/B5lD,EAAA4zB,wbCJb,IAAAkyB,EAAAlmD,EAAA,IAEAgO,EAAAhO,EAAA,GAEAmmD,EAAA,SAAA1/C,GAAA,SAAA0/C,mDAaA,OAbmDh/C,EAAAg/C,EAAA1/C,GAC/C0/C,EAAAlnD,UAAAixC,SAAA,WAAa,MAAO,YAEpBiW,EAAAlnD,UAAA84B,SAAA,WACI,QAASnxB,KAAKw/C,eAGlBpnD,OAAA6B,eAAIslD,EAAAlnD,UAAA,iBAAA+B,IAAJ,eAAA2F,EAAAC,KAII,OAAOA,KAAKgU,OAAO6F,OAAOqL,iBAAiBhmB,KAHzB,SAACrF,GAAc,OAACA,EAAEqS,QAAUrS,EAAE+lB,OAAS/lB,EAAEuS,SAASqL,UAElErQ,EAAAxI,aAAamB,EAAKiU,OAAOkrC,gBAAiBrlD,EAAE0hB,QAAQpR,yCAG9Do1C,EAbA,CAAmDD,EAAAz2B,UAA7BrvB,EAAA+lD,gxDCJtB,IAGAryB,EAAA,SAAArtB,GAAA,SAAAqtB,mDAkBA,OAlB+C3sB,EAAA2sB,EAAArtB,GACrCqtB,EAAA70B,UAAAO,MAAN,kBAAAyB,EAAA2F,UAAA,2BAAA3G,EAAA2G,KAAA,SAAAxC,GAAA,OAAAA,EAAAwkB,OAAA,cACQhiB,KAAKw/C,eAAiBx/C,KAAKw/C,cAAcpzC,UACzC,EAAMpM,KAAKy/C,gBAAgBz/C,KAAKw/C,iBADhC,YACArtC,EAAA4P,wBAEJ,SAAM/hB,KAAKspB,uBAAXnX,EAAA4P,iBAGUmL,EAAA70B,UAAAonD,gBAAd,SAA8Bp0C,iGAGtB,OAFJA,EAAOuU,SACH0Q,EAAYjlB,EAAOkQ,QAAQpR,MAC3B,EAAMnK,KAAK4qB,kBAAkB0F,kBAA7Bne,EAAA4P,QACA,EAAM/hB,KAAK6pB,YAAYxe,KADvB,YAEA,OADA8G,EAAA4P,QACA,EAAM1W,EAAOqW,SAAS1hB,KAAK8oB,cAA3B3W,EAAA4P,+BAGJ1W,EAAOuU,UAAQ,SAEvBsN,EAlBA,CAHA9zB,EAAA,IAG+CmmD,sBAAlC/lD,EAAA0zB,2GCqBb1zB,EAAAuwB,iBAAA,SAAiChR,GAC7B,OACIxO,KAAM,WACN+Z,SAAUvL,IAKlBvf,EAAAmqB,MAAA,WACI,OAASpZ,KAAM,oBAAA/M,EAAAyO,EAAA1R,GAAA,iBAAAxC,EAAAiC,EAAAgG,WAAAO,YAAAxI,EAAA,SAAAyF,EAAAyO,GAAA,OAAAlU,EAAAK,OAAA+a,iBAAAC,wBAAA5W,OAAA,SAAAgB,EAAAyO,GAAAzO,EAAA4V,UAAAnH,IAAA,SAAAzO,EAAAyO,GAAA,QAAA1R,KAAA0R,IAAA3T,eAAAiC,KAAAiD,EAAAjD,GAAA0R,EAAA1R,MAAAiD,EAAAyO,IAAA,SAAAzO,EAAAyO,GAAA,SAAA1R,IAAAyF,KAAAqT,YAAA7V,EAAAzF,EAAAyF,EAAAyO,GAAAzO,EAAAnF,UAAA,OAAA4T,EAAA7T,OAAAkb,OAAArH,IAAA1R,EAAAlC,UAAA4T,EAAA5T,UAAA,IAAAkC,KAAAF,EAAA2F,WAAA8wB,WAAA,SAAAtzB,EAAAyO,EAAA1R,EAAAxC,GAAA,WAAAwC,MAAA4D,UAAA,SAAAnE,EAAAK,GAAA,SAAAhB,EAAAmE,GAAA,IAAA5D,EAAA7B,EAAA2D,KAAA8B,IAAA,MAAAA,GAAAnD,EAAAmD,IAAA,SAAA3B,EAAA2B,GAAA,IAAA5D,EAAA7B,EAAA2nD,MAAAliD,IAAA,MAAAA,GAAAnD,EAAAmD,IAAA,SAAA5D,EAAA4D,KAAAmiD,KAAA3lD,EAAAwD,EAAAlD,OAAA,IAAAC,EAAA,SAAA0R,KAAAzO,EAAAlD,SAAA8H,KAAA/I,EAAAwC,GAAAjC,GAAA7B,IAAAa,MAAA4E,EAAAyO,QAAAvQ,WAAArC,EAAA2G,WAAA+wB,aAAA,SAAAvzB,EAAAyO,GAAA,IAAA1R,EAAAxC,EAAAiC,EAAAK,EAAAhB,GAAA2oB,MAAA,EAAAD,KAAA,gBAAA/nB,EAAA,SAAAA,EAAA,UAAAA,EAAA,IAAA4lD,QAAAC,QAAA,OAAAxlD,GAAAqB,KAAAG,EAAA,GAAA6jD,MAAA7jD,EAAA,GAAAikD,OAAAjkD,EAAA,uBAAAkkD,SAAA1lD,EAAA0lD,OAAAC,UAAA,kBAAAhgD,OAAA3F,EAAA,SAAAwB,EAAAxB,GAAA,gBAAAwB,GAAA,gBAAAxB,GAAA,GAAAE,EAAA,UAAA0lD,UAAA,wCAAA5mD,GAAA,OAAAkB,EAAA,EAAAxC,IAAAiC,EAAA,EAAAK,EAAA,GAAAtC,EAAA+nD,OAAAzlD,EAAA,GAAAtC,EAAA2nD,SAAA1lD,EAAAjC,EAAA+nD,SAAA9lD,EAAAzB,KAAAR,GAAA,GAAAA,EAAA2D,SAAA1B,IAAAzB,KAAAR,EAAAsC,EAAA,KAAAslD,KAAA,OAAA3lD,EAAA,OAAAjC,EAAA,EAAAiC,IAAAK,GAAA,EAAAA,EAAA,GAAAL,EAAAM,QAAAD,EAAA,kBAAAL,EAAAK,EAAA,oBAAAhB,EAAA2oB,SAAA1nB,MAAAD,EAAA,GAAAslD,MAAA,UAAAtmD,EAAA2oB,QAAAjqB,EAAAsC,EAAA,GAAAA,GAAA,mBAAAA,EAAAhB,EAAAwmD,IAAAK,MAAA7mD,EAAAumD,KAAAM,MAAA,sBAAAlmD,KAAAX,EAAAumD,MAAA3nD,OAAA,GAAA+B,IAAA/B,OAAA,UAAAoC,EAAA,QAAAA,EAAA,KAAAhB,EAAA,kBAAAgB,EAAA,MAAAL,GAAAK,EAAA,GAAAL,EAAA,IAAAK,EAAA,GAAAL,EAAA,KAAAX,EAAA2oB,MAAA3nB,EAAA,gBAAAA,EAAA,IAAAhB,EAAA2oB,MAAAhoB,EAAA,IAAAX,EAAA2oB,MAAAhoB,EAAA,GAAAA,EAAAK,EAAA,SAAAL,GAAAX,EAAA2oB,MAAAhoB,EAAA,IAAAX,EAAA2oB,MAAAhoB,EAAA,GAAAX,EAAAwmD,IAAA1nD,KAAAkC,GAAA,MAAAL,EAAA,IAAAX,EAAAwmD,IAAAK,MAAA7mD,EAAAumD,KAAAM,MAAA,SAAA7lD,EAAA4R,EAAA1T,KAAAiF,EAAAnE,GAAA,MAAAmE,GAAAnD,GAAA,EAAAmD,GAAAzF,EAAA,UAAAwC,EAAAP,EAAA,OAAAK,EAAA,SAAAA,EAAA,UAAAC,MAAAD,EAAA,GAAAA,EAAA,UAAAslD,MAAA,KAAAtlD,EAAAwB,OAAAzD,OAAA6B,eAAAgS,EAAA,cAAA3R,OAAA,IC7BnB,IAEA6lD,EAAA,SAAAtgD,GAAA,SAAAsgD,mDAsCA,OAtCiD5/C,EAAA4/C,EAAAtgD,GAC7CsgD,EAAA9nD,UAAAixC,SAAA,WAAa,MAAO,UAEJ6W,EAAA9nD,UAAA+nD,WAAhB,SAA2BrnC,mGACnByK,KACAyH,EAAQ,EAAAlzB,EAAAiqB,MAAA,gBACJwB,GAAUyH,EAAQ,IACtBA,KACI,EAAMjrB,KAAKqgD,cAActnC,MAFL,mBAEpB5G,EAAA4P,QACAyB,MAAS,OADT,YAGA,SAAMxjB,KAAKspB,gBAAXnX,EAAA4P,2DAKEo+B,EAAA9nD,UAAAgoD,cAAd,SAA4BtnC,4GACpB6Q,EAAqB,SAAC/vB,GAAc,MAAqB,UAArBA,EAAEyQ,UAAUC,MAChD1Q,EAAE8lB,QAAQ1nB,OAAS4B,EAAEypB,gCAAgCzpB,EAAEyQ,YACvDzQ,EAAEyQ,UAAU+Y,OAAOZ,SAAS1J,IAC5BunC,EAAYtgD,KAAKgU,OAAO6F,OAAO8P,oBAAoB3pB,KAAK8oB,KAAKvc,OAASqd,GACtEpG,KACA88B,GACA,EAAMtgD,KAAK6pB,YAAYy2B,KADvB,YAEI,OADJnuC,EAAA4P,QACI,EAAMu+B,EAAUr+B,SAASjiB,KAAK8oB,MAAQve,KAAM,QAAS+Z,SAAUvL,YAA/D5G,EAAA4P,SACAyB,MAASxpB,EAAAgoB,MAAA,SAUjB,SAAOwB,SAGf28B,EAtCA,CAFA/mD,EAAA,IAEiDyvB,UAA3BrvB,EAAA2mD,8wDCNtB,IAAA/4C,EAAAhO,EAAA,GAMA4zB,EAAA,SAAAntB,GAAA,SAAAmtB,mDA8DA,OA9D6CzsB,EAAAysB,EAAAntB,GACzCmtB,EAAA30B,UAAA84B,SAAA,eAAApxB,EAAAC,KAYI,OAPaA,KAAK8U,QAAQ5X,OAHA,SAACrD,GAAc,MAAqB,UAArBA,EAAEyQ,UAAUC,MACjD1Q,EAAE8lB,QAAQ1nB,OAAS4B,EAAEypB,gCAAgCzpB,EAAEyQ,aAGrCoW,KAAK,SAAC7mB,GACxB,IAAI+P,EAAS7J,EAAKwgD,WAAW1mD,GACzB2mD,EAAWzgD,EAAK0gD,aAAa5mD,GACjC,SAAU+P,IAAU42C,MAMtBxzB,EAAA30B,UAAAO,MAAN,kBAAAyB,EAAA2F,UAAA,wBAAAxC,EAAAyO,EAAA1R,EAAA,OAAAlB,EAAA2G,KAAA,SAAAjI,GAAA,OAAAA,EAAAiqB,OAAA,cACQvY,EAAQzJ,KAAK0gD,YACb92C,EAAS5J,KAAKugD,WAAW92C,GACzB+2C,EAAWxgD,KAAKygD,aAAah3C,GAG7BG,GAAUxC,EAAAxI,aAAaoB,KAAKgU,OAAOkrC,gBAAiBt1C,EAAO4Y,WACvD,EAAMxiB,KAAKuqB,WAAW3gB,KAD1B,mBACIuI,EAAA4P,QACA,EAAM/hB,KAAKogD,WAAWx2C,EAAOkZ,YAD7B,YACA3Q,EAAA4P,kDAEGy+B,GACH,EAAMxgD,KAAKiqB,gBAAgBu2B,KADxB,mBACHruC,EAAA4P,QACA,EAAM/hB,KAAKogD,WAAWI,EAASz8B,WAD/B,YACA5R,EAAA4P,2DAOJiL,EAAA30B,UAAAqoD,UAAR,WAII,OADoBt5C,EAAA9I,QAAQ0B,KAAK8U,SAAS5V,KAFhB,SAACrF,GAAc,MAAqB,UAArBA,EAAEyQ,UAAUC,MACjD1Q,EAAE8lB,QAAQ1nB,OAAS4B,EAAEypB,gCAAgCzpB,EAAEyQ,cAMvD0iB,EAAA30B,UAAAkoD,WAAR,SAAmB92C,GACf,GAAIA,GAAkC,UAAzBA,EAAMa,UAAUC,KAAkB,CAC3C,IAAMo2C,EAA2Bl3C,EAAMa,UAGvC,OADqBlD,EAAA9I,QAAQ0B,KAAKkpB,SAAShqB,KADX,SAAC7E,GAAc,OAAAsmD,EAAQt9B,OAAO3C,KAAK,SAAA8C,GAAU,OAAAnpB,EAAEyoB,WAAaU,QAM5FwJ,EAAA30B,UAAAooD,aAAR,SAAqBh3C,GACjB,GAAIA,GAAkC,UAAzBA,EAAMa,UAAUC,KAAkB,CAC3C,IAAMq2C,EAA2Bn3C,EAAMa,UAKvC,OAFmClD,EAAA9I,QAAQ0B,KAAK6gD,WAAW3hD,KADjC,SAAC1B,GAA0B,OAAAojD,EAAQv9B,OAAO3C,KAAK,SAAA8C,GAAU,OAAAhmB,EAAEumB,UAAYP,QAM7GwJ,EA9DA,CAHA5zB,EAAA,IAG6C+mD,oBAAhC3mD,EAAAwzB,ybCNb,IAAA7xB,EAAA/B,EAAA,GACA4iC,EAAA5iC,EAAA,IAGAoyB,EAAApyB,EAAA,IACAgO,EAAAhO,EAAA,GAEAikC,EAAA,SAAAx9B,GAII,SAAAw9B,EAAoBrpB,EAAuB+R,GAA3C,IAAAhmB,EACIF,EAAAtH,KAAAyH,KAAM,GAAIgU,EAAOuD,YAAc,EAAG,EAAG,IAAEvX,YADvBD,EAAAiU,SAAuBjU,EAAAgmB,QAH3ChmB,EAAAk/B,YACAl/B,EAAA0gB,WAII1gB,EAAKsV,OAAStV,EAAKsV,OAAOnY,OAAO,SAAAoY,GAAS,QAAEA,aAAiBna,EAAAoa,OAAOC,oBACpEnT,QAAQC,IAAI,2BAA6ByjB,MAAOhmB,EAAKgmB,UA4D7D,OAnEgCxlB,EAAA88B,EAAAx9B,GAU5Bw9B,EAAAhlC,UAAA2e,OAAA,SAAOC,EAAQjB,GACXnW,EAAAxH,UAAM2e,OAAMze,KAAAyH,KAACiX,EAAQjB,GACrB,IAAI8qC,EAAY,SAAAlnD,GAAK,OAAAA,EAAEiyB,OACvB7rB,KAAKi/B,SAAWj/B,KAAKi/B,SAAS/hC,OAAO4jD,GACrC9gD,KAAKygB,QAAUzgB,KAAKygB,QAAQvjB,OAAO4jD,GACnC,IAAIv0C,EAAM0K,EAAOohB,MAAMC,SAAS3K,QAAQ8U,aACpCC,EAGG1iC,KAAKi/B,SAAQ3hC,OACb0C,KAAKygB,SAEZ,GAAIiiB,EAAWzqC,OAAS,EAAG,CACvByqC,EAAW/jC,QAAQ,SAAAgkC,GAAOA,EAAEluB,SAAekuB,EAAE3c,EAAI,IACjD,IAAI4c,EAAS,SAAC/oC,GAKV,OAJUA,EAAE43B,eAOZoR,EAAqBz7B,EAAAvK,QACrB0P,EACAm2B,EACAE,GAEAC,GAAaD,EAAOC,GAAWzlC,SAASmP,GAA4B,EAArBs2B,EAAUxsB,aAEzDwsB,EAAUpuB,SACVouB,EAAU7c,EAAI,OAW1BqX,EAAAhlC,UAAAinC,SAAA,SAAS/yB,EAAK4M,sBACV,IAAIwI,EAAU,IAAIqa,EAAAvQ,QAAQD,EAAA6P,MAAMC,cAAe/uB,EAAKvM,KAAKgU,QAAUmF,MAAKA,IACxEwI,EAAQqN,OACRhvB,KAAKi/B,SAAS9mC,KAAKwpB,GAEf3hB,KAAK+lB,MACL/lB,KAAK+lB,MAAMvZ,IAAImV,GAEftf,QAAQ0gB,KAAK,mCAIrBsa,EAAAhlC,UAAA6kC,SAAA,eAAAn9B,EAAAC,KACIA,KAAKi/B,SAAStgC,QAAQ,SAAC/E,GAAM,OAAAmG,EAAKgmB,MAAMoX,OAAOvjC,KAC/CoG,KAAKygB,QAAQ9hB,QAAQ,SAAC/E,GAAM,OAAAmG,EAAKgmB,MAAMoX,OAAOvjC,MAEtDyjC,EAnEA,CAAgCliC,EAAAihB,OAAnB5iB,EAAA6jC,4FCJb,IAAAj2B,EAAAhO,EAAA,GACA6J,EAAA7J,EAAA,GAEA2nD,EAAA,WAGG,SAAAA,EAAYlW,GACR7qC,KAAKoY,MAAQyyB,EAAKzyB,QA6BzB,OA1BG2oC,EAAA1oD,UAAA2oD,SAAA,SAASlhB,EAAgBmhB,GACtB,OAAOjhD,KAAKoY,MAAMszB,aAAa5L,EAAQmhB,IAG1CF,EAAA1oD,UAAA6oD,YAAA,SAAYrX,GACR,IAAInzB,EAAQ1W,KAAKoY,MAAM4xB,MAIvB,OAHc5iC,EAAAtL,MAAM4a,EAChB,SAACC,GAAiB,OAAA3a,KAAK4kB,IAAIipB,EAASzsC,SAASuZ,QAE7C9Z,GAMRkkD,EAAA1oD,UAAA8oD,6BAAA,SAA6BtX,EAAkBuX,kBAAcn+C,EAAAG,MAAMD,MAAMyD,QACrE,IAAI8P,EAAQ1W,KAAKoY,MAAM4xB,MAKvB,OAJc5iC,EAAAtL,MACV4a,EAAMxZ,OAAO,SAACyZ,GAAiB,OAAA3a,KAAK4kB,IAAIjK,EAAKzC,EAAI21B,EAAS31B,GAAKktC,IAC/D,SAACzqC,GAAiB,OAAA3a,KAAK4kB,IAAIipB,EAASzsC,SAASuZ,QAE7C9Z,GAKXkkD,EAjCA,GAAavnD,EAAAunD,gbCNb,IAAA5lD,EAAA/B,EAAA,GAEAgO,EAAAhO,EAAA,GAEAioD,EAAAjoD,EAAA,IAKAgkC,EAAA,SAAAv9B,GAMI,SAAAu9B,EAAYnpB,EAAWC,GAAvB,IAAAnU,EACIF,EAAAtH,KAAAyH,KAAMiU,EAAGC,EAAG,EAAG,IAAElU,YANrBD,EAAAuhD,YAEAvhD,EAAA+Z,aACA/Z,EAAA++B,sBAA2C,KAIvC/+B,EAAKsV,OAAStV,EAAKsV,OAAOnY,OAAO,SAAAoY,GAAS,QAAEA,aAAiBna,EAAAoa,OAAOC,sBAmI5E,OA3I4BjV,EAAA68B,EAAAv9B,GAaxBu9B,EAAA/kC,UAAAyd,KAAA,SAAKC,EAA+BC,GAApC,IAAAjW,EAAAC,KACIH,EAAAxH,UAAMyd,KAAIvd,KAAAyH,KAAC+V,EAAKC,GAEhB,IAAIurC,EAAYvhD,KAAKshD,SACjBthD,KAAKwhD,SAAWD,GACJvhD,KAAKwhD,QAAQppC,MAAMgyB,WACzBzrC,QAAQ,SAACia,GACN,IAAA/c,EAAA+c,EAAA,GAAE5a,EAAA4a,EAAA,GACH6oC,EAAW1rC,EAAI2rC,qBAAqB7lD,EAAEoY,EAAEpY,EAAEqY,EAAEnU,EAAKwM,IAAI2H,EAAElW,EAAEiW,EAAEjW,EAAEkW,EAAEnU,EAAKwM,IAAI2H,GAE5EutC,EAASE,aAAa,EAAG,SACzBF,EAASE,aAAa,EAAG,QAEzB5rC,EAAI6G,YACJ7G,EAAI8G,OAAOhhB,EAAEoY,EAAGpY,EAAEqY,EAAInU,EAAKwM,IAAI2H,GAC/B6B,EAAIgH,OAAO/e,EAAEiW,EAAGjW,EAAEkW,EAAInU,EAAKwM,IAAI2H,GAC/B6B,EAAIiH,YACJjH,EAAImH,YAAcukC,EAClB1rC,EAAIuH,UAAY,GAChBvH,EAAIoH,YAKhBigB,EAAA/kC,UAAA2e,OAAA,SAAOC,EAAcjB,GACbiB,EAAO3W,UACPN,KAAKshD,YAELthD,KAAKshD,aAKblkB,EAAA/kC,UAAA6kC,SAAA,eAAAn9B,EAAAC,KACIA,KAAKwhD,QAAU,KACfxhD,KAAK8+B,sBAAwB,KAC7B9+B,KAAK8Z,UAAUnb,QAAQ,SAAAX,GAAK,OAAA+B,EAAKo9B,OAAOn/B,MAG5Co/B,EAAA/kC,UAAA+mC,cAAA,SAAchzB,GACVA,EAASoI,UACLpI,EAASuM,aACTvM,EAASuM,WAAWwC,OAAOtG,kBAAkB1c,KAAKiU,GAClDpM,KAAK4hD,gBAET5hD,KAAK8Z,UAAU3hB,KAAKiU,GACpBA,EAAS4L,iBACThY,KAAKwM,IAAIJ,IAGbgxB,EAAA/kC,UAAAsiB,sBAAA,SAAsB7d,EAAgB4iC,EAA2C1iC,YAA3C0iC,mBAA2C1iC,MAAA,WAAyC,WACtH,IAAIC,EAAW+C,KAAK8Z,UACnB5c,OAAO,SAAAkP,GACJ,SAACszB,EAAeznC,OAAS,IACvBynC,EAAehf,KAAK,SAAAmhC,GAAM,OAAAz1C,EAAS2H,qBAAqB8tC,MAEtD7kD,EAAUoP,KAGlB,GAAInP,GAAYA,EAAShF,OAAS,EAE9B,OAAOmP,EAAAtL,MAAMmB,EADU,SAACmP,GAAa,OAAAtP,EAAOM,SAASgP,EAASsK,QAAQ,OAK9E0mB,EAAA/kC,UAAAwnC,YAAA,SAAYC,EAAgBC,GACnB//B,KAAKwhD,SACNxhD,KAAK4hD,eAET,IAAIE,EAAU9hD,KAAKwhD,QAAQN,YAAYphB,GACnCmhB,EAAOlhB,EAAYrpB,QAAQ,GAC3BqrC,EAAW/hD,KAAKwhD,QAAQN,YAAYD,GAExC,OADWjhD,KAAKwhD,QAAQR,SAASc,EAASC,IAI9C3kB,EAAA/kC,UAAAq4B,kBAAA,SAAkBoP,EAAgBC,EAAqBiiB,sBAC9ChiD,KAAKwhD,SACNxhD,KAAK4hD,eAET,IAAIE,EAAUE,EAAmBhiD,KAAKwhD,QAAQL,6BAA6BrhB,GAAU9/B,KAAKwhD,QAAQN,YAAYphB,GAC1GmhB,EAAOlhB,EACPgiB,EAAW/hD,KAAKwhD,QAAQN,YAAYD,GAGxC,OAFWjhD,KAAKwhD,QAAQR,SAASc,EAASC,IAO9C3kB,EAAA/kC,UAAAsxB,oBAAA,SAAoB7sB,EAAgB8iC,EAAuC5iC,YAAvC4iC,mBAAuC5iC,MAAA,WAAuC,WAC9G,IAAI8X,EAAU9U,KAAKipB,qBAMnB,IALAnU,EAAUA,EAAQ5X,OAAO,SAAArD,GACrB,SAAC+lC,EAAa3nC,OAAS,IAAI2nC,EAAalf,KAAK,SAAAnF,GAAW,OAAA1hB,EAAE0hB,mBAAmBA,MACzEve,EAAUnD,OAGHib,EAAQ7c,OAAS,EAE5B,OAAOmP,EAAAtL,MAAMgZ,EADG,SAACjb,GAAM,OAAAiD,EAAOM,SAASvD,EAAE0S,IAAIC,IAAI3S,EAAEuS,SAASG,SAKpEnU,OAAA6B,eAAImjC,EAAA/kC,UAAA,UAAA+B,IAAJ,WACI,OAAO4F,KAAK8Z,UAAU,GAAK9Z,KAAK8Z,UAAU,GAAGvN,IAAM,MAAApS,YAAA,EAAAD,cAAA,IAG/CkjC,EAAA/kC,UAAAupD,aAAR,WACI,IAAI/f,EAAO7hC,KAAK8Z,UAAU,GACtB+nB,IACA7hC,KAAKwhD,QAAU,IAAIH,EAAAN,eAAelf,KAI1CzE,EAAA/kC,UAAA6sB,eAAA,WACI,OAAO9d,EAAA/J,WAAW2C,KAAK8Z,UAAUpd,IAAI,SAAAsB,GAAK,OAAAA,EAAE0d,iBAGhD0hB,EAAA/kC,UAAA4wB,mBAAA,WACI,OAAO7hB,EAAA/J,WAAW2C,KAAKiiD,gBAAgBvlD,IAAI,SAAAsB,GAAK,OAAAA,EAAE0d,gBAC7Cxe,OAAO,SAAArD,GAAK,OAAAA,EAAEqS,SAGvB9T,OAAA6B,eAAcmjC,EAAA/kC,UAAA,mBAAA+B,IAAd,WACI,OAAO4F,KAAK8Z,UAAU5c,OAAO,SAAAc,GAAK,OAAAA,EAAEyZ,4CAE5C2lB,EA3IA,CAA4BjiC,EAAAihB,OAAf5iB,EAAA4jC,waCRb,IAAA8kB,EAAA9oD,EAAA,GACAoa,EAAApa,EAAA,GACA+B,EAAA/B,EAAA,GACA8N,EAAA9N,EAAA,GAEAkN,EAAA,SAAAzG,GAAA,SAAAyG,IAAA,IAAAvG,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YAEID,EAAAoiD,WAAaj7C,EAAAlE,WAAWO,QA+B5B,OAjC2ChD,EAAA+F,EAAAzG,GAGvCyG,EAAAjO,UAAA6hB,UAAA,WAAc,OAAO/e,EAAAoE,MAAM+J,OAAOuO,QAAQ5V,OAAO,MACjDqE,EAAAjO,UAAAyd,KAAA,SAAKC,EAAKC,GAEPnW,EAAAxH,UAAMyd,KAAIvd,KAAAyH,KAAC+V,EAAKC,IAGnB1P,EAAAjO,UAAAke,MAAA,WACI,IAAI6rC,KACAC,EAAQriD,KAAKuX,YAEb0mC,EAASj+C,KAAKqW,WAAa,EAkB/B,OAfA+rC,EAASjqD,KACL6H,KAAKkb,UACDlb,KAAKuM,IAAI0H,EAAIgqC,EAAQj+C,KAAKuM,IAAI2H,EAAImuC,EAClC7uC,EAAAvC,YAAYC,OAIpBkxC,EAASjqD,KACL6H,KAAKkb,UACDlb,KAAKuM,IAAI0H,EAAIjU,KAAKqW,WAAa4nC,EAC/Bj+C,KAAKuM,IAAI2H,EAAImuC,EACb7uC,EAAAvC,YAAYG,QAIbgxC,GAEf97C,EAjCA,CAA2C47C,EAAA/9C,UAA9B3K,EAAA8M,ubCNb,IAAAnL,EAAA/B,EAAA,GACA8K,EAAA9K,EAAA,GACAoa,EAAApa,EAAA,GAGA8N,EAAA9N,EAAA,GACAya,EAAAza,EAAA,IACAgO,EAAAhO,EAAA,GACAwa,EAAAxa,EAAA,IAGA+M,EAAA,SAAAtG,GAAA,SAAAsG,IAAA,IAAApG,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAA6U,WACA7U,EAAA2U,aAGA3U,EAAAuiD,gBAAkBp7C,EAAAlE,WAAWQ,OAC7BzD,EAAAwiD,iBAAmB,EAAAt2C,EA2LvB,OAjM2C1L,EAAA4F,EAAAtG,GAOvCzH,OAAA6B,eAAIkM,EAAA9N,UAAA,eAAA+B,IAAJ,WAAoB,OAAO4F,KAAKuX,YAAc,GAAApd,YAAA,EAAAD,cAAA,IAE9C9B,OAAA6B,eAAIkM,EAAA9N,UAAA,UAAA+B,IAAJ,WACI,OAAO4F,KAAKuM,IAAI2H,EAAIlU,KAAKuX,YAAcvX,KAAKwiD,6CAGjDr8C,EAAA9N,UAAAqe,MAAA,WACK,IAAIzC,EAAIjU,KAAKuM,IAAI0H,EAAIjU,KAAKqW,WAAW,EACjCnC,EAAIlU,KAAKuM,IAAI2H,EAAIlU,KAAKuX,YAAcvX,KAAKwiD,YAC7C,OACI,IAAIrnD,EAAAga,OAAOnZ,KAAKK,MAAM4X,GAAIjY,KAAKK,MAAM6X,MAG7C/N,EAAA9N,UAAAue,aAAA,eAAA7W,EAAAC,KACQk8B,EAAIl8B,KAAKqW,WAAW,EACpBpC,EAAIjU,KAAKuM,IAAI0H,EAAIioB,EACjBhoB,EAAIlU,KAAKuM,IAAI2H,EAAIlU,KAAKuX,YAAcvX,KAAKwiD,YAAc,GAS3D,OARAtuC,GAAKhN,EAAAvD,qBAAqB3D,KAAKsiD,iBAAmB,KAG9C,IAAInnD,EAAAga,OAAOlB,EAAIioB,EAAE,EAAGhoB,WAChBlU,KAAKuiD,iBAAmB,GAAK,IAAIpnD,EAAAga,OAAOlB,EAAEC,QAC9C,IAAI/Y,EAAAga,OAAOlB,EAAIioB,EAAE,EAAGhoB,KAGdxX,IAAI,SAAA7C,GAAK,WAAIqK,EAAA4P,YAAYja,EAAGkG,EAAKuiD,oBAO/Cn8C,EAAA9N,UAAA+f,MAAA,SAAMqqC,GACF,IAAIjjD,EAAIK,EAAAxH,UAAM+f,MAAK7f,KAAAyH,KAACyiD,GAChBvjD,EAAO,SAAC7F,GAAc,OAAAmG,EAAEgZ,aAAanf,EAAG+N,EAAArJ,kBACxCwY,EAAkBvW,KAAKuW,QAAQ7Z,IAAI,SAAArD,GAAK,OAAAA,EAAEkT,MAE1CuI,EAAU9U,KAAKmY,0BAA0Bzb,IAAI,SAAA9B,GAAK,OAAAsE,EAAKtE,KAG3D,GAFAwM,EAAAxJ,SAASkX,EAAS,GAAGnW,QAAQ,SAACwT,OAACmW,EAAAnW,EAAA,GAAMuwC,EAAAvwC,EAAA,GAAW,OAAA3S,EAAEoZ,KAAK0P,EAAMo6B,KAEzD1iD,KAAK2iD,cAAe,CACpB,IAAIC,EAAW1jD,EAAKqX,EAAM,IAAKssC,EAAY3jD,EAAKqX,EAAMA,EAAMte,OAAS,IACrEuH,EAAEoZ,KAAKgqC,EAAU9tC,EAAQ,IACzBtV,EAAEoZ,KAAK9D,EAAQA,EAAQ7c,OAAS,GAAI4qD,OACjC,CACH,IAAIC,EAAU5jD,EAAKqX,EAAM,IACzB/W,EAAEoZ,KAAK9D,EAAQ,GAAIguC,GAGvB,IAAInsC,EAAO3W,KAAK0W,QAAQ,GAIxB,OAHA5B,EAAQnW,QAAQ,SAAA0M,GAAU,OAAA7L,EAAEoZ,KAAKvN,EAAQnM,EAAKyX,MAGvCnX,GAIX2G,EAAA9N,UAAAke,MAAA,WACI,IAAI6rC,KACAC,EAAQriD,KAAKuX,YAAcvX,KAAKwiD,YAuCpC,OArCIxiD,KAAK2iD,eACLP,EAASjqD,KACL6H,KAAKkb,UACDlb,KAAKuM,IAAI0H,EAAGjU,KAAKuM,IAAI2H,EAAImuC,EACzB7uC,EAAAvC,YAAYC,OAKxBkxC,EAASjqD,KACL6H,KAAKkb,UACDlb,KAAKuM,IAAI0H,EAAIjU,KAAKqW,WAAa,EAC/BrW,KAAKuM,IAAI2H,EAAIlU,KAAKuX,YAClB/D,EAAAvC,YAAYI,OAIpB+wC,EAASjqD,KACL6H,KAAKkb,UACDlb,KAAKuM,IAAI0H,EAAIjU,KAAKqW,WAAa,EAC/BrW,KAAKuM,IAAI2H,EAAI,EACbV,EAAAvC,YAAYE,KAKhBnR,KAAK2iD,eACLP,EAASjqD,KACL6H,KAAKkb,UACDlb,KAAKuM,IAAI0H,EAAIjU,KAAKqW,WAClBrW,KAAKuM,IAAI2H,EAAImuC,EACb7uC,EAAAvC,YAAYG,QAMjBgxC,GAGXhqD,OAAA6B,eAAIkM,EAAA9N,UAAA,iBAAA+B,IAAJ,WACI,QAAQ4F,KAAK2Y,YAAgB3Y,KAAK2Y,WAAWwC,kBAAkBhV,oCAGnEA,EAAA9N,UAAAuf,gBAAA,SAAgB9a,GAMZ,OAL4C,IAAxCkD,KAAKgU,OAAO6F,OAAOC,UAAU7hB,SAC7B6E,EAAOoX,EAAIlU,KAAKgU,OAAOwsB,UAIpB1jC,GAGXqJ,EAAA9N,UAAAyf,QAAA,SAAQhb,GACwC,IAAxCkD,KAAKgU,OAAO6F,OAAOC,UAAU7hB,QAC7B+H,KAAKuM,IAAMzP,EACXkD,KAAKuM,IAAI2H,GAAKlU,KAAKuX,YAAc,EAAIvX,KAAKwiD,aAE1CxiD,KAAK+X,YAAYjb,IAMzBqJ,EAAA9N,UAAAyd,KAAA,SAAKC,EAA+BC,GAChC,IAAIpU,EAAQ5B,KAAKia,YAejB,GAbAlE,EAAIkH,UAAYrb,EAAMM,SAKtB2R,EAAAwI,kBACItG,EACA/V,KAAKqZ,iBACLrZ,KAAK+iD,kBACL/iD,KAAKia,cAIJja,KAAKyX,SAAU,CAEhB,IAAI7d,EAAIuB,EAAAoE,MAAMc,MAAMwX,QACpBje,EAAEiC,EAAI,GACNgY,EAAAgK,SAAS9H,EAAK/V,KAAKqZ,iBAAkBzf,GAIzC,IAAIopD,EAAahjD,KAAKgU,OAAOpS,MAAMK,OAAO,IAG1C4R,EAAAoC,SACIF,GACE9B,EAAGjU,KAAKiU,EAAGC,EAAGlU,KAAKkU,EAAIlU,KAAKuX,YAAcvX,KAAKwiD,YAJ/B,GAKhBruC,MAAOnU,KAAKqW,WAAYjC,OAAQ6uC,IAEhCD,EAAWtwC,QAAQ,KAGzBmB,EAAAoC,SACIF,GACE9B,EAAGjU,KAAKiU,EAAGC,EAAGlU,KAAKkU,EAAIlU,KAAKuX,YAAcvX,KAAKwiD,cAXtC,EAYTruC,MAAOnU,KAAKqW,WAAYjC,OAAQpU,KAAKwiD,aAZ5B,GAcTQ,GAIN,IACIE,EAAQljD,KAAKuM,IAAI0H,EAASjU,KAAKqW,WAAa,EAAvB,EACrB8sC,EAAQnjD,KAAKuM,IAAI2H,EAFA,GAIrB6B,EAAIkH,UAAY9hB,EAAAoE,MAAMc,MAAM4c,YAC5BlH,EAAI6H,SAASslC,EAAOC,EAAM,EAAG,EAAGC,IAChCvvC,EAAA0J,kBACIxH,GACE9B,EAAGivC,EAAOhvC,EAAGivC,EAAOhvC,MAAO,GAAIC,OAAQ,GACzCR,EAAAsI,kBAAkBwe,MAItB76B,EAAAxH,UAAMyd,KAAIvd,KAAAyH,KAAC+V,EAAKC,IAGpB7P,EAAA9N,UAAA6hB,UAAA,WAAc,OAAO/e,EAAAoE,MAAMwT,MAAM8E,SACrC1R,EAjMA,CAA2CjC,EAAAC,UAA9B3K,EAAA2M,ubCXb,IAAA+7C,EAAA9oD,EAAA,GACA8N,EAAA9N,EAAA,GAEA6M,EAAA,SAAApG,GAAA,SAAAoG,IAAA,IAAAlG,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAuiD,gBAAkBp7C,EAAAlE,WAAWQ,OAC7BzD,EAAAwiD,iBAAmB,EAAAt2C,EAgBvB,OAlByC1L,EAAA0F,EAAApG,GAIrCoG,EAAA5N,UAAAgf,KAAA,WAAS,OAAOrX,KAAKqZ,kBAczBpT,EAlBA,CAAyCi8C,EAAA39C,gBAA5B/K,EAAAyM,qbCHb,IAAAi8C,EAAA9oD,EAAA,GACA+B,EAAA/B,EAAA,GACA8K,EAAA9K,EAAA,GACA8N,EAAA9N,EAAA,GAEA2M,EAAA,SAAAlG,GAAA,SAAAkG,IAAA,IAAAhG,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAuiD,gBAAkBp7C,EAAAlE,WAAWU,OAWjC,OAZkCnD,EAAAwF,EAAAlG,GAE9BkG,EAAA1N,UAAAue,aAAA,WACI,IAAIslB,EAAIl8B,KAAKqW,WAAW,EACpBpC,EAAIjU,KAAKuM,IAAI0H,EAAIioB,EACjBhoB,EAAIlU,KAAKuM,IAAI2H,EAAIlU,KAAKuX,YAAcvX,KAAKwiD,YAAct7C,EAAAvD,qBAAqBuD,EAAAlE,WAAWU,MAAM,EAKjG,OAHI,IAAIvI,EAAAga,OAAOlB,EAAIioB,EAAE,EAAGhoB,GACpB,IAAI/Y,EAAAga,OAAOlB,EAAIioB,EAAE,EAAGhoB,IAEdxX,IAAI,SAAA7C,GAAK,WAAIqK,EAAA4P,YAAYja,EAAGqN,EAAAlE,WAAWU,SAEzDqC,EAZA,CAAkCm8C,EAAA39C,gBAArB/K,EAAAuM,8aCLb,IAAAm8C,EAAA9oD,EAAA,GACA+B,EAAA/B,EAAA,GACA8K,EAAA9K,EAAA,GACA8N,EAAA9N,EAAA,GAEAyM,EAAA,SAAAhG,GAAA,SAAAgG,IAAA,IAAA9F,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAuiD,gBAAkBp7C,EAAAlE,WAAWS,QAYjC,OAbmClD,EAAAsF,EAAAhG,GAE/BgG,EAAAxN,UAAAue,aAAA,WACI,IAAIslB,EAAIl8B,KAAKqW,WAAW,EACpBpC,EAAIjU,KAAKuM,IAAI0H,EAAIioB,EACjBhoB,EAAIlU,KAAKuM,IAAI2H,EAAIlU,KAAKuX,YAAcrQ,EAAAvD,qBAAqBuD,EAAAlE,WAAWS,OAAO,EAM/E,OAJI,IAAItI,EAAAga,OAAOlB,EAAIioB,EAAE,EAAGhoB,GACpB,IAAI/Y,EAAAga,OAAOlB,EAAIioB,EAAE,EAAGhoB,IAGdxX,IAAI,SAAA7C,GAAK,WAAIqK,EAAA4P,YAAYja,EAAGqN,EAAAlE,WAAWS,UAEzDoC,EAbA,CAAmCq8C,EAAA39C,gBAAtB/K,EAAAqM,+aCLb,IAAAq8C,EAAA9oD,EAAA,GACA8N,EAAA9N,EAAA,GAIAuM,EAAA,SAAA9F,GAAA,SAAA8F,IAAA,IAAA5F,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAuiD,gBAAkBp7C,EAAAlE,WAAWQ,OAC7BzD,EAAAwiD,iBAAmB,EAAAt2C,EAYvB,OAdoC1L,EAAAoF,EAAA9F,GAcpC8F,EAdA,CAAoCu8C,EAAA39C,gBAAvB/K,EAAAmM,gbCLb,IAKAF,EAAA,SAAA5F,GAAA,SAAA4F,IAAA,IAAA1F,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAwiD,iBAAmB,EAAAt2C,EAcvB,OAfwC1L,EAAAkF,EAAA5F,GAEpC4F,EAAApN,UAAAgf,KAAA,WAAS,OAAOrX,KAAKqZ,kBAazB5T,EAfA,CALArM,EAAA,GAKwCmL,gBAA3B/K,EAAAiM,obCFb,IAEAF,EAAA,SAAA1F,GAAA,SAAA0F,IAAA,IAAAxF,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YAEID,EAAAwiD,iBAAmB,EAAAt2C,EAYvB,OAdiC1L,EAAAgF,EAAA1F,GAcjC0F,EAdA,CAFAnM,EAAA,GAEiCqL,UAApBjL,EAAA+L,6aCLb,IAKAF,EAAA,SAAAxF,GAAA,SAAAwF,IAAA,IAAAtF,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YAEID,EAAAwiD,iBAAmB,EAAAt2C,EAYvB,OAdiC1L,EAAA8E,EAAAxF,GAcjCwF,EAdA,CALAjM,EAAA,GAKiCqL,UAApBjL,EAAA6L,6aCLb,IAKAF,EAAA,SAAAtF,GAAA,SAAAsF,IAAA,IAAApF,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YAEID,EAAAwiD,iBAAmB,EAAAt2C,EAavB,OAfwC1L,EAAA4E,EAAAtF,GAexCsF,EAfA,CALA/L,EAAA,GAKwCqL,UAA3BjL,EAAA2L,obCLb,IAEAF,EAAA,SAAApF,GAAA,SAAAoF,mDAIA,OAJqC1E,EAAA0E,EAAApF,GAEjCoF,EAAA5M,UAAA6hB,UAAA,WAAc,OAAOla,KAAK4B,MAAM8Q,QAAQ,KAE5CzN,EAJA,CAFA7L,EAAA,GAEqCiL,cAAxB7K,EAAAyL,ibCFb,IAAAi9C,EAAA9oD,EAAA,GACAoa,EAAApa,EAAA,GAGA6J,EAAA7J,EAAA,GAEA2L,EAAA,SAAAlF,GAAA,SAAAkF,IAAA,IAAAhF,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAsjD,WAAmB,KACnBtjD,EAAAujD,SAAmBrgD,EAAAG,MAAMD,MAAMwD,QAkCnC,OApCgCpG,EAAAwE,EAAAlF,GAG5BkF,EAAA1M,UAAAuf,gBAAA,SAAgB9a,GAMb,OALIkD,KAAKujD,gBAGLzmD,EAAOmX,EAAIjU,KAAKuM,IAAI0H,GAEjBnX,GAIViI,EAAA1M,UAAAyf,QAAA,SAAQhb,GACJ,GAAIkD,KAAKujD,cAAe,CACpB,IAAIzoC,EAAU9a,KAAK+X,YAAYjb,GAC3Bge,IACA9a,KAAK2U,OAASmG,EAAQnG,OAElBmG,IACA9a,KAAKqjD,WAAavoC,SAI1B,GAAI9a,KAAK2U,SAAWnB,EAAAvC,YAAYE,GAAI,CAChC,IAAI0lC,EAAY72C,KAAKqjD,WAAW92C,IAAI2H,EAAIlU,KAAKgU,OAAOwsB,SAAW,GAE3DmC,EAAI3mC,KAAKC,IAAI46C,EAAW76C,KAAKG,IAAI6D,KAAKsjD,SAAUtjD,KAAKqjD,WAAW92C,IAAI2H,EAAIpX,EAAOoX,IACnFlU,KAAK6lB,UAAW8c,EAAE3iC,KAAKsjD,SAAUtjD,KAAKsjD,SAAW,IACjDtjD,KAAKuM,IAAI2H,EAAIlU,KAAKqjD,WAAW92C,IAAI2H,EAAIlU,KAAKuX,iBAEtCorB,EAAI3mC,KAAKG,IAAI6D,KAAKsjD,SAAUxmD,EAAOoX,EAAIlU,KAAKqjD,WAAW92C,IAAI2H,GAC/DlU,KAAK6lB,UAAW8c,EAAE3iC,KAAKsjD,SAAUtjD,KAAKsjD,SAAW,KAIjEv+C,EApCA,CAAgCm9C,EAAAv9C,YAAnBnL,EAAAuL,4aCNb,IAAAm9C,EAAA9oD,EAAA,GACA+B,EAAA/B,EAAA,GACA8K,EAAA9K,EAAA,GACA8N,EAAA9N,EAAA,GAEAyL,EAAA,SAAAhF,GAAA,SAAAgF,mDAiCA,OAjCkCtE,EAAAsE,EAAAhF,GAE9BgF,EAAAxM,UAAAue,aAAA,WACI,IAAIslB,EAAI,EAAEl8B,KAAKqW,WAAW,EACtBpC,EAAIjU,KAAKuM,IAAI0H,EAAIioB,EACjBhoB,EAAIlU,KAAKuM,IAAI2H,EAAIlU,KAAKuX,YAAY,EAOtC,OALI,IAAIpc,EAAAga,OAAOlB,EAAGC,EAAE,KAChB,IAAI/Y,EAAAga,OAAOlB,EAAGC,GACd,IAAI/Y,EAAAga,OAAOlB,EAAGC,EAAE,MAGVxX,IAAI,SAAA7C,GAAK,WAAIqK,EAAA4P,YAAYja,EAAGqN,EAAAlE,WAAWU,SAGrDmB,EAAAxM,UAAAyd,KAAA,SAAKC,EAA+BC,GAChChW,KAAKwjD,UAAUztC,EAAK/V,KAAKuM,IAAI0H,EAAGjU,KAAKuM,IAAI2H,GACzClU,KAAK0b,aAAa/c,QAAQ,SAAA0M,GAAU,OAAAA,EAAOyK,KAAKC,EAAKC,MAIjDnR,EAAAxM,UAAAmrD,UAAR,SAAkBztC,EAAK0tC,EAAMC,GACzB,IAAI/gB,EAAI3iC,KAAKuX,YACT2kB,EAAIl8B,KAAKqW,WACbN,EAAI6G,YACJ7G,EAAI8G,OAAO,EAAI4mC,EAAM9gB,EAAI+gB,GACzB3tC,EAAI4tC,cAAc,EAAIF,EAAM9gB,EAAI,IAAM+gB,EAAM,IAAMD,EAAM,GAAKC,EAAMxnB,EAAI,GAAKunB,EAAM,EAAIC,GACtF3tC,EAAI4tC,cAAcznB,EAAI,GAAKunB,EAAM,EAAIC,EAAMxnB,EAAI,EAAIunB,EAAM,GAAKC,EAAMxnB,EAAI,GAAKunB,EAAM,GAAKC,GACxF3tC,EAAI4tC,cAAcznB,EAAI,EAAIunB,EAAM,GAAKC,EAAMxnB,EAAIunB,EAAO9gB,EAAE,GAAM+gB,EAAMxnB,EAAIunB,EAAM9gB,EAAI+gB,GAClF3tC,EAAIgH,OAAO,EAAI0mC,EAAM9gB,EAAI+gB,GACzB3tC,EAAIkH,UAAYjd,KAAKia,YAAY/X,SACjC6T,EAAItZ,QAEZoI,EAjCA,CAAkCq9C,EAAAz9C,UAArBjL,EAAAqL,8aCLb,IAAA1J,EAAA/B,EAAA,GACA8K,EAAA9K,EAAA,GACAgO,EAAAhO,EAAA,GAEAoa,EAAApa,EAAA,GACAqa,EAAAra,EAAA,IACAya,EAAAza,EAAA,IACA6J,EAAA7J,EAAA,GAEAuL,EAAA,SAAA9E,GAAA,SAAA8E,IAAA,IAAA5E,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAujD,SAAmBrgD,EAAAG,MAAMD,MAAMwD,MAC/B5G,EAAAwjD,iBACAxjD,EAAA6U,WAAU3I,EAkKd,OArKgC1L,EAAAoE,EAAA9E,GAK5B8E,EAAAtM,UAAA6hB,UAAA,WAAc,OAAOla,KAAKgU,OAAOpS,MAAMK,OAAO,KAE9C0C,EAAAtM,UAAAyd,KAAA,SAAKC,EAAKC,GACN,IAAIS,EAAOzW,KAAKkW,OAChBrC,EAAAoC,SAASF,EAAKU,EAAMzW,KAAK4B,MAAMK,OAAO,KAGtCwU,EAAKxC,EAAIwC,EAAKxC,EAAIjU,KAAKqW,WADf,EAERI,EAAKtC,OAAgBnU,KAAKqW,WAFlB,EAEM,EACdxC,EAAAoC,SAASF,EAAKU,EAAMzW,KAAK4B,MAAMK,OAAO,MAI1C0C,EAAAtM,UAAAqe,MAAA,WACI,IAAIzC,EAAIjU,KAAKuM,IAAI0H,EAAIjU,KAAKqW,WAAW,EACjCnC,EAAIlU,KAAKuM,IAAI2H,EACjB,OACI,IAAI/Y,EAAAga,OAAOnZ,KAAKK,MAAM4X,GAAIC,KAIlCvP,EAAAtM,UAAA+f,MAAA,SAAMC,kBAAA,IAAgC5E,EAAA6E,OAClC,IAAI9Y,EAAI6Y,EAEJ0X,EAAY/vB,KAAKqW,WAAW,EAC5BpC,EAAIjU,KAAKuM,IAAI0H,EAAI8b,EAEjB8a,EAAOrrC,EAAEgZ,aAAaxY,KAAK0W,QAAQ,GAAItP,EAAArJ,iBACvCiG,EAAQxE,EAAEgZ,aAAa,IAAIrd,EAAAga,OAAOlB,EAAEjU,KAAK4jD,cAAc,IAAKx8C,EAAArJ,iBAChEyB,EAAEoZ,KAAKiyB,EAAK7mC,GAEZ,IAAI6/C,EAAU7jD,KAAK4jD,cAEnBx8C,EAAAxJ,SAASimD,EAAS,GAAGllD,QAAQ,SAACwT,OAAC6jC,EAAA7jC,EAAA,GAAG2xC,EAAA3xC,EAAA,GAC1BwW,EAAMnpB,EAAEgZ,aAAa,IAAIrd,EAAAga,OAAOlB,EAAE+hC,GAAK5uC,EAAArJ,iBACvCgmD,EAAMvkD,EAAEgZ,aAAa,IAAIrd,EAAAga,OAAOlB,EAAE6vC,GAAK18C,EAAArJ,iBAC3CyB,EAAEoZ,KAAK+P,EAAKo7B,KAGhB,IAAIA,EAAMvkD,EAAEgZ,aAAa,IAAIrd,EAAAga,OAAOlB,EAAGjU,KAAKuM,IAAI2H,EAAIlU,KAAKuX,aAAcnQ,EAAArJ,iBACnEimD,EAAMxkD,EAAEgZ,aAAa,IAAIrd,EAAAga,OAAOlB,EAAG4vC,EAAQA,EAAQ5rD,OAAO,IAAKmP,EAAArJ,iBACnEyB,EAAEoZ,KAAKmrC,EAAIC,GAEXH,EAAQllD,QAAQ,SAAAmlD,GACZ,IAAIC,EAAMvkD,EAAEgZ,aAAa,IAAIrd,EAAAga,OAAOlB,EAAE6vC,GAAK18C,EAAArJ,iBAEvCuqB,EAAO9oB,EAAEgZ,aAAa,IAAIrd,EAAAga,OAAOlB,EAAE8b,EAAU+zB,GAAK18C,EAAArJ,iBACtDyB,EAAEoZ,KAAK0P,EAAKy7B,GAEZ,IAAIrB,EAAQljD,EAAEgZ,aAAa,IAAIrd,EAAAga,OAAOlB,EAAE8b,EAAU+zB,GAAK18C,EAAArJ,iBACvDyB,EAAEoZ,KAAKmrC,EAAIrB,KAGf,IAAkB,IAAAjqC,EAAA,EAAAtG,EAAAnS,KAAK6U,kBAAL4D,EAAAtG,EAAAla,OAAAwgB,IAAwB,CAArC,IAAIC,EAAKvG,EAAAsG,GACNjC,EAAOhX,EAAEgZ,aAAaE,EAAMC,WAAWpM,IAAKnF,EAAArJ,iBAC5C8a,EAAYrZ,EAAEgZ,aAAaE,EAAMhC,QAAQ,GAAItP,EAAArJ,iBACjDyB,EAAEoZ,KAAKC,EAAWrC,GAClBhX,EAAEoZ,KAAKpC,EAAMqC,GAEbH,EAAMN,MAAM5Y,GAGhB,OAAOA,GAGHmF,EAAAtM,UAAAurD,YAAR,WAKI,IAAIK,EAAYjoD,KAAKK,MAAO2D,KAAKuX,YAAevX,KAAKsjD,UACjDO,KAEA3vC,EAAIlU,KAAKuM,IAAI2H,EAEjB,GAAI+vC,EAAY,EACZ,IAAc,IAAAxrC,EAAA,EAAAtG,EAAA/K,EAAA7K,MAAM0nD,GAANxrC,EAAAtG,EAAAla,OAAAwgB,IAAkB,CAA3B,IAAI1gB,EAACoa,EAAAsG,GACNorC,EAAQ1rD,KACJ+b,GAAMnc,EAAE,GAAKiI,KAAKsjD,eAI1BO,EAAQ1rD,KAAK6H,KAAKsjD,UAEtB,OAAOO,GAGXl/C,EAAAtM,UAAAke,MAAA,WACI,IAAI6rC,KAEJA,EAASjqD,KACL6H,KAAKkb,UACDlb,KAAKuM,IAAI0H,EAAIjU,KAAKqW,WAAW,EAC7BrW,KAAKuM,IAAI2H,EACTV,EAAAvC,YAAYE,KAIpB,IAAc,IAAAsH,EAAA,EAAAtG,EAAAnS,KAAK4jD,cAALnrC,EAAAtG,EAAAla,OAAAwgB,IAAoB,CAA7B,IAAIvE,EAAC/B,EAAAsG,GACN2pC,EAASjqD,KACL6H,KAAKkb,UACDlb,KAAKuM,IAAI0H,EAAGC,EACZV,EAAAvC,YAAYC,OAIpBkxC,EAASjqD,KACL6H,KAAKkb,UACDlb,KAAKuM,IAAI0H,EAAIjU,KAAKqW,WAClBnC,EACAV,EAAAvC,YAAYG,QAYxB,OAPAgxC,EAASjqD,KACL6H,KAAKkb,UACDlb,KAAKuM,IAAI0H,EAAIjU,KAAKqW,WAAW,EAC7BrW,KAAKuM,IAAI2H,EAAIlU,KAAKuX,YAClB/D,EAAAvC,YAAYI,OAGb+wC,GAGXz9C,EAAAtM,UAAA4f,YAAA,SAAYnb,GACR,OAAIkD,KAAKujD,gBACLvjD,KAAKujD,kBAAgB,IAM7B5+C,EAAAtM,UAAAuf,gBAAA,SAAgB9a,GAMZ,OALIkD,KAAKujD,cAKFzmD,GAGX6H,EAAAtM,UAAAyf,QAAA,SAAQhb,GAEAkD,KAAKujD,eACLvjD,KAAK+X,YAAYjb,GAMjB,IAAIq/B,EACCn8B,KAAKsjD,SAAWtnD,KAAKK,MAAML,KAAK4kB,IAAI9jB,EAAOoX,EAAIlU,KAAKgU,OAAOwsB,UAAYxgC,KAAKsjD,UAAa,GAEhGtjD,KAAK6lB,UACD7pB,KAAKG,IAAIggC,EAAOn8B,KAAKsjD,SAAW,MAK9C3+C,EArKA,CAAgCT,EAAAC,UAAnB3K,EAAAmL,4aCTb,IAAAxJ,EAAA/B,EAAA,GACA8K,EAAA9K,EAAA,GACAoa,EAAApa,EAAA,GACA8N,EAAA9N,EAAA,GAEAgO,EAAAhO,EAAA,GAEAqL,EAAA,SAAA5E,GAAA,SAAA4E,IAAA,IAAA1E,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAA6U,WACA7U,EAAA2U,aAwEA3U,EAAAoiD,WAAaj7C,EAAAlE,WAAWO,MACxBxD,EAAAwiD,iBAAmB,EAAAt2C,EAavB,OAxF8B1L,EAAAkE,EAAA5E,GAI1B4E,EAAApM,UAAA+f,MAAA,SAAMqqC,GACF,IAAIjjD,EAAIK,EAAAxH,UAAM+f,MAAK7f,KAAAyH,KAACyiD,GAChBvjD,EAAO,SAAC7F,GAAc,OAAAmG,EAAEgZ,aAAanf,EAAG+N,EAAArJ,kBAExCwY,EAAkBvW,KAAKuW,QAAQ7Z,IAAI,SAAArD,GAAK,OAAAA,EAAEkT,MAC1Cq2C,EAAW1jD,EAAKqX,EAAM,IAAKssC,EAAY3jD,EAAKqX,EAAMA,EAAMte,OAAO,IAC/D6c,EAAU9U,KAAKmY,0BAA0Bzb,IAAI,SAAAoa,GAAY,OAAA5X,EAAK4X,KAClEtX,EAAEoZ,KAAKgqC,EAAU9tC,EAAQ,IACzB1N,EAAAxJ,SAASkX,EAAS,GAAGnW,QAAQ,SAACwT,OAACmW,EAAAnW,EAAA,GAAMuwC,EAAAvwC,EAAA,GAAW,OAAA3S,EAAEoZ,KAAK0P,EAAMo6B,KAC7DljD,EAAEoZ,KAAK9D,EAAQA,EAAQ7c,OAAO,GAAI4qD,GAElC,IAAIlsC,EAAO3W,KAAK0W,QAAQ,GAGxB,OAFA5B,EAAQnW,QAAQ,SAAA0M,GAAU,OAAA7L,EAAEoZ,KAAKvN,EAAQnM,EAAKyX,MAEvCnX,GAIXiF,EAAApM,UAAAke,MAAA,WACI,IAAI6rC,KACAC,EAAQriD,KAAKuX,YAEb0mC,EAASj+C,KAAKqW,WAAa,EAkB/B,OAfA+rC,EAASjqD,KACL6H,KAAKkb,UACDlb,KAAKuM,IAAI0H,EAAIgqC,EAAQj+C,KAAKuM,IAAI2H,EAAImuC,EAClC7uC,EAAAvC,YAAYC,OAIpBkxC,EAASjqD,KACL6H,KAAKkb,UACDlb,KAAKuM,IAAI0H,EAAIjU,KAAKqW,WAAa4nC,EAC/Bj+C,KAAKuM,IAAI2H,EAAImuC,EACb7uC,EAAAvC,YAAYG,QAIbgxC,GAOX39C,EAAApM,UAAAyd,KAAA,SAAKC,EAA+BC,GAChC,IAAIpU,EAAe5B,KAAKia,YAEpB0oB,EAAI3iC,KAAKuX,YAEbxB,EAAI6G,YACJ7G,EAAI6I,IACA5e,KAAKuM,IAAI0H,EAAIjU,KAAKqW,WAAW,EAC7BrW,KAAKuM,IAAI2H,EAAIyuB,EACb3iC,KAAKqW,WAAW,IAChB,EACAra,KAAKqiB,OAGTtI,EAAIiH,YACJjH,EAAIkH,UAAYrb,EAAMM,SACtB6T,EAAItZ,OAEJoD,EAAAxH,UAAMyd,KAAIvd,KAAAyH,KAAC+V,EAAKC,IAGpBvR,EAAApM,UAAA6hB,UAAA,WAAc,OAAO/e,EAAAoE,MAAMwT,MAAM8E,QAAQ5V,OAAO,MAIhDwC,EAAApM,UAAAue,aAAA,eAAA7W,EAAAC,KACQk8B,EAAIl8B,KAAKqW,WAAW,EACpBpC,EAAIjU,KAAKuM,IAAI0H,EAAIioB,EACjBhoB,EAAIlU,KAAKuM,IAAI2H,EAAIlU,KAAKuX,YAAcrQ,EAAAvD,qBAAqB3D,KAAKmiD,YAAY,EAO9E,OALI,IAAIhnD,EAAAga,OAAOlB,EAAIioB,EAAE,EAAGhoB,WACU,IAA1BlU,KAAKuiD,kBAA0B,IAAIpnD,EAAAga,OAAOlB,EAAEC,QAChD,IAAI/Y,EAAAga,OAAOlB,EAAIioB,EAAE,EAAGhoB,KAGdxX,IAAI,SAAA7C,GAAK,WAAIqK,EAAA4P,YAAYja,EAAGkG,EAAKoiD,eAEnD19C,EAxFA,CAA8BP,EAAAC,UAAjB3K,EAAAiL,0aCPb,IAAAP,EAAA9K,EAAA,GACAoa,EAAApa,EAAA,GAEA+B,EAAA/B,EAAA,GACA8N,EAAA9N,EAAA,GACAya,EAAAza,EAAA,IACAgO,EAAAhO,EAAA,GAEAmL,EAAA,SAAA1E,GAAA,SAAA0E,IAAA,IAAAxE,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YAEID,EAAAwU,UAAoB,EACpBxU,EAAA2U,aACA3U,EAAA6U,WA+HA7U,EAAAuiD,gBAA8Bp7C,EAAAlE,WAAWO,MACzCxD,EAAAwiD,iBAA2B,EAAAt2C,EAC/B,OArIoC1L,EAAAgE,EAAA1E,GAChCzH,OAAA6B,eAAIsK,EAAAlM,UAAA,eAAA+B,IAAJ,WAAoB,OAAO4F,KAAKuX,YAAc,GAAApd,YAAA,EAAAD,cAAA,IAK9CqK,EAAAlM,UAAA6hB,UAAA,WAAc,OAAOla,KAAK4B,MAAMK,OAAO,KAEvCsC,EAAAlM,UAAAgf,KAAA,WAAS,OAAOrX,KAAKsX,YAErBlf,OAAA6B,eAAIsK,EAAAlM,UAAA,UAAA+B,IAAJ,WACI,OAAO4F,KAAKuM,IAAI2H,EAAIlU,KAAKuX,YAAcvX,KAAKwiD,6CAGhDj+C,EAAAlM,UAAAyd,KAAA,SAAKC,EAA+BC,GAUhC,GAPAnC,EAAAwI,kBACItG,EACA/V,KAAKqX,OACLrX,KAAK+iD,kBACL/iD,KAAKia,cAGJja,KAAKyX,SAAU,CAChB,IAAI7d,EAAIuB,EAAAoE,MAAMc,MAAMwX,QACpBje,EAAEiC,EAAI,GACNgY,EAAAgK,SAAS9H,EAAK/V,KAAKqX,OAAQzd,GAG/B,IACIopD,EAAahjD,KAAKgU,OAAOpS,MAAMK,OAAO,IAE1C4R,EAAAoC,SACIF,GACE9B,EAAGjU,KAAKiU,EAAGC,EAAGlU,KAAKkU,EAAIlU,KAAKuX,YAAcvX,KAAKwiD,YAL/B,GAMhBruC,MAAOnU,KAAKqW,WAAYjC,OAAQ6uC,IAEhCD,EAAWtwC,QAAQ,KAGzBmB,EAAAoC,SACIF,GACE9B,EAAGjU,KAAKiU,EAAGC,EAAGlU,KAAKkU,EAAIlU,KAAKuX,YAAcvX,KAAKwiD,cAXtC,EAYTruC,MAAOnU,KAAKqW,WAAYjC,OAAQpU,KAAKwiD,aAZ5B,GAcTQ,GAGNnjD,EAAAxH,UAAMyd,KAAIvd,KAAAyH,KAAC+V,EAAKC,IAIpBzR,EAAAlM,UAAAke,MAAA,WACI,IAAI6rC,KACAC,EAAQriD,KAAKuX,YAAcvX,KAAKwiD,YAChCI,EAAiB5iD,KAAKkb,UACtBlb,KAAKuM,IAAI0H,EACTjU,KAAKuM,IAAI2H,EAAImuC,EACb7uC,EAAAvC,YAAYC,MAEhBkxC,EAASjqD,KAAKyqD,GAEd,IAAIC,EAAkB7iD,KAAKkb,UACvBlb,KAAKuM,IAAI0H,EAAIjU,KAAKqW,WAClBrW,KAAKuM,IAAI2H,EAAImuC,EACb7uC,EAAAvC,YAAYG,OAmBhB,OAjBAgxC,EAASjqD,KAAK0qD,GAEdT,EAASjqD,KACL6H,KAAKkb,UACDlb,KAAKuM,IAAI0H,EAAIjU,KAAKqW,WAAW,EAC7BrW,KAAKuM,IAAI2H,EACTV,EAAAvC,YAAYE,KAIpBixC,EAASjqD,KACL6H,KAAKkb,UACDlb,KAAKuM,IAAI0H,EAAIjU,KAAKqW,WAAW,EAC7BrW,KAAKuM,IAAI2H,EAAIlU,KAAKuX,YAClB/D,EAAAvC,YAAYI,OAGb+wC,GAGX79C,EAAAlM,UAAAqe,MAAA,WACI,IAAIzC,EAAIjU,KAAKuM,IAAI0H,EAAIjU,KAAKqW,WAAW,EACjCnC,EAAIlU,KAAKuM,IAAI2H,EAAIlU,KAAKuX,YAAYvX,KAAKwiD,YAC3C,OACI,IAAIrnD,EAAAga,OAAOnZ,KAAKK,MAAM4X,GAAIjY,KAAKK,MAAM6X,MAI7C3P,EAAAlM,UAAA+f,MAAA,SAAMqqC,GACF,IAAIjjD,EAAIK,EAAAxH,UAAM+f,MAAK7f,KAAAyH,KAACyiD,GAChBlsC,EAAgBvW,KAAKuW,QACrBrX,EAAO,SAAC7F,GAAc,OAAAmG,EAAEgZ,aAAanf,EAAG+N,EAAArJ,kBACxC6kD,EAAW1jD,EAAKqX,EAAM,GAAGhK,KAAMs2C,EAAY3jD,EAAKqX,EAAM,GAAGhK,KACzDuI,EAAU9U,KAAKmY,0BAA0Bzb,IAAI,SAAA9B,GAAK,OAAAsE,EAAKtE,KAC3D4E,EAAEoZ,KAAKgqC,EAAU9tC,EAAQ,IACzB1N,EAAAxJ,SAASkX,EAAS,GAAGnW,QAAQ,SAACwT,OAACmW,EAAAnW,EAAA,GAAMuwC,EAAAvwC,EAAA,GAAW,OAAA3S,EAAEoZ,KAAK0P,EAAMo6B,KAC7DljD,EAAEoZ,KAAK9D,EAAQA,EAAQ7c,OAAO,GAAI4qD,GAElC,IAAIlsC,EAAO3W,KAAK0W,QAAQ,GAExB,OADA5B,EAAQnW,QAAQ,SAAA0M,GAAU,OAAA7L,EAAEoZ,KAAKvN,EAAQnM,EAAKyX,MACvCnX,GAGX+E,EAAAlM,UAAAyf,QAAA,SAAQhb,GACJkD,KAAK+X,YAAYjb,IAGrByH,EAAAlM,UAAAue,aAAA,eAAA7W,EAAAC,KACQk8B,EAAIl8B,KAAKqW,WAAW,EACpBpC,EAAIjU,KAAKuM,IAAI0H,EAAIioB,EACjBhoB,EAAIlU,KAAKuM,IAAI2H,EAAIlU,KAAKuX,YAAcvX,KAAKwiD,YAAc,GAS3D,OARAtuC,GAAKhN,EAAAvD,qBAAqB3D,KAAKsiD,iBAAmB,KAG9C,IAAInnD,EAAAga,OAAOlB,EAAIioB,EAAE,EAAGhoB,WAChBlU,KAAKuiD,iBAAmB,GAAK,IAAIpnD,EAAAga,OAAOlB,EAAEC,QAC9C,IAAI/Y,EAAAga,OAAOlB,EAAIioB,EAAE,EAAGhoB,KAGdxX,IAAI,SAAA7C,GAAK,WAAIqK,EAAA4P,YAAYja,EAAGkG,EAAKuiD,oBAMnD/9C,EArIA,CAAoCL,EAAAC,UAAvB3K,EAAA+K,gbCRb,IAAAL,EAAA9K,EAAA,GACA+B,EAAA/B,EAAA,GACAoa,EAAApa,EAAA,GAGAiL,EAAA,SAAAxE,GAAA,SAAAwE,IAAA,IAAAtE,EAAA,OAAAF,KAAAjH,MAAAoH,KAAAuL,YAAAvL,YACID,EAAAwU,UAAoB,EAEpBxU,EAAAwjD,iBACAxjD,EAAA4U,OAAsBnB,EAAAvC,YAAYC,KAqDlCnR,EAAAmkD,QAAkB,EAAAj4C,EAsBtB,OA/EkC1L,EAAA8D,EAAAxE,GAM/BwE,EAAAhM,UAAAqe,MAAA,WACK,IAAIzC,EAAIjU,KAAKuM,IAAI0H,EAAIjU,KAAKqW,WAAW,EACjCnC,EAAIlU,KAAKuM,IAAI2H,EAAI,EAAElU,KAAKuX,YAAY,EACxC,OACI,IAAIpc,EAAAga,OAAOnZ,KAAKK,MAAM4X,GAAIjY,KAAKK,MAAM6X,MAG7C7P,EAAAhM,UAAA6hB,UAAA,WAAc,OAAOla,KAAK4B,MAAMK,OAAO,KAEvCoC,EAAAhM,UAAAke,MAAA,WACI,IAAI6rC,KACAC,EAAQ,EAAIriD,KAAKuX,YAAc,EAiBnC,OAfA6qC,EAASjqD,KACL6H,KAAKkb,UACDlb,KAAKuM,IAAI0H,EAAGjU,KAAKuM,IAAI2H,EAAImuC,EACzB7uC,EAAAvC,YAAYC,OAIpBkxC,EAASjqD,KACL6H,KAAKkb,UACDlb,KAAKuM,IAAI0H,EAAIjU,KAAKqW,WAClBrW,KAAKuM,IAAI2H,EAAImuC,EACb7uC,EAAAvC,YAAYG,QAIbgxC,GAIX/9C,EAAAhM,UAAA4f,YAAA,SAAYnb,GACR,OAAIkD,KAAKujD,gBACLvjD,KAAKujD,iBACLvjD,KAAK8X,QAAQ9X,KAAK4X,gBAAgB9a,SAM1CuH,EAAAhM,UAAAuf,gBAAA,SAAgB9a,GACZ,IAAIqnD,EAAYrnD,EAAO+a,QAMvB,OALI7X,KAAKujD,gBAELY,EAAUjwC,EAAIlU,KAAKuM,IAAI2H,GAGpBiwC,GAIX9/C,EAAAhM,UAAAyf,QAAA,SAAQhb,GAEJ,GAAIkD,KAAKujD,cAAe,CACpB,IAAIzoC,EAAU9a,KAAK+X,YAAYjb,GAC3Bge,IACA9a,KAAK2U,OAASmG,EAAQnG,OAElBmG,GAAW9a,KAAK2U,SAAWnB,EAAAvC,YAAYC,OACvClR,KAAKkkD,QAAUppC,EAAQvO,IAAI0H,SAK/BjU,KAAK2U,SAAWnB,EAAAvC,YAAYC,MAC5BlR,KAAK8lB,SAAS9pB,KAAK4kB,IAAI5gB,KAAKkkD,QAAUpnD,EAAOmX,IAC7CjU,KAAKuM,IAAI0H,EAAIjU,KAAKkkD,QAAUlkD,KAAKqW,YAEjCrW,KAAK8lB,SAAS9pB,KAAK4kB,IAAI5gB,KAAKuM,IAAI0H,EAAInX,EAAOmX,KAI3D5P,EA/EA,CAAkCH,EAAAC,UAArB3K,EAAA6K,gCCLb5K,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAAwB,EAAuB,iDAAA4C,EAAAyO,EAAA1R,GCAxCd,EAAAD,QAAiBJ,EAAA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","file":"main.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t1: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([130,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import { Vector, Color } from \"excalibur\";\r\nimport { Rectangle } from \"./values/Rectangle\";\r\nimport { getBackgroundPattern, BackgroundPattern } from \"./actors/Building/BackgroundPatterns\";\r\n\r\nconst extremumBy = (arr, pluck, extremum) => {\r\n  return arr.reduce(function(best, next) {\r\n    var pair = [ pluck(next), next ];\r\n    if (!best) {\r\n       return pair;\r\n    } else if (extremum.apply(null, [ best[0], pair[0] ]) == best[0]) {\r\n       return best;\r\n    } else {\r\n       return pair;\r\n    }\r\n  },null)[1];\r\n}\r\n\r\nexport const minBy = (arr, fn) => extremumBy(arr, fn, Math.min)\r\nexport const maxBy = (arr, fn) => extremumBy(arr, fn, Math.max)\r\n\r\n\r\nexport const sample = (arr) => arr[Math.floor(Math.random() * arr.length)]\r\n\r\nexport const range = (n) => Array(n).fill(0).map((_val,idx) => idx)\r\n\r\nexport function closest<T>(cursor: Vector, arr: Array<T>, getVector: (elem: T) => Vector, predicate?: (elem: T) => boolean) {\r\n   if (arr.length === 0) { return null }\r\n   let matching: Array<T> = arr;\r\n   if (predicate) { arr = arr.filter(predicate) }\r\n   if (matching) {\r\n      let distanceToCursor = (elem: T) => cursor.distance(getVector(elem))\r\n      return minBy(matching, distanceToCursor)\r\n   }\r\n}\r\n\r\nexport const flatSingle = arr => [].concat(...arr);\r\n\r\nexport const deleteByValue = (arr, elem) => arr.filter(e => e !== elem)\r\n\r\nexport const deleteByValueOnce = (arr, elem) => {\r\n  let index = arr.indexOf(elem);\r\n  if (index !== -1) arr.splice(index, 1);\r\n}\r\n\r\nexport function eachCons(a, n) {\r\n  var r = []\r\n  for (var i = 0; i < a.length - n + 1; i++) {\r\n    r.push(_ecRange(a, i, n))\r\n  }\r\n  return r\r\n}\r\n\r\nfunction _ecRange (a, i, n) {\r\n  var r = []\r\n  for (var j = 0; j < n; j++) {\r\n    r.push(a[i + j])\r\n  }\r\n  return r\r\n}\r\n\r\nexport function eachChunk(a, n) {\r\n  return a.reduce(function (result, value, index, array) {\r\n    if (index % n === 0)\r\n      result.push(array.slice(index, index + n));\r\n    return result;\r\n  }, []);\r\n}\r\n\r\nexport const measureDistance = (a: Vector, b: Vector) => a.distance(b)\r\n\r\n\r\nexport function sleep(ms) {\r\n  return new Promise(resolve => setTimeout(resolve, ms));\r\n}\r\n\r\nexport function shuffle(arr) {\r\n  return arr.sort(() => Math.random() > 0.5 ? 1 : -1)\r\n}\r\n\r\nexport const zip = (a, b) => a.map((e, i) => [e, b[i]])\r\n\r\nexport const countOccurrences = (arr) => {\r\n  let counts = {}\r\n  arr.forEach((elem) => {\r\n    counts[elem] = counts[elem] || 0\r\n    counts[elem] += 1\r\n  })\r\n  return counts\r\n}\r\n\r\nexport function containsUniq<T>(arr: T[], testElems: T[]) {\r\n  let doesContain = false\r\n  let arrCopy = arr.slice()\r\n  if (arr.length > 0) {\r\n    let missingItem = false\r\n    testElems.forEach(testElem => {\r\n      if (arrCopy.find(e => e === testElem)) {\r\n        deleteByValueOnce(arrCopy, testElem)\r\n      } else {\r\n        missingItem = true\r\n      }\r\n    })\r\n    doesContain = !missingItem\r\n  }\r\n  return doesContain\r\n}\r\n\r\n\r\nexport function mixColors(a: Color, b: Color, factor: number = 0.5): Color {\r\n  let aFactor = factor, bFactor = (1-factor)\r\n  return new Color(\r\n    (a.r * aFactor) + (b.r * bFactor),\r\n    (a.g * aFactor) + (b.g * bFactor),\r\n    (a.b * aFactor) + (b.b * bFactor),\r\n    255\r\n  )\r\n}\r\n\r\nexport function onlyUnique(value, index, self) { \r\n    return self.indexOf(value) === index;\r\n}","import { Engine, DisplayMode, Loader, Timer, Color } from 'excalibur';\r\nimport { World } from './models/World';\r\nimport { Resources } from './Resources';\r\n\r\nconst mu = 9\r\n\r\nexport class Game extends Engine {\r\n  static font = 'Helvetica'\r\n  static title: string = 'ASTRA';\r\n  // static debugPath: boolean = false\r\n  static startHour: number = 10\r\n\r\n  static mansheight: number = 3 * mu\r\n  static citizenSpeed: number = 5 * Game.mansheight\r\n\r\n  // combat knobs\r\n  static bulletSpeed: number = 8 * Game.citizenSpeed\r\n  static raidingPartyFrequency: number = 120000\r\n\r\n  // 10000 = 1 min / 10 sec\r\n  // 1000 = 1 min / second\r\n  // 100 = 10 min / second\r\n  static minuteTickMillis: number = 850\r\n\r\n\r\n\r\n  constructor(public world: World) {\r\n    super({\r\n      // width: 800,\r\n      // height: 600,\r\n      displayMode: DisplayMode.FullScreen,\r\n      backgroundColor: Color.Black //world.skyColor\r\n    });\r\n  }\r\n\r\n\r\n  public start() {\r\n    let loader = new Loader();\r\n    for (let key in Resources) {\r\n      loader.addResource(Resources[key]);\r\n    }\r\n    loader.backgroundColor = '#0a0e0c'\r\n    // loader.logo = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAABACAYAAAD1Xam+AAACwklEQVR4nO3dQXKbMBQAULvTbXYe1u30fln0IF3kfp1mzXjnA7grMoRxDBISSOi9VSYBPsrw/xdg8OkEAAAAAAAAAAAAAAAAAAAAABTjvPcOHEXfX+/P/t51l6z/61zx+/56n647Fys27qNYIeum2o+WfN97B2o2Puj+/Pq5eNlUB2PINlPHX7qNIW6OBNxz/EehAETq++t9LunHxsuu6XSx2xgvmyJ+aNzUMWsZf+kUgEBDJwlJ/qnX7hLdGVN01K67nHN25mcxUxS+YXtr92Xtdo5AAQgQ2vWfee0uH9sMmU6nOmBzdea5mGvP82sef4m+7b0DtUiZ/D9eXj5+Hs8G5uLnOFDH3bBkrY8/FwWATbWecKVRABZI2f0fmZsF5J6mlp6UrY8/JwVgRu7kH3xVBLY6Ry01CVoff24KADRMAYCGKQBP5Jr+v99uD38/PQ3Y+hbVFtPgvW57LtHiaYACAA1TAPgkZ8et4UM3pe9fagrAxr6a/h9dDcnfIh8F3lBM8u9xTpr6oZ0126x9/KVTADYSk/x7HIhLE27pcmsf2oldN1ZrFwEVgA0ccdq/5Pn7ljpprVwDyGxN8tfcjVLcUqt5/LVQAJ7ousv5999/Ueu+327Byf/WXz911q3vS5fWtVsf/xYUgAyOOOWP0eIHa2rjGkAikv6xVG8CIg8FYMZwAA9v8MllOv2fxt/ircIlJmnr48/NKcACXXc5v/XXbNv/KvnH8XNOpUt/3r728ZdMAWATrgeUSQFYKNcsYK77j+PnSKBaul/r48/FNYAA44Nw7TWBoZiEvts+1eus93gt9trz+drHXyIFIND4ddKxRWBp15+LX8LrtUOlKAKnU73jL40CEGk6JZ0rBuPTh1RfzdXyV2O1Pv5UFIAVpl83tXTZo8SPlerWXq3jBwAAAAAAAAAAAAAAAAAAAAB46D+AUA+q0Ax9RQAAAABJRU5ErkJggg=='\r\n    loader.logo = 'data:image/png;base64,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'\r\n    // loader.logo = 'data:image/png;base64,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'\r\n    // loader.logo = 'data:image/png;base64,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'\r\n    loader.logoWidth = 3 * 256\r\n    loader.logoHeight = 3 * 64\r\n\r\n    // loader.playButtonText = 'make planetfall'\r\n    loader.startButtonFactory = () => {\r\n      let myButton = document.createElement('button');\r\n      myButton.textContent = 'Make Planetfall';\r\n      myButton.style.border = 'none'\r\n      myButton.style.display = 'block'\r\n      myButton.style.padding = '24px'\r\n      myButton.style.fontFamily = Game.font //'Helvetica'\r\n      myButton.style.color = 'white'\r\n      myButton.style.fontSize = '20pt'\r\n      myButton.style.fontWeight = '300'\r\n\r\n      myButton.style.backgroundColor = '#9a5e5c'\r\n\r\n\r\n      myButton.onmouseenter = () => {\r\n        myButton.style.backgroundColor = Color.Red.darken(0.5).toRGBA()\r\n      }\r\n      myButton.onmouseleave = () => { myButton.style.backgroundColor = '#9a5e5c' }\r\n      return myButton;\r\n    };\r\n\r\n    return super.start(loader).then(() => {\r\n      console.log(\"Osiris running.\")\r\n    });\r\n  }\r\n\r\n  debugMode: boolean = false\r\n  public toggleDebugMode() {\r\n    this.debugMode = !this.debugMode\r\n  }\r\n}","import { Scale } from \"./Scale\";\r\nimport { Game } from \"../Game\";\r\nlet { major, minor } = Scale\r\n\r\nexport enum DeviceSize {\r\n    Tiny,\r\n    Small,\r\n    Medium,\r\n    Large,\r\n    Huge,\r\n}\r\n\r\n\r\nexport function getVisibleDeviceSize(size: DeviceSize): number {\r\n    let unit = Game.mansheight\r\n    let sz = 10;\r\n    switch (size) {\r\n        case DeviceSize.Tiny:   sz = minor.second; break\r\n        case DeviceSize.Small:  sz = minor.sixth; break\r\n        case DeviceSize.Medium: sz = major.first;  break\r\n        case DeviceSize.Large:  sz = major.second; break\r\n        case DeviceSize.Huge:   sz = major.eighth; break\r\n    }\r\n    return sz;\r\n}","import { Building } from './Building';\r\n\r\nimport { CorridorView } from './CorridorView';\r\nimport { CommonAreaView } from './CommonAreaView';\r\nimport { DomeView } from './DomeView';\r\nimport { TunnelView } from './TunnelView';\r\nimport { ArcologyView } from './ArcologyView';\r\nimport { LadderView } from './LadderView';\r\nimport { SurfaceRoadView } from './SurfaceRoadView';\r\nimport { SmallDomeThreeView } from './SmallDomeThreeView';\r\nimport { MidDomeView } from './MidDomeView';\r\nimport { BigDomeView } from './BigDomeView';\r\nimport { SmallRoomThreeView } from './SmallRoomThreeView';\r\nimport { MediumRoomView } from './MediumRoomView';\r\nimport { LargeRoomView } from './LargeRoomView';\r\nimport { HugeRoomView } from './HugeRoomView';\r\nimport { MediumRoomThreeView } from './MediumRoomThreeView';\r\nimport { MediumSurfaceRoomView } from './MediumSurfaceRoomView';\r\nimport { GroundVehiclePoolView } from './GroundVehiclePoolView';\r\n\r\n\r\nconst structureViews: { [key: string]: typeof Building } = {\r\n    CorridorView,\r\n    LadderView,\r\n    TunnelView,\r\n    SurfaceRoadView,\r\n\r\n    DomeView, // small dome 2\r\n    SmallDomeThreeView,\r\n    MidDomeView,\r\n    BigDomeView,\r\n\r\n    SmallRoomThreeView,\r\n\r\n    CommonAreaView,\r\n    MediumRoomView,\r\n    MediumRoomThreeView,\r\n    LargeRoomView,\r\n    HugeRoomView,\r\n\r\n    ArcologyView,\r\n    MediumSurfaceRoomView,\r\n\r\n    GroundVehiclePoolView,\r\n}\r\n\r\nexport {\r\n    Building,\r\n\r\n    CorridorView,\r\n    LadderView,\r\n    TunnelView,\r\n    SurfaceRoadView,\r\n\r\n    DomeView, // small dome 2\r\n    SmallDomeThreeView,\r\n    MidDomeView,\r\n    BigDomeView,\r\n\r\n    SmallRoomThreeView,\r\n\r\n    CommonAreaView,\r\n    MediumRoomView,\r\n    MediumRoomThreeView,\r\n\r\n    LargeRoomView,\r\n    HugeRoomView,\r\n\r\n    ArcologyView,\r\n\r\n    MediumSurfaceRoomView,\r\n\r\n\r\n    structureViews\r\n\r\n}","import { Game } from \"../Game\";\r\n\r\nconst majorUnit = Game.mansheight * 2\r\nconst minorUnit = Math.floor(Game.mansheight / 4)\r\n// const microUnit = Math.floor(Game.mansheight / 8)\r\n// const microUnit = Game.man\r\n\r\n// type ScaleDegree = 'first'\r\ninterface Octave {\r\n    first: number\r\n    second: number\r\n    third: number\r\n    fourth: number\r\n    fifth: number\r\n    sixth: number\r\n    seventh: number\r\n    eighth: number\r\n}\r\n\r\nfunction octave(unit: number): Octave {\r\n    return {\r\n        first: unit,\r\n        second: unit * 2,\r\n        third: unit * 3,\r\n        fourth: unit * 4,\r\n        fifth: unit * 5,\r\n        sixth: unit * 6,\r\n        seventh: unit * 7,\r\n        eighth: unit * 8,\r\n    }\r\n}\r\n\r\nconst majorScale = octave(majorUnit)\r\nconst minorScale = octave(minorUnit) \r\n// const nanoScale = octave(microUnit)\r\n\r\nexport const Scale = {\r\n    major: majorScale,\r\n    minor: minorScale,\r\n    // nano: nanoScale,\r\n}","import { ResourceBlock, Economy, emptyMarket } from \"./Economy\";\r\nimport { Color, FontStyle, Resource } from \"excalibur\";\r\nimport { DeviceSize } from \"../values/DeviceSize\";\r\nimport { MechanicalOperation, mechanicalOperations } from \"./MechanicalOperation\";\r\nimport { shuffle, range, sample } from \"../Util\";\r\nimport { Device } from \"../actors/Device\";\r\nimport { doesNotReject } from \"assert\";\r\n\r\nconst bookshelfSvg = require('../images/bookshelf-plain.svg');\r\nconst vatSvg = require('../images/vat-plain.svg');\r\nconst benchSimple = require('../images/bench-simple-plain.svg');\r\nconst stove = require('../images/stove-plain.svg');\r\nconst cabin = require('../images/cabin-plain.svg');\r\nconst fire = require('../images/cooking-fire-plain.svg')\r\nconst bed = require('../images/bed-plain.svg')\r\nconst fridge = require('../images/fridge-plain.svg')\r\nconst server = require('../images/research-server-plain.svg')\r\nconst plant = require('../images/houseplant-plain.svg')\r\nconst workstation = require('../images/workstation-plain.svg')\r\n\r\nconst console = require('../images/console-plain.svg')\r\nconst consolePurple = require('../images/console-purple-plain.svg')\r\nconst consoleGreen = require('../images/console-green-plain.svg')\r\nconst consoleRed = require('../images/console-red-plain.svg')\r\nconst megaconsole = require('../images/mega-console-plain.svg')\r\n\r\nconst fabricator = require('../images/fabricator-plain.svg')\r\n\r\nconst couch = require('../images/couch-plain.svg')\r\nconst solar = require('../images/solar-collector-plain.svg')\r\nconst miner = require('../images/miner-plain.svg')\r\n\r\nconst statue = require('../images/statue-plain.svg')\r\nconst codex = require('../images/codex-plain.svg')\r\n\r\nconst lavaLamp = require('../images/lava-lamp-plain.svg')\r\nconst orrery = require('../images/orrery-plain.svg')\r\nconst telescope = require('../images/telescope-plain.svg')\r\nconst books = require('../images/books-plain.svg')\r\n\r\nconst greenhouse = require('../images/greenhouse-plain.svg')\r\nconst o2 = require('../images/oxygen-extractor-plain.svg')\r\nconst h20 = require('../images/water-condenser-plain.svg')\r\n\r\nconst minProcessor = require('../images/mineral-processor-plain.svg')\r\n\r\nconst laser = require('../images/laser-turret-plain.svg')\r\n\r\nconst images = {\r\n    bookshelf: bookshelfSvg,\r\n    vat: vatSvg,\r\n    bench: benchSimple,\r\n    stove,\r\n    cabin,\r\n    fire,\r\n    bed,\r\n    fridge,\r\n    server,\r\n    plant,\r\n    workstation,\r\n\r\n    console,\r\n    consolePurple,\r\n    consoleGreen,\r\n    consoleRed,\r\n    megaconsole,\r\n\r\n    fabricator,\r\n\r\n    couch,\r\n    solar,\r\n    miner,\r\n    statue,\r\n\r\n    codex,\r\n    lavaLamp,\r\n    orrery,\r\n    telescope,\r\n    books,\r\n    greenhouse,\r\n\r\n    o2,\r\n    h20,\r\n\r\n    minProcessor,\r\n    laser,\r\n\r\n}\r\n\r\n\r\nconst { Red, Green, Blue, Orange, Violet, Yellow } = Color;\r\n\r\nlet { store, generate, recipe, spawn, accelerateTime, explore } = mechanicalOperations\r\n\r\nexport class Machine {\r\n    name: string = '(machine name)'\r\n    description: string = '(machine description)'\r\n    color: Color = Color.LightGray\r\n\r\n    cost: ResourceBlock[] = [ResourceBlock.Mineral]\r\n\r\n    size: DeviceSize = DeviceSize.Small\r\n    operation: MechanicalOperation = { type: 'noop' }\r\n    image = images.vat\r\n    prereqs: (typeof Machine)[] = []\r\n    economy: Economy = emptyMarket()\r\n    forDome: boolean = false\r\n    hide: boolean = false\r\n\r\n    capacity: boolean\r\n\r\n    isVehicle: boolean = false\r\n\r\n    tinySlots: boolean = false\r\n    isEatingSurface: boolean = false\r\n\r\n    powerEffect: boolean = false\r\n\r\n    defender: boolean = false\r\n\r\n    concretize(): Machine { return this; } \r\n\r\n    onPlacement(device: Device) {\r\n        // ...whatever we need to script here?\r\n    }\r\n}\r\n\r\nexport class CommandCenter extends Machine {\r\n    name = 'Command Console'\r\n    description = 'commander, we need your help'\r\n    operation = store(\r\n        [ResourceBlock.Mineral, ResourceBlock.Ore], //,ResourceBlock.Biomass],\r\n        32\r\n    )\r\n    image = images.megaconsole\r\n    size = DeviceSize.Medium\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 10, demand: 0 },\r\n        Oxygen: { supply: 20, demand: 0 },\r\n        Water: { supply: 20, demand: 0 },\r\n        Hope: { supply: 10, demand: 0 },\r\n        Shelter: { supply: 20, demand: 0}\r\n    }\r\n\r\n    onPlacement(device: Device) {\r\n        device.built = true\r\n        for (let i in range(20)) {\r\n            device.produceResource(ResourceBlock.Mineral)\r\n        }\r\n        let { building } = device\r\n\r\n        building.populate(device.pos.add(building.pos), true)\r\n        let initialPop = 2\r\n        for (let times in range(initialPop)) {\r\n            building.populate(device.pos.add(building.pos), false)\r\n        }\r\n        // building.populate(device.pos.add(building.pos), false)\r\n    }\r\n}\r\n\r\nexport class MissionLog extends Machine {\r\n    name = 'Mission Log'\r\n    description = 'gather data'\r\n    operation = store(\r\n        [ResourceBlock.Data],\r\n        8\r\n    )\r\n    image = images.consolePurple\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 0.1 },\r\n        Hope: { supply: 1, demand: 0 }\r\n    }\r\n}\r\n\r\n//export class Energon extends Machine {\r\n//    name = 'Energon'\r\n//    description = 'food paste'\r\n//}\r\n\r\n// tiny\r\nexport class LavaLamp extends Machine {\r\n    name = 'Lava Lamp'\r\n    description = 'mesmerizing'\r\n    size = DeviceSize.Tiny\r\n    prereqs = [ Table ]\r\n    image  = images.lavaLamp\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Joy: { supply: 1, demand: 0 },\r\n        Power: { supply: 0, demand: 0.1 },\r\n    }\r\n}\r\n\r\nexport class Figurine extends Machine {\r\n    name = 'Figurine'\r\n    description = 'not an action figure'\r\n    size = DeviceSize.Tiny\r\n    prereqs = [ Table ]\r\n    image = images.statue   \r\n    economy = {\r\n        ...emptyMarket(),\r\n        Beauty: { supply: 0.1, demand: 0 },\r\n    }\r\n}\r\n\r\nexport class Orrery extends Machine {\r\n    name = 'Orrery'\r\n    description = 'to the stars'\r\n    size = DeviceSize.Tiny\r\n    prereqs = [ Table ]\r\n    image = images.orrery\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Wonder: { supply: 0.1, demand: 0 },\r\n    }\r\n}\r\n\r\nexport class Books extends Machine {\r\n    name = 'Books'\r\n    description = 'all there in black and white'\r\n    operation = generate(ResourceBlock.Idea, 2)\r\n    size = DeviceSize.Tiny\r\n    prereqs = [ Table ]\r\n    image = images.books\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Wisdom: { supply: 0.1, demand: 0 },\r\n    }\r\n}\r\n\r\n// small\r\n/// small surface\r\n\r\nexport class OxygenExtractor extends Machine {\r\n    name = 'O2 Extractor'\r\n    description = 'breathe deep'\r\n    image = images.o2\r\n    prereqs = [ WaterCondensingMachine, SolarCell ]\r\n    forDome = true\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Oxygen: { supply: 6, demand: 0 },\r\n        Power: { supply: 0, demand: 1 },\r\n    }\r\n}\r\n\r\nexport class SolarCell extends Machine {\r\n    name = 'Solar Cell'\r\n    description = 'feel the warmth'\r\n    image = images.solar\r\n    prereqs = [ Bed ] \r\n\r\n    forDome = true\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 10, demand: 0 },\r\n    }\r\n}\r\n\r\n\r\nexport class WaterCondensingMachine extends Machine {\r\n    name = 'H2O Condenser'\r\n    description = 'have a drink'\r\n// setup a loop here so we have to get survival I?\r\n    prereqs = [ SolarCell, OxygenExtractor ]\r\n    image = images.h20\r\n\r\n    forDome = true\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Water: { supply: 5, demand: 0 },\r\n        Power: { supply: 0, demand: 1 },\r\n    }\r\n}\r\n\r\nexport class Telescope extends Machine {\r\n    name = 'Telescope'\r\n    description = 'look to the stars'\r\n    prereqs = [ Orrery ]\r\n    forDome = true\r\n    image = images.telescope\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Wisdom: { supply: 1, demand: 0 },\r\n    } \r\n}\r\n\r\n\r\n// /// small subsurface\r\n\r\nexport class Table extends Machine {\r\n    name = 'Table'\r\n    description = 'a simple table'\r\n    image = images.bench\r\n    isEatingSurface = true\r\n    // this device provides slots for tiny-sized deviecs\r\n    tinySlots = true\r\n}\r\n\r\nexport class Statue extends Machine {\r\n    name = 'Statue'\r\n    description = 'for honor'\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Hope: { supply: 0.1, demand: 0 },\r\n        Beauty: { supply: 1, demand: 0 },\r\n    }\r\n    image = images.statue\r\n    prereqs = [ Figurine ]\r\n}\r\n\r\nexport class StudyMachine extends Machine {\r\n    operation = recipe(\r\n        [ ResourceBlock.Idea, ResourceBlock.Idea, ResourceBlock.Idea ],\r\n        ResourceBlock.Data\r\n    )\r\n    color = Blue\r\n    concretize(): Machine { return new Workstation() } //(sample([Workstation, Desk]))() }\r\n}\r\n\r\n// export class Desk extends StudyMachine {\r\n//     name = 'Desk'\r\n//     description = 'get to work'\r\n//     image = images.bench\r\n//     prereqs = [ OxygenExtractor ]\r\n//     concretize() { return this }\r\n// }\r\n\r\nexport class Codex extends Machine {\r\n    name = 'Codex'\r\n    description = 'read it closely'\r\n    image = images.codex\r\n    prereqs = [ Bookshelf ]\r\n    operation = store([ResourceBlock.Data], 3)\r\n    color = Blue\r\n    // concretize() { return this }\r\n}\r\n\r\nexport class Workstation extends StudyMachine {\r\n    name = 'Workstation'\r\n    description = 'hackety hack'\r\n    prereqs = [ Bookshelf ]\r\n    image = images.workstation\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 1 },\r\n    }\r\n    concretize() { return this }\r\n}\r\n\r\nexport class Couch extends Machine {\r\n    name = 'Couch'\r\n    description = 'take it easy'\r\n    prereqs = []\r\n    image = images.couch\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Joy: { supply: 0.1, demand: 0 },\r\n    }\r\n}\r\n\r\n\r\n\r\nexport class Bookshelf extends Machine {\r\n    name = 'Shelf'\r\n    description = 'brainstorm'\r\n    operation = generate(ResourceBlock.Idea)\r\n    image = images.bookshelf\r\n    prereqs = [ Books, Codex ] // setup a loop...\r\n    color = Blue\r\n}\r\n\r\n\r\nexport class Fridge extends Machine {\r\n    name = 'Fridge'\r\n    description = 'store meals'\r\n    operation = store([ResourceBlock.Meal], 6)\r\n    image = images.fridge\r\n    prereqs = [Bookshelf]\r\n    color = Yellow\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 1 },\r\n    }\r\n}\r\n\r\nexport class Stove extends Machine {\r\n    name = 'Stove'\r\n    description = 'make a meal'\r\n    operation = recipe(\r\n        [ResourceBlock.Biomass, ResourceBlock.Biomass],\r\n        ResourceBlock.Meal\r\n    )\r\n    image = images.stove\r\n\r\n    prereqs = [Bookshelf, Fridge]\r\n    color = Yellow\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 1 },\r\n    }\r\n}\r\n\r\nexport class Bed extends Machine {\r\n    name = 'Bed'\r\n    description = 'sweet dreams'\r\n    image = images.bed\r\n    prereqs = [ OxygenExtractor ]\r\n    color = Orange\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Shelter: { supply: 1, demand: 0 },\r\n    }\r\n}\r\n\r\nexport class Houseplant extends Machine {\r\n    name = 'House Plant'\r\n    description = 'so nice'\r\n    prereqs = [ Botany, Bed ]\r\n    // produces = ResourceBlock.Food\r\n    cost = [ ResourceBlock.Biomass ]\r\n    operation = generate(ResourceBlock.Biomass, 1)\r\n    color = Green\r\n    image = images.plant\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Oxygen: { supply: 1, demand: 0 },\r\n        Water: { supply: 0, demand: 0.1 },\r\n    }\r\n}\r\n\r\nexport class PersonnelRegistry extends Machine {\r\n    name = 'Personnel Registry'\r\n    description = 'track everybody'\r\n    prereqs = [ CloningVat ]\r\n    operation = store([ResourceBlock.Data], 4)\r\n    color = Yellow\r\n    image = images.console\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 0.1 },\r\n        Wisdom: { supply: 1, demand: 0 },\r\n    }\r\n\r\n    // onPlacement(device: Device) {\r\n    //     device.building.planet\r\n    // }\r\n}\r\n\r\nexport class OrientationConsole extends Machine {\r\n    name = 'Orientation Console'\r\n    description = 'welcome to the colony'\r\n    prereqs = [CloningVat]\r\n    operation = generate(ResourceBlock.Data, 1)\r\n    image = images.consoleRed\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 0.1 },\r\n        Hope: { supply: 1, demand: 0 },\r\n    }\r\n}\r\n\r\nexport class CloningVat extends Machine {\r\n    name = 'Cloning Vat'\r\n    description = 'we all grow'\r\n    // behavior = MachineOperation.SpawnCitizen \r\n    operation = spawn()\r\n    productionTime = 1500\r\n    image = images.vat\r\n    prereqs = [AlgaeVat]\r\n    size = DeviceSize.Small\r\n    color = Violet\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 2 },\r\n    }\r\n}\r\n\r\nexport class DissolutionVat extends Machine {\r\n    name = 'Dissolution Vat'\r\n    description = 'back to basics'\r\n    // behavior = MachineOperation.SpawnCitizen \r\n    operation = recipe(\r\n        [ ResourceBlock.Biomass, ResourceBlock.Biomass ],\r\n        ResourceBlock.Bioplasma\r\n    )\r\n    productionTime = 1500\r\n    image = images.vat\r\n    prereqs = [PlasmaBank]\r\n    size = DeviceSize.Small\r\n    color = Violet\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 1 },\r\n    }\r\n}\r\n\r\nexport class PlasmaBank extends Machine {\r\n    name = 'Bioplasm Bank'\r\n    description = 'hold on'\r\n    operation = store([ ResourceBlock.Bioplasma ])\r\n    prereqs = [AlgaeVat]\r\n    color = Green\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 1 },\r\n    }\r\n}\r\n\r\n    \r\nexport class Fabricator extends Machine {\r\n    name = 'Fabricator'\r\n    description = 'you made that'\r\n    operation = recipe(\r\n        [ResourceBlock.Mineral, ResourceBlock.Mineral],\r\n         ResourceBlock.Alloy\r\n    )\r\n    size = DeviceSize.Small\r\n    color = Red\r\n    prereqs = [Workstation]\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 3 },\r\n    }\r\n    image = images.fabricator\r\n}\r\n\r\nexport class AlgaeVat extends Machine {\r\n    name = 'Algae Vat'\r\n    description = 'where there is a will'\r\n    operation = generate(ResourceBlock.Biomass)\r\n    prereqs = [ OxygenExtractor, Bookshelf, Fridge ]\r\n    size = DeviceSize.Small\r\n    color = Violet\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 2 },\r\n    }\r\n}\r\n\r\nexport class LifeSciencesConsole extends Machine {\r\n    name = 'Life Sciences Console'\r\n    description = 'mind and body together'\r\n    operation = store([ResourceBlock.Biomass, ResourceBlock.Data], 5)\r\n    prereqs = [Houseplant, Botany]\r\n    color = Green\r\n    image = images.consoleGreen\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 0.2 },\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n//\r\n// medium machines \r\n//\r\n\r\nexport class Laser extends Machine {\r\n    name = 'Laser (Defender)'\r\n    description = 'laser weapons system'\r\n    color = Red\r\n    size = DeviceSize.Medium\r\n    image = images.laser\r\n    defender = true\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 2 },\r\n    }\r\n}\r\n\r\nexport class Miner extends Machine {\r\n    name = 'Miner (Rover)'\r\n    description = 'mobile drill unit'\r\n\r\n    // gather actually takes the machine/citizen around?\r\n    operation = explore(ResourceBlock.Ore, 2)\r\n\r\n    prereqs = [MineralProcessor, MiningDrill]\r\n    color = Red\r\n    size = DeviceSize.Medium\r\n    isVehicle = true\r\n    image = images.miner\r\n}\r\n\r\nexport class MetalStorage extends Machine {\r\n    name = 'Metal Storage'\r\n    description = 'contain minerals and alloys?'\r\n    operation = store([ResourceBlock.Mineral, ResourceBlock.Alloy], 8)\r\n    prereqs = [Bookshelf]\r\n    color = Red\r\n    size = DeviceSize.Medium\r\n}\r\n\r\nexport class ResearchServer extends Machine {\r\n    name = 'Research Server'\r\n    description = 'hold data'\r\n    operation = store([ResourceBlock.Data, ResourceBlock.Algorithm], 10)\r\n    image = images.server\r\n    prereqs = [Bookshelf, Workstation]\r\n    size = DeviceSize.Medium\r\n    color = Blue\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 4 },\r\n    }\r\n}\r\n\r\nexport class Greenhouse extends Machine {\r\n   name = 'Greenhouse'\r\n   description = 'grow some food'\r\n   operation = generate(ResourceBlock.Biomass)\r\n   size = DeviceSize.Medium\r\n   prereqs = [AlgaeVat]\r\n   color = Green\r\n    forDome = true\r\n    image = images.greenhouse\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 1 },\r\n        Water: { supply: 0, demand: 1 },\r\n        Oxygen: { supply: 4, demand: 0 },\r\n    }\r\n}\r\n\r\n\r\nexport class Cabin extends Machine {\r\n   name = 'Cabin'\r\n   description = 'home on the plains'\r\n   operation = recipe(\r\n       [ ResourceBlock.Biomass, ResourceBlock.Biomass ],\r\n       ResourceBlock.Meal\r\n   )\r\n   image = images.cabin\r\n   prereqs = [Orchard]\r\n   size = DeviceSize.Medium\r\n   color = Orange\r\n    forDome = true\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 1 },\r\n        Water: { supply: 0, demand: 1 },\r\n        Shelter: { supply: 4, demand: 0 },\r\n    }\r\n}\r\n\r\nexport class Arbor extends Machine {\r\n    name = 'Arbor'\r\n    description = 'arbor around the clock'\r\n    operation = generate(ResourceBlock.Biomass)\r\n    prereqs = [Orchard]\r\n    size = DeviceSize.Medium\r\n    color = Green\r\n    forDome = true\r\n}\r\n\r\n\r\nexport class Botany extends Machine {\r\n    name = 'Botany'\r\n    description = 'plant lab'\r\n    operation = generate(ResourceBlock.Biomass)\r\n    prereqs = [ OxygenExtractor, Bookshelf ]\r\n    size = DeviceSize.Medium\r\n    color = Green\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 1 },\r\n    }\r\n}\r\n\r\n\r\nexport class MineralProcessor extends Machine {\r\n    name = 'Mineral Processor'\r\n    description = 'wheat from the chaff'\r\n    operation = recipe(\r\n        [ResourceBlock.Ore, ResourceBlock.Ore, ResourceBlock.Ore],\r\n         ResourceBlock.Mineral\r\n    )\r\n    size = DeviceSize.Medium\r\n    color = Red\r\n    image = images.minProcessor\r\n    prereqs = [Workstation, Fabricator]\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 2 },\r\n    }\r\n}\r\n\r\nexport class ThinkingFountain extends Machine {\r\n    name = 'Thinking Fountain'\r\n    description = 'slowly growing'\r\n    size = DeviceSize.Medium\r\n    prereqs = [ Mainframe, Megafabricator, MolecularEngine ]\r\n    color = Color.fromHex('daa520')\r\n    operation = generate(ResourceBlock.Aurum, 8)\r\n    cost = [ResourceBlock.Aurum]\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Wisdom: { supply: 2, demand: 0 },\r\n        Wonder: { supply: 1, demand: 0 }\r\n    }\r\n}\r\n\r\nexport class SilverForest extends Machine {\r\n    name = 'Silver Forest'\r\n    description = 'immense serenity'\r\n    size = DeviceSize.Medium\r\n    prereqs = [ Megafabricator, Mainframe ]\r\n    color = Color.fromHex('c0c0c0')\r\n    operation = store([ResourceBlock.Argent], 12)\r\n    cost = [ResourceBlock.Alloy, ResourceBlock.Algorithm]\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Beauty: { supply: 2, demand: 0 },\r\n        Wonder: { supply: 1, demand: 0 }\r\n    }\r\n    forDome = true\r\n}\r\n\r\nexport class TimeCrystal extends Machine {\r\n    name = 'Time Crystal'\r\n    description = 'xlr8'\r\n    size = DeviceSize.Medium\r\n    color = Color.fromHex('e5e4e2')\r\n    operation = accelerateTime()\r\n    cost = [ResourceBlock.Omnium]\r\n    prereqs = [ Megafabricator, SilverForest ]\r\n}\r\n\r\nexport class HoloProjector extends Machine {\r\n    name = 'Holo Projector'\r\n    description = 'whatever your heart desires'\r\n    size = DeviceSize.Medium\r\n    color = Blue\r\n    operation = generate(ResourceBlock.Data, 3)\r\n    cost = [ResourceBlock.Algorithm, ResourceBlock.Mineral]\r\n    prereqs = [ Mainframe ]\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 2 },\r\n        Joy: { supply: 3, demand: 0 },\r\n    }\r\n}\r\n\r\nexport class SacredGrove extends Machine {\r\n    name = 'Sacred Grove'\r\n    description = 'where the furies play'\r\n    size = DeviceSize.Medium\r\n    forDome = true\r\n    cost = [ ResourceBlock.Omnium ]\r\n    prereqs = [ AtomicCompiler ]\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Oxygen: { supply: 4, demand: 0 },\r\n        Wonder: { supply: 1, demand: 0 },\r\n    }\r\n}\r\n\r\nexport class AtomicCompiler extends Machine {\r\n    name = 'Atomic Compiler'\r\n    description = 'super position'\r\n    operation = recipe(\r\n        [ ResourceBlock.Aurum, ResourceBlock.Argent ],\r\n        ResourceBlock.Omnium\r\n    )\r\n    cost = [ ResourceBlock.Argent, ResourceBlock.Algorithm ]\r\n    prereqs = [ ThinkingFountain, SilverForest ]\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 3 },\r\n    }\r\n}\r\n\r\nexport class ExtropyFountain extends Machine {\r\n    name = 'Extropy Fountain'\r\n    description = 'absolute extension'\r\n    // operation = \r\n    cost = [ ResourceBlock.Mineral ]\r\n    prereqs = [ AtomicCompiler ]\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: Infinity, demand: 0 },\r\n        Wonder: { supply: 1000, demand: 0 },\r\n    }\r\n\r\n    powerEffect = true\r\n}\r\n\r\n\r\n// large devices!\r\n\r\nexport class Orchard extends Machine {\r\n   name = 'Orchard'\r\n   description = 'grow some food'\r\n   operation = generate(ResourceBlock.Biomass, 10)\r\n   size = DeviceSize.Large\r\n   prereqs = [AlgaeVat]\r\n   color = Green\r\n    forDome = true\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 1 },\r\n        Water: { supply: 0, demand: 1 },\r\n        Oxygen: { supply: 2, demand: 0 },\r\n    }\r\n}\r\n\r\n\r\nexport class MiningDrill extends Machine {\r\n    name = 'Mining Drill'\r\n    description = 'ore away'\r\n    operation = generate(ResourceBlock.Ore)\r\n    size = DeviceSize.Large\r\n    prereqs = [ Fabricator ]\r\n    image = images.miner\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 5 },\r\n    }\r\n}    \r\n\r\nexport class Megafabricator extends Machine {\r\n    name = 'Mega-Fabricator'\r\n    size = DeviceSize.Large\r\n    prereqs = [ Fabricator ]\r\n    color = Red\r\n    operation = recipe(\r\n        [ResourceBlock.Alloy, ResourceBlock.Algorithm],\r\n        ResourceBlock.Argent\r\n    )\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 8 },\r\n    }\r\n}\r\n\r\nexport class MolecularEngine extends Machine {\r\n    name = 'Molecular Engine'\r\n    size = DeviceSize.Large\r\n    prereqs = [ Megafabricator ]\r\n    color = Violet\r\n    operation = recipe(\r\n        [ResourceBlock.Bioplasma, ResourceBlock.Algorithm],\r\n        ResourceBlock.Aurum\r\n    )\r\n    image = images.megaconsole\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 3 },\r\n        Water: { supply: 0, demand: 1 },\r\n    }\r\n}\r\n\r\nexport class Mainframe extends Machine {\r\n    name = 'Mainframe'\r\n    size = DeviceSize.Large\r\n    color = Blue\r\n    prereqs = [ResearchServer]\r\n    cost = [ ResourceBlock.Mineral, ResourceBlock.Mineral ]\r\n    operation = recipe(\r\n        [ ResourceBlock.Data, ResourceBlock.Data ],\r\n        ResourceBlock.Algorithm\r\n    )\r\n    image = images.server\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Power: { supply: 0, demand: 6 },\r\n    }\r\n}\r\n\r\nexport class Preserve extends Machine {\r\n    name = 'Nature Preserve'\r\n    size = DeviceSize.Large\r\n    prereqs = [ Arbor ]\r\n    color = Green\r\n    forDome = true\r\n    operation = generate(ResourceBlock.Biomass, 12)\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Water: { supply: 0, demand: 4 },\r\n        Oxygen: { supply: 12, demand: 0 },\r\n    }\r\n}\r\n\r\nexport class LogicPool extends Machine {\r\n    name = 'Logic Pool'\r\n    size = DeviceSize.Large\r\n    prereqs = [ MolecularEngine ]\r\n    color = Color.fromHex('daa520')\r\n    operation = store([ResourceBlock.Aurum], 12)\r\n    cost = [ResourceBlock.Algorithm, ResourceBlock.Bioplasma]\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Wisdom: { supply: 2, demand: 0 },\r\n        Wonder: { supply: 1, demand: 0 }\r\n    }\r\n}\r\n\r\nexport class Cathedral extends Machine {\r\n    name = 'Cathedral'\r\n    description = 'first ultrahumanist'\r\n    size = DeviceSize.Large\r\n    prereqs = [ SacredGrove ]\r\n}\r\n\r\n\r\n/// huge devices\r\n\r\nexport class Microcity extends Machine {\r\n    name = 'Microcity'\r\n    size = DeviceSize.Huge\r\n    prereqs = [ Megafabricator ]\r\n    color = Orange\r\n    forDome = true\r\n    economy = {\r\n        ...emptyMarket(),\r\n        Water: { supply: 0, demand: 2 },\r\n        Power: { supply: 0, demand: 2 },\r\n        Joy: { supply: 5, demand: 0 },\r\n        Hope: { supply: 5, demand: 0 },\r\n        Beauty: { supply: 1, demand: 0 },\r\n        Wonder: { supply: 1, demand: 0 },\r\n    }\r\n}\r\n\r\nexport class LogicCrystal extends Machine {\r\n    name = 'Logic Crystal'\r\n    size = DeviceSize.Huge\r\n    prereqs = [ Megafabricator ]\r\n    color = Blue\r\n}\r\n\r\n// export class MiniSun extends Machine {}\r\n\r\nexport const allMachines: (typeof Machine)[] = [\r\n    AlgaeVat,\r\n    Arbor,\r\n    Bed,\r\n    Bookshelf,\r\n    Cabin,\r\n    CloningVat,\r\n    // Desk,\r\n    Fabricator,\r\n    Fridge,\r\n    Houseplant,\r\n    Megafabricator,\r\n    MiningDrill,\r\n    Orchard,\r\n    OxygenExtractor,\r\n    Preserve,\r\n    ResearchServer,\r\n    SolarCell,\r\n    Stove,\r\n    WaterCondensingMachine,\r\n    Workstation,\r\n    Microcity,\r\n    LogicCrystal,\r\n    Botany,\r\n\r\n    MineralProcessor,\r\n    PlasmaBank,\r\n    DissolutionVat,\r\n    MetalStorage,\r\n    Mainframe,\r\n\r\n    PersonnelRegistry,\r\n    MolecularEngine,\r\n    ThinkingFountain,\r\n    SilverForest,\r\n\r\n    OrientationConsole,\r\n    LifeSciencesConsole,\r\n\r\n    TimeCrystal,\r\n    LogicPool,\r\n    HoloProjector,\r\n    Cathedral,\r\n    SacredGrove,\r\n    AtomicCompiler,\r\n\r\n    Couch,\r\n    Statue,\r\n    Codex,\r\n\r\n    Table,\r\n    LavaLamp,\r\n\r\n    Figurine,\r\n\r\n    Miner,\r\n    Orrery,\r\n    Telescope,\r\n    Books,\r\n\r\n    ExtropyFountain,\r\n\r\n    Laser,\r\n]","\r\nexport enum Orientation { Left, Up, Right, Down } //, Angle }\r\n\r\nexport const compass = [\r\n    Orientation.Left,\r\n    Orientation.Right,\r\n    Orientation.Up,\r\n    Orientation.Down,\r\n]\r\n\r\n\r\nexport function flip(orientation: Orientation): Orientation {\r\n    switch (orientation) {\r\n        case Orientation.Left: return Orientation.Right\r\n        case Orientation.Right: return Orientation.Left\r\n        case Orientation.Up: return Orientation.Down\r\n        case Orientation.Down: return Orientation.Up\r\n    }\r\n    throw new Error(`Don't know orientation ${ orientation }`)\r\n}","import { Color } from \"excalibur\";\r\n\r\n// an abstract/intangible thing (or at least something we don't represent)\r\nexport enum PureValue {\r\n    Power = 'Power',\r\n    Oxygen = 'Oxygen',\r\n    Water = 'Water',\r\n    Shelter = 'Shelter',\r\n    Hope = 'Hope',\r\n    Joy = 'Joy',\r\n    Wisdom = 'Wisdom',\r\n    Wealth = 'Wealth',\r\n    Beauty = 'Beauty',\r\n    Wonder = 'Wonder'\r\n}\r\n\r\nexport const allValues: PureValue[] = [\r\n    PureValue.Power,\r\n    PureValue.Oxygen,\r\n    PureValue.Water,\r\n    PureValue.Shelter,\r\n    PureValue.Hope,\r\n    PureValue.Joy,\r\n    PureValue.Wisdom,\r\n    PureValue.Wealth,\r\n    PureValue.Beauty,\r\n    PureValue.Wonder\r\n]\r\n\r\nexport type Economy = { [key in PureValue]: {\r\n    supply: number,\r\n    demand: number\r\n} }\r\n\r\nexport function emptyMarket() : Economy {\r\n    return {\r\n        Power: { supply: 0, demand: 0 },\r\n        Oxygen: { supply: 0, demand: 0 },\r\n        Water: { supply: 0, demand: 0 },\r\n        Shelter: { supply: 0, demand: 0 },\r\n        Hope: { supply: 0, demand: 0 },\r\n        Joy: { supply: 0, demand: 0 },\r\n        Wealth: { supply: 0, demand: 0 },\r\n        Wisdom: { supply: 0, demand: 0 },\r\n        Beauty: { supply: 0, demand: 0 },\r\n        Wonder: { supply: 0, demand: 0 },\r\n    }\r\n}\r\n\r\nexport function availableCapacity(market: Economy, value: PureValue) {\r\n    return Math.floor(market[value].supply - market[value].demand)\r\n}\r\n\r\nexport const sumMarkets: (ea: Economy, eb: Economy) => Economy = (ea, eb) => {\r\n    let newMarket = emptyMarket();\r\n    for (let value in PureValue) {\r\n        let { supply: sa, demand: da } = ea[value]\r\n        let { supply: sb, demand: db } = eb[value]\r\n        let supply = sa + sb\r\n        let demand = da + db\r\n        newMarket[value] = {\r\n            supply,\r\n            demand,\r\n        }\r\n    }\r\n    return newMarket\r\n}\r\n\r\nexport const equilibrium: (e: Economy) => boolean = (e) => {\r\n    return allValues.every(value => availableCapacity(e, value) >= 0)\r\n}\r\n\r\nexport enum ResourceBlock {\r\n    // base\r\n    Biomass = 'Biomass',\r\n    Ore = 'Ore',\r\n    Idea = 'Idea',\r\n\r\n    // derived\r\n    Meal = 'Meal',\r\n    Data = 'Data',\r\n    Mineral = 'Mineral',\r\n    Bioplasma = 'Bioplasma',\r\n\r\n    // higher-order\r\n    Alloy = \"Alloy\",\r\n    Algorithm = \"Algorithm\",\r\n\r\n    // superb\r\n    Argent = \"Argent\",\r\n    Aurum = \"Aurum\",\r\n\r\n    // hyperbolic\r\n    Omnium = \"Omnium\",\r\n}\r\n\r\nlet cStep = 0.3\r\nconst blockColors: { [key in ResourceBlock]: Color } = {\r\n    Biomass: Color.Green,\r\n    Data: Color.Blue.lighten(cStep),\r\n    Mineral: Color.Red,\r\n\r\n    Meal: Color.Yellow.darken(cStep),\r\n    Idea: Color.Blue.lighten(cStep*2), //.desaturate(cStep),\r\n    Ore: Color.Red.darken(cStep),\r\n\r\n    Bioplasma: Color.Viridian,\r\n\r\n    Alloy: Color.DarkGray.darken(cStep), //(cStep),\r\n    Algorithm: Color.Blue.darken(cStep), //.desaturate(cStep),\r\n\r\n    Argent: Color.Gray.lighten(cStep),\r\n    Aurum: Color.Orange.lighten(cStep),\r\n\r\n    Omnium: Color.White,\r\n}\r\n\r\nexport function blockColor(block: ResourceBlock) {\r\n    let baseColor = blockColors[block]\r\n    return baseColor.desaturate(0.1) //.lighten(0.1) //.desaturate(0.25).lighten(0.125)\r\n}\r\n\r\n","import { Actor, Vector, CollisionType, Color, Label, Traits, FontStyle } from \"excalibur\";\r\nimport { Planet } from \"../Planet/Planet\";\r\nimport { Structure, } from \"../../models/Structure\";\r\nimport { Slot } from \"../../values/Slot\";\r\nimport { Orientation, flip, compass } from \"../../values/Orientation\";\r\nimport { Game } from \"../../Game\";\r\nimport { Rectangle } from \"../../values/Rectangle\";\r\nimport { closest, measureDistance, deleteByValue, containsUniq, flatSingle } from \"../../Util\";\r\nimport { Graph } from \"../../values/Graph\";\r\nimport { ResourceBlock, emptyMarket, Economy, sumMarkets, equilibrium, allValues, availableCapacity } from \"../../models/Economy\";\r\nimport { Device } from \"../Device\";\r\nimport { allSpaceFunctions, RoomRecipe } from \"../../models/RoomRecipe\";\r\nimport { DeviceSize, getVisibleDeviceSize } from \"../../values/DeviceSize\";\r\nimport { World } from \"../../models/World\";\r\nimport { Machine, allMachines, CommandCenter, MissionLog, StudyMachine } from \"../../models/Machine\";\r\nimport { BackgroundPattern } from \"./BackgroundPatterns\";\r\nimport { EconomicValue } from \"../Hud/EconomicValue\";\r\nimport { drawRect, pathFromRect } from \"../../Painting\";\r\nimport { Scale } from \"../../values/Scale\";\r\n\r\nexport class DevicePlace {\r\n    constructor(private pos: Vector, private size: DeviceSize) {}\r\n    get position() { return this.pos }\r\n    get visibleSize() { return getVisibleDeviceSize(this.size) }\r\n\r\n}\r\n\r\nexport class Building extends Actor {\r\n    edgeWidth: number = 0\r\n\r\n    nameLabel: Label\r\n\r\n    placed: boolean = false\r\n    hover: boolean = false\r\n    showLabel: boolean = false\r\n    facing: Orientation = Orientation.Right\r\n    hideBox: boolean = false\r\n    parentSlot: Slot\r\n    childrenBuildings: Building[] = []\r\n\r\n    spaceFunction: RoomRecipe\r\n\r\n    private devices: Device[] = []\r\n    givenName: string\r\n\r\n\r\n    private active: boolean = true\r\n    // private built: boolean = false\r\n\r\n    constructor(pos: Vector, public structure: Structure, public planet: Planet) {\r\n        super(\r\n          pos.x,\r\n          pos.y,\r\n          structure.width,\r\n          structure.height,\r\n          structure.infra ? planet.color.darken(0.3) : Color.Transparent\r\n        )\r\n        this.anchor = new Vector(0,0)\r\n\r\n        this.setup();\r\n        this.traits = this.traits.filter(trait => !(trait instanceof Traits.OffscreenCulling))\r\n\r\n        // this.on('pointerenter', () => {\r\n        //     this.hover = true\r\n        //     if (!this.devices.some(d => d.hover)) {\r\n        //         this.planet.currentlyViewing = this\r\n        //     }\r\n        // })\r\n\r\n\r\n        // this.on('pointerdown', () => {\r\n        //     // console.log(\"CLICKED BUILDING\", { building: this })\r\n        //     this.toggleActive();\r\n        // })\r\n\r\n        // this.on('pointerleave', () => {\r\n        //     this.hover = false\r\n        // })\r\n\r\n        this.collisionType = CollisionType.Passive\r\n\r\n        this.nameLabel = new Label(this.structure.name, 0, 0, Game.font) // 'Helvetica')\r\n        this.nameLabel.fontSize = 9\r\n        // this.nameLabel.fontStyle = FontStyle.Italic\r\n        this.nameLabel.color = Color.White\r\n\r\n\r\n        if (this.structure.infra) { this.active = true }\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        if (!this.hideBox) {\r\n            drawRect(ctx, this.aabb(), this.processedColor())\r\n        }\r\n        super.draw(ctx, delta)\r\n\r\n        if (this.showLabel && this.spaceFunction) {\r\n            this.nameLabel.pos = this.pos.add(\r\n                new Vector(this.getWidth()/2 - this.nameLabel.getTextWidth(ctx)/2, 0)\r\n            )\r\n            this.nameLabel.draw(ctx, delta)\r\n        }\r\n\r\n        if (this.debugGraph) {\r\n            if (this.slots().length > 0) {\r\n                // draw slots\r\n                this.slots().forEach((slot: Slot) => {\r\n                    let rect: Rectangle = { x: slot.pos.x, y: slot.pos.y, width: 3, height: 3 }\r\n                    drawRect(ctx, rect, Color.Gray.lighten(0.5))\r\n                })\r\n            }\r\n            if (this.nodes().length > 0) {\r\n                // draw nodes\r\n                this.nodes().forEach((node: Vector) => {\r\n                    let rect: Rectangle = { x: node.x, y: node.y, width: 4, height: 4 }\r\n                    drawRect(ctx, rect, Color.Yellow.lighten(0.5))\r\n                })\r\n            }\r\n        }\r\n\r\n        let showDevicePlaces = this.debugGraph\r\n        if (showDevicePlaces && this.devicePlaces().length > 0 && this.devices.length < this.devicePlaces().length) {\r\n            this.devicePlaces().forEach(p => {\r\n                let place = p.position\r\n                let sz = p.visibleSize\r\n                drawRect(ctx,\r\n                    { x: place.x - sz/2, y: place.y - sz/2, width: sz, height: sz },\r\n                    // 0.1,\r\n                    Color.White,\r\n                    false,\r\n                    true\r\n                )\r\n            })\r\n        }\r\n    }\r\n\r\n\r\n    debugGraph: boolean = false\r\n    step: number = 0\r\n    update(engine: Game, delta: number) {\r\n        super.update(engine, delta)\r\n\r\n        let tryProduce = this.placed;\r\n        if (tryProduce) {\r\n            this.devices.forEach(device => {\r\n                device.tryProduce(this.step)\r\n                if(device.tinyDevices.length > 0) {\r\n                    device.tinyDevices.forEach(tinyDevice => tinyDevice.tryProduce(this.step))\r\n                }\r\n            });\r\n\r\n        }\r\n\r\n        this.step += 1\r\n\r\n        if (engine.debugMode) {\r\n            this.debugGraph = true\r\n        } else {\r\n            this.debugGraph = false\r\n        }\r\n    }\r\n\r\n\r\n    poly() { return this.aabbPoly() }\r\n\r\n\r\n    get name() {\r\n        if (this.spaceFunction) {\r\n            return this.spaceFunction.name\r\n        } else {\r\n            return this.structure.name\r\n        }\r\n    }\r\n\r\n    get description() {\r\n        if (this.spaceFunction) {\r\n            return this.spaceFunction.description\r\n        } else {\r\n            return this.structure.description\r\n        }\r\n    }\r\n\r\n    get floorY() {\r\n        return this.pos.y + this.getHeight() //().y\r\n    }\r\n\r\n    economy(emptyUnlessActive: boolean = true): Economy {\r\n        if (emptyUnlessActive && !this.isActive) {\r\n            return emptyMarket()\r\n        } else {\r\n            let machineEconomies = this.devices.map(d => d.economy)\r\n            //machine.economy)\r\n\r\n            let buildingEconomy = {\r\n                ...emptyMarket(),\r\n                Oxygen: { demand: 1, supply: 0 }, // structural demand\r\n                // Water: { demand: 0.1, supply: 0 },\r\n            }\r\n\r\n            let aggregate = [...machineEconomies, buildingEconomy]\r\n                .reduce(sumMarkets, emptyMarket())\r\n\r\n            return aggregate\r\n        }\r\n    }\r\n\r\n    // private toggleActive() {\r\n    //     if (!this.structure.infra) {\r\n    //         if (this.active) {\r\n    //             if (this.devices.some(d => d.inUse)) { return }\r\n    //             let wasEquil = equilibrium(this.planet.economy)\r\n    //             this.active = false\r\n    //             if (wasEquil) {\r\n    //                 if (!equilibrium(this.planet.economy)) {\r\n    //                     this.active = true\r\n    //                     // return\r\n    //                 }\r\n    //                 // this.active = true\r\n    //             } else {\r\n    //                 // we weren't at equilibrium previously\r\n    //                 // permit it, if we don't have any supply that would go negative without us?\r\n    //                 // console.log(\"can we toggle?\")\r\n    //                 for (let value of allValues) {\r\n    //                     let localCap = availableCapacity(this.economy(false), value)\r\n    //                     let globalCap = availableCapacity(this.planet.economy, value)\r\n    //                     // console.log(\"value\", { value, localCap, globalCap})\r\n    //                     if (localCap > 0 && globalCap < 0) {\r\n    //                         // don't permit it to be turned off\r\n    //                         this.active = true\r\n    //                     }\r\n    //                 }\r\n    //             }\r\n    //         } else { // this.active is false now\r\n    //             let agg = [\r\n    //                 this.planet.economy,\r\n    //                 this.economy(false)\r\n    //             ].reduce(sumMarkets, emptyMarket())\r\n\r\n    //             if (equilibrium(agg)) {\r\n    //                 this.active = true\r\n    //             }\r\n    //         }\r\n    //     }\r\n    // }\r\n\r\n    get isActive() { return !!this.active }\r\n\r\n\r\n    setup(): void { }\r\n\r\n    constrainCursor(cursor: Vector): Vector {\r\n        return cursor.clone();\r\n    }\r\n    reshape(cursor: Vector): void {\r\n        // this.pos = cursor.clone()\r\n        this.alignToSlot(cursor)\r\n    }\r\n\r\n    afterConstruct(): void {}\r\n\r\n    handleClick(_pos): boolean { return true; }\r\n\r\n    slots(): Slot[] {\r\n        return []\r\n    }\r\n\r\n    nodes(): Vector[] {\r\n        let x = this.pos.x + this.getWidth()/2;\r\n        let y = this.pos.y + this.getHeight()\r\n        return [\r\n            new Vector(Math.floor(x), Math.floor(y))\r\n        ];\r\n    }\r\n\r\n    devicePlaces(): DevicePlace[] {\r\n        return []; //this.nodes();\r\n    }\r\n\r\n    deviceInteractionPlaces(): Vector[] {\r\n        return this.devicePlaces().map(place => {\r\n            place.position.y += (place.visibleSize/2)\r\n            return place.position\r\n        })\r\n    }\r\n\r\n    graph(supergraph: Graph<Vector> = new Graph()): Graph<Vector> {\r\n        let g = supergraph\r\n        // assemble subgraph\r\n        let nodes = this.nodes()\r\n        let rootNode = g.findOrCreate(nodes[0], measureDistance)\r\n        for (let child of this.childrenBuildings) {\r\n            let slot = g.findOrCreate(child.parentSlot.pos, measureDistance)\r\n            g.edge(rootNode, slot)\r\n\r\n            let childNode = g.findOrCreate(child.nodes()[0], measureDistance)\r\n            g.edge(slot, childNode)\r\n\r\n            child.graph(g)\r\n        }\r\n        return g\r\n    }\r\n\r\n    // just a patch through to planet -- but could animate something here?\r\n    public redeem(res: ResourceBlock) {\r\n        this.planet.gather(res)\r\n    }\r\n\r\n    public debit(res: ResourceBlock) {\r\n        this.planet.spend(res)\r\n    }\r\n\r\n    public populate(pos: Vector, elite: boolean = false) {\r\n        this.planet.populate(pos, elite) //this.pos)\r\n    }\r\n\r\n    protected aabb(): Rectangle {\r\n        return {\r\n            x: this.pos.x,\r\n            y: this.pos.y,\r\n            width: this.getWidth(),\r\n            height: this.getHeight()\r\n        }\r\n    }\r\n\r\n    protected aabbPoly(): {x:number,y:number}[] {\r\n        return pathFromRect(this.aabb());\r\n\r\n    }\r\n\r\n    protected angledRoofPoly(): {x: number, y: number}[] {\r\n        let angleStartY = 1 * (this.getHeight() / 3) - 3\r\n        let angleStartX = (Scale.major.first) // 1 * (this.getWidth() / 10)\r\n        return [\r\n            // bottom-left\r\n            { x: this.pos.x, y: this.pos.y + this.getHeight() },\r\n\r\n            // upper-left\r\n            { x: this.pos.x, y: this.pos.y + angleStartY },\r\n            { x: this.pos.x + angleStartX, y: this.pos.y },\r\n\r\n            // upper-right\r\n            { x: this.pos.x + this.getWidth() - angleStartX, y: this.pos.y },\r\n            { x: this.pos.x + this.getWidth(), y: this.pos.y + angleStartY },\r\n\r\n            // bottom-right\r\n            { x: this.pos.x + this.getWidth(), y: this.pos.y + this.getHeight() },\r\n        ]\r\n            \r\n    }\r\n\r\n    protected overlaps(other: Building): boolean {\r\n        let rect1 = this.aabb(), rect2 = other.aabb();\r\n        let doesOverlap = (\r\n            rect1.x < rect2.x + rect2.width &&\r\n            rect1.x + rect1.width > rect2.x &&\r\n            rect1.y < rect2.y + rect2.height &&\r\n            rect1.y + rect1.height > rect2.y\r\n        )\r\n        return(!!doesOverlap);\r\n    }\r\n\r\n    public overlapsAny(): boolean {\r\n        return !!this.planet.colony.buildings.find(bldg => bldg !== this && this.overlaps(bldg))\r\n    }\r\n\r\n    protected edgeColor(): Color {\r\n        let edge = this.processedColor().lighten(0.85);\r\n        return edge;\r\n    }\r\n\r\n    protected mainColor(): Color {\r\n        let main = this.processedColor().darken(0.08);\r\n        return main;\r\n    }\r\n\r\n    protected colorBase(): Color {\r\n        return this.color;\r\n    }\r\n\r\n    protected processedColor(): Color {\r\n        let clr = this.colorBase().clone();\r\n        if (!this.placed)  { \r\n            if (this.overlapsAny()) { clr = Color.Red }\r\n            clr.a = 0.8\r\n        }\r\n        if (!this.active) {\r\n            clr = clr.darken(0.8)\r\n        }\r\n\r\n        if (this.hover) { clr.a = 0.5 }\r\n        return clr;\r\n    }\r\n\r\n    get connections() {\r\n        return this.structure.connections;\r\n    }\r\n\r\n\r\n    protected findSlot(\r\n        pos: Vector,\r\n        validConnections: { [key in Orientation]: (typeof Structure)[] } = this.connections\r\n    ): Slot {\r\n        let slotList = []\r\n            for (let dir of compass) {\r\n                const validStructures = validConnections[dir];\r\n                let flipped = flip(dir)\r\n                const buildings = validStructures.map(structure =>\r\n                    this.planet.closestBuildingByType(pos, [structure])\r\n                )\r\n                buildings.forEach(building => {\r\n                    if (building) {\r\n                        let neighborSlots = building.slots()\r\n                        neighborSlots.filter(slot => slot.facing === flipped)\r\n                        .forEach(matchingSlot => {\r\n                            slotList.push(matchingSlot)\r\n                        })\r\n                    }\r\n                })\r\n            }\r\n\r\n        if (slotList.length > 0) {\r\n            return closest(pos, slotList, (slot) => slot.pos)\r\n        } else {\r\n            // console.warn('no conecting structures found')\r\n        }\r\n    }\r\n\r\n    protected alignToSlot(\r\n        cursor: Vector,\r\n        validConnections: { [key in Orientation]: (typeof Structure)[] } = this.connections\r\n    ) {\r\n        let theSlot = this.findSlot(cursor, validConnections)\r\n        if (theSlot) {\r\n            let matchingSlot = this.slots()\r\n                .find(s => s.facing == flip(theSlot.facing))\r\n            if (matchingSlot) {\r\n                let offset = theSlot.pos.sub(matchingSlot.pos)\r\n                this.pos.addEqual(offset)\r\n\r\n                this.parentSlot = theSlot;\r\n                return theSlot;\r\n            }\r\n        }\r\n    }\r\n\r\n    protected buildSlot(x: number, y: number, facing: Orientation = Orientation.Right): Slot {\r\n        return {\r\n            pos: new Vector(x,y),\r\n            facing,\r\n            parent: this\r\n        }\r\n    }\r\n\r\n    public addDevice(device: Device) {\r\n        // device.finalize()\r\n        if (device.building !== this) {\r\n            device.building = this\r\n        }\r\n        this.devices.push(device)\r\n        device.pos.subEqual(this.pos) // = this.devicePlaces()[0].position\r\n        // console.log(\"DEVICE IS AT\", { pos: device.pos })\r\n        this.add(device)\r\n        this.updateFunction()\r\n        device.machine.onPlacement(device)\r\n        // this.toggleActive()\r\n\r\n        device.placed = true\r\n    }\r\n\r\n    public hasPlaceForDevice() {\r\n        return this.devices.length < this.devicePlaces().length\r\n    }\r\n\r\n    public nextDevicePlace(): DevicePlace {\r\n        // could throw an err if we have no place\r\n        return this.devicePlaces()[\r\n            this.devices.length\r\n        ]\r\n    }\r\n\r\n    public getDevices() {\r\n        return [ ...this.devices, ...flatSingle(this.devices.map(d => d.tinyDevices)) ]\r\n    }\r\n\r\n    public updateFunction() {\r\n        let allTheMachines = [ StudyMachine, ...allMachines, CommandCenter, MissionLog ]\r\n        let machines = this.devices.map(\r\n            d => allTheMachines.find((m: typeof Machine) => d.machine instanceof m)\r\n        )\r\n        let fn = allSpaceFunctions.find(spaceFn => {\r\n            let sf = new spaceFn()\r\n\r\n            return containsUniq(\r\n              machines,\r\n              sf.machines\r\n            );\r\n        })\r\n        if (fn) {\r\n            // console.log(\"Determined building function\", { fn })\r\n            let sf = new fn()\r\n            this.spaceFunction = sf\r\n            this.nameLabel.text = sf.name\r\n        } else {\r\n            // console.warn(\"Could not identify function!\")\r\n        }\r\n    }\r\n\r\n    get backgroundPattern() {\r\n        if (this.spaceFunction) {\r\n            return this.spaceFunction.background\r\n        } else {\r\n            return BackgroundPattern.Grid\r\n        }\r\n    }\r\n}","import { Vector, Color } from \"excalibur\";\r\nimport { Rectangle } from \"./values/Rectangle\";\r\nimport { BackgroundPattern, getBackgroundPattern } from \"./actors/Building/BackgroundPatterns\";\r\nimport { Game } from \"./Game\";\r\n\r\ntype PaintingPath = { x: number, y: number }[]\r\n\r\nexport function pathFromRect(rect: Rectangle): PaintingPath {\r\n  let pos = { x: rect.x, y: rect.y }\r\n  let path = [\r\n            // bottom-left\r\n            { x: pos.x, y: pos.y + rect.height }, // this.getHeight() },\r\n\r\n            // upper-left\r\n            { x: pos.x, y: pos.y },\r\n\r\n            // upper-right\r\n            { x: pos.x + rect.width, y: pos.y },\r\n\r\n            // bottom-right\r\n            { x: pos.x + rect.width, y: pos.y + rect.height },\r\n        ];\r\n\r\n  return path\r\n}\r\n\r\n// tiny rendering lib\r\nexport function drawLine(ctx: CanvasRenderingContext2D, a: Vector, b: Vector, clr: Color = Color.White, lineWidth: number = 1) {\r\n  ctx.save()\r\n  let c = clr.clone()\r\n  // c.a = 0.5\r\n  ctx.beginPath()\r\n  ctx.moveTo(a.x, a.y)\r\n  ctx.lineTo(b.x, b.y)\r\n  ctx.strokeStyle = c.toRGBA()\r\n  ctx.lineWidth = lineWidth\r\n  ctx.closePath()\r\n  ctx.stroke()\r\n  // ctx.lineWidth = 1\r\n  ctx.restore()\r\n}\r\n\r\nexport function drawPatternedRect(\r\n  ctx: CanvasRenderingContext2D,\r\n  rect: Rectangle,\r\n  pattern: BackgroundPattern = BackgroundPattern.Grid\r\n) {\r\n  const gridPattern = getBackgroundPattern(ctx, pattern)\r\n  if (gridPattern) {\r\n    drawPatternedPoly(ctx, pathFromRect(rect), pattern)\r\n\r\n  }\r\n}\r\n\r\nexport function drawPatternedPoly(\r\n  ctx: CanvasRenderingContext2D,\r\n  path: {x:number, y:number}[],\r\n  // rect: Rectangle,\r\n  pattern: BackgroundPattern = BackgroundPattern.Grid,\r\n  edgeColor: Color = Color.Black\r\n) {\r\n  const gridPattern = getBackgroundPattern(ctx, pattern)\r\n  if (gridPattern) {\r\n    ctx.save()\r\n    ctx.translate(path[0].x, path[0].y)\r\n    // ctx.moveTo(0, 0)\r\n    ctx.beginPath()\r\n    ctx.moveTo(0,0) //path[0].x, path[0].y)\r\n    path.forEach(pt => ctx.lineTo(pt.x - path[0].x, pt.y-path[0].y))\r\n    ctx.lineTo(0,0) // path[0].x, path[0].y)\r\n    ctx.closePath()\r\n    // let { x, y, width, height } = rect;\r\n    ctx.fillStyle = gridPattern\r\n    ctx.fill()\r\n\r\n\r\n    ctx.strokeStyle = edgeColor.fillStyle()\r\n    ctx.stroke()\r\n    ctx.restore()\r\n    // ctx.fillRect(x,y,width,height)\r\n\r\n    // ctx.lineWidth = 2\r\n    // ctx.setLineDash([])\r\n    // ctx.strokeStyle = Color.White.toRGBA()\r\n    // ctx.strokeRect(x,y,width,height)\r\n  }\r\n}\r\n\r\nexport function drawRect(\r\n  ctx: CanvasRenderingContext2D,\r\n  rectangle: Rectangle,\r\n  color: Color = Color.White,\r\n  filled: boolean = true,\r\n  dashed: boolean = false\r\n) {\r\n  let { x, y, width, height } = rectangle;\r\n\r\n  if (filled) {\r\n    let main = color.clone();\r\n    // main.a = 1\r\n    ctx.fillStyle = main.toRGBA();\r\n    ctx.fillRect(\r\n      x,\r\n      y,\r\n      width,\r\n      height\r\n    )\r\n  }\r\n\r\n  //if (edgeWidth > 0) {\r\n  //  let edge = Color.White.clone();\r\n  //  ctx.strokeStyle = edge.toRGBA();\r\n  //  ctx.lineWidth=edgeWidth\r\n  //  if (dashed) { ctx.setLineDash([5, 10]) }\r\n  //  else { ctx.setLineDash([]) }\r\n  //  ctx.strokeRect(\r\n  //    x, y, width, height\r\n  //  )\r\n  //}\r\n}\r\n\r\nexport function drawPoly(\r\n  ctx: CanvasRenderingContext2D,\r\n  path: {x:number, y:number}[],\r\n  color: Color\r\n  // rect: Rectangle,\r\n  // pattern: BackgroundPattern = BackgroundPattern.Grid\r\n) {\r\n  // const gridPattern = getBackgroundPattern(ctx, pattern)\r\n  // if (gridPattern) {\r\n    ctx.beginPath()\r\n    ctx.moveTo(path[0].x, path[0].y)\r\n    path.forEach(pt => ctx.lineTo(pt.x, pt.y))\r\n    ctx.lineTo(path[0].x, path[0].y)\r\n    ctx.closePath()\r\n    // let { x, y, width, height } = rect;\r\n    ctx.fillStyle = color.fillStyle()\r\n    ctx.fill()\r\n    // ctx.fillRect(x,y,width,height)\r\n\r\n    // ctx.lineWidth = 2\r\n    // ctx.setLineDash([])\r\n    // ctx.strokeStyle = Color.White.toRGBA()\r\n    // ctx.strokeRect(x,y,width,height)\r\n  // }\r\n}\r\n\r\nexport function drawStar(ctx, cx, cy, outerRadius=3.6, innerRadius=1.4, spikes=5, ) {\r\n    var rot = Math.PI / 2 * 3;\r\n    var x = cx;\r\n    var y = cy;\r\n    var step = Math.PI / spikes;\r\n\r\n    ctx.beginPath();\r\n    ctx.moveTo(cx, cy - outerRadius)\r\n    for (let i = 0; i < spikes; i++) {\r\n        x = cx + Math.cos(rot) * outerRadius;\r\n        y = cy + Math.sin(rot) * outerRadius;\r\n        ctx.lineTo(x, y)\r\n        rot += step\r\n\r\n        x = cx + Math.cos(rot) * innerRadius;\r\n        y = cy + Math.sin(rot) * innerRadius;\r\n        ctx.lineTo(x, y)\r\n        rot += step\r\n    }\r\n    ctx.lineTo(cx, cy - outerRadius);\r\n    ctx.closePath();\r\n    ctx.lineWidth = 1;\r\n    ctx.strokeStyle = 'yellow';\r\n    ctx.stroke();\r\n    ctx.fillStyle = 'yellow';\r\n    ctx.fill();\r\n}\r\n\r\nexport function drawCircle(ctx, cx, cy: number, radius: number, color: Color, hemi=false) {\r\n  let theta = hemi ? Math.PI : (2 * Math.PI)\r\n  ctx.beginPath()\r\n\r\n  ctx.arc(\r\n    cx,\r\n    cy, //this.getHeight(),\r\n    radius,\r\n    0,\r\n    theta,\r\n    true\r\n  )\r\n  ctx.closePath()\r\n\r\n  ctx.fillStyle = color.toRGBA()\r\n  ctx.fill()\r\n}\r\n\r\nexport function drawEllipse(ctx: CanvasRenderingContext2D, cx, cy, radiusX: number, radiusY: number, color: Color, hemi=false) {\r\n  let theta = hemi ? Math.PI : (2 * Math.PI)\r\n  ctx.beginPath()\r\n\r\n  ctx.ellipse(\r\n    cx,\r\n    cy, //this.getHeight(),\r\n    radiusX,\r\n    radiusY,\r\n    0,\r\n    0,\r\n    theta,\r\n    // true\r\n  )\r\n  ctx.closePath()\r\n\r\n  ctx.fillStyle = color.toRGBA()\r\n  ctx.fill()\r\n}\r\n\r\nexport function drawText(ctx: CanvasRenderingContext2D, msg: string, tx: number, ty: number) {\r\n  ctx.font = `5pt ${Game.font}`\r\n  ctx.fillStyle = Color.White.toRGBA()\r\n  ctx.fillText(msg, tx, ty)\r\n}","import { Actor, Label, Color, Vector, CollisionType, ParticleEmitter, Traits, Timer } from \"excalibur\";\r\nimport { Machine } from \"../models/Machine\";\r\nimport { Building } from \"./Building\";\r\nimport { ResourceBlock, blockColor, emptyMarket, sumMarkets } from \"../models/Economy\";\r\nimport { Citizen } from \"./Citizen\";\r\nimport { Planet } from \"./Planet/Planet\";\r\nimport { allStructures } from \"../models/Structure\";\r\nimport { getVisibleDeviceSize, DeviceSize } from \"../values/DeviceSize\";\r\nimport { Recipe, ResourceStorage, MechanicalOperation, ResourceGenerator, ExploreForResource } from \"../models/MechanicalOperation\";\r\nimport { range, deleteByValueOnce, closest, sample, sleep } from \"../Util\";\r\nimport { drawRect } from \"../Painting\";\r\nimport { InteractionRequest, retrieveResource } from \"../values/InteractionRequest\";\r\nimport { Game } from \"../Game\";\r\nimport { Rectangle } from \"../values/Rectangle\";\r\nimport { makeEmitter } from \"./EmitterFactory\";\r\nimport { Orientation } from \"../values/Orientation\";\r\nimport { LaserBeam } from \"./LaserBeam\";\r\nimport { Scale } from \"../values/Scale\";\r\n\r\nexport class Device extends Actor {\r\n    // constructionMaterials: ResourceBlock[] = []\r\n\r\n    // could also use for storage?\r\n    product: ResourceBlock[] = []\r\n    nameLabel: Label\r\n    image: HTMLImageElement\r\n    building: Building\r\n    inUse: boolean = false\r\n    hover: boolean = false\r\n\r\n    imageLoaded: boolean = false\r\n\r\n    built: boolean = false\r\n    reserved: boolean = false\r\n\r\n    private emitter: ParticleEmitter = null\r\n\r\n    orientation: Orientation = Orientation.Right\r\n\r\n    constructor(\r\n        public machine: Machine,\r\n        initialPos: Vector\r\n    ) {\r\n        super(\r\n            initialPos.x,\r\n            initialPos.y,\r\n            getVisibleDeviceSize(machine.size),\r\n            getVisibleDeviceSize(machine.size),\r\n            Color.Transparent\r\n            // machine.color\r\n        )\r\n\r\n        this.traits = this.traits.filter(trait => !(trait instanceof Traits.OffscreenCulling))\r\n\r\n        this.nameLabel = new Label(this.machine.name, 0, 0, Game.font) // 'Helvetica')\r\n        this.nameLabel.fontSize = this.machine.size === DeviceSize.Tiny ? 2 : 6\r\n        this.nameLabel.color = Color.White\r\n\r\n        this.image = new Image();\r\n        this.image.onload = () => { this.imageLoaded = true }\r\n        this.image.src = machine.image\r\n\r\n        // this.on('pointerenter', () => {\r\n        //     // console.log(\"HOVER OVER\", { machine: this.machine })\r\n        //     let tinyDevices = this.tinyDevices.length > 0 &&\r\n        //       this.tinyDevices.some(d => d.hover)\r\n        //     let people = this.building && this.building.planet.population.citizens.length > 0 &&\r\n        //         this.building.planet.population.citizens.some(c => c.hover)\r\n        //     if (this.building && !tinyDevices && !people) {\r\n        //         this.hover = true\r\n        //         this.building.planet.currentlyViewing = this\r\n        //     }\r\n        // })\r\n\r\n        // this.on('pointerleave', () => {\r\n        //     this.hover = false\r\n        //     if (this.building && this.building.planet.currentlyViewing === this) {\r\n        //         this.building.planet.currentlyViewing = null\r\n        //     }\r\n        // })\r\n\r\n        this.collisionType = CollisionType.Passive\r\n\r\n        if (this.machine.powerEffect) {\r\n            this.emitter = makeEmitter(Color.White, Color.Blue)\r\n            this.emitter.isEmitting = true\r\n            this.add(this.emitter)\r\n        }\r\n\r\n    }\r\n\r\n    get isEvil() { return false }\r\n\r\n    get imageX() { return this.pos.x - this.getWidth() / 2 }\r\n    get imageY() { return this.pos.y - this.getHeight() / 2 } //- 10 }\r\n\r\n    get economy() { return this.built ? this.computeEconomy() : emptyMarket() }\r\n\r\n    private computeEconomy() {\r\n        let econs = [ this.machine.economy, ...this.tinyDevices.map(d => d.economy) ]\r\n        return econs.reduce(sumMarkets, emptyMarket())\r\n    }\r\n\r\n    update(engine, delta) {\r\n        super.update(engine, delta)\r\n        if (this.machine.defender) {\r\n            // the algo should try to be simple as possible: enemy within 500 yards? fire away\r\n            let hostiles = this.building.planet.population.raiders\r\n            let withinRange = hostiles.some(hostile => Math.abs(hostile.pos.y - this.pos.y) < 500)\r\n            if (withinRange) {\r\n                this.fire()\r\n                // console.debug('would defend!')\r\n            }\r\n        }\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        if (this.imageLoaded) {\r\n            ctx.save()\r\n            if (!this.built) { ctx.globalAlpha = 0.5 }\r\n            ctx.translate(this.imageX, this.imageY)\r\n            if (this.vel.x > 0) {\r\n                // flip? (assume we're drawn facing left)\r\n                ctx.translate(this.getWidth(), 0)\r\n                ctx.scale(-1,1)\r\n            }\r\n            let ix = 0, iy = 0\r\n            if (this.orientation === Orientation.Left) {\r\n                ctx.scale(-1,1)\r\n                ix = -this.getWidth()\r\n                ctx.drawImage(\r\n                    this.image,\r\n                    ix, iy,\r\n                    // -this.getWidth(),\r\n                    // 0, //this.imageY,\r\n\r\n                    this.getWidth(),\r\n                    this.getHeight()\r\n                )\r\n            } else {\r\n                ctx.drawImage(\r\n                    this.image,\r\n                    ix, iy,\r\n                    // 0,\r\n                    // 0, //this.imageY,\r\n\r\n                    this.getWidth(),\r\n                    this.getHeight()\r\n                )\r\n            }\r\n            // if (!this.built) { ctx.globalAlpha = 1.0 }\r\n\r\n            let c = Color.Transparent.clone()\r\n            if (this.hover) {\r\n                c = Color.White.clone()\r\n                c.a = 0.5\r\n            }\r\n            if (!(this.size === DeviceSize.Tiny || this.placed) && this.overlapsAny()) {\r\n                c = Color.Red.clone()\r\n                c.a = 0.3\r\n            }\r\n\r\n            drawRect(\r\n                ctx,\r\n                { x: ix, y: iy, width: this.getWidth(), height: this.getHeight() },\r\n                // 0,\r\n                c\r\n            )\r\n            ctx.restore()\r\n        }\r\n\r\n        let iv = new Vector(this.imageX, this.imageY + this.getHeight() / 8)\r\n\r\n        let showLabel = true\r\n        if (showLabel) {\r\n            this.nameLabel.pos = iv\r\n            this.nameLabel.draw(ctx, delta)\r\n        }\r\n\r\n        let { x: bx, y: by } = iv\r\n        let blockSize = 5\r\n        let yOff = this.nameLabel.fontSize\r\n        this.product.forEach((produced, index) => {\r\n            ctx.fillStyle = blockColor(produced).toRGBA()\r\n            ctx.fillRect(bx + blockSize * index, by - blockSize + yOff, blockSize-1, blockSize-1)\r\n        })\r\n\r\n        super.draw(ctx ,delta)\r\n        // this.tinyDevices.forEach(d => d.draw(ctx, delta))\r\n    }\r\n\r\n    get name() { return this.machine.name }\r\n    get description() { return this.machine.description }\r\n    get size() { return this.machine.size }\r\n    get operation() { return this.machine.operation }\r\n\r\n    async assemble(citizen: Citizen) {\r\n        if (citizen.isCarryingUnique(this.machine.cost)) {\r\n            for (let res of this.machine.cost) {\r\n                citizen.drop(res)\r\n                await citizen.progressBar(3000)\r\n            }\r\n            this.built = true\r\n        }\r\n    }\r\n\r\n    async interact(citizen: Citizen, request: InteractionRequest): Promise<boolean> {\r\n        if (this.inUse || !this.built) {\r\n            return false\r\n        }\r\n\r\n        let worked = false\r\n        let op = this.operation\r\n        if (op.type === 'recipe' && request.type === 'work') {\r\n            let recipe: Recipe = op\r\n            // do we have all the things?\r\n            if (citizen.carrying.some(it => recipe.consumes.includes(it))) {\r\n                this.inUse = true\r\n                if (citizen.isCarryingUnique(recipe.consumes)) {\r\n                    recipe.consumes.forEach(consumed => citizen.drop(consumed))\r\n                    let workTime = this.getEffectiveWorkTime(recipe)\r\n                    await citizen.progressBar(workTime) // recipe.workTime)\r\n                    citizen.carry(recipe.produces)\r\n\r\n                    worked = true\r\n                } else {\r\n                    console.warn(\"not carrying all requirements?\", { requires: recipe.consumes, has: citizen.carrying })\r\n                }\r\n                this.inUse = false\r\n            }\r\n        } else if ((op.type === 'store' || op.type === 'explore') && (request.type === 'retrieve' || request.type === 'store')) {\r\n            // accept it! (whatever you have that matches...?)\r\n            let storeOrExplore: ResourceStorage | ExploreForResource = op\r\n            if (request && request.type === 'retrieve') { // assume dispense request for now?\r\n                this.inUse = true\r\n                await citizen.progressBar(1000)\r\n                worked = this.dispense(citizen, request)\r\n                //if (worked) {\r\n                //    await citizen.progressBar(500)\r\n                //}\r\n                this.inUse = false\r\n            } else {\r\n                if (storeOrExplore.type === 'store') {\r\n                    let store: ResourceStorage = storeOrExplore\r\n                    if (request.type === 'store' &&\r\n                        citizen.carrying.some(it => store.stores.includes(it))) { // maybe trying to store?\r\n                        if (this.product.length < this.getEffectiveOperationalCapacity(store)) { // store.capacity) {\r\n                            let res = null\r\n                            if (store.stores.some(stored => { res = citizen.drop(stored); return res })) {\r\n                                if (res) {\r\n                                    this.produceResource(res)\r\n                                    // this.product.push(res)\r\n                                    // this.building.redeem(res)\r\n                                    worked = true\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                } else {\r\n                    console.warn(\"no capacity in this store!!\")\r\n                    worked = false\r\n                }\r\n            }\r\n        } else if (op.type === 'generator') {\r\n            this.inUse = true\r\n            worked = this.dispense(citizen, request)\r\n            if (worked) {\r\n                await citizen.progressBar(500)\r\n            }\r\n            this.inUse = false\r\n        } else if (op.type === 'explore') {\r\n            this.inUse = true\r\n            let origX = this.pos.x\r\n            let groundSpeed = Game.citizenSpeed * 3\r\n            citizen.drive(this)\r\n            let xOff = 25000 * (Math.random() > 0.5 ? -1 : 1)\r\n            await this.actions.moveTo(this.pos.x + xOff, this.pos.y, groundSpeed).asPromise()\r\n            await citizen.progressBar(5000)\r\n            this.produceResource(op.gathers)\r\n            await this.actions.moveTo(origX, this.pos.y, groundSpeed).asPromise()\r\n            worked = true\r\n            citizen.stopDriving()\r\n            this.inUse = false\r\n        }\r\n\r\n        return worked\r\n    }\r\n\r\n\r\n\r\n    getEffectiveOperationalCapacity(op: ResourceGenerator | ResourceStorage | ExploreForResource) {\r\n        let bonus = this.building.spaceFunction\r\n            ? this.building.spaceFunction.bonuses.capacity \r\n        : 0\r\n        return op.capacity + bonus\r\n    }\r\n\r\n    getEffectiveWorkTime(op: Recipe) {\r\n        let bonus = this.building.spaceFunction \r\n         ? this.building.spaceFunction.bonuses.workSpeed\r\n         : 1\r\n\r\n        return Math.round(op.workTime * (1/bonus))\r\n    } \r\n\r\n\r\n    private dispense(citizen: Citizen, request: InteractionRequest) {\r\n        if (request && request.type === 'retrieve') {\r\n            let canFulfill = this.product.find(p => p === request.resource)\r\n            if (canFulfill) {\r\n                deleteByValueOnce(this.product, request.resource)\r\n                citizen.carry(request.resource)\r\n                this.building.debit(request.resource)\r\n                return true\r\n            }\r\n        }\r\n        return false\r\n    }\r\n\r\n    public tryProduce(step: number) {\r\n        if (this.building.isActive && this.built) {\r\n            if (this.machine.operation.type === 'generator') {\r\n                if (step % this.machine.operation.generationTime === 0) {\r\n                    if (this.product.length < this.machine.operation.capacity) {\r\n                        this.produceResource(this.machine.operation.generates)\r\n                    }\r\n                }\r\n\r\n            } else if (this.machine.operation.type === 'spawn') {\r\n                if (step % 1000 == 0) {\r\n                    // console.log(\"WOULD SPAWN\")\r\n                    setTimeout(() => this.building.populate(this.pos.add(this.building.pos)), 100)\r\n                }\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    public produceResource(res: ResourceBlock) {\r\n        this.product.push(res)\r\n        this.building.redeem(res)\r\n    }\r\n\r\n    snap(planet: Planet, pos: Vector = this.pos) {\r\n        if (this.size === DeviceSize.Tiny) { // or large...\r\n            return this.snapTiny(planet, pos)\r\n        } else {\r\n            console.log(\"attempt to snap device...\")\r\n            let bldg = planet.colony.closestBuildingByType(pos,\r\n                allStructures,\r\n                (bldg: Building) => {\r\n                    // let hasSpace = bldg.hasPlaceForDevice()\r\n                    let compatible = bldg.structure.machines.some(Machine => this.machine instanceof Machine)\r\n                    return compatible\r\n\r\n                }\r\n            )\r\n\r\n            let snapped = false\r\n            let halfSize = getVisibleDeviceSize(this.size) / 2\r\n            if (bldg) {\r\n                // console.log(\"we have a building!\", { bldg })\r\n                let spot = bldg.getCenter()\r\n                let d = spot.distance(pos)\r\n                snapped = d < 4 * bldg.getWidth() && (Math.abs(spot.y - pos.y) < 2*bldg.getWidth()) //Scale.major.fifth)\r\n            } else {\r\n                // console.log(\"no bldg found\")\r\n            }\r\n\r\n            if (snapped) {\r\n                this.building = bldg;\r\n                this.pos = pos //.x //this.building.nextDevicePlace().position\r\n                let gridGrain = halfSize\r\n                this.pos.x += bldg.x\r\n                this.pos.x = Math.floor(this.pos.x / gridGrain) * gridGrain\r\n                this.pos.x -= bldg.x\r\n                this.pos.x = Math.max(\r\n                    bldg.x + 2*halfSize,\r\n                    this.pos.x\r\n                )\r\n                this.pos.x = Math.min(\r\n                    bldg.x + bldg.getWidth() - halfSize,\r\n                    this.pos.x\r\n                )\r\n                this.pos.y = bldg.floorY - getVisibleDeviceSize(this.size)/2 //getCenter().y + (bldg.getHeight()/8)\r\n            } else {\r\n                this.pos = pos\r\n            }\r\n\r\n            // let overlapping = !this.overlapsAny()\r\n\r\n            return snapped // && !overlapping\r\n        }\r\n    }\r\n\r\n    public overlapsAny(): boolean {\r\n        if (this.building) {\r\n            return !!this.building.planet.colony.findAllDevices().find(device => device !== this && this.overlaps(device))\r\n        } else {\r\n            return true\r\n        }\r\n    }\r\n\r\n    private overlaps(other: Device): boolean {\r\n        let rect1 = this.aabb(), rect2 = other.aabb();\r\n        let doesOverlap = (\r\n            rect1.x < rect2.x + rect2.width &&\r\n            rect1.x + rect1.width > rect2.x &&\r\n            rect1.y < rect2.y + rect2.height &&\r\n            rect1.y + rect1.height > rect2.y\r\n        )\r\n        return(!!doesOverlap);\r\n    }\r\n\r\n    placed: boolean = false\r\n    private aabb(): Rectangle {\r\n        let pos = this.pos.clone()\r\n        if (this.placed) {\r\n            pos.addEqual(this.building.pos)\r\n        }\r\n        return {\r\n            x: pos.x,\r\n            y: pos.y,\r\n            width: this.getWidth(),\r\n            height: this.getHeight()\r\n        }\r\n    }\r\n    // private overlapsAny()\r\n\r\n    private snapTiny(planet: Planet, pos: Vector) {\r\n        // okay, we need the closest building with any built machine that HAS a tiny slot\r\n        let bldg = planet.colony.closestBuildingByType(pos,\r\n            allStructures,\r\n            (bldg: Building) => bldg.getDevices().some(\r\n                (device: Device) => device.built && device.hasTinyPlace()\r\n            )\r\n        )\r\n\r\n        if (!bldg) {\r\n            return false\r\n        }\r\n\r\n        // todo look at all devices? (closest bldg may not house closest device!!)\r\n        let device: Device = closest(\r\n            pos,\r\n            bldg.getDevices().filter((d: Device) => d.built && d.hasTinyPlace()),\r\n            (d: Device) => d.pos,\r\n        )\r\n\r\n        this.pos = pos\r\n        let snapped = false\r\n        if (device) {\r\n            let spot = device.nextTinyPlace().add(device.pos).add(device.building.pos)\r\n            let d = spot.distance(pos)\r\n            snapped = d < Scale.minor.fifth //Game.mansheight*4\r\n\r\n            if (snapped) {\r\n                this.building = device.building\r\n                this.parentDevice = device\r\n                this.pos = spot\r\n            }\r\n        }\r\n\r\n        return snapped\r\n    }\r\n\r\n    public parentDevice: Device = null\r\n    tinyDevices: Device[] = []\r\n    private hasTinyPlace() {\r\n        if (!this.machine.tinySlots) {\r\n            return false\r\n        } else {\r\n            return this.tinyDevices.length < 3\r\n        }\r\n    }\r\n\r\n    private nextTinyPlace() {\r\n        let tx0 = -this.getWidth()/3, ty0 = -3\r\n        let ndx = this.tinyDevices.length\r\n        return new Vector(tx0 + (ndx * 14), ty0)\r\n    }\r\n\r\n    public addTinyDevice(device: Device) {\r\n        // console.log(\"ADD TINY DEVICE\", { device: device.machine })\r\n        device.pos = this.nextTinyPlace() //.add(this.pos)\r\n        // device.pos.addEqual(this.pos.add(this.nextTinyPlace()))\r\n        this.tinyDevices.push(device)\r\n        this.add(device)\r\n    }\r\n    \r\n    firing: boolean = false\r\n    private async fire() {\r\n        // attack in the direction our orientation is facing!\r\n        if (!this.firing) {\r\n            this.firing = true\r\n            let numTimes = range(sample(range(5)))\r\n            for (let times in numTimes) {\r\n                await sleep(450)\r\n                let bullet = new LaserBeam(this, this.orientation === Orientation.Left ? -1 : 1) //this.assembleBullet()\r\n                bullet.color = Color.Red\r\n                bullet.setHeight(2)\r\n                bullet.setWidth(24)\r\n                bullet.x -= 22\r\n                bullet.vel.x *= 1.2\r\n                bullet.y += 10\r\n                // bullet.vel.y += 6\r\n                this.scene.add(bullet)\r\n                bullet.z = 4\r\n                this.scene.addTimer(new Timer(() => { bullet.kill() }, 2200))\r\n            }\r\n            await sleep(2800)\r\n            this.firing = false\r\n        }\r\n    }\r\n}","import { Color } from \"excalibur\";\r\nimport { Game } from \"./Game\";\r\n\r\nexport function assembleButton(label: string, color: Color = Color.LightGray) {\r\n    let theButton = document.createElement('button');\r\n    theButton.textContent = label;\r\n\r\n    theButton.style.display = 'block';\r\n    theButton.style.fontSize = '6pt';\r\n    theButton.style.fontFamily = Game.font // 'Verdana';\r\n    theButton.style.fontWeight = '500';\r\n    theButton.style.padding = '2px';\r\n    theButton.style.width = '100px';\r\n    // theButton.style.height = '100px';\r\n    theButton.style.textTransform = 'uppercase';\r\n    theButton.style.border = 'none' //1px solid rgba(255,255,255,0.08)';\r\n\r\n    let c = color.clone()\r\n    let bg = c.darken(0.5).desaturate(0.5).clone();\r\n    bg.a = 0.8;\r\n    let fg = c.lighten(0.8).desaturate(0.4).clone();\r\n    theButton.style.background = bg.toRGBA();\r\n    theButton.style.color = fg.toRGBA();\r\n\r\n    theButton.onmouseover = () => {\r\n        theButton.style.background = bg.saturate(0.5).lighten(0.95).toRGBA();\r\n        theButton.style.color = fg.lighten(0.9).toRGBA();\r\n    };\r\n    theButton.onmouseleave = () => {\r\n        theButton.style.background = bg.toRGBA();\r\n        theButton.style.color = fg.toRGBA();\r\n    };\r\n    return theButton;\r\n}\r\n\r\nexport function assembleToggle(label: string, colorize: () => Color) {\r\n    let theButton = document.createElement('button');\r\n    theButton.textContent = label;\r\n\r\n    theButton.style.display = 'block';\r\n    theButton.style.fontSize = '6pt';\r\n    theButton.style.fontFamily = Game.font // 'Verdana';\r\n    theButton.style.fontWeight = '500';\r\n    theButton.style.padding = '2px';\r\n    theButton.style.width = '100px';\r\n    // theButton.style.height = '100px';\r\n    theButton.style.textTransform = 'uppercase';\r\n    theButton.style.border = 'none' //1px solid rgba(255,255,255,0.08)';\r\n\r\n    let c = colorize().clone()\r\n    let bg = c.darken(0.5).desaturate(0.5).clone();\r\n    bg.a = 0.8;\r\n    let fg = c.lighten(0.8).desaturate(0.4).clone();\r\n    theButton.style.background = bg.toRGBA();\r\n    theButton.style.color = fg.toRGBA();\r\n\r\n    theButton.onmouseover = () => {\r\n        let c = colorize().clone()\r\n        let bg = c.darken(0.5).desaturate(0.5).clone();\r\n        bg.a = 0.8;\r\n        let fg = c.lighten(0.8).desaturate(0.4).clone();\r\n\r\n        theButton.style.background = bg.toRGBA();\r\n        theButton.style.color = fg.toRGBA();\r\n    };\r\n    theButton.onmouseleave = () => {\r\n        let c = colorize().clone()\r\n        let bg = c.darken(0.5).desaturate(0.5).clone();\r\n        bg.a = 0.8;\r\n        let fg = c.lighten(0.8).desaturate(0.4).clone();\r\n\r\n        theButton.style.background = bg.toRGBA();\r\n        theButton.style.color = fg.toRGBA();\r\n    };\r\n    return theButton;\r\n}","import { Color } from \"excalibur\";\r\nimport { Game } from \"../../Game\";\r\n\r\nexport class Pane {\r\n    protected _element: HTMLDivElement;\r\n    title: HTMLDivElement\r\n    dragging: boolean = false\r\n    xOff: number = 0\r\n    yOff: number = 0\r\n    initialX: number\r\n    initialY: number\r\n\r\n\r\n    constructor(protected name: string, private x: number, private y: number) {\r\n        this.makeRootElement()\r\n\r\n    }\r\n\r\n    hide() {\r\n        this._element.style.display = 'none'\r\n    }\r\n\r\n    show() {\r\n        this._element.style.display = 'flex'\r\n    }\r\n\r\n    protected makeRootElement() {\r\n        if (this._element) {\r\n            this._element.parentElement.removeChild(this._element);\r\n        }\r\n        // if (!(this.comprehended.length > 0)) { return }\r\n\r\n        this._element = document.createElement('div');\r\n        this._element.style.position = 'absolute';\r\n        this._element.style.display = 'flex';\r\n        this._element.style.flexWrap = 'wrap';\r\n        this._element.style.width = '200px';\r\n        this._element.style.border = 'none'; //1px solid black'; //0.5px solid white';\r\n        // this._element.style.zIndex = '1'; //1px solid black'; //0.5px solid white';\r\n\r\n\r\n        document.body.appendChild(this._element);\r\n\r\n        // make title...\r\n        if (this.name) {\r\n            let container = document.createElement('div')\r\n            container.style.width = '200px'\r\n            // container.draggable = true\r\n            // container.position = 'absolute'\r\n            container.style.backgroundColor = Color.Violet.darken(0.92).toRGBA()\r\n\r\n            this.title = document.createElement('div')\r\n            this.title.textContent = this.name\r\n            this.title.style.fontFamily = Game.font //'Verdana'\r\n            this.title.style.border = 'none'\r\n            this.title.style.fontSize = '8pt'\r\n            this.title.style.fontWeight = '600'\r\n            this.title.style.color = Color.White.toRGBA()\r\n            this.title.style.padding = '4px'\r\n            this.title.style.margin = '0px'\r\n\r\n            container.appendChild(this.title)\r\n            this._element.appendChild(\r\n                container\r\n            )\r\n\r\n            /// hmmmm\r\n            document.addEventListener(\"pointerdown\", (e) => { this.dragStart(e) }, false);\r\n            document.addEventListener(\"pointerup\", (e) => { this.dragEnd(e) }, false);\r\n            document.addEventListener(\"pointermove\", (e) => { this.drag(e) }, false);\r\n\r\n        }\r\n\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D): any {\r\n        if (this._element) {\r\n            let left = ctx.canvas.offsetLeft;\r\n            let top = ctx.canvas.offsetTop;\r\n            this._element.style.left = `${left + this.x + this.xOff}px`;\r\n            this._element.style.top = `${top + this.y + this.yOff}px`;\r\n        }\r\n    }\r\n    private dragStart = (e) => {\r\n        if (e.target === this.title) {\r\n            // console.log(\"drag start\")\r\n            this.initialX = e.clientX - this.xOff;\r\n            this.initialY = e.clientY - this.yOff;\r\n            this.dragging = true\r\n        }\r\n    }\r\n\r\n    private drag = (e) => {\r\n        if (this.dragging) {\r\n            e.preventDefault()\r\n            // console.log(\"drag\")\r\n            let currentX = e.clientX - this.initialX;\r\n            let currentY = e.clientY - this.initialY;\r\n            this.xOff = currentX\r\n            this.yOff = currentY\r\n        }\r\n\r\n    }\r\n\r\n    private dragEnd = (e) => {\r\n        if (this.dragging) {\r\n            // console.log(\"drag end\")\r\n            this.dragging = false\r\n        }\r\n\r\n    }\r\n\r\n    // protected buttonFactory\r\n}","import { Citizen } from \"../actors/Citizen\";\r\nimport { Planet } from \"../actors/Planet/Planet\";\r\nimport { Device } from \"../actors/Device\";\r\nimport { sleep } from \"../Util\";\r\nimport { ResourceBlock } from \"../models/Economy\";\r\nimport { retrieveResource, drive } from \"../values/InteractionRequest\";\r\nimport { Recipe, MechanicalOperation, ExploreForResource } from \"../models/MechanicalOperation\";\r\n\r\nexport abstract class Strategy {\r\n    private sleepInterval: number = 150\r\n    protected isActive: boolean = false;\r\n    constructor(protected pawn: Citizen) { }\r\n\r\n    protected abstract async apply();\r\n    abstract canApply(): boolean;\r\n    abstract describe(): string\r\n\r\n    protected get planet(): Planet { return this.pawn.currentPlanet; }\r\n    protected get devices(): Device[] { return this.planet.colony.findPoweredDevices(); }\r\n    protected get operations(): MechanicalOperation[] { return this.devices.map(d => d.operation); }\r\n    protected get recipes(): Recipe[] {\r\n        let recipes: Recipe[] = [];\r\n        this.operations.forEach(op => {\r\n            if (op.type === 'recipe') {\r\n                recipes.push(op);\r\n            }\r\n        });\r\n        return recipes;\r\n    }\r\n\r\n    protected get explorers(): ExploreForResource[] {\r\n        let explores: ExploreForResource[] = []\r\n        this.operations.forEach(op => {\r\n            if (op.type === 'explore') {\r\n                explores.push(op)\r\n            }\r\n        })\r\n        return explores;\r\n    }\r\n\r\n\r\n    async attempt(): Promise<void> {\r\n        if (this.isActive) {\r\n            return;\r\n        }\r\n        if (!this.isActive) {\r\n            this.isActive = true\r\n            // note apply will need to set this.isActive around its critical section\r\n            await this.apply();\r\n            this.isActive = false\r\n        }\r\n\r\n        // await this.pause()\r\n        // setInterval(() => { this.attempt() }, this.sleepInterval)\r\n    }\r\n\r\n    protected async pause() {\r\n        await sleep(this.sleepInterval)\r\n    }\r\n\r\n    protected async gatherBlock(res: ResourceBlock): Promise<boolean> {\r\n        let gathered = false\r\n        let generatesDesiredBlock = (d: Device) => (d.operation.type === 'generator') &&\r\n            d.product.some(stored => res === stored) //&& !d.inUse\r\n        let gen: Device = this.planet.colony.closestDeviceByType(this.pawn.pos, [], generatesDesiredBlock)\r\n\r\n        let storesDesiredBlock = (d: Device) => (d.operation.type === 'store') &&\r\n              d.product.some(stored => res === stored) //&& !d.inUse\r\n        let store: Device = this.planet.colony.closestDeviceByType(this.pawn.pos, [], storesDesiredBlock)\r\n\r\n        let device: Device = gen || store\r\n\r\n        if (device) {\r\n            // device.inUse = true\r\n            await this.visitDevice(device)\r\n\r\n            if (device.inUse) {\r\n                // at least wait a bit and try again?\r\n                let waitTimes = 0\r\n                while (device.inUse) {\r\n                    await this.pause() //sleep(5000) //this.pause()\r\n                    if (waitTimes++ > 10) {\r\n                        return false \r\n                    }\r\n                }\r\n            }\r\n\r\n            if (await device.interact(this.pawn, retrieveResource(res))) {\r\n                gathered = true\r\n            }\r\n        } else {\r\n            console.warn(\"Didn't gather...\")\r\n            // don't work sub-recipes??\r\n            // let recipe = this.recipes.find(recipe => recipe.produces === res);\r\n            // if (recipe) {\r\n                // gathered = await this.workRecipe(recipe);\r\n                // gathered = true\r\n            // }\r\n        }\r\n\r\n        return gathered\r\n    }\r\n\r\n    protected async visitDevice(device: Device) {\r\n        await this.pawn.visit(device)\r\n    }\r\n\r\n    protected async workExploration(exploring: ExploreForResource): Promise<boolean> {\r\n        let knowsHow = (d: Device) => d.operation === exploring && !d.reserved\r\n        let vehicle = this.planet.colony.closestDeviceByType(this.pawn.pos, [], knowsHow)\r\n        let explored = false\r\n        if (vehicle) {\r\n            vehicle.reserved = true\r\n            if (await this.drive(vehicle, exploring)) {\r\n                explored = true\r\n            }\r\n\r\n            vehicle.reserved = false\r\n        }\r\n        return explored\r\n    }\r\n\r\n    private async drive(vehicle: Device, exploring: ExploreForResource) {\r\n        let driven = false\r\n        if (!vehicle.machine.isVehicle) {\r\n            throw new Error(\"Tried to drive a device that wasn't a vehicle!\")\r\n        } else {\r\n            await this.visitDevice(vehicle)\r\n            if (await vehicle.interact(this.pawn, drive())) {\r\n                if (await vehicle.interact(this.pawn, retrieveResource(exploring.gathers))) {\r\n                    driven = true\r\n                }\r\n            }\r\n        }\r\n        return driven\r\n    }\r\n\r\n    protected async workRecipe(recipe: Recipe): Promise<boolean> {\r\n        console.debug(\"Working recipe\", { product: recipe.produces })\r\n        let knowsRecipe = (d: Device) => d.operation === recipe && !d.reserved\r\n        let maker = this.planet.colony.closestDeviceByType(this.pawn.pos, [], knowsRecipe)\r\n        let made = false\r\n        if (maker) {\r\n            maker.reserved = true\r\n            // maker.inUse = true\r\n            if (await this.gatherIngredients(recipe.consumes)) {\r\n                await this.visitDevice(maker)\r\n                if (await this.performRecipeTask(maker, recipe)) {\r\n                    made = true\r\n                }\r\n            }\r\n            maker.reserved = false\r\n            // maker.inUse = false\r\n        }\r\n        // await this.pause()\r\n        // await this.workRecipe(recipe);\r\n        return made\r\n    }\r\n\r\n    protected async gatherIngredients(blocks: ResourceBlock[]): Promise<boolean> {\r\n        if (!this.pawn.isCarryingUnique(blocks)) {\r\n            console.debug(\"Gathering blocks...\")\r\n            for (let ingredient of blocks) {\r\n                let tries = 0\r\n                let gathered = false\r\n                while (!gathered && tries < 20) {\r\n                    tries += 1\r\n                    if (await this.gatherBlock(ingredient)) {\r\n                        gathered = true\r\n                    } else {\r\n                        await this.pause()\r\n                    }\r\n                }\r\n\r\n                if (!gathered) {\r\n                    console.warn(\"couldn't gather one of the ingredients!!\")\r\n                    return false\r\n                }\r\n                //else {\r\n                //    console.warn(\"didn't gather it!\")\r\n                //    return false\r\n                //}\r\n            }\r\n        }\r\n        return true\r\n    }\r\n\r\n    protected async performRecipeTask(maker: Device, recipe: Recipe, timesToAttempt: number = 5) {\r\n        console.debug(\"Try to perform recipe task...\", { produces: recipe.produces })\r\n        let worked = await maker.interact(this.pawn, { type: 'work', recipe })\r\n        if (!worked) {\r\n            // await this.pause()\r\n            console.warn(\"waiting for machine to become available...\")\r\n            for (let i = 0; i < timesToAttempt; i ++) {\r\n                await this.pause()\r\n                if (await this.performRecipeTask(maker, recipe)) {\r\n                    worked = true\r\n                    break\r\n                }\r\n            }\r\n        }\r\n        return worked\r\n    }\r\n}","import { Actor, Color, Traits, Vector, VisibleEvent, Label, CollisionType, Timer, EmitterType, ParticleEmitter, GlobalCoordinates } from \"excalibur\";\r\nimport { Building } from \"./Building\";\r\nimport { Planet } from \"./Planet/Planet\";\r\nimport { ResourceBlock, blockColor } from \"../models/Economy\";\r\nimport { Game } from \"../Game\";\r\nimport { eachCons, deleteByValueOnce, sleep, containsUniq, deleteByValue, sample, range } from \"../Util\";\r\nimport { Device } from \"./Device\";\r\nimport { Scale } from \"../values/Scale\";\r\nimport { ProductionStrategy } from \"../strategies/ProductionStrategy\";\r\nimport { CapacityBasedProduction } from \"../strategies/CapacityBasedProduction\";\r\nimport { drawStar, drawRect, drawCircle, drawEllipse, drawText, drawLine } from \"../Painting\";\r\nimport { ConstructionStrategy } from \"../strategies/ConstructionStrategy\";\r\nimport { ProxmityBasedConstruction } from \"../strategies/ProximityBasedConstruction\";\r\nimport { SleepingStrategy } from \"../strategies/SleepingStrategy\";\r\nimport { AnyBedSleepingStrategy } from \"../strategies/AnyBedSleepingStrategy\";\r\nimport { EatingStrategy } from \"../strategies/EatingStrategy\";\r\nimport { WhenHungryEatingStrategy } from \"../strategies/WhenHungryEatingStrategy\";\r\nimport { DeviceSize, getVisibleDeviceSize } from \"../values/DeviceSize\";\r\nimport { CombatStrategy } from \"../strategies/CombatStrategy\";\r\nimport { AttackNearestHostileStrategy } from \"../strategies/AttackNearestHostileStrategy\";\r\nimport { randomBytes } from \"crypto\";\r\nimport { LaserBeam } from \"./LaserBeam\";\r\nimport { CommandCenter } from \"../models/Machine\";\r\nimport { Strategy } from \"../strategies/Strategy\";\r\nimport { makeEmitter } from \"./EmitterFactory\";\r\nimport { isIPv4 } from \"net\";\r\nimport { Colors } from \"../models/World\";\r\n\r\ninterface CitizenAspects {\r\n    evil?: boolean // = false\r\n    elite?: boolean\r\n    large?: boolean\r\n}\r\n\r\nexport class Citizen extends Actor {\r\n    alive: boolean = true\r\n    isPlanning: boolean = false\r\n    carrying: ResourceBlock[] = []\r\n    path: Vector[] = []\r\n\r\n    private shouldAwaken: boolean = false\r\n\r\n    private workInProgress: boolean = false\r\n    private workStarted: number\r\n    private workDuration: number\r\n    private progress: number\r\n    private sleeping: boolean = false\r\n\r\n    private productionStrategy: ProductionStrategy\r\n    private constructionStrategy: ConstructionStrategy\r\n    private sleepingStrategy: SleepingStrategy\r\n    private eatingStrategy: EatingStrategy\r\n    private fightingStrategy: CombatStrategy\r\n\r\n    hunger: number = 0.0;\r\n    energy: number = 100\r\n    health: number = 100\r\n    maxHealth: number = 100\r\n\r\n    private driving: Device = null\r\n\r\n    private shirtColor: Color\r\n    private skinColor: Color\r\n    private weight: number\r\n\r\n    private bloodEmitter: ParticleEmitter\r\n\r\n    sleepingInBed: Device\r\n\r\n    hover: boolean = false\r\n\r\n    private debugPath: boolean = false\r\n\r\n    constructor(\r\n        public name: string,\r\n        home: Vector,\r\n        protected planet: Planet,\r\n        private aspects: CitizenAspects = {}\r\n    ) {\r\n        super(\r\n            home.x, home.y,\r\n            aspects.large ? (3 * (2 * Game.mansheight / 4)) : (2 * Game.mansheight / 4),\r\n            aspects.large ? (3 * Game.mansheight) : Game.mansheight,\r\n            // Color.White\r\n        )\r\n\r\n        this.maxHealth = aspects.large ? 250 : 100\r\n        this.health = this.maxHealth\r\n\r\n        this.traits = this.traits.filter(trait => !(trait instanceof Traits.OffscreenCulling))\r\n\r\n        this.productionStrategy = new CapacityBasedProduction(this)\r\n        this.constructionStrategy = new ProxmityBasedConstruction(this)\r\n        this.sleepingStrategy = new AnyBedSleepingStrategy(this)\r\n        this.eatingStrategy = new WhenHungryEatingStrategy(this)\r\n        this.fightingStrategy = new AttackNearestHostileStrategy(this)\r\n\r\n        let shirtColors = this.aspects.elite ? Colors.primary : Colors.secondary\r\n\r\n        if (this.isEvil) {\r\n            shirtColors = Colors.tertiary.map(c => c.clone().darken(0.82))\r\n        }\r\n\r\n        this.shirtColor = sample(shirtColors).clone().desaturate(0.18).lighten(0.24)\r\n\r\n        let alien = Math.random() < 0.02\r\n\r\n        let skinColors  = alien ?  [Color.Green.desaturate(0.4), Color.Blue.desaturate(0.4).lighten(0.2)] : [Color.Orange]\r\n\r\n        this.skinColor = sample(skinColors).lighten(0.4) //range(5).map((inc, i) => sample(skinColors).clone().lighten(0.2 + (inc/10))))\r\n        //     [\r\n        //    Color.Orange.lighten(0.3),\r\n        //    Color.Orange.lighten(0.4),\r\n        //    Color.Orange.lighten(0.5),\r\n        //    Color.Orange.lighten(0.6),\r\n        //    Color.Orange.lighten(0.7),\r\n        //    Color.Orange.lighten(0.8),\r\n\r\n        //    Color.Green.lighten(0.5),\r\n        //    Color.Blue.lighten(0.5),\r\n        //])\r\n\r\n        this.weight = sample(range(4)) //.map(w => w + 2))\r\n\r\n        this.collisionType = CollisionType.Passive\r\n        let bloodColor = alien ? Color.Green : Color.Red\r\n        this.bloodEmitter = makeEmitter(bloodColor, bloodColor.darken(0.6))\r\n        this.add(this.bloodEmitter)\r\n\r\n        // this.on('pointerenter', () => {\r\n        //     this.log(\"HOVER\")\r\n        //     this.hover = true\r\n        //     this.z = 1000\r\n        // })\r\n\r\n        // this.on('pointerleave', () => {\r\n        //     this.log('STOP HOVERING')\r\n        //     this.hover = false\r\n        //     this.z = 1\r\n        // })\r\n    }\r\n\r\n    get title() {\r\n        let title = this.aspects.elite ? 'Cmdr. ' : ''\r\n        return title\r\n    }\r\n\r\n    get isHungry() { return this.hunger > 60 }\r\n    get isTired()  { return this.energy < 90 }\r\n\r\n    get currentPlanet() { return this.planet }\r\n\r\n    get walkSpeed() {\r\n        let speedMultiplier = this.planet.timeFactor * (this.aspects.elite ? 1.4 : 1)\r\n        return Game.citizenSpeed * speedMultiplier\r\n    }\r\n\r\n    get isEvil(): boolean { return !!this.aspects.evil }\r\n\r\n    get description() { return this.isEvil ? 'Bad person' : 'Good person' }\r\n\r\n    update(engine, delta) {\r\n        super.update(engine, delta)\r\n\r\n        if (this.workInProgress) {\r\n            let now = (new Date()).getTime()\r\n            this.progress = \r\n              Math.min(\r\n                  (now - this.workStarted) / this.workDuration,\r\n                  1\r\n              )\r\n\r\n            this.fatigue()\r\n        } else if (this.path.length > 0) {\r\n            // we have a non-empty path (so just follow it!)\r\n        } else {\r\n            this.work()\r\n        }\r\n\r\n        if (this.driving) {\r\n            this.pos = this.driving.pos.add(this.driving.building.pos)\r\n        }\r\n\r\n        if (this.combatting && !this.combatting.alive) {\r\n            this.combatting = null\r\n        }\r\n\r\n        if (this.sleeping) {\r\n            this.health = Math.min(this.maxHealth, this.health+0.1)\r\n            this.energy = Math.min(100, this.energy+0.1)\r\n            // if (this.health === this.maxHealth && !this.isTired) {\r\n                // this.log(\"Try to awaken early!! (We are healed, not tired...)\")\r\n                // this.shouldAwaken = true\r\n                // this.log(\"should wake up now!!\")\r\n            // }\r\n        }\r\n\r\n        // if (this.hover) {\r\n            // this.log(\"HOVER\")\r\n            // this.log(`working? ${this.isPlanning ? 'yes' : 'no'}`)\r\n        // }\r\n\r\n        // this.z = 1000 + this.y - this.getHeight()/2\r\n\r\n        if (engine.debugMode) {\r\n            this.debugPath = true\r\n        } else {\r\n            this.debugPath = false\r\n        }\r\n    }\r\n\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n\r\n        let { x, y } = this\r\n        ctx.save()\r\n\r\n        ctx.translate(x, y) // - this.getHeight()/2) // - this.getHeight()) // - 5)\r\n        if (this.alive) {\r\n            let ix = -this.getWidth(), iy = -this.getHeight()/2 - Scale.minor.first - 6 //-15, iy = 10 - (this.getHeight() * 0.9)\r\n            if (this.hover) {\r\n                drawRect(ctx, { x: ix - 2, y: iy - 12, width: 24 + this.getWidth() * 2, height: 18 },\r\n                    Color.DarkGray.clone().darken(0.8))\r\n\r\n                drawText(ctx, this.name, ix, iy - 5) //-14, -20 - this.getHeight())\r\n            }\r\n\r\n            if (this.health < this.maxHealth) {\r\n                let ratio = this.health / this.maxHealth\r\n                let healthColor = ratio > 0.74 ? Color.Green : Color.Yellow\r\n                if (ratio < 0.34) {\r\n                    healthColor = ratio < 0.1 ? Color.Red : Color.Orange\r\n                }\r\n                this.drawBar(ctx, ix+1, iy-2, this.getWidth()*2, 4, ratio, healthColor)\r\n            }\r\n\r\n            if (this.guarding) {\r\n                let c = Color.Cyan.clone()\r\n                c.a = 0.3\r\n                drawCircle(ctx, 2, 2, 24, c) //Color.Cyan)\r\n            }\r\n        }\r\n\r\n        if (this.sleeping || !this.alive) {\r\n            ctx.rotate(-Math.PI / 2);\r\n            if (this.sleeping) {\r\n                ctx.translate(5, -10)\r\n            } else {\r\n                ctx.translate(-15, 0)\r\n            }\r\n        }\r\n        this.drawSelf(ctx)\r\n        if (this.carrying) {\r\n            let dx = 5\r\n            this.carrying.forEach((carried, idx) => {\r\n                ctx.fillStyle = blockColor(carried).clone().saturate(0.2).toRGBA()\r\n                ctx.fillRect(dx, 2 - 4 * idx, 5, 5)\r\n            })\r\n        }\r\n        ctx.restore()\r\n\r\n        if (this.workInProgress) {\r\n            ctx.lineWidth = 1\r\n            let pw = this.getWidth(), ph = 3\r\n            let px = this.x - pw/2, py = this.y - 10;\r\n            this.drawBar(ctx, px, py, pw, ph, this.progress)\r\n        }\r\n\r\n        if (this.path && this.debugPath) {\r\n            let c = Color.White.clone()\r\n            // c.a = 0.5\r\n            eachCons(this.path, 2).forEach(([a,b]) => {\r\n                drawLine(ctx, a,b,c,10)\r\n\r\n            })\r\n        }\r\n\r\n        if (this.combatting) {\r\n            // draw weapon?\r\n            // drawLine(ctx, this.combatting.pos, this.pos.add(new Vector(0,-12)), Color.Red, 1)\r\n        }\r\n\r\n\r\n        // this.color = Color.Transparent.clone() //this.hover ? Color.White : Color.Transparent\r\n        // this.color.a = 0.2\r\n\r\n        // needed to draw particles?\r\n        super.draw(ctx, delta)\r\n    }\r\n\r\n    private drawBar(ctx: CanvasRenderingContext2D, px: number, py: number, pw: number, ph: number, progress: number, color: Color = Color.Violet) {\r\n        let c = color.clone()\r\n        ctx.strokeStyle = Color.White.toRGBA()\r\n        ctx.strokeRect(px, py, pw, ph)\r\n        ctx.fillStyle = c.darken(0.9).toRGBA()\r\n        ctx.fillRect(px, py, pw, ph)\r\n        ctx.fillStyle = c.toRGBA()\r\n        ctx.fillRect(px, py, progress * pw, ph)\r\n    }\r\n\r\n\r\n    private drawSelf(ctx: CanvasRenderingContext2D) {\r\n        let halfWidth = this.getWidth()/2\r\n        let halfHeight = this.getHeight()/2\r\n        // body\r\n        let shirt = this.shirtColor.clone()\r\n        drawEllipse(\r\n            ctx,\r\n            0, (halfHeight * 0.15), // this.getHeight()/2,\r\n            halfWidth + this.weight,\r\n            (halfHeight * 0.8), // - 5,\r\n            shirt\r\n        )\r\n\r\n        // head\r\n        let head = this.skinColor.clone()\r\n        let headRadius = halfWidth * 0.85\r\n        drawCircle(\r\n            ctx, \r\n            0, -halfHeight + headRadius/2, /// - 3,\r\n            headRadius,\r\n            // this.getWidth() * 0.7,\r\n            head\r\n        ) \r\n\r\n        if (this.aspects.elite) {\r\n            drawStar(ctx, 12, -8)\r\n        } \r\n    }\r\n\r\n    async progressBar(duration: number) {\r\n        this.workInProgress = true\r\n        this.workStarted = (new Date()).getTime()\r\n        this.workDuration = duration\r\n        await new Promise((resolve, reject) => setTimeout(resolve, duration));\r\n        this.workInProgress = false\r\n    }\r\n\r\n    drive(d: Device) {\r\n        this.driving = d\r\n        this.z = -1\r\n    }\r\n\r\n    stopDriving() {\r\n        this.driving = null\r\n        this.z = 1\r\n    }\r\n\r\n    get isDriving(): boolean { return !!this.driving }\r\n\r\n    carry(c: ResourceBlock) {\r\n        this.carrying.push(c);\r\n    }\r\n\r\n    isCarryingUnique(resources: ResourceBlock[]): boolean {\r\n        let isCarrying = containsUniq(this.carrying, resources)\r\n        return isCarrying\r\n    }\r\n\r\n    drop(res: ResourceBlock): ResourceBlock {\r\n        if (this.carrying.length > 0) {\r\n            if (this.carrying.find(r => r === res)) {\r\n                deleteByValueOnce(this.carrying, res)\r\n                return res\r\n            }\r\n        }\r\n        return null\r\n    }\r\n\r\n    currentBuilding: Building = null\r\n    async visit(device: Device) {\r\n        let target = this.targetForDevice(device)\r\n        if (target.distance(this.pos) > Scale.minor.first) {\r\n            await this.pathTo(target)\r\n        }\r\n        await this.glideTo(target)\r\n        this.currentBuilding = device.building\r\n    }\r\n\r\n    async pathTo(pos: Vector) {\r\n        const path = this.planet.pathBetweenPoints(this.pos.clone(), pos)\r\n        // path.pop()\r\n        await this.followPath(path)\r\n    }\r\n\r\n    private targetForDevice(device: Device) {\r\n        let target = device.pos.add(device.building.pos)\r\n        if (device.parentDevice) {\r\n            target = (device.parentDevice.pos).add(device.building.pos)\r\n            target.x += device.pos.x\r\n            target.y += getVisibleDeviceSize(device.parentDevice.size) / 2\r\n        } else {\r\n            target.y += getVisibleDeviceSize(device.size) / 2\r\n        }\r\n        return target\r\n    }\r\n\r\n    async glideTo(pos: Vector) {\r\n        if (pos) {\r\n            await this.actions.moveTo(pos.x, pos.y, this.walkSpeed).asPromise()\r\n        }\r\n    }\r\n\r\n    async followPath(path: Vector[]) {\r\n        if (path.length > 0) {\r\n            this.path = path.map(v => v.sub(new Vector(0,Scale.minor.second)))\r\n            // console.log(`${this.name} following path`, { path: this.path })\r\n            // await this.glideTo(path.pop())\r\n            // await Promise.all(\r\n                this.path.forEach(async step => await this.glideTo(step))\r\n            // )\r\n            this.path = []\r\n        }\r\n    }\r\n    \r\n    protected get strategies() {\r\n        let { evil } = this.aspects\r\n        return [\r\n            this.fightingStrategy,\r\n            ...(evil ? [] : [this.sleepingStrategy]),\r\n            ...(evil ? [] : [this.eatingStrategy]),\r\n            ...(evil ? [] : [this.constructionStrategy]),\r\n            ...(evil ? [] : [this.productionStrategy])\r\n        ]\r\n    }\r\n\r\n    lastChoice: Strategy = null\r\n    async work() {\r\n        if (this.isPlanning || this.sleeping || !this.alive) { return }\r\n        this.isPlanning = true\r\n        if (this.carrying.length > 0) { this.carrying = [] }\r\n        let choice = this.strategies.find(strat => strat.canApply())\r\n        if (choice) {\r\n            this.lastChoice = choice\r\n            await choice.attempt()\r\n        }\r\n        this.isPlanning = false\r\n    }\r\n\r\n    async takeRest(duration: number = 8 * 60 * Game.minuteTickMillis) {\r\n        this.sleeping = true\r\n        await this.progressBar(duration)\r\n        this.sleeping = false\r\n\r\n    }\r\n\r\n    async eat() {\r\n        let thirtyMinuteTimer = 30 * Game.minuteTickMillis\r\n        await this.progressBar(thirtyMinuteTimer)\r\n        deleteByValueOnce(this.carrying, ResourceBlock.Meal)\r\n        this.hunger = 0\r\n    }\r\n\r\n    private combatting: Citizen = null\r\n\r\n    engageHostile(hostile: Citizen) {\r\n        this.combatting = hostile\r\n    }\r\n\r\n    get enemyCombatant() { return this.combatting }\r\n\r\n    get engagedInCombat() {\r\n        return this.combatting !== null\r\n    }\r\n\r\n    distanceToHostile(): number { \r\n        if (this.combatting) {\r\n            return this.combatting.getWorldPos().distance(this.getWorldPos())\r\n        } else {\r\n            return 0\r\n        }\r\n    }\r\n\r\n    private paceUnit: number = Math.floor(Game.mansheight * 0.6)\r\n    get idealCombatRange() {\r\n        let idealDistance = 10 * this.paceUnit\r\n        return idealDistance\r\n    }\r\n\r\n    get hostileDirectionSign() {\r\n        if (this.combatting) {\r\n            let enemy = this.combatting.getWorldPos()\r\n            let self = this.getWorldPos()\r\n            if (enemy.x > self.x) {\r\n                return 1\r\n            } else {\r\n                return -1\r\n            }\r\n        } else {\r\n            return 0\r\n        }\r\n    }\r\n\r\n    get enemyPosition() { return this.combatting.getWorldPos().clone() }\r\n\r\n    combatMovementUnit: number = this.paceUnit * 5\r\n    firingRangeBuffer: number = this.combatMovementUnit * 2\r\n\r\n    tooCloseToEnemyLine(): boolean {\r\n        let dx = Math.abs(this.enemyPosition.x - this.x)\r\n        return dx < this.idealCombatRange - this.firingRangeBuffer\r\n    }\r\n\r\n    tooFarFromEnemyLine(): boolean {\r\n        let dx = Math.abs(this.enemyPosition.x - this.x)\r\n        return dx > this.idealCombatRange + this.firingRangeBuffer\r\n    }\r\n\r\n    withinFiringRange(): boolean {\r\n        return !(this.tooCloseToEnemyLine() || this.tooFarFromEnemyLine())\r\n    }\r\n\r\n    async advanceTowardsEnemy() {\r\n        let nextGoal = this.getWorldPos().clone()\r\n        let unit = this.combatMovementUnit\r\n        if (this.tooFarFromEnemyLine()) {\r\n            unit *= this.hostileDirectionSign\r\n            // this.log(`ADVANCE TOWARD ENEMY LINE`)\r\n            nextGoal.x += unit\r\n            await this.glideTo(nextGoal)\r\n        } else if (this.tooCloseToEnemyLine()) {\r\n            unit *= -this.hostileDirectionSign\r\n            // this.log(`RETREAT FROM ENEMY LINE`)\r\n            nextGoal.x += unit\r\n            await this.glideTo(nextGoal)\r\n        }\r\n    }\r\n\r\n    async advanceTowards(target: Vector) {\r\n        let goal = target.clone()\r\n        goal.y = this.pos.y\r\n        let unit = this.combatMovementUnit\r\n        if (target.x > this.pos.x) {\r\n            goal.x = this.pos.x + unit\r\n        } else {\r\n            goal.x = this.pos.x - unit\r\n        }\r\n        await this.glideTo(goal)\r\n    }\r\n\r\n    // bullets: Actor[]\r\n    firing: boolean = false\r\n    async fire() {\r\n        if (!this.firing) {\r\n            // console.log(\"FIRE!!!\")\r\n            // launch a (few) projectile(s)!!!\r\n\r\n                    this.firing = true\r\n            let numTimes = range(sample(range(4)))\r\n            for (let times in numTimes) {\r\n                await this.progressBar(350)\r\n                if (this.alive && this.combatting && this.combatting.alive) {\r\n                    let bullet = this.assembleBullet()\r\n                    this.scene.add(bullet)\r\n                    this.scene.addTimer(new Timer(() => { bullet.kill() }, 2200))\r\n                }\r\n            }\r\n            await sleep(800)\r\n                    this.firing = false\r\n            // await sleep(250) //this.progressBar(250)\r\n        }\r\n    }\r\n\r\n    guarding: boolean = false\r\n    async guard() {\r\n        if (!this.guarding) {\r\n            // this.guarding = true\r\n            if (this.alive && this.combatting) {\r\n                this.guarding = true\r\n                // sometimes a short guard\r\n                let length = Math.random() > 0.2 ? 4000 : 1600\r\n                await sleep(length)\r\n                this.guarding = false\r\n            }\r\n        }\r\n    }\r\n\r\n    private assembleBullet() {\r\n        let hostileDir = this.hostileDirectionSign\r\n        let bullet = new LaserBeam(this, hostileDir)\r\n        return bullet\r\n    }\r\n\r\n    injure(amt: number, attacker: Citizen | Device) {\r\n        if (this.aspects.elite) {\r\n            // commanders take only 30% of incoming damage\r\n            amt = amt * 0.3\r\n        }\r\n        this.health -= amt\r\n        if (this.health <= 0) {\r\n            this.die()\r\n        }\r\n        this.bleed()\r\n        // await sleep(150) // stun?\r\n        if (attacker instanceof Citizen) {\r\n            this.engageHostile(attacker)\r\n        }\r\n    }\r\n\r\n    die() {\r\n        this.actionQueue.clearActions()\r\n        this.path = []\r\n        this.alive = false\r\n        this.guarding = false\r\n        this.sleeping = false\r\n        this.collisionType = CollisionType.Passive\r\n        this.scene.addTimer(new Timer(() => { this.kill() }, 5000))\r\n    }\r\n\r\n    bleed() {\r\n\r\n        this.bloodEmitter.isEmitting = true\r\n        this.scene.addTimer(new Timer(() => { this.bloodEmitter.isEmitting = false }, 50))\r\n\r\n    }\r\n\r\n    private fatigue() {\r\n        let unit = 1e-4;\r\n        this.energy -= unit;\r\n        this.hunger += unit;\r\n    }\r\n\r\n    log(msg) {\r\n        console.debug(`${this.name}: ${msg}`)\r\n    }\r\n}","import { Color } from 'excalibur';\r\nimport { Scale } from '../values/Scale';\r\nimport { Orientation } from '../values/Orientation';\r\nimport { Machine, OxygenExtractor, WaterCondensingMachine, SolarCell, allMachines } from './Machine';\r\nimport { DeviceSize } from '../values/DeviceSize';\r\n\r\nconst { major, minor } = Scale\r\n\r\nconst smallMachines = allMachines.filter(machine => (new machine()).size === DeviceSize.Small)\r\nconst mediumMachines = allMachines.filter(machine => (new machine()).size === DeviceSize.Medium)\r\nconst largeMachines = allMachines.filter(machine => (new machine()).size === DeviceSize.Large)\r\nconst hugeMachines = allMachines.filter(machine => (new machine()).size === DeviceSize.Huge)\r\n\r\nconst smallDome = smallMachines.filter(machine => (new machine()).forDome)\r\nconst smallBelow = smallMachines.filter(machine => !(new machine()).forDome)\r\n\r\nconst midDome = mediumMachines.filter(machine => (new machine()).forDome)\r\nconst midBelow = mediumMachines.filter(machine => !(new machine()).forDome && !(new machine()).isVehicle)\r\n\r\nconst largeDome = largeMachines.filter(machine => (new machine()).forDome)\r\nconst largeBelow = largeMachines.filter(machine => !(new machine()).forDome)\r\n\r\nconst hugeDome = hugeMachines.filter(machine => (new machine()).forDome)\r\nconst hugeBelow = hugeMachines.filter(machine => !(new machine()).forDome)\r\n\r\nconst medGroundVehicles = mediumMachines.filter(machine => (new machine()).isVehicle)\r\n\r\nexport class Structure {\r\n    name: string = '(structure name)';\r\n    description: string = '(structure description)';\r\n    view: string = '<structure (room) view>';\r\n    width: number = 10\r\n    height: number = 10\r\n    zoom: number = 1\r\n    color: Color = Color.Gray\r\n    infra: boolean = false\r\n\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Left]: [ Corridor ],\r\n        [Orientation.Right]: [ Corridor ],\r\n        [Orientation.Up]: [ Ladder ],\r\n        [Orientation.Down]: [ Ladder ],\r\n    }\r\n\r\n    machines: (typeof Machine)[] = []\r\n    prereqs: (typeof Structure)[] = []\r\n\r\n\r\n    hide: boolean = false\r\n}\r\n\r\n\r\nexport class MainTunnel extends Structure {\r\n    name: string = 'Main Tunnel';\r\n    description: string = 'Elevating';\r\n    view: string = 'TunnelView';\r\n    width: number = major.third\r\n    height: number = major.eighth\r\n    zoom = 0.25\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Left]: [ Corridor ],\r\n        [Orientation.Right]: [ Corridor ],\r\n        [Orientation.Up]: [ MediumSurfaceRoom ],\r\n        [Orientation.Down]: [ ],\r\n    }\r\n    infra = true\r\n}\r\n\r\n\r\nexport class SurfaceRoad extends Structure {\r\n    name: string = 'Road'\r\n    description: string = 'go for a walk'\r\n    view: string = 'SurfaceRoadView'\r\n    width: number = minor.fifth\r\n    height: number = minor.first\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Left]: [ Dome, MediumSurfaceRoom ],\r\n        [Orientation.Right]: [  Dome, MediumSurfaceRoom ],\r\n        [Orientation.Up]: [ ],\r\n        [Orientation.Down]: [ ],\r\n    }\r\n    infra = true\r\n}\r\n\r\nexport class Corridor extends Structure {\r\n    name: string = 'Corridor'\r\n    description: string = 'in the hallway'\r\n    view: string = 'CorridorView'\r\n    width: number = minor.fifth\r\n    height: number = major.first\r\n    zoom = 0.5\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Left]: [\r\n            MainTunnel,\r\n            CommonArea,\r\n            Ladder,\r\n        ],\r\n        [Orientation.Right]: [\r\n            MainTunnel,\r\n            CommonArea,\r\n            Ladder,\r\n        ],\r\n        [Orientation.Up]: [ ],\r\n        [Orientation.Down]: [ ],\r\n    }\r\n    prereqs = [SurfaceRoad] //MainTunnel]\r\n    infra = true\r\n}\r\n\r\nexport class Ladder extends Structure {\r\n    name = 'Ladder'\r\n    description = 'connect vertically'\r\n    view = 'LadderView'\r\n    width = major.second\r\n    height = major.third\r\n    zoom = 0.5\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Up]: [ CommonArea ],\r\n        [Orientation.Down]: [ CommonArea ],\r\n        [Orientation.Left]: [ ],\r\n        [Orientation.Right]: [ ],\r\n    }\r\n    prereqs = [Corridor, SmallRoomThree]\r\n    infra = true\r\n}\r\n\r\n// 'abstract' structure...\r\n\r\nclass Dome extends Structure {\r\n    description: string = 'Biome sweet biome';\r\n\r\n    view: string = 'DomeView';\r\n    width: number  = major.sixth\r\n    height: number = major.fourth\r\n    zoom = 0.2\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Left]: [ SurfaceRoad ],\r\n        [Orientation.Right]: [ SurfaceRoad ],\r\n        [Orientation.Up]: [ ],\r\n        [Orientation.Down]: [ ],\r\n    }\r\n\r\n    machines = [\r\n        SolarCell,\r\n        OxygenExtractor, WaterCondensingMachine,\r\n    ]\r\n}\r\n\r\n// common subsurface room...\r\nclass CommonArea extends Structure {\r\n    name: string = 'Commons'\r\n    description: string = 'hallway cap'\r\n    view: string = 'CommonAreaView'\r\n    width: number = major.third //2 * major.eighth\r\n    height: number = major.third\r\n\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Left]: [\r\n            Corridor, CommonArea\r\n            ],\r\n        [Orientation.Right]: [\r\n            Corridor,\r\n            CommonArea,\r\n        ],\r\n        [Orientation.Up]: [ Ladder ],\r\n        [Orientation.Down]: [ Ladder ],\r\n    }\r\n\r\n    machines = []\r\n\r\n    prereqs = [\r\n    ]\r\n}\r\n\r\nexport class SmallRoomTwo extends CommonArea {\r\n    name = 'Side Room'\r\n    // width = major.eighth\r\n    height = major.first\r\n    width = major.third\r\n    prereqs = [ SmallDome ]\r\n    machines = smallBelow\r\n}\r\n\r\nexport class SmallRoomThree extends CommonArea {\r\n    name = 'Sm. Room (3)'\r\n    prereqs = [SmallRoomTwo]\r\n    view = 'SmallRoomThreeView'\r\n    // width = 2 * major.eighth\r\n    // height = major.eighth\r\n\r\n    width: number = major.fourth\r\n    height: number = major.second\r\n\r\n    machines = [ ...smallBelow ] //, ...midBelow ]\r\n}\r\n\r\nexport class MediumRoom extends CommonArea {\r\n    name = 'Mid Room'\r\n    prereqs = [ SmallRoomThree ]\r\n    view = 'MediumRoomView'\r\n    width = 2 * major.eighth\r\n    machines = [ ...midBelow, ...smallBelow ]\r\n}\r\n\r\nexport class MediumRoomThree extends CommonArea {\r\n    name = 'Mid Room (3)'\r\n    prereqs = [ MediumRoom ]\r\n    view = 'MediumRoomThreeView'\r\n    width = 3 * major.eighth\r\n    height = major.eighth\r\n\r\n    machines = [ ...midBelow, ...smallBelow ]\r\n}\r\n\r\nexport class LargeRoom extends CommonArea {\r\n    name = 'Lg. Room'\r\n    view = 'LargeRoomView'\r\n    prereqs = [ MediumRoom ]\r\n    width = 4 * major.eighth\r\n    height = 2*major.eighth\r\n    machines = [ ...largeBelow, ...midBelow, ...smallBelow ]\r\n}\r\n\r\nexport class HugeRoom extends CommonArea {\r\n    name = 'Huge Room'\r\n    view = 'HugeRoomView'\r\n    width = 10 * major.eighth\r\n    height = 8 * major.eighth\r\n\r\n    prereqs = [LargeRoom]\r\n    machines = hugeBelow\r\n}\r\n\r\n// export class Octagon extends CommonArea {\r\n//     // ...\r\n//     name = 'Octagon'\r\n//     view = 'OctagonView'\r\n// }\r\n\r\n/// surface bldgs\r\n\r\nexport class MediumSurfaceRoom extends Dome {\r\n    name = 'Mid Surf Bldg'\r\n    description = 'home away from home';\r\n\r\n    view: string = 'MediumSurfaceRoomView';\r\n\r\n    width: number =  2 * major.fifth\r\n    height: number = major.fourth\r\n\r\n    zoom = 0.1\r\n\r\n    prereqs = [ SmallDome ]\r\n\r\n    connections: { [key in Orientation]: (typeof Structure)[] } = {\r\n        [Orientation.Left]: [ SurfaceRoad ],\r\n        [Orientation.Right]: [ SurfaceRoad ],\r\n        [Orientation.Up]: [ MainTunnel, MediumSurfaceRoom ],\r\n        [Orientation.Down]: [ MainTunnel, MediumSurfaceRoom ],\r\n    }\r\n\r\n    machines = [ \r\n        ...midBelow,\r\n        ...smallBelow\r\n    ]\r\n\r\n    // hide = false // need another one which cares about connecting to roads...\r\n}\r\n\r\nexport class SmallDome extends Dome {\r\n    name = 'Sm. Dome'\r\n    width = major.third\r\n    height = major.third\r\n    machines = smallDome\r\n}\r\n\r\nexport class SmallDomeThree extends Dome {\r\n    name = 'Sm. Dome (3)'\r\n    view = 'SmallDomeThreeView'\r\n    width = major.fourth\r\n    height = major.fourth\r\n    // width = 3 * major.fifth\r\n    // height = 2*major.fifth\r\n    machines = smallDome\r\n}\r\n\r\nexport class MidDome extends Dome {\r\n    name = 'Mid Dome'\r\n    view = 'MidDomeView'\r\n    width = 3 * major.seventh\r\n    // height = 2 * major.seventh\r\n    prereqs = [ SmallDome, MediumRoom ]\r\n    machines = [ ...midDome, ...smallDome ]\r\n}\r\n\r\nexport class LargeDome extends Dome {\r\n    name = 'Lg. Dome'\r\n    view = 'BigDomeView'\r\n    width = 4 * major.eighth\r\n    // height = 3 * major.eighth\r\n    prereqs = [MidDome] //, LargeRoom]\r\n    machines = [ ...largeDome, ...midDome, ...smallDome ]\r\n}\r\n\r\nexport class Arcology extends Dome {\r\n    name = 'Arcology'\r\n    view = 'ArcologyView'\r\n    width = 12 * major.eighth\r\n    height = 36 * major.eighth\r\n    prereqs = [LargeDome] //, HugeRoom]\r\n    machines = hugeDome\r\n\r\n}\r\n\r\n/// vehicles...!\r\n\r\nexport class GroundVehiclePool extends Dome {\r\n    name = 'Veh. Pool'\r\n    description = 'ground transit hub'\r\n    view = 'GroundVehiclePoolView'\r\n    width = 2 * major.eighth\r\n    height = minor.second\r\n    machines = medGroundVehicles\r\n}\r\n\r\n\r\nexport const allStructures =\r\n    [\r\n        SmallDome,\r\n        SmallDomeThree,\r\n        MidDome,\r\n        // LargeDome,\r\n        // Arcology,\r\n        MediumSurfaceRoom,\r\n\r\n        SmallRoomTwo,\r\n        SmallRoomThree,\r\n        // MediumRoom,\r\n        // MediumRoomThree,\r\n        // LargeRoom,\r\n        // HugeRoom,\r\n\r\n        GroundVehiclePool,\r\n    ]\r\n\r\n\r\n","import { Machine, OxygenExtractor, WaterCondensingMachine, CloningVat, Bookshelf, Bed, Stove, AlgaeVat, ResearchServer, Fridge, SolarCell, Arbor, Cabin, Workstation, Fabricator, Houseplant, Orchard, Megafabricator, StudyMachine, Mainframe, CommandCenter, MissionLog, Botany, OrientationConsole, PersonnelRegistry, MineralProcessor, MiningDrill, HoloProjector, TimeCrystal, Couch, Statue } from './Machine';\r\nimport { Color } from 'excalibur';\r\nimport { Structure, MediumSurfaceRoom } from './Structure';\r\nimport { BackgroundPattern } from '../actors/Building/BackgroundPatterns';\r\n\r\nexport class RoomRecipe {\r\n     name: string = '(generic)'\r\n     description: string = '(generic description)'\r\n     machines: (typeof Machine)[] = []\r\n     color: Color = Color.Gray\r\n\r\n     prereqs: (typeof RoomRecipe)[] =  [] \r\n\r\n     structure: typeof Structure = null\r\n     hide: boolean = false\r\n     background: BackgroundPattern = BackgroundPattern.Beige\r\n\r\n     bonuses: {\r\n          capacity: number, // every store/generator gets this??\r\n          workSpeed: number, // 2 should double work speed (dur *= 1/multiplier)\r\n     } = {\r\n          capacity: 0, // boost cap by one\r\n          workSpeed: 1.00 // 20% bonus to work speed\r\n     }\r\n}\r\n\r\nexport class MissionControl extends RoomRecipe {\r\n     hide = true\r\n     name = 'Mission Control'\r\n     description = 'keeping everything on track'\r\n     structure = MediumSurfaceRoom\r\n     prereqs = [] //ComputerCore, Factory, Farm ]\r\n     machines = [ CommandCenter, MissionLog ]\r\n     background = BackgroundPattern.Window\r\n}\r\n\r\nexport class LivingQuarters extends RoomRecipe {\r\n     name = 'Living Quarters'\r\n     description = 'good night'\r\n     machines = [ Bed ]\r\n}\r\n\r\nclass Barracks extends RoomRecipe {\r\n     name = 'Barracks'\r\n     description = 'sleep tight'\r\n     machines = [ Bed, Bed, Bed ]\r\n}\r\n\r\nexport class Kitchen extends RoomRecipe {\r\n     name = 'Kitchen'\r\n     description = 'stay together'\r\n     machines = [ Stove, Fridge ]\r\n     bonuses = {\r\n          capacity: 2,\r\n          workSpeed: 1.1\r\n     }\r\n     background = BackgroundPattern.Checker\r\n}\r\n\r\nexport class LifeSupportPod extends RoomRecipe {\r\n     name = 'Life Support'\r\n     description = 'keep it going'\r\n     machines = [ OxygenExtractor, WaterCondensingMachine ]\r\n}\r\n\r\nclass Retreat extends RoomRecipe {\r\n     name = 'Retreat'\r\n     description = 'take it easy'\r\n     machines = [ Cabin, Cabin ]\r\n}\r\n\r\nexport class CloneMatrix extends RoomRecipe {\r\n     name = 'Clone Matrix'\r\n     description = 'clone home'\r\n     machines = [ CloningVat, CloningVat ]\r\n}\r\n\r\nexport class CloneReception extends RoomRecipe {\r\n     name = 'Clone Reception'\r\n     description = 'welcome clone'\r\n     machines = [ CloningVat, OrientationConsole, PersonnelRegistry ]\r\n}\r\n\r\nclass ReadingRoom extends RoomRecipe {\r\n     name = 'Reading Room'\r\n     description = 'butterflies in the sky'\r\n     machines = [ Bookshelf, Bookshelf ]\r\n}\r\n\r\nexport class Library extends RoomRecipe {\r\n     name = 'Library'\r\n     description = 'take a look'\r\n     machines = [ Bookshelf, Bookshelf, Bookshelf ]\r\n     background = BackgroundPattern.Books\r\n}\r\n\r\nexport class Study extends RoomRecipe {\r\n     name = 'Study'\r\n     description = 'plan it out'\r\n     machines = [ StudyMachine, Bookshelf ]\r\n     background = BackgroundPattern.Wood\r\n}\r\n\r\nclass ComputerLab extends RoomRecipe {\r\n     name = 'Computer Lab'\r\n     description = 'make it happen'\r\n     machines = [ Workstation, Workstation, Workstation ]\r\n}\r\n\r\nexport class Archive extends RoomRecipe {\r\n     name = 'Archive'\r\n     description = 'write it down'\r\n     machines = [ ResearchServer, ResearchServer ]\r\n}\r\n\r\nclass Arboretum extends RoomRecipe {\r\n     name = 'Arboretum'\r\n     description = 'walk it out'\r\n     machines = [ Arbor, Arbor ]\r\n}\r\n\r\nclass AlgaeFarm extends RoomRecipe {\r\n     name = 'Algae Farm'\r\n     description = 'make do'\r\n     machines = [ AlgaeVat, AlgaeVat ]\r\n}\r\n\r\nexport class SolarArray extends RoomRecipe {\r\n     name = 'Solar Array'\r\n     description = 'warm up'\r\n     machines = [ SolarCell, SolarCell ]\r\n}\r\n\r\nexport class Workshop extends RoomRecipe {\r\n     name = 'Workshop'\r\n     description = 'take form'\r\n     machines = [ Fabricator, Fabricator ]\r\n}\r\n\r\nclass Nursery extends RoomRecipe {\r\n     name = 'Nursery'\r\n     description = 'quiet please'\r\n     machines = [ Houseplant, Houseplant, Houseplant ]\r\n     background = BackgroundPattern.Leafy\r\n}\r\n\r\nclass Farm extends RoomRecipe {\r\n     name = 'Farm'\r\n     description = 'food for the masses'\r\n     machines = [ Orchard, Orchard ]\r\n}\r\n\r\nclass Factory extends RoomRecipe {\r\n     name = 'Factory'\r\n     description = 'production lines'\r\n     machines = [ Megafabricator, Megafabricator ]\r\n}\r\n\r\n\r\nexport class ComputerCore extends RoomRecipe {\r\n     name = 'Computer Core'\r\n     description = 'let us calculate'\r\n     machines = [ Mainframe, Mainframe ]\r\n     background = BackgroundPattern.Tech\r\n}\r\n\r\nexport class LifeSciencesLab extends RoomRecipe {\r\n     name = 'Life Sciences Lab'\r\n     description = 'where do i come from'\r\n     machines = [ Botany, Botany ]\r\n}\r\n\r\nexport class Refinery extends RoomRecipe {\r\n     name = 'Refinery'\r\n     description = 'separation'\r\n     machines = [ MineralProcessor ]\r\n}\r\n\r\nexport class Mine extends RoomRecipe {\r\n     name = 'Mine'\r\n     description = 'ore from the stone'\r\n     machines = [ MiningDrill ]\r\n}\r\n\r\nexport class HoloMatrix extends RoomRecipe {\r\n     name = 'Hologram Matrix'\r\n     description = 'dream it'\r\n     machines = [ HoloProjector, HoloProjector ]\r\n}\r\n\r\nexport class TimeChamber extends RoomRecipe {\r\n     name = 'Time Chamber'\r\n     description = 'believe it'\r\n     machines = [ TimeCrystal, TimeCrystal ]\r\n}\r\n\r\n// export class DreamMatrix extends \r\n\r\nexport class LivingRoom extends RoomRecipe {\r\n     name = 'Living Room'\r\n     description = 'just relax'\r\n     machines = [ Couch, Couch ]\r\n}\r\n\r\nexport class Statuary extends RoomRecipe {\r\n     name = 'Statuary'\r\n     description = 'to remember'\r\n     machines = [ Statue, Statue, Statue ]\r\n}\r\n\r\nexport const allSpaceFunctions = [\r\n    MissionControl,\r\n\r\n    Library,\r\n    Barracks,\r\n    LifeSupportPod,\r\n    CloneMatrix,\r\n    LivingQuarters,\r\n    Kitchen,\r\n    AlgaeFarm,\r\n    Archive,\r\n    Arboretum,\r\n    SolarArray,\r\n    Retreat,\r\n    Study,\r\n    Workshop,\r\n    ReadingRoom,\r\n    Nursery,\r\n    Farm,\r\n    Factory,\r\n    ComputerLab,\r\n\r\n    ComputerCore,\r\n\r\n    LifeSciencesLab,\r\n\r\n    CloneReception,\r\n    \r\n    Refinery,\r\n    Mine,\r\n    HoloMatrix,\r\n    TimeChamber,\r\n\r\n    LivingRoom,\r\n    Statuary,\r\n]","import { Game } from \"./Game\";\r\nimport { BaseCamera, Vector, Input, Engine } from \"excalibur\";\r\nimport { Orientation } from \"./values/Orientation\";\r\n\r\nexport class GameController {\r\n\r\n    private dragging: boolean = false\r\n    private dragOrigin: Vector\r\n    pointerMoveCallback: (pos: Vector) => any = null\r\n    leftClickCallback: (pos: Vector, holdingShift: boolean) => any = null\r\n    cameraPanCallback: () => any = null\r\n    keyPressCallback: (key) => any = null\r\n\r\n    constructor(private game: Engine, private camera: BaseCamera) {\r\n        \r\n    }\r\n\r\n    onMove(cb: (pos: Vector) => any) {\r\n        this.pointerMoveCallback = cb\r\n    }\r\n\r\n    onLeftClick(cb: (pos: Vector, holdingShift: boolean) => any) {\r\n        this.leftClickCallback = cb\r\n    }\r\n\r\n    onCameraPan(cb: () => any) {\r\n        this.cameraPanCallback = cb\r\n    }\r\n\r\n    onKeyPress(cb: (key) => any) {\r\n        this.keyPressCallback = cb\r\n\r\n    }\r\n\r\n    activate() {\r\n        this.game.input.pointers.primary.on('move', (e: Input.PointerMoveEvent) => {\r\n\r\n            if (this.dragging) {\r\n                this.camera.pos = this.camera.pos.add(\r\n                    this.dragOrigin.sub(e.pos)\r\n                )\r\n            } else {\r\n                if (this.pointerMoveCallback) {\r\n                    this.pointerMoveCallback(e.pos)\r\n                }\r\n\r\n            }\r\n        })\r\n\r\n        this.game.input.pointers.primary.on('up', () => {\r\n            if (this.dragging) { this.dragging = false; }\r\n        })\r\n\r\n        this.game.input.pointers.primary.on('down', (e: Input.PointerDownEvent) => {\r\n            if (e.button == Input.PointerButton.Left) {\r\n                if (this.leftClickCallback) {\r\n                    this.leftClickCallback(\r\n                        e.pos,\r\n                        this.game.input.keyboard.isHeld(Input.Keys.Shift)\r\n                    )\r\n                }\r\n\r\n            } else if (e.button === Input.PointerButton.Middle) {\r\n                this.dragging = true;\r\n                this.dragOrigin = e.pos\r\n            }\r\n        })\r\n\r\n        this.game.input.pointers.primary.on('wheel', (e: Input.WheelEvent) => {\r\n            let z = this.camera.getZoom()\r\n            let step = 0.05\r\n            let min = 0.05, max = 8\r\n            if (e.deltaY < 0) {\r\n                this.camera.zoom(Math.min(z + step, max))\r\n            } else if (e.deltaY > 0) {\r\n                this.camera.zoom(Math.max(z - step, min))\r\n            }\r\n        })\r\n\r\n        let { Up, Down, Left, Right } = Orientation;\r\n        let moveCam = (direction: Orientation) => {\r\n            if (this.cameraPanCallback) {\r\n                this.cameraPanCallback()\r\n            }\r\n            let camMoveSpeed = 10 * (1 / this.camera.getZoom())\r\n            let dv = new Vector(0, 0)\r\n            switch (direction) {\r\n                case Left: dv.x = -camMoveSpeed; break\r\n                case Right: dv.x = camMoveSpeed; break\r\n                case Up: dv.y = -camMoveSpeed; break\r\n                case Down: dv.y = camMoveSpeed; break\r\n            }\r\n            this.camera.move(this.camera.pos.add(dv), 0)\r\n        }\r\n\r\n\r\n        this.game.input.keyboard.on('press', (e: Input.KeyEvent) => {\r\n            if (e.key === Input.Keys.Up || e.key === Input.Keys.W) {\r\n                moveCam(Up)\r\n            } else if (e.key === Input.Keys.Left || e.key === Input.Keys.A) {\r\n                moveCam(Left)\r\n            } else if (e.key === Input.Keys.Down || e.key === Input.Keys.S) {\r\n                moveCam(Down)\r\n            } else if (e.key === Input.Keys.Right || e.key === Input.Keys.D) {\r\n                moveCam(Right)\r\n            } else {\r\n                if (this.keyPressCallback) {\r\n                    this.keyPressCallback(e.key)\r\n                }\r\n            }\r\n        })\r\n        this.game.input.keyboard.on('hold', (e: Input.KeyEvent) => {\r\n            if (e.key === Input.Keys.Up || e.key === Input.Keys.W) {\r\n                moveCam(Up)\r\n            } else if (e.key === Input.Keys.Left || e.key === Input.Keys.A) {\r\n                moveCam(Left)\r\n            } else if (e.key === Input.Keys.Down || e.key === Input.Keys.S) {\r\n                moveCam(Down)\r\n            } else if (e.key === Input.Keys.Right || e.key === Input.Keys.D) {\r\n                moveCam(Right)\r\n            }\r\n        })\r\n    }\r\n\r\n    deactivate(): any {\r\n        this.game.input.keyboard.off('press')\r\n        this.game.input.keyboard.off('hold')\r\n        this.game.input.pointers.primary.off('wheel') //, (e: Input.WheelEvent) => {\r\n        this.game.input.pointers.primary.off('down') //, (e: Input.WheelEvent) => {\r\n        this.game.input.pointers.primary.off('up') //, (e: Input.WheelEvent) => {\r\n    }\r\n}","import { Scale } from \"../../values/Scale\";\r\n\r\nconst raisedSquare = require('../../images/raised-square-bg.png')\r\nconst leafy = require('../../images/leafy-bg.png')\r\nconst bookish = require('../../images/books-bg.png')\r\nconst posters = require('../../images/poster-wall-bg.png')\r\nconst tech = require('../../images/tech-bg.png')\r\nconst checker = require('../../images/checker-bg.png')\r\nconst beige = require('../../images/beige-bg.png')\r\nconst window = require('../../images/window-bg.png')\r\nconst ussf = require('../../images/ussf.png')\r\nconst wood = require('../../images/wood-panel-bg.png')\r\n\r\ninterface Background {\r\n    image: HTMLImageElement\r\n    pattern: CanvasPattern\r\n    loading: boolean\r\n}\r\n\r\nconst loadBg = (path, scale = 1) => {\r\n    let background: Background = { image: null, pattern: null, loading: true }\r\n    background.image = new Image();\r\n    background.image.src = path\r\n    background.image.onload = function () {\r\n      background.loading = false\r\n    }\r\n    return { background, scale }\r\n}\r\n\r\nexport enum BackgroundPattern {\r\n    Leafy = 'Leafy',\r\n    Grid = 'Grid',\r\n    Books = 'Books',\r\n    Poster = 'Poster',\r\n    Tech = 'Tech',\r\n    Checker = 'Checker',\r\n    Beige = 'Beige',\r\n    Window = 'Window',\r\n    USSF = 'USSF',\r\n    Wood = 'Wood',\r\n}\r\n\r\nconst backgroundPatterns: { [ key in BackgroundPattern ]: { background: Background, scale: number } } = {\r\n    Leafy: loadBg(leafy),\r\n    Grid: loadBg(raisedSquare),\r\n    Books: loadBg(bookish),\r\n    Poster: loadBg(posters),\r\n    Tech: loadBg(tech),\r\n    Checker: loadBg(checker),\r\n    Beige: loadBg(beige),\r\n    Window: loadBg(window),\r\n    USSF: loadBg(ussf, 0.5),\r\n    Wood: loadBg(wood),\r\n}\r\n\r\nexport const getBackgroundPattern = (ctx: CanvasRenderingContext2D, p: BackgroundPattern) => {\r\n    let pattern = backgroundPatterns[p]\r\n    let bg = pattern.background\r\n    if (!bg.loading) {\r\n        if (!bg.pattern) {\r\n            let matrix = new DOMMatrix() //bg.pattern.cre //ctx. // new SVGMatrix()\r\n\r\n            // bg.image.scal\r\n            // bg.image.scale\r\n            bg.pattern = ctx.createPattern(bg.image, 'repeat');\r\n            bg.pattern.setTransform(matrix.scale(pattern.scale * (Scale.major.first / 32))) //0.5))\r\n\r\n        }\r\n        return bg.pattern\r\n    }\r\n}","import { Color } from 'excalibur';\r\nimport { sample } from '../Util';\r\n\r\nexport class Colors {\r\n  static primary: Color[] = [\r\n    Color.Red, Color.Blue, Color.Yellow, // Color.Green,\r\n  ]\r\n\r\n  static secondary: Color[] = [\r\n    Color.Green, Color.Orange, Color.Violet,\r\n  ]\r\n\r\n  static tertiary: Color[] = [\r\n    Color.Vermillion, Color.Chartreuse, Color.Magenta, Color.Azure,\r\n    //Color.Teal,\r\n    new Color(54, 117, 136),\r\n\r\n    //Color.Amber\r\n    new Color(255, 191, 0),\r\n  ]\r\n\r\n  static process(c: Color): Color {\r\n    return c.clone()\r\n      .desaturate(0.68)\r\n      .lighten(0.14)\r\n  }\r\n}\r\n\r\nexport class World {\r\n    static nameCitizen(): string {\r\n      return sample([\r\n        // first-gen names\r\n        'Parthas', 'Athos', 'Karzak', 'Echo', 'Jaen', 'Xavier', 'Mante', 'Ern', 'Leor', 'Exiel', 'Tomlien', 'Amriel', 'Sariel', 'Arthax', 'Avalon',\r\n        'Kor', 'Exelon', 'Dominel', 'Prinz', 'Etsa', 'Corinth', 'Coade', 'Exter', 'Domnek', 'Tahm', 'Esk', 'Ith', 'Torl', 'Klapaucius', 'Antonidus',\r\n        'Exeleron', 'Moab', 'Thim', 'Pol', 'Maigel',\r\n\r\n        // second-gen\r\n        \"Abalone\", \"Exton\", \"Mauritius\", \"Elenorg\", \"Miga\", \"Elph\", \"Jame\", \"Eln\", \"Corax\", \"Thoeam\", \"Spoob\", \"Morna\", \"Elia\", \"Iatia\", \"Manea\",\r\n        \"Elphenor\", \"Morican\", \"Neutron\", \"Codeman\", \"Alphegor\", \"Belfast\", \"Minah\", \"Alcahtrazz\", \"Miskadew\", \"Erlangjag\", \"Manling\", \"Hopeful\",\r\n        \"Noman\", \"Nohbdy\", \"Elseone\", \"Othera\", \"Selene\", \"Maytrix\", \"Damsehl\", \"Allegore\", \"Samilie\", \"Phonolia\", \"Philia\", \"Dippides\", \"Euripimus\",\r\n        \"D'arcy\", \"Noname\", \"Sig\", \"Gil\", \"Felix\",  \"Ertrude\", \"Imitos\", \"Exitos\", \"Xenia\", \"Corelia\", \"Lineament\", \"Fundament\", \"Hyperion\", \"Nonce\",\r\n        \"Eris\", \"Nael\", \"Gronthax\", \"Sparerib\", \"Carhorn\", \"Doorknot\", \"Careful\", \"Sadusee\", \"Alright\", \"Kevim\", \"Elador\", \"Elabor\", \"Elgar\", \"Elbow\",\r\n        \"Nell\", \"Kell\", \"Tell\", \"Pell\", \"Jell\", \"Xell\", \"Zell\", \"Zil\", \"Zok\", \"Nog\", \"Yog\", \"Moog\", \"Mogue\", \"Rogue\", \"Boog\", \"Dude\", \"Aesthyr\", \"Kerax\",\r\n        \"Norman\", \"Gordon\", \"Gordax\", \"Gornoth\", \"Torgon\", \"Zorgax\", \"Zarnath\", \"Sarnox\", \"Porkath\", \"Esperil\", \"Ythr\", \"Dream\", \"Fever\", \"Spite\", \"Coreheart\",\r\n        \"Darkfire\", \"Lost\", \"Found\", \"Norm\", \"Korm\", \"Dorm\", \"Lorm\", \"Form\", \"Sorm\", \"Roam\", \"Nome\", \"Tome\", \"Bore\", \"Nore\", \"Kore\", \"Dorling\", \"Norlath\",\r\n        \"Natling\", \"Dathron\", \"Dathlax\", \"Kargill\", \"Nomandy\", \"Exactlee\", \"Terminax\", \"Exlith\", \"Lisztia\", \"Zed\", \"Alphus\", \"Quatlewis\", \"Serenado\", \"Imma\", \r\n\r\n        // third-gen\r\n        \"Splendor\", \"Airline\", \"Phax\", \"Index\", \"Tolerable\", \"Expert\", \"Tonsil\", \"Deerhoof\", \"Coldrain\", \"Darkwater\",\r\n        \"Interzone\", \"Neverwhen\", \"Dream\", \"Really\", \"Artefax\", \"Maniple\", \"Anseb\", \"Target\", \"Novim\", \"Evim\", \"Lisem\", \"Nancem\",\r\n        \"Orligot\", \"Nolifun\", \"Deriduh\", \"Flandor\", \"Lamplife\", \"Coldwave\", \"Oncetold\", \"Oncebit\", \"Twiceshy\", \"Niceguy\", \"Okay\",\r\n\r\n\r\n        // very long names\r\n        // \"Turbinaceous\", \"Etceteron\", \"Domicilian\", \"Colphraginate\",\"Malfeagarance\", \"Fintupulate\", \r\n        // \"Explenador\", \"Sedmonicker\", \"Diphtongidus\", \"Temperance\", \"Templexity\", \"Excapital\", \r\n        // \"Amtrack\", \"Coalescent\", \"Coagulant\", \"Tertullius\",  \"Imaginandum\", \"Terrycotta\",\r\n        // \"Aristotle\", \"Maximilien\",\r\n      ])\r\n    }\r\n\r\n  static colors = [\r\n    ...Colors.primary,\r\n  ] \r\n\r\n  static skyColors = [\r\n    ...Colors.secondary,\r\n  ]\r\n\r\n  static pickColor() {\r\n    return Colors.process(sample(World.colors)).darken(0.2)\r\n  }\r\n\r\n  static pickSkyColor() {\r\n    return Colors.process(\r\n      sample(World.skyColors)\r\n    ).lighten(0.2)\r\n  }\r\n}","import * as ex from 'excalibur';\r\nimport { Actor, Color, Vector, Scene } from 'excalibur';\r\nimport { Building } from '../Building';\r\nimport { range, flatSingle, mixColors, sample, closest, sleep } from '../../Util';\r\nimport { Structure } from '../../models/Structure';\r\nimport { Hud } from '../Hud/Hud';\r\nimport { ResourceBlock, Economy, sumMarkets, emptyMarket, availableCapacity, PureValue } from '../../models/Economy';\r\nimport { Colony } from './Colony';\r\nimport { Population } from './Population';\r\nimport { Machine } from '../../models/Machine';\r\nimport { Device } from '../Device';\r\nimport { MechanicalOperation } from '../../models/MechanicalOperation';\r\nimport { World } from '../../models/World';\r\nimport { SkyLayers } from './SkyLayers';\r\nimport { Citizen } from '../Citizen';\r\nimport { Game } from '../../Game';\r\n\r\nexport class Planet extends Actor {\r\n    colony: Colony\r\n    population: Population\r\n    hostiles: Citizen[] = []\r\n\r\n    baseSkyColor: Color\r\n    sky: Actor\r\n    skyLayers: SkyLayers\r\n\r\n    constructor(\r\n        public scene: Scene,\r\n        private w: number = 60000,\r\n        private depth: number = 30000,\r\n    ) {\r\n        super(0, depth / 2, w, depth, World.pickColor())\r\n        this.traits = this.traits.filter(trait => !(trait instanceof ex.Traits.OffscreenCulling))\r\n\r\n        this.baseSkyColor = World.pickSkyColor()\r\n        this.sky = new Actor(0, -depth, w, depth, this.baseSkyColor) //World.pickSkyColor())\r\n        this.add(this.sky)\r\n\r\n        let yBase = -depth / 2\r\n        let crustHeight = Game.mansheight * 4\r\n        this.createLayer(yBase, crustHeight, this.color.lighten(0.45))\r\n\r\n\r\n        let layerCount = 10\r\n        let layerHeight = depth / layerCount\r\n        for (let i of range(layerCount)) {\r\n            this.createLayer(\r\n                yBase + crustHeight + (layerHeight / 2) + (layerHeight * (i + 1)),\r\n                layerHeight,\r\n                this.color.darken(0.05 + 0.01 * i)\r\n            )\r\n        }\r\n        let c = this.color.clone()\r\n\r\n        this.skyLayers =new SkyLayers(\r\n           -depth/2, // - 20,\r\n           this.getWidth(),\r\n           this.color.lighten(0.04),\r\n           this.baseSkyColor.lighten(0.15),\r\n        //    3\r\n        )\r\n        this.add(this.skyLayers)\r\n\r\n        // this.depth = depth\r\n        this.buildColonyAndPopulation()\r\n    }\r\n\r\n    private hud: Hud\r\n    wireHud(hud: Hud) { this.hud = hud}\r\n\r\n    teardown() {\r\n        if (this.colony) {\r\n            this.colony.tearDown()\r\n            // this.colony.kill()\r\n            this.remove(this.colony)\r\n        }\r\n\r\n        if (this.population) {\r\n            this.population.tearDown()\r\n            // this.population.kill()\r\n            this.remove(this.population)\r\n        }\r\n    }\r\n\r\n    // depth: number\r\n    buildColonyAndPopulation() {\r\n        this.teardown()\r\n        \r\n\r\n        this.colony = new Colony(0, -this.depth / 2)\r\n        this.add(this.colony)\r\n\r\n        \r\n\r\n        // console.log(\"in planet, scene is: \", { scene: this.scene })\r\n        this.population = new Population(this, this.scene)\r\n        this.add(this.population)\r\n\r\n    }\r\n\r\n\r\n    private currentTime: number\r\n    private currentHour: number\r\n    get hour() { return this.currentHour }\r\n    get time() { return this.currentTime }\r\n\r\n    setTime(time: number) {\r\n        this.currentTime = time\r\n        this.currentHour = (Math.floor(time / 60)) % 24\r\n\r\n        let nextHour = this.hour + 1\r\n\r\n        let minute = Math.floor(time % 60)\r\n        let inc = (minute / 60)\r\n        // console.log({ hour: this.hour, nextHour: nextHour, minute, inc })\r\n\r\n        let oldC = this.skyColorForHour(this.hour),\r\n            newC = this.skyColorForHour(nextHour)\r\n        let mixC = mixColors(newC, oldC, inc)\r\n        this.assignColors(mixC)\r\n    }\r\n\r\n    private assignColors(skyColor: Color) {\r\n        this.sky.color = skyColor\r\n        // let inc = 0.02\r\n        let c = //mixColors(\r\n            this.sky.color.lighten(0.05) //.lighten(5 * inc) //,\r\n            // this.color.darken(5 * inc),\r\n            // 0.7\r\n        // )\r\n        this.skyLayers.setHi(c)\r\n    }\r\n\r\n    skyColorForHour(hour: number) {\r\n        let c = this.baseSkyColor.clone()\r\n        let colorMap = {\r\n            night: c.darken(0.7),\r\n            dawn: c.darken(0.2),\r\n            morning: c.lighten(0.1),\r\n            afternoon: c.lighten(0.2).desaturate(0.1),\r\n            evening: c,\r\n        }\r\n        let result: Color = null\r\n        if (hour >= 5 && hour < 8) { // dawn\r\n            let inc = (hour - 6) / 5\r\n            result = colorMap.dawn.lighten(inc)\r\n        } else if (hour >= 8 && hour < 12) { // morning\r\n            let inc = (hour - 8) / 24\r\n            result = colorMap.morning.lighten(inc)\r\n        } else if (hour >= 12 && hour < 14) { // early afternoon\r\n            result = colorMap.afternoon //.darken(inc)\r\n        } else if (hour >= 14 && hour < 18) {  // late afternoon\r\n            let inc = (hour - 14) / 16\r\n            result = colorMap.afternoon.darken(inc)\r\n        } else if (hour >= 18 && hour < 23) { // evening\r\n            let inc = (hour - 18) / 10\r\n            result = colorMap.evening.darken(inc)\r\n        } else if (hour >= 23) { // late night\r\n            result = colorMap.night\r\n        } else if (hour < 5) { // early morning\r\n            result = colorMap.night\r\n        }\r\n        return result\r\n    }\r\n\r\n    //set hour(hour: number) {\r\n    //    this.currentHour = hour\r\n    //}\r\n\r\n    set currentlyViewing(buildingOrDevice: Building | Device) {\r\n        if (buildingOrDevice instanceof Building) {\r\n            let b: Building = buildingOrDevice\r\n            if (this.hud) {\r\n                this.hud.showCard(b)\r\n            }\r\n        } else if (buildingOrDevice instanceof Device) {\r\n            let d: Device = buildingOrDevice\r\n            if (this.hud) {\r\n                this.hud.showCard(d)\r\n            }\r\n        }\r\n    }\r\n\r\n    private createLayer(y: number, size: number, color: Color) {\r\n        let theLayer = new Actor(0, y, this.getWidth(), size, color);\r\n        this.add(theLayer);\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta) {\r\n        super.draw(ctx, delta)\r\n\r\n        if (this.currentlyConstructing) {\r\n            this.currentlyConstructing.draw(ctx, delta)\r\n        }\r\n    }\r\n\r\n    get economy(): Economy {\r\n        // let devices = this.colony.findPoweredDevices()\r\n        // let economies = devices.map((d: Device) => d.machine.economy)\r\n\r\n        let buildings = this.colony.buildings\r\n        let economies = buildings.map(b => b.economy())\r\n        let theEconomy = economies.reduce(sumMarkets, emptyMarket())\r\n\r\n        let popularDemand = this.population.citizens.length\r\n        theEconomy['Shelter'].demand = popularDemand\r\n        theEconomy['Oxygen'].demand += popularDemand\r\n        theEconomy['Water'].demand += popularDemand\r\n        return theEconomy\r\n    }\r\n\r\n    update(engine, delta) {\r\n        super.update(engine, delta)\r\n\r\n        this.colony.buildings.forEach(building => building.update(engine, delta))\r\n        this.population.citizens.forEach(citizen => citizen.update(engine, delta))\r\n    }\r\n\r\n    get currentlyConstructing() {\r\n        return this.colony.currentlyConstructing\r\n    }\r\n\r\n    gather(resource: ResourceBlock): any {\r\n        if (this.hud) {\r\n            this.hud.resourceGathered(resource)\r\n        }\r\n    }\r\n\r\n    spend(resource: ResourceBlock): any {\r\n        if (this.hud) {\r\n            this.hud.resourceExpended(resource)\r\n        }\r\n    }\r\n\r\n    placeBuilding(building: Building) {\r\n        this.colony.placeBuilding(building)\r\n    }\r\n\r\n    populate(pos: Vector, elite: boolean = false) {\r\n        if (this.population.citizens.length < this.maxPop) {\r\n            // console.log(\"POPULATIN'!\")\r\n            // let home = this.closestDevice(pos, [CloningVat])\r\n            this.population.increase(pos, elite) //home)\r\n        } else {\r\n            console.warn(\"too many citizens already to populate more!\")\r\n        }\r\n    }\r\n\r\n    get maxPop() {\r\n        let devices = this.colony.findPoweredDevices()\r\n        let economies = devices.map((d: Device) => d.machine.economy)\r\n        let theEconomyWithoutPeople = economies.reduce(sumMarkets, emptyMarket())\r\n\r\n        let values = [PureValue.Shelter, PureValue.Water, PureValue.Oxygen]\r\n        return Math.max(0, Math.min(\r\n            ...values.map(val => availableCapacity(theEconomyWithoutPeople, val))\r\n        ))\r\n    }\r\n\r\n    closestBuildingByType(cursor: Vector, structureTypes: (typeof Structure)[], predicate: (Building) => boolean = () => true): Building {\r\n        return this.colony.closestBuildingByType(cursor, structureTypes, predicate)\r\n    }\r\n\r\n    closestDevice(cursor: Vector, machineTypes: (typeof Machine)[] = [], predicate: (Device) => boolean = () => true) {\r\n        return this.colony.closestDeviceByType(cursor, machineTypes, predicate);\r\n    }\r\n\r\n    pathBetween(origin: Vector, destination: Building): Vector[] {\r\n        return this.colony.pathBetween(origin, destination)\r\n    }\r\n\r\n    pathBetweenPoints(origin: Vector, destination: Vector): Vector[] {\r\n        return this.colony.pathBetweenPoints(origin, destination)\r\n    }\r\n\r\n    get timeFactor() {\r\n        let devices = this.colony.findPoweredDevices()\r\n        let ops: MechanicalOperation[] = devices.map(d => d.operation) //.filter(op => op.type === 'accelerate')\r\n        return ops\r\n            .map(op => op.type === 'accelerate' ? op.factor : 1)\r\n            .reduce((acc, val) => val * acc, 1.0)\r\n    }\r\n\r\n    get storedResources(): ResourceBlock[] {\r\n        let devices = this.colony.findAllDevices()\r\n        return flatSingle(devices.map(d => d.product))\r\n    }\r\n\r\n    hasMachineKind(kind: typeof Machine) {\r\n        return this.colony.findPoweredDevices().find(d => d.machine instanceof kind);\r\n    }\r\n\r\n    threatLevel: number = 0\r\n    async sendRaidingParty() {\r\n        if (this.threatLevel === 0) {\r\n            await sleep(10000) // wait for game to bootstrap (the first time)...\r\n        }\r\n        if (this.population && this.population.citizens && this.population.citizens.length > 0) {\r\n            this.threatLevel += 1\r\n            let maxPartySize = 1 + Math.floor(this.threatLevel / 3)\r\n            let partySize = 1 + sample(range(maxPartySize))\r\n            for (let times in range(partySize)) {\r\n                this.sendRaider()\r\n            }\r\n            console.warn(`Sent ${partySize} raiders!`)\r\n        }\r\n    }\r\n\r\n    private async sendRaider() {\r\n        let evil = true\r\n        let elite = Math.random() < 0.03\r\n        let large = this.threatLevel > 3 ? Math.random() < 0.1 : Math.random() < 0.03\r\n        let options = { evil, elite, large }\r\n\r\n        let origin = this.colony.origin.clone()\r\n        origin.y = this.getTop() + 5\r\n        let xOff = Math.random() * 50\r\n        let raider =\r\n            new Citizen('Raider', origin.add(new Vector(5000 + xOff, 0)), this, options)\r\n\r\n        this.population.raiders.push(\r\n            raider\r\n        )\r\n\r\n        this.scene.add(raider)\r\n        let target = closest(raider.pos, this.population.citizens, (c) => c.pos)\r\n        raider.engageHostile(target) //sample(this.population.citizens))\r\n    }\r\n}","import { Input, Vector, LockCameraToActorStrategy, Color, Engine, UIActor } from \"excalibur\";\r\nimport { Building, structureViews } from \"./actors/Building\";\r\nimport { DevicePlace } from \"./actors/Building/Building\";\r\nimport { Device } from \"./actors/Device\";\r\nimport { Hud } from \"./actors/Hud/Hud\";\r\nimport { Planet } from \"./actors/Planet/Planet\";\r\nimport { Machine, allMachines } from \"./models/Machine\";\r\nimport { LivingQuarters, MissionControl, SolarArray, RoomRecipe } from \"./models/RoomRecipe\";\r\nimport { Corridor, HugeRoom, LargeRoom, MainTunnel, MediumRoomThree, SmallDome, SmallRoomThree, Structure, SurfaceRoad } from \"./models/Structure\";\r\nimport { flatSingle, zip, sample, closest } from \"./Util\";\r\nimport { DeviceSize } from \"./values/DeviceSize\";\r\nimport { TechnologyRank } from \"./models/TechnologyRank\";\r\nimport { TechTree } from \"./models/TechTree\";\r\nimport { Citizen } from \"./actors/Citizen\";\r\nimport { GameController } from \"./GameController\";\r\nimport { Game } from \"./Game\";\r\nimport { Player } from \"./actors/player\";\r\nimport { Scale } from \"./values/Scale\";\r\n// handle ui for construction (also includes following stuff?)\r\nexport class Construction extends UIActor {\r\n    private restricted: boolean = true\r\n    static requiredStructuresAndFunctions: (typeof RoomRecipe | typeof Structure)[] = [\r\n        MissionControl,\r\n        SurfaceRoad,\r\n        SolarArray,\r\n        MainTunnel,\r\n        Corridor,\r\n        LivingQuarters,\r\n    ];\r\n    private lost: boolean = true;\r\n    private techTree: TechTree = new TechTree()\r\n    private followedCitizen: Citizen = null\r\n    private hasActiveModal: boolean = false\r\n    private defaultMessage: string = 'Welcome to the Colony, Commander.';\r\n    firstBuilding: boolean = true\r\n    placingFunction: RoomRecipe = null\r\n    private hud: Hud\r\n\r\n    constructor(private planet: Planet, private game: Game, private introMessage: string) {\r\n        super() //0, 0, 0, 0)\r\n        let buildIt = (e) => this.startConstructing(e);\r\n        let followIt = (c) => this.toggleFollowing(c);\r\n        this.hud = new Hud(this.game, buildIt, buildIt, buildIt, followIt);\r\n        this.planet.wireHud(this.hud);\r\n    }\r\n\r\n    standup(ctrl: GameController) {\r\n        this.scene.add(this.hud);\r\n        this.hud.show();\r\n        if (this.lost) {\r\n            this.welcome();\r\n        }\r\n        this.controlWith(ctrl)\r\n    }\r\n\r\n    teardown() {\r\n        this.scene.remove(this.hud);\r\n        this.hud.hide();\r\n        this.closeSystemMessage();\r\n        this.stopFollowing();\r\n    }\r\n\r\n    update(engine: Engine, delta) {\r\n        let devices = this.planet.colony.findPoweredDevices();\r\n        let machines = allMachines.filter(machine => devices.some(device => device.machine instanceof machine));\r\n        let discipline = this.techTree.findDisciplineToRankUp(machines);\r\n        if (discipline) {\r\n            let rank = this.techTree.rankUp(discipline);\r\n            this.rankUp(rank);\r\n        }\r\n        this.hud.updateDetails(this.planet, this.techTree, this.followedCitizen, true, this.planet.time); //, this.scene.currentTime)\r\n        if (!this.lost && !this.firstBuilding && this.planet.population.citizens.length === 0) {\r\n            this.lost = true;\r\n            this.askYesNo('The colony has perished! Try again?', () => this.welcome(), () => engine.goToScene('menu'));\r\n        }\r\n\r\n        let pos = engine.input.pointers.primary.lastWorldPos\r\n        let hoverables: (Device | Building)[] = [\r\n            ...this.planet.colony.findAllDevices(),\r\n            ...this.planet.colony.buildings,\r\n            // ...this.planet.population.citizens\r\n        ]\r\n        if (hoverables.length > 0) {\r\n            hoverables.forEach(h => h.hover = false)\r\n            let center = (d: Device | Building) => {\r\n                let pos = d.getWorldPos()\r\n                if (d instanceof Building) {\r\n                    pos.addEqual(new Vector(d.getWidth()/2, d.getHeight()/2))\r\n                }\r\n                return pos\r\n            }\r\n            // .add( new Vector(d.getWidth() / 2, d.getHeight() / 2))\r\n            let hoverable: Device | Building = closest(\r\n                pos,\r\n                hoverables,\r\n                center\r\n            )\r\n            if (hoverable && center(hoverable).distance(pos) < hoverable.getWidth()) {\r\n                // console.log(\"HOVER ON\", { hoverable })\r\n                hoverable.hover = true\r\n                // hoverable.z = 1000\r\n                this.hud.showCard(hoverable)\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    get camera() { return this.game.currentScene.camera; }\r\n    controlWith(controller: GameController) {\r\n        controller.onCameraPan(() => this.stopFollowing());\r\n        controller.onMove((pos: Vector) => {\r\n            if (this.hasActiveModal) {\r\n                return;\r\n            }\r\n            let currentlyBuilding = this.planet.currentlyConstructing;\r\n            if (currentlyBuilding instanceof Building) {\r\n                let constrained = currentlyBuilding.constrainCursor(pos);\r\n                currentlyBuilding.reshape(constrained)\r\n            }\r\n            else if (currentlyBuilding instanceof Device) {\r\n                currentlyBuilding.snap(this.planet, pos)\r\n            }\r\n        });\r\n        controller.onLeftClick((pos: Vector, shift: boolean) => {\r\n            if (this.hasActiveModal) {\r\n                return;\r\n            }\r\n            const currentlyBuilding = this.planet.currentlyConstructing;\r\n            if (currentlyBuilding) {\r\n                if (currentlyBuilding instanceof Building) {\r\n                    let buildingUnderConstruction = currentlyBuilding;\r\n                    let placementValid = !buildingUnderConstruction.overlapsAny();\r\n                    if (buildingUnderConstruction && placementValid && buildingUnderConstruction.handleClick(pos)) {\r\n                        this.planet.placeBuilding(buildingUnderConstruction);\r\n                        if (this.placingFunction) {\r\n                            let fn = this.placingFunction;\r\n                            zip(fn.machines, buildingUnderConstruction.devicePlaces()).forEach(([machine, place]: [typeof Machine, DevicePlace]) => {\r\n                                let m = (new machine()).concretize();\r\n                                let device = new Device(m, place.position);\r\n                                buildingUnderConstruction.addDevice(device);\r\n                            });\r\n                            this.placingFunction = null;\r\n                        }\r\n                        this.hud.setStatus(this.defaultMessage);\r\n                        this.planet.colony.currentlyConstructing = null;\r\n                        this.prepareNextBuilding(pos);\r\n                    }\r\n                }\r\n                else {\r\n                    let deviceUnderConstruction = currentlyBuilding;\r\n                    let placementValid = (deviceUnderConstruction.size === DeviceSize.Tiny) ||\r\n                        !deviceUnderConstruction.overlapsAny();\r\n                    let snapped = deviceUnderConstruction.snap(this.planet);\r\n                    if (snapped && placementValid) {\r\n                        if (deviceUnderConstruction.size === DeviceSize.Tiny) {\r\n                            let parent = deviceUnderConstruction.parentDevice;\r\n                            parent.addTinyDevice(deviceUnderConstruction);\r\n                        }\r\n                        else {\r\n                            let bldg = deviceUnderConstruction.building;\r\n                            bldg.addDevice(deviceUnderConstruction);\r\n                        }\r\n                        this.planet.colony.currentlyConstructing = null;\r\n                        this.hud.setStatus(this.defaultMessage);\r\n                        if (shift) {\r\n                            this.startConstructing(deviceUnderConstruction.machine);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        controller.onKeyPress((key) => {\r\n            if (this.hasActiveModal) {\r\n                return;\r\n            }\r\n            if (key === Input.Keys.H) {\r\n                if (this.buildings && this.buildings[0]) {\r\n                    this.stopFollowing();\r\n                    this.camera.move(this.buildings[0].pos, 500);\r\n                    this.camera.zoom(0.5, 1000);\r\n                }\r\n            }\r\n            else if (key === Input.Keys.Esc) {\r\n                this.planet.colony.currentlyConstructing = null;\r\n                this.placingFunction = null;\r\n                this.stopFollowing(true);\r\n                this.hud.setStatus(this.defaultMessage);\r\n            }\r\n        });\r\n    }\r\n\r\n    restrictionsOff() {\r\n        this.restricted = false\r\n        this.hud.restrictionsOff()\r\n    }\r\n\r\n    get buildings() { return this.planet.colony.buildings; }\r\n    welcome() {\r\n        this.planet.buildColonyAndPopulation();\r\n        this.lost = false;\r\n        this.firstBuilding = true;\r\n        this.infoMessage(this.introMessage, () => this.prepareNextBuilding());\r\n        this.camera.zoom(0.25);\r\n    }\r\n    cameraStrategy: LockCameraToActorStrategy;\r\n    startFollowing(citizen) {\r\n        this.stopFollowing();\r\n        this.cameraStrategy = new LockCameraToActorStrategy(citizen);\r\n        this.camera.zoom(1.2, 1000);\r\n        this.camera.addStrategy(this.cameraStrategy);\r\n        this.followedCitizen = citizen;\r\n    }\r\n    stopFollowing(resetZoom = false) {\r\n        if (this.cameraStrategy) {\r\n            this.camera.removeStrategy(this.cameraStrategy);\r\n            if (resetZoom) {\r\n                this.camera.zoom(0.5, 1000);\r\n            }\r\n            this.followedCitizen = null;\r\n        }\r\n    }\r\n    startConstructing(structureOrMachine: Structure | Machine | RoomRecipe, pos: Vector = new Vector(0, 0)) {\r\n        this.hud.showCard(structureOrMachine);\r\n        let theNextOne = null;\r\n        if (structureOrMachine instanceof Structure) {\r\n            let structure = structureOrMachine;\r\n            this.hud.setStatus(`Place ${structure.name} (${structure.description})`);\r\n            theNextOne = this.spawnBuilding(structure, pos);\r\n            if (this.firstBuilding) {\r\n                this.camera.zoom(structure.zoom, 250);\r\n                this.camera.pos = theNextOne.pos;\r\n                this.firstBuilding = false;\r\n            }\r\n        }\r\n        else if (structureOrMachine instanceof Machine) {\r\n            let machine = structureOrMachine;\r\n            this.hud.setStatus(`Install ${machine.name} (${machine.description})`);\r\n            theNextOne = this.spawnDevice(machine, pos);\r\n        }\r\n        else if (structureOrMachine instanceof RoomRecipe) {\r\n            let fn: RoomRecipe = structureOrMachine;\r\n            this.hud.setStatus(`Place ${fn.name} (${fn.description})`);\r\n            theNextOne = this.spawnFunction(fn, pos);\r\n            this.placingFunction = fn;\r\n        }\r\n        this.planet.colony.currentlyConstructing = null;\r\n        if (theNextOne) {\r\n            this.planet.colony.currentlyConstructing = theNextOne;\r\n        }\r\n    }\r\n    protected spawnDevice(machine: Machine, pos: Vector): Device {\r\n        let device = new Device(machine, pos);\r\n        if (device.snap(this.planet)) {\r\n            this.camera.pos = device.pos;\r\n        }\r\n        return device;\r\n    }\r\n    private spawnBuilding(structure: Structure, pos: Vector): Building {\r\n        let anotherBuilding = this.assembleBuildingFromStructure(structure, pos);\r\n        anotherBuilding.reshape(anotherBuilding.constrainCursor(pos));\r\n        return anotherBuilding;\r\n    }\r\n    private assembleBuildingFromStructure(structure: Structure, pos: Vector): Building {\r\n        let View = structureViews[structure.view];\r\n        let building = new View(pos, structure, this.planet);\r\n        return building;\r\n    }\r\n    private spawnFunction(fn: RoomRecipe, pos: Vector): Building {\r\n        let theStructure: Structure = (fn.structure && new fn.structure()); // || new SmallRoomThree()\r\n        if (!theStructure) {\r\n            theStructure = new SmallRoomThree();\r\n            let machines = fn.machines.map(m => new m());\r\n            if (machines.some(m => m.size === DeviceSize.Medium)) {\r\n                theStructure = new MediumRoomThree();\r\n            }\r\n            if (machines.some(m => m.size === DeviceSize.Large)) {\r\n                theStructure = new LargeRoom();\r\n            }\r\n            if (machines.some(m => m.size === DeviceSize.Huge)) {\r\n                theStructure = new HugeRoom();\r\n            }\r\n            if (machines.some(m => m.forDome)) {\r\n                theStructure = new SmallDome();\r\n            }\r\n        }\r\n        let building = this.assembleBuildingFromStructure(theStructure, pos);\r\n        building.reshape(building.constrainCursor(building.pos));\r\n        return building;\r\n    }\r\n    private nextMissingStructureOrFunction(): Structure | RoomRecipe {\r\n        let reqs = Construction.requiredStructuresAndFunctions.map(req => new req());\r\n        let actualStructureNames = this.buildings.map(building => building.structure.name);\r\n        let actualFunctionNames = flatSingle(this.buildings.map(building => building.spaceFunction && building.spaceFunction.name));\r\n        let actualNames = [...actualStructureNames, ...actualFunctionNames];\r\n        return reqs.find(req => !actualNames.includes(req.name));\r\n    }\r\n    protected prepareNextBuilding(pos: Vector = new Vector(0, 0)) {\r\n        let structure = null;\r\n        let nextMissing = this.nextMissingStructureOrFunction();\r\n        if (nextMissing) {\r\n            structure = nextMissing;\r\n        }\r\n        if (structure) {\r\n            let congrats = sample(['Alright!', 'Perfect.', 'Great work!', 'Excellent!', 'Good.', 'That works.', 'Cool.', 'Fantastic!', 'Now we are cooking.', 'It looks good!']);\r\n            let nextUp = sample([\"Let's pick a location for a\", 'Next we will build a', 'Okay, time to make a', 'Get ready to place a']);\r\n            this.tutorialMessage(`${congrats} ${nextUp} ${structure.name}...`);\r\n            this.startConstructing(structure, pos);\r\n        }\r\n        else {\r\n            this.hud.showPalettes();\r\n        }\r\n    }\r\n    toggleFollowing(citizen) {\r\n        if (this.followedCitizen === citizen) {\r\n            this.stopFollowing(true);\r\n        }\r\n        else {\r\n            this.startFollowing(citizen);\r\n        }\r\n    }\r\n    showTutorial: boolean = true;\r\n    private infoMessage(message: string, onComplete: () => any = null) {\r\n        this.hasActiveModal = true;\r\n        this.hud.systemMessage(message, \"\", {\r\n            continue: () => {\r\n                this.closeSystemMessage(); if (onComplete) {\r\n                    onComplete();\r\n                }\r\n            },\r\n        });\r\n    }\r\n    private askYesNo(message: string, onYes: () => any, onNo: () => any) {\r\n        this.hasActiveModal = true;\r\n        this.hud.systemMessage(message, \"\", {\r\n            yes: () => {\r\n                this.closeSystemMessage(); if (onYes) {\r\n                    onYes();\r\n                }\r\n            },\r\n            no: () => {\r\n                this.closeSystemMessage(); if (onNo) {\r\n                    onNo();\r\n                }\r\n            },\r\n        });\r\n    }\r\n    private tutorialMessage(message: string) {\r\n        if (this.showTutorial) {\r\n            this.hasActiveModal = true;\r\n            this.hud.systemMessage(message, \"\", {\r\n                'i got this': () => {\r\n                    this.closeSystemMessage();\r\n                    this.showTutorial = false;\r\n                },\r\n                continue: () => { this.closeSystemMessage(); },\r\n            });\r\n        }\r\n    }\r\n    private rankUp(rank: TechnologyRank) {\r\n        if (this.lost || !this.restricted) {\r\n            return;\r\n        }\r\n        if (this.hasActiveModal) {\r\n            this.closeSystemMessage();\r\n        }\r\n        this.hasActiveModal = true;\r\n        let rankUpMessage = \"Your colony's mastery of a discipline has improved! \" +\r\n            \"The following new machines are now available for construction:\";\r\n        let okay = sample(['excellent!', 'great!', 'perfect', 'good work', 'cool', 'wonderful', 'brilliant', 'that is what i am talking about', 'keep up the good work', 'learning is fun!']);\r\n        let modal = this.hud.systemMessage(rankUpMessage, \"rank up\", {\r\n            [okay]: () => { this.closeSystemMessage(); }\r\n        });\r\n        modal.addHeading(rank.name, 28, Color.Orange);\r\n        modal.addHeading(rank.description, 12);\r\n        modal.addIconMatrix(rank.unlocks.map(m => new m()).map(machine => {\r\n            return {\r\n                image: machine.image,\r\n                label: machine.name\r\n            };\r\n        }));\r\n    }\r\n    private closeSystemMessage() {\r\n        this.hud.closeSystemMessage();\r\n        this.hasActiveModal = false;\r\n    }\r\n}\r\n","import { Color } from 'excalibur';\r\nimport { range, mixColors } from '../../Util';\r\nimport { PlanetBackground } from './PlanetBackground';\r\nimport { Scale } from '../../values/Scale';\r\nexport class MountainLayers extends PlanetBackground {\r\n    layers: {\r\n        baseY: number;\r\n        deltas: number[];\r\n    }[] = [];\r\n    skyColor: Color = Color.Blue.clone();\r\n    static layerHeight: number = Scale.minor.third;\r\n    static layerCount = 1;\r\n    peakCount = 460;\r\n    get peakWidth() {\r\n        return Math.floor(this.getWidth() / this.peakCount);\r\n    }\r\n    onInitialize() {\r\n        let c = MountainLayers.layerCount\r\n        for (let layerIndex of range(c)) {\r\n            this.layers.unshift({\r\n                baseY: (layerIndex + 1) * (-MountainLayers.layerHeight+4),\r\n                deltas: this.genPeaks(layerIndex)\r\n            });\r\n        }\r\n    }\r\n    draw(ctx, delta) {\r\n        let wc = this.color.clone();\r\n        let sc = this.skyColor.clone().lighten(0.1);\r\n        let ndx = 1;\r\n        let ls = this.layers.slice();\r\n        for (let layer of ls) {\r\n            let c = mixColors(wc, sc, (ndx / (this.layers.length)));\r\n            this.drawLayer(ctx, layer, c);\r\n            ndx += 1;\r\n        }\r\n    }\r\n    private drawLayer(ctx, layer, color) {\r\n        let ox = -this.getWidth() / 2, oy = this.pos.y + layer.baseY;\r\n        let c = color.clone();\r\n        ctx.beginPath();\r\n        ctx.moveTo(ox, oy);\r\n        let ndx = 0;\r\n        for (let delta of layer.deltas) {\r\n            ctx.lineTo(ox + (ndx * this.peakWidth), oy + delta);\r\n            ndx += 1;\r\n        }\r\n        ctx.lineTo(ox + (this.peakCount * this.peakWidth), oy);\r\n        let h = MountainLayers.layerHeight\r\n        ctx.lineTo(ox + (this.peakCount * this.peakWidth), oy + h) //this.layerHeight);\r\n        ctx.lineTo(ox, oy + h) //this.layerHeight);\r\n        ctx.closePath();\r\n        c.a = 1;\r\n        ctx.fillStyle = c.toRGBA();\r\n        ctx.fill();\r\n    }\r\n    private genPeaks(n) {\r\n        let h = MountainLayers.layerHeight\r\n        let dMax = 1 * (h / 2);\r\n        let deltas = [];\r\n        let randomDelta = () => (Math.random() * (dMax)) - (dMax / 2);\r\n        let last = 0;\r\n        let maxDiff = (h/3);\r\n        for (let times in range(this.peakCount)) {\r\n            let curr = randomDelta();\r\n            let pick = Math.max(last - maxDiff, Math.min(curr, last + maxDiff));\r\n            deltas.push(pick);\r\n            last = pick;\r\n        }\r\n        return deltas;\r\n    }\r\n}\r\n","import { Actor, Color } from 'excalibur';\r\n\r\nexport class PlanetBackground extends Actor {\r\n    constructor(y: number, width: number, color: Color) {\r\n        super(0, y, width, 1500, color)\r\n    }\r\n}\r\n\r\n","import { Color, ParticleEmitter, EmitterType } from \"excalibur\";\r\nimport { Scale } from \"../values/Scale\";\r\n\r\nexport function makeEmitter(beginC: Color, endC: Color, size: number = Scale.minor.first) {\r\n    let emitter = new ParticleEmitter()\r\n    emitter.emitterType = EmitterType.Circle\r\n    emitter.radius = size\r\n    emitter.minVel = 10\r\n    emitter.maxVel = 24\r\n    emitter.minAngle = 0\r\n    emitter.maxAngle = Math.PI * 2\r\n    emitter.emitRate = 350\r\n    emitter.opacity = 0.5\r\n    emitter.fadeFlag = true\r\n    emitter.particleLife = 500\r\n    emitter.maxSize = 2\r\n    emitter.minSize = 1\r\n    emitter.beginColor = beginC //Color.Red.darken(0.12)\r\n    emitter.endColor = endC //Color.Red.darken(0.36)\r\n    emitter.isEmitting = false\r\n    return emitter\r\n}","import { Actor, Color, CollisionType, Traits } from \"excalibur\";\r\nimport { Game } from \"../Game\";\r\nimport { Citizen } from \"./Citizen\";\r\nimport { Device } from \"./Device\";\r\nimport { Scale } from \"../values/Scale\";\r\n\r\nexport class LaserBeam extends Actor {\r\n    private evil: boolean\r\n    constructor(private source: Citizen | Device, private targetDirectionSign: number) {\r\n        super(\r\n            source.pos.x + 4 * targetDirectionSign,\r\n            source.pos.y - (source.getHeight() / 3),\r\n            Scale.minor.third,\r\n            1 //0.8\r\n        )\r\n\r\n        this.evil = source.isEvil\r\n\r\n        this.color = (this.evil ? Color.Green : Color.Cyan).clone().lighten(0.3)\r\n        this.vel.x = Game.bulletSpeed * targetDirectionSign\r\n\r\n        let drift = 12\r\n        this.vel.y = (Math.random() * drift) - (drift/2)\r\n        this.on('collisionstart', this.handleCollision) \r\n        this.collisionType = CollisionType.Passive\r\n        this.traits = this.traits.filter(trait => !(trait instanceof Traits.OffscreenCulling))\r\n    }\r\n\r\n    handleCollision = (collision) => {\r\n        let rightKindOfThing = \r\n            (collision.other instanceof Citizen && collision.other.alive) // ||\r\n            // (collision.other instanceof Device && collision.other.defender)\r\n        if (!rightKindOfThing) { return }\r\n\r\n        let validTarget = this.evil !== collision.other.isEvil\r\n        if (!validTarget) { return }\r\n\r\n        if (collision.other instanceof Citizen) {\r\n            this.hitPerson(collision.other)\r\n        } // else if (collision.other instanceof Device) {\r\n            // this.hitThing(collision.other)\r\n        // }\r\n    }\r\n\r\n    private hitPerson(citizen: Citizen) {\r\n        if (citizen.guarding) {\r\n            // 60% chance to reflect\r\n            if (Math.random() > 0.4) {\r\n                this.vel.x = -this.vel.x\r\n                this.evil = !this.evil\r\n                // 10% chance to alter y-vel\r\n                if (Math.random() > 0.9) {\r\n                    this.vel.y += (Math.random() * 60) - 30\r\n                }\r\n            } else if (Math.random() > 0.4) {\r\n                // if didn't reflect, 60% to absorb\r\n                this.kill()\r\n            }\r\n        } else if (Math.random() > 0.4) {\r\n            this.kill()\r\n            let damage = 5 + (Math.random() * 2)\r\n            citizen.injure(damage, this.source)\r\n        }\r\n    }\r\n\r\n    // private hitThing(device: Device) {\r\n        // console.debug(\"a defensive device was struck!\")\r\n    // }\r\n}","import { Strategy } from \"./Strategy\";\r\n\r\nexport abstract class CombatStrategy extends Strategy {\r\n    describe() { return 'fighting' }\r\n}","import { minBy } from \"../Util\";\r\nimport { Game } from \"../Game\";\r\nimport { Scale } from \"./Scale\";\r\n\r\nexport class Graph<T> {\r\n    private empty: boolean = true\r\n    public nodes: T[] = []\r\n    private edges: { [key: number]: number[] } = {}\r\n    private edgesInverse: { [key: number]: number[] } = {}\r\n\r\n    public isEmpty(): boolean {\r\n        return this.empty;\r\n    }\r\n\r\n    public get size() { return this.nodes.length }\r\n\r\n    public node(newNode: T) {\r\n        this.empty = false;\r\n        if (!this.contains(newNode)) {\r\n            this.nodes.push(newNode)\r\n        }\r\n    }\r\n\r\n    public contains(testNode: T) {\r\n        return this.nodes.includes(testNode)\r\n    }\r\n\r\n    public findOrCreate(testNode: T, measure: (a: T, b: T) => number, tolerance: number = Scale.minor.second): T {\r\n        let nodes = this.dfs();\r\n        let closest = minBy(nodes, (node: T) => measure(testNode, node))\r\n        if (closest && measure(closest, testNode) < tolerance) {\r\n            return closest;\r\n        }\r\n        return testNode;\r\n    }\r\n\r\n    public edge(src: T, dst: T) {\r\n        this.node(src)\r\n        this.node(dst)\r\n\r\n        let s = this.indexOf(src), d = this.indexOf(dst)\r\n        this.edges[s] = this.edges[s] || []\r\n        this.edges[s].push(d)\r\n\r\n        this.edgesInverse[d] = this.edgesInverse[d] || []\r\n        this.edgesInverse[d].push(s)\r\n    }\r\n\r\n    public union(otherGraph: Graph<T>) {\r\n       otherGraph.edgeList().forEach(([a,b]) => this.edge(a,b))\r\n    }\r\n\r\n    public edgeList(): [T,T][] {\r\n        let theEdges = []\r\n        for (let node of this.nodes) {\r\n            let index = this.indexOf(node)\r\n            if (this.edges[index]) {\r\n                for (let otherIndex of this.edges[index]) {\r\n                    let otherNode = this.nodes[otherIndex]\r\n                    if (!theEdges.includes([otherNode, node])) {\r\n                        theEdges.push([node, otherNode])\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return theEdges\r\n    }\r\n\r\n    public adjacent(testNode: T): T[] {\r\n        let index = this.indexOf(testNode)\r\n        let vertex = this.adjacentIndices(index)\r\n        return vertex.map((n) => this.nodes[n])\r\n    }\r\n\r\n    private adjacentIndices(testNodeIndex: number): number[] {\r\n        let es = this.edges[testNodeIndex] || []\r\n        let esInv = this.edgesInverse[testNodeIndex] || []\r\n        let vertex = [...es, ...esInv ]\r\n        return vertex\r\n    }\r\n\r\n    public dfs(root:T=null, visited=[]): T[] {\r\n        let rIndex = root ? this.indexOf(root) : 0\r\n        return this.dfsIndex(rIndex).map(n => this.nodes[n])\r\n    }\r\n\r\n    private dfsIndex(rootIndex:number=0, visited:number[]=[]) {\r\n        visited.push(rootIndex)\r\n        let children = this.adjacentIndices(rootIndex)\r\n        children.forEach((childIndex: number) => {\r\n            if (!visited.includes(childIndex)) {\r\n                this.dfsIndex(childIndex, visited)\r\n            }\r\n        })\r\n\r\n        return visited\r\n    }\r\n\r\n    public bfs(root:T=null, cb: (x: number,y: number)=>boolean = ()=>true): T[] {\r\n        let rIndex = root ? this.indexOf(root) : 0\r\n        return this.bfsIndex(rIndex, cb).map(n => this.nodes[n])\r\n    }\r\n\r\n    private bfsIndex(rootIndex:number=null, cb: (x: number, y: number) => boolean = () => true): number[] {\r\n        let halt = false;\r\n        let visited: number[] = []\r\n        visited.push(rootIndex)\r\n        let tries = 0\r\n        while (visited.length < this.nodes.length && tries++ < this.nodes.length * 20) {\r\n            for (let visitedNode of visited) {\r\n                let adj: number[] = this.adjacentIndices(visitedNode)\r\n                for (let adjacentNode of adj) {\r\n                    if (!visited.includes(adjacentNode)) {\r\n                        if (!cb(visitedNode, adjacentNode)) {\r\n                            halt = true;\r\n                            break;\r\n                        }\r\n                        visited.push(adjacentNode)\r\n                    }\r\n                }\r\n                if (halt) break;\r\n            }\r\n            if (halt) break;\r\n        }\r\n        return visited\r\n    }\r\n\r\n    public shortestPath(src: T, dst: T, maxStep: number = 256): T[] {\r\n        let prevStep = {}\r\n        let dstIndex = this.indexOf(dst)\r\n        this.bfs(src, (prev, curr) => {\r\n            prevStep[curr] = prev;\r\n            return curr !== dstIndex\r\n        })\r\n        let path = []\r\n        let curr = dstIndex\r\n        let steps = 0\r\n        let srcIndex = this.indexOf(src)\r\n        while (!path.includes(srcIndex) && steps < maxStep) {\r\n            path.push(curr)\r\n            curr = prevStep[curr]\r\n            steps += 1\r\n        }\r\n        let pathNodes = path.map(n => this.nodes[n])\r\n        return pathNodes.reverse()\r\n    }\r\n\r\n    private indexOf(node: T) {\r\n        return this.nodes.indexOf(node)\r\n    }\r\n\r\n}","import { Texture, Sound } from 'excalibur';\r\nconst sword = require('./images/sword.png');\r\nconst craterRock = require('./sounds/crater-rock.mp3')\r\nconst assembler = require('./sounds/assembler.mp3')\r\nconst indivision = require('./sounds/indivision.mp3')\r\nconst understanding = require('./sounds/understanding.mp3')\r\nconst futureTense = require('./sounds/future tense.mp3')\r\n// const isomer = require('./sounds/isomer.mp3')\r\n// const outbound = require('./sounds/outbound.mp3')\r\n\r\nlet Resources = {\r\n    Sword: new Texture(sword),\r\n\r\n    // CraterRock: new Sound(craterRock),\r\n    Assembler: new Sound(assembler),\r\n    // Indivision: new Sound(indivision),\r\n    // Understanding: new Sound(understanding),\r\n    FutureTense: new Sound(futureTense),\r\n    // Isomer: new Sound(isomer),\r\n    // Outbound: new Sound(outbound),\r\n\r\n\r\n}\r\n\r\nexport { Resources }\r\n","import { Scene, Engine } from \"excalibur\";\r\nimport { Planet } from \"../actors/Planet/Planet\";\r\nimport { GameController } from \"../GameController\";\r\nimport { Construction } from \"../Construction\";\r\nimport { Game } from \"../Game\";\r\n\r\nexport class Sandbox extends Scene {\r\n    private controller: GameController\r\n    private planet: Planet\r\n    private construction: Construction\r\n\r\n    public onInitialize(game: Game) {\r\n        this.planet = new Planet(this)\r\n        this.add(this.planet)\r\n        this.construction = new Construction(this.planet, game,\r\n            \"Welcome to the Ad Astra sandbox. \" +\r\n            \"All structures and devices are permitted here. \" +\r\n            \"Go build whatever you are dreaming of! \"\r\n            )\r\n        this.construction.restrictionsOff()\r\n    }\r\n\r\n    public onActivate() {\r\n        this.add(this.construction)\r\n        this.controller = new GameController(this.engine, this.camera)\r\n        this.construction.standup(this.controller)\r\n        this.controller.activate()\r\n    }\r\n\r\n    public onDeactivate() {\r\n        this.construction.teardown()\r\n        this.controller.deactivate()\r\n    }\r\n}","import { Pane } from \"../actors/Hud/Pane\";\r\nimport { Scene, Color, Engine, ParticleEmitter, Vector } from \"excalibur\";\r\nimport { assembleButton } from \"../Elemental\";\r\nimport { GameController } from \"../GameController\";\r\nimport { drawText } from \"../Painting\";\r\nimport { Game } from \"../Game\";\r\nimport { sleep } from \"../Util\";\r\n\r\nclass SceneList extends Pane {\r\n\r\n    travelling: boolean = false\r\n    setup(btns: { label: string, scene: string }[], engine: Engine) {\r\n        btns.forEach(btn => {\r\n            let theButton = assembleButton(btn.label, Color.Blue)\r\n            theButton.onclick = async () => {\r\n                if (!this.travelling) {\r\n                    this.travelling = true\r\n                    engine.currentScene.camera.zoom(0.0125, 450)\r\n                    await sleep(500)\r\n                    engine.goToScene(btn.scene)\r\n                    this.travelling = false\r\n                }\r\n            }\r\n            this._element.appendChild(theButton)\r\n        })\r\n    }\r\n\r\n}\r\n\r\nexport class Menu extends Scene {\r\n    controller: GameController\r\n\r\n    sceneList: SceneList\r\n    blueEmitter: ParticleEmitter\r\n    redEmitter: ParticleEmitter\r\n\r\n    onInitialize() {\r\n        let canvasHeight = this.engine.canvasHeight / window.devicePixelRatio;\r\n        let canvasWidth = this.engine.canvasWidth / window.devicePixelRatio;\r\n\r\n        let halfHeight = Math.floor(canvasHeight/2)\r\n        let halfWidth = Math.floor(canvasWidth/2)\r\n\r\n        this.sceneList = new SceneList(\r\n            'AD ASTRA: OSIRIS CONTINGENCY',\r\n            halfWidth /2,\r\n            halfHeight - 50,\r\n        )\r\n        this.sceneList.setup([\r\n            { label: 'Play', scene: 'play' },\r\n            { label: 'Arena', scene: 'arena' },\r\n            { label: 'Sandbox', scene: 'sandbox' },\r\n        ], this.engine)\r\n\r\n        this.blueEmitter = this.makeBigBangEmitter(\r\n            canvasWidth + 50,\r\n            // halfWidth + (halfWidth/2),\r\n            halfHeight - 50,\r\n            Color.Cyan.lighten(0.3)\r\n        )\r\n        this.add(this.blueEmitter)\r\n        this.redEmitter = this.makeBigBangEmitter(\r\n            canvasWidth + 50,\r\n            // halfWidth + (halfWidth/2),\r\n            halfHeight - 50,\r\n            Color.Orange.darken(0.3)\r\n        )\r\n        this.add(this.redEmitter)\r\n\r\n        this.controller = new GameController(this.engine, this.camera)\r\n    }\r\n\r\n    onActivate() {\r\n\r\n        this.sceneList.show()\r\n\r\n        // let canvasHeight = this.engine.canvasHeight / window.devicePixelRatio;\r\n\r\n        this.camera.zoom(1.5, 3800) //2.5)\r\n        this.blueEmitter.isEmitting = true\r\n        this.redEmitter.isEmitting = true\r\n\r\n        this.controller = new GameController(this.engine, this.camera)\r\n        this.controller.activate()\r\n    }\r\n\r\n    onDeactivate() {\r\n        this.blueEmitter.isEmitting = false\r\n        this.redEmitter.isEmitting = false\r\n        this.controller.deactivate()\r\n        this.sceneList.hide()\r\n    }\r\n\r\n    draw(ctx, delta) {\r\n        let canvasHeight = this.engine.canvasHeight / window.devicePixelRatio;\r\n        let canvasWidth = this.engine.canvasWidth / window.devicePixelRatio;\r\n        super.draw(ctx, delta)\r\n        this.sceneList.draw(ctx)\r\n        drawText(ctx,\r\n            `${Game.title} v0.0.1 (pre-alpha)`,\r\n            canvasWidth - 100, canvasHeight - 20)\r\n        drawText(ctx,\r\n            `Zoom: ${this.camera.getZoom()} / Pos: ${this.camera.pos.x}, ${this.camera.pos.y}`,\r\n            1000, 1000)\r\n    }\r\n\r\n    private makeBigBangEmitter(x,y,c) {\r\n        let emitter = new ParticleEmitter(\r\n            x,\r\n            y\r\n        )\r\n        emitter.endColor = c.clone() //Color.Blue\r\n        emitter.beginColor = Color.White.darken(0.18)\r\n        emitter.radius = 10\r\n        emitter.minVel = 10\r\n        emitter.maxVel = 250\r\n        emitter.minAngle = 0 //3 * (Math.PI / 2) //0\r\n        emitter.maxAngle = Math.PI * 2\r\n        emitter.emitRate = 36 // 300 particles/second\r\n        emitter.opacity = 0.54\r\n        emitter.fadeFlag = true\r\n        emitter.particleLife = 4600 // in milliseconds = 1 sec\r\n        emitter.maxSize = 100 // in pixels\r\n        emitter.minSize = 1\r\n        // emitter.beginColor = Color.Red.darken(0.12);\r\n        emitter.isEmitting = false;\r\n        return emitter\r\n    }\r\n}","import { Scene, Vector, Color } from \"excalibur\";\r\nimport { Citizen } from \"../actors/Citizen\";\r\nimport { Game } from \"../Game\";\r\nimport { Planet } from \"../actors/Planet/Planet\";\r\nimport { Pane } from \"../actors/Hud/Pane\";\r\nimport { assembleButton } from \"../Elemental\";\r\nimport { sample } from \"../Util\";\r\nimport { GameController } from \"../GameController\";\r\nimport { Laser } from \"../models/Machine\";\r\nimport { Device } from \"../actors/Device\";\r\nimport { Orientation } from \"../values/Orientation\";\r\nimport { getVisibleDeviceSize } from \"../values/DeviceSize\";\r\n\r\nclass SpawnPalette extends Pane {\r\n    constructor(x: number, y: number, buttons: { label: string, color: Color, cb: () => any }[]) {\r\n        super(\"Summon\", x, y)\r\n        this.makeRootElement()\r\n        buttons.forEach(btn => {\r\n            let { label, color, cb } = btn\r\n            let theButton = assembleButton(label, color)\r\n            theButton.onclick = cb\r\n            this._element.appendChild(theButton)\r\n        })\r\n    }\r\n}\r\n\r\nexport class Arena extends Scene {\r\n    private planet: Planet\r\n    private spawnPalette: SpawnPalette\r\n    private floorY: number\r\n    private controller: GameController\r\n    private friendlySpawnX: number = 1000\r\n    private hostileSpawnY: number = -1000\r\n    private spawnDrift: number = 500\r\n\r\n    private machines: Device[] = []\r\n\r\n    public onInitialize(game: Game) {\r\n        this.planet = new Planet(this)\r\n        this.add(this.planet)\r\n        this.planet.z = -100\r\n        this.floorY = this.planet.getTop() - Game.mansheight/2 // - 15\r\n\r\n        let canvasWidth = this.engine.canvasWidth / window.devicePixelRatio;\r\n        let halfWidth = Math.floor(canvasWidth/2)\r\n\r\n\r\n        this.spawnPalette = new SpawnPalette(halfWidth-100,20,[\r\n            { label: 'Raider', color: Color.Red, cb: this.spawnHostile }, \r\n            { label: 'Citizen', color: Color.Green, cb: this.spawnFriendly }, \r\n            { label: 'Elite Raider', color: Color.Red, cb: this.spawnHostileCommander }, \r\n            { label: 'Commander', color: Color.Green, cb: this.spawnFriendlyCommander }, \r\n            { label: 'Big Raider', color: Color.Red, cb: this.spawnBigHostile }, \r\n            { label: 'Laser', color: Color.Green, cb: () => { this.spawnLaser() } }, \r\n            { label: 'Regen World', color: Color.White, cb: () => { this.regenerate() } }, \r\n            { label: 'Main Menu', color: Color.White, cb: () => { game.goToScene('menu') }}, \r\n        ])\r\n    }\r\n\r\n    onActivate() {\r\n        this.controller = new GameController(this.engine, this.camera)\r\n        this.controller.activate()\r\n        this.spawnPalette.show()\r\n        this.spawnInitialPair()\r\n\r\n        this.camera.move(this.planet.population.citizens[0].pos, 0)\r\n    }\r\n\r\n    onDeactivate() {\r\n        this.spawnPalette.hide()\r\n        this.controller.deactivate()\r\n\r\n    }\r\n\r\n    draw(ctx, delta) {\r\n        super.draw(ctx,delta)\r\n        this.spawnPalette.draw(ctx)\r\n    }\r\n\r\n    regenerate() {\r\n        this.machines.forEach(machine => {this.remove(machine);  machine.kill(); })\r\n        // this.machines = []\r\n        this.planet.teardown()\r\n        this.remove(this.planet)\r\n        this.planet = new Planet(this)\r\n        this.planet.z = -100\r\n        this.add(this.planet)\r\n        this.spawnInitialPair()\r\n    }\r\n\r\n    spawnInitialPair() {\r\n        if (this.planet.population.citizens.length === 0) {\r\n            this.spawnFriendly()\r\n        }\r\n        if (this.planet.population.raiders.length === 0) {\r\n            this.spawnHostile()\r\n        }\r\n    }\r\n\r\n\r\n    spawnFriendlyCommander = () => {\r\n        let elite = true\r\n        let cmdrName = sample(['Spork', 'Kierkegon', 'Bolnes', 'Pickhard', 'Rilker', 'Krusha', 'Forage', 'Scorch', 'Hula', 'Checkmate', 'Gorf', 'Helen', 'Arg'])\r\n        let friendly = new Citizen(cmdrName, new Vector((Math.random() * this.spawnDrift) + this.friendlySpawnX, this.floorY), this.planet, { elite })\r\n        // friend\r\n        this.planet.population.citizens.push(friendly)\r\n        this.add(friendly)\r\n        friendly.z = 1\r\n    }\r\n\r\n    spawnFriendly = () => {\r\n        let pawnName = sample([\r\n            'Jones', 'Smith', 'Ford', 'Abel', 'Thomas',\r\n            'Frost', 'Amos', 'Sandra', 'Cheryl', 'Dominic',\r\n            'Aomi', 'Cadence', 'Cree', 'Luri', 'Moon', 'Dean',\r\n            'Sun', 'Lee', 'Fern', 'Tuck',\r\n        ])\r\n        let friendly = new Citizen(pawnName, this.spawnPoint(), this.planet)\r\n        this.planet.population.citizens.push(friendly)\r\n        this.add(friendly)\r\n        friendly.z = 1\r\n    }\r\n\r\n    spawnHostile = () => {\r\n        let evil = true\r\n        let hostile = new Citizen('Raider', this.spawnPoint(false), this.planet, { evil })\r\n        this.planet.population.raiders.push(hostile)\r\n        this.add(hostile)\r\n        hostile.z = 1\r\n    }\r\n\r\n    spawnBigHostile = () => {\r\n        let evil = true\r\n        let large = true\r\n        let hostile = new Citizen('Heavy Raider', this.spawnPoint(false), this.planet, { evil, large })\r\n        hostile.y -= hostile.getHeight()/4\r\n        this.planet.population.raiders.push(hostile)\r\n        this.add(hostile)\r\n        hostile.z = 1\r\n    }\r\n\r\n\r\n    spawnHostileCommander = () => {\r\n        let elite = true, evil = true\r\n        let cmdrName = sample([ 'Conn', 'Drak', 'Tanoz', 'Queue', 'Morgosh', 'Umph'])\r\n        let hostile = new Citizen(cmdrName, this.spawnPoint(false), this.planet, { elite, evil })\r\n        this.planet.population.raiders.push(hostile)\r\n        this.add(hostile)\r\n        hostile.z = 1\r\n    }\r\n\r\n    spawnLaser() {\r\n        // add a laser at the average position, minus a bit\r\n        let pos = this.spawnPoint()\r\n        pos.y = this.floorY // - getVisibleDeviceSize((new Laser()).size)/4 ///2\r\n        let laser = new Device(new Laser(), pos) //this.spawnPoint())\r\n        laser.orientation = Orientation.Left\r\n        laser.built = true\r\n        laser.placed = true\r\n        // @ts-ignore\r\n        laser.building = { planet: this.planet }\r\n        this.add(laser)\r\n        laser.z = 2\r\n        // this.planet.colony.\r\n\r\n        this.machines.push(laser)\r\n    }\r\n\r\n    private spawnPoint(friendly: boolean = true) {\r\n        return new Vector((Math.random() * this.spawnDrift) + (friendly ? this.friendlySpawnX : this.hostileSpawnY), this.floorY)\r\n    }\r\n}","import { Machine, Houseplant, Orchard, Bed, OxygenExtractor, WaterCondensingMachine, Codex, Bookshelf, SolarCell, Fridge, Stove, Books, Workstation, Greenhouse, Botany, MineralProcessor, Miner, Table } from \"./Machine\";\r\n\r\nexport enum Discipline {\r\n    Survival = 'Environmental Control',\r\n    Agriculture = 'Food Production',\r\n    LibraryScience = 'Library Science',\r\n    Cooking = 'Food Preparation',\r\n    // PowerGeneration = 'Power Generation',\r\n    // LifeScience = 'Life Sciences',\r\n    // PlasticArts = 'Plastic Arts',\r\n    MineralProduction = 'Mineral Production',\r\n}\r\n\r\nexport interface TechnologyRank {\r\n    name: string\r\n    level: number\r\n    description: string\r\n    prereqs: (typeof Machine)[]\r\n    unlocks: (typeof Machine)[]\r\n}\r\n\r\nexport const disciplineTree: { [key in Discipline]: TechnologyRank[] } = {\r\n    [Discipline.Survival]: [\r\n        { \r\n            name: \"Survival I\",\r\n            level: 1,\r\n            description: \"staying alive\",\r\n            prereqs: [ Bed, SolarCell ],\r\n            unlocks: [ OxygenExtractor, WaterCondensingMachine ]\r\n        },\r\n    ],\r\n\r\n    [Discipline.Agriculture]: [\r\n        // small planter?\r\n        {\r\n            name: 'Food Prod. I',\r\n            level: 1,\r\n            description: \"watch the calories\",\r\n            prereqs: [Botany],\r\n            unlocks: [Houseplant, Greenhouse, Orchard],\r\n        } // Greenhouse...? ] }\r\n    ],\r\n\r\n    [Discipline.Cooking]: [\r\n        {\r\n            name: 'Food Prep. I',\r\n            level: 1,\r\n            description: \"bam\",\r\n            prereqs: [Fridge],\r\n            unlocks: [Stove],\r\n        }\r\n    ],\r\n\r\n    [Discipline.LibraryScience]: [\r\n        {\r\n            name: \"Library Science I\",\r\n            level: 1,\r\n            description: \"try to understand\",\r\n            prereqs: [ Books ],\r\n            unlocks: [ Bookshelf, Workstation, Codex ],\r\n        }\r\n    ],\r\n\r\n    [Discipline.MineralProduction]: [\r\n        {\r\n            name: 'Mineral Production I',\r\n            level: 1,\r\n            description: 'make it work',\r\n            prereqs: [ Table ],\r\n            unlocks: [ Miner, MineralProcessor ],\r\n        }\r\n    ]\r\n\r\n    // [Discipline.LifeScience]: [ \r\n    //     { prereqs: [], unlocks: [ Botany, AlgaeVat ]}\r\n    // ],\r\n\r\n    // [Discipline.PlasticArts]: [\r\n    //     { prereqs: [ Figurine ], unlocks: [ Statue ] }\r\n\r\n    // ],\r\n}\r\n\r\n","import { Machine } from \"./Machine\";\r\nimport { range } from \"../Util\";\r\nimport { Discipline, TechnologyRank, disciplineTree } from \"./TechnologyRank\";\r\n\r\nexport class TechTree {\r\n    currentLevels: {\r\n        [key in Discipline]: number;\r\n    } = {\r\n            [Discipline.Survival]: -1,\r\n            [Discipline.LibraryScience]: -1,\r\n            [Discipline.Agriculture]: -1,\r\n            [Discipline.Cooking]: -1,\r\n            [Discipline.MineralProduction]: -1,\r\n        };\r\n\r\n    findDisciplineToRankUp(machines: (typeof Machine)[]): Discipline {\r\n        for (let disciplineName of Object.keys(Discipline)) {\r\n            let discipline: Discipline = Discipline[disciplineName];\r\n            if (this.canRankUp(discipline, machines)) {\r\n                return discipline;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    rankUp(discipline: Discipline): TechnologyRank {\r\n        this.currentLevels[discipline] += 1;\r\n        return this.currentRank(discipline);\r\n    }\r\n\r\n    private currentRank(discipline: Discipline): TechnologyRank {\r\n        return disciplineTree[discipline][this.currentLevels[discipline]];\r\n    }\r\n\r\n    private canRankUp(discipline: Discipline, machines: (typeof Machine)[]): boolean {\r\n        let level = this.currentLevels[discipline];\r\n        let nextLevel: TechnologyRank = disciplineTree[discipline][level + 1];\r\n        if (nextLevel) {\r\n            if (nextLevel.prereqs.every(machine => machines.includes(machine))) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    allUnlockedMachines(): (typeof Machine)[] {\r\n        let unlocked = [];\r\n        for (let disciplineName of Object.keys(Discipline)) {\r\n            unlocked.push(...this.unlockedMachinesFor(Discipline[disciplineName]));\r\n        }\r\n        return unlocked;\r\n    }\r\n\r\n    private unlockedMachinesFor(discipline: Discipline) {\r\n        let tree = disciplineTree[discipline];\r\n        let unlocked = [];\r\n        let level = this.currentLevels[discipline] + 1;\r\n        for (let i in range(level)) {\r\n            unlocked.push(...tree[i].unlocks);\r\n        }\r\n        return unlocked;\r\n    }\r\n}\r\n","import { Color } from \"excalibur\";\r\nimport { Pane } from \"./Pane\";\r\nimport { Citizen } from \"../Citizen\";\r\nimport { Game } from \"../../Game\";\r\nimport { assembleButton } from \"../../Elemental\";\r\nimport { CombatStrategy } from \"../../strategies/CombatStrategy\";\r\n\r\nclass CitizenLine {\r\n    private _line: HTMLDivElement\r\n    private button: HTMLButtonElement\r\n    private task: HTMLSpanElement\r\n    private sleepy: HTMLSpanElement\r\n    private hunger: HTMLSpanElement\r\n    // private fighting: HTMLSpanElement\r\n    private busyRow: HTMLDivElement\r\n    private followed: boolean = false\r\n    // ...\r\n    constructor(private citizen: Citizen, private onSelect: (Citizen) => any) {\r\n        this.buildLine()\r\n    }\r\n\r\n    get root() { return this._line }\r\n\r\n    update(isFollowed: boolean, hungry: boolean, tired: boolean) {\r\n        if (isFollowed !== this.followed) {\r\n            this.followed = isFollowed\r\n            // rebuild button\r\n            this._line.removeChild(this.button)\r\n            this.button = this.makeButton()\r\n            this._line.appendChild(this.button)\r\n        // this.button.textContent = isFollowed ? 'Following' : 'Follow'\r\n        // this.button.backg clr = Color.DarkGray // followed ? Color.Violet : Color.DarkGray\r\n        }\r\n\r\n\r\n        this.sleepy.style.display = tired || this.citizen.sleepingInBed ? 'inline' : 'none'\r\n        if (this.citizen.sleepingInBed) {\r\n            this.sleepy.textContent = 'SLEEPING'\r\n        } else {\r\n            this.sleepy.textContent = 'tired'\r\n        }\r\n\r\n        // this.sleepy.textContent = `tired (${this.citizen.energy.toFixed()})`\r\n        this.hunger.style.display = hungry ? 'inline' : 'none'\r\n        // this.hunger.textContent = `hungry (${this.citizen.hunger.toFixed()})`\r\n\r\n        // this.fighting.style.display = this.citizen.engagedInCombat ? 'inline' : 'none'\r\n\r\n        this.task.style.display = this.citizen.isPlanning ? 'inline' : 'none'\r\n        if (this.citizen.lastChoice) {\r\n            this.task.textContent = this.citizen.lastChoice.describe()\r\n            if (this.citizen.lastChoice instanceof CombatStrategy) {\r\n                this.task.style.color = Color.Red.toRGBA()\r\n            } else {\r\n                this.task.style.color = Color.LightGray.toRGBA()\r\n            }\r\n        }\r\n    }\r\n\r\n    buildLine() {\r\n        this._line = document.createElement('div')\r\n        this._line.style.fontFamily = Game.font\r\n        this._line.style.color = 'white'\r\n        this._line.style.backgroundColor = '#6a6a6a'\r\n        this._line.style.display = 'flex'\r\n        // this._line.style.width = '100%'\r\n        // this._line.style.height = '40px'\r\n        this._line.style.justifyContent = 'space-between'\r\n        this._line.style.paddingLeft = '5px'\r\n        this._line.style.fontSize = '8pt'\r\n\r\n        let nameLabel = document.createElement('span')\r\n\r\n        nameLabel.textContent = [this.citizen.title, this.citizen.name].join(' ')\r\n        nameLabel.style.alignSelf = 'center'\r\n        this._line.appendChild(nameLabel)\r\n\r\n        this.busyRow = document.createElement('div')\r\n        this.busyRow.style.display = 'flex'\r\n        this.busyRow.style.flexDirection = 'column'\r\n        this._line.appendChild(this.busyRow)\r\n\r\n        this.task = document.createElement('span')\r\n        this.task.textContent = ''\r\n        this.task.style.color = 'white'\r\n        this.task.style.padding = '2px'\r\n        this.busyRow.appendChild(this.task)\r\n\r\n        this.hunger = document.createElement('span')\r\n        this.hunger.textContent = 'hungry'\r\n        this.hunger.style.color = 'yellow'\r\n        this.hunger.style.padding = '2px'\r\n        this.busyRow.appendChild(this.hunger)\r\n\r\n        this.sleepy = document.createElement('span')\r\n        this.sleepy.textContent = 'sleepy'\r\n        this.sleepy.style.color = 'blue'\r\n        this.sleepy.style.padding = '2px'\r\n        this.busyRow.appendChild(this.sleepy)\r\n\r\n        this.button = this.makeButton()\r\n        this._line.appendChild(this.button)\r\n    }\r\n\r\n    makeButton() {\r\n        let msg = this.followed ? \"Following\" : \"Follow\"\r\n        let clr = this.followed ? Color.Violet : Color.DarkGray\r\n        let button = assembleButton(msg, clr)\r\n        button.style.padding = '15px'\r\n        if (this.onSelect) {\r\n            button.onclick = () => {\r\n                this.onSelect(this.citizen)\r\n            }\r\n        }\r\n        return button\r\n    }\r\n}\r\n\r\nexport class CitizenList extends Pane {\r\n    private _wrapper: HTMLDivElement\r\n    private citizens: Citizen[] = []\r\n    following: Citizen = null\r\n    private citizenLines: Map<Citizen, CitizenLine> = new Map()\r\n\r\n    constructor(\r\n        x: number,\r\n        y: number,\r\n        private onCitizenSelect: (Citizen) => any = null\r\n    ) {\r\n        super(\"Colony Roster\", x, y);\r\n    }\r\n\r\n    updateRoster(citizens: Citizen[], following: Citizen): any {\r\n        let missingCitizens = citizens.some(c => !this.doesRosterInclude(c))\r\n        let lostCitizens = this.citizens.some(c => !citizens.includes(c))\r\n        if (missingCitizens || lostCitizens) { // rebuild\r\n            this.citizens = citizens\r\n            this.makeRoster()\r\n        }\r\n        // let followedChanged = following !== this.citizenList.following\r\n        this.following = following\r\n        this.updateRosterDetails()\r\n    }\r\n\r\n    updateRosterDetails() {\r\n        this.citizens.forEach(citizen => {\r\n            let line: CitizenLine = this.citizenLines.get(citizen)\r\n            line.update(this.following === citizen, citizen.isHungry, citizen.isTired)\r\n        })\r\n    }\r\n\r\n    doesRosterInclude(citizen) {\r\n        return this.citizens.includes(citizen)\r\n    }\r\n\r\n    private makeRoster() {\r\n        this.makeRootElement();\r\n        this._element.style.height = '260px'\r\n        this._wrapper = document.createElement('div')\r\n        this._wrapper.style.overflow = 'auto'\r\n        // this._wrapper.style.maxHeight = '480px'\r\n        this._wrapper.style.height = '250px'\r\n        this._wrapper.style.width = '100%'\r\n        this._element.appendChild(this._wrapper)\r\n        this.citizens.forEach(c => this.makeCitizenLine(c))\r\n        // citizen => \r\n        // });\r\n    }\r\n\r\n    private makeCitizenLine(citizen: Citizen) {\r\n        let line = new CitizenLine(citizen, this.onCitizenSelect)\r\n        this.citizenLines.set(citizen, line)\r\n        this._wrapper.appendChild(line.root);\r\n    }\r\n}\r\n","import { Color } from \"excalibur\";\r\nimport { Game } from \"../../Game\";\r\nexport class Modal {\r\n    private _element: HTMLDivElement\r\n\r\n    private _header: HTMLDivElement\r\n    private _body: HTMLDivElement\r\n    private _footer: HTMLDivElement\r\n    // private titleLabel: Label\r\n    // private messageLabel: Label\r\n    constructor(private title: string, private message: string, private x: number, private y: number, private width: number = 500) {\r\n        this.makeDialog();\r\n        // super(x,y,200,200, Color.DarkGray)\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D): any {\r\n        // console.log(\"DRAW MODAL\")\r\n        if (this._element) {\r\n            let left = ctx.canvas.offsetLeft - this.width/2;\r\n            let top = ctx.canvas.offsetTop - this._element.clientHeight/2;\r\n            this._element.style.left = `${left + this.x}px`;\r\n            this._element.style.top = `${top + this.y}px`;\r\n        }\r\n    }\r\n\r\n    addButtons(buttonMap: {\r\n        [intent: string]: () => any;\r\n    }) {\r\n        // throw new Error(\"Method not implemented.\");\r\n        let buttons = Object.entries(buttonMap)\r\n        buttons.forEach(([intent, cb]) => {\r\n            let btn = this.buttonFactory(intent, Color.Gray, this.width/(buttons.length))\r\n            btn.onclick = cb\r\n            this._footer.appendChild(btn)\r\n        })\r\n    }\r\n\r\n    teardown() {\r\n        document.body.removeChild(this._element)\r\n        // throw new Error(\"Method not implemented.\");\r\n    }\r\n\r\n    private makeDialog() {\r\n        this._element = document.createElement('div');\r\n        this._element.style.position = 'absolute';\r\n        this._element.style.display = 'flex';\r\n        this._element.style.flexWrap = 'wrap';\r\n        this._element.style.width = `${this.width}px`;\r\n        this._element.style.border = 'none'; //1px solid black'; //0.5px solid white';\r\n        document.body.appendChild(this._element);\r\n\r\n        let bg = Color.Violet.clone().darken(0.92) //.clone..toRGBA()\r\n        bg.a = 0.92\r\n\r\n        let title = document.createElement('div');\r\n        title.textContent = this.title;\r\n        title.style.fontFamily = Game.font //'Verdana';\r\n        title.style.fontSize = '14pt';\r\n        title.style.fontWeight = '700';\r\n        title.style.textTransform = 'uppercase';\r\n        title.style.textAlign = 'center'\r\n        title.style.width = `${this.width}px`;\r\n        title.style.color = Color.White.toRGBA();\r\n        title.style.backgroundColor = bg.toRGBA() //Color.Violet.darken(0.92).toRGBA();\r\n        title.style.padding = '12px';\r\n        title.style.margin = '0px';\r\n        this._element.appendChild(title);\r\n\r\n        this._header = document.createElement('div')\r\n        this._header.style.width = `${this.width}px`;\r\n        this._header.style.backgroundColor = bg.toRGBA() // Color.Violet.darken(0.92).toRGBA();\r\n        this._element.appendChild(this._header)\r\n\r\n        this._body = document.createElement('div');\r\n        this._body.textContent = this.message;\r\n        this._body.style.fontFamily = Game.font //'Verdana';\r\n        this._body.style.fontSize = '9pt';\r\n        this._body.style.fontWeight = '400';\r\n        this._body.style.width = `${this.width}px`;\r\n        this._body.style.color = Color.White.toRGBA();\r\n        this._body.style.backgroundColor = bg.toRGBA() //Color.Violet.darken(0.92).toRGBA();\r\n        this._body.style.padding = '24px';\r\n        this._body.style.paddingBottom = '48px';\r\n        this._body.style.margin = '0px';\r\n        this._element.appendChild(this._body);\r\n\r\n        this._footer = document.createElement('div')\r\n        this._footer.style.width = `${this.width}px`\r\n        this._footer.style.display = 'flex';\r\n        this._footer.style.flexWrap = 'wrap';\r\n        this._element.appendChild(this._footer)\r\n    }\r\n\r\n    addHeading(heading: string, size: number = 24, color: Color = Color.White) {\r\n        let headerMessage = document.createElement('div');\r\n        headerMessage.textContent = heading;\r\n        headerMessage.style.fontFamily = Game.font // 'Helvetica';\r\n        headerMessage.style.fontSize = `${size}pt`;\r\n        headerMessage.style.fontWeight = '600';\r\n        headerMessage.style.textAlign = 'center';\r\n        headerMessage.style.width = `${this.width}px`;\r\n        headerMessage.style.color = color.clone().toRGBA();\r\n        // headerMessage.style.backgroundColor = Color.Violet.darken(0.8).toRGBA();\r\n        headerMessage.style.padding = '0px';\r\n        headerMessage.style.margin = '0px';\r\n        this._header.appendChild(headerMessage)\r\n    }\r\n\r\n    addIconMatrix(iconSet: { image: string, label: string }[] = []) {\r\n        // build a icon matrix\r\n        let matrix = document.createElement('div')\r\n        matrix.style.display = 'flex'\r\n        matrix.style.flexWrap = 'wrap'\r\n        matrix.style.padding = '15px'\r\n        matrix.style.width = `100%` //${this.width}px`\r\n\r\n        matrix.style.justifyContent = 'space-evenly'\r\n\r\n        iconSet.forEach(({ label, image }) => {\r\n            let img = new Image()\r\n            img.width = 64\r\n            img.height = 64\r\n            img.src = image\r\n            img.style.padding = '8px'\r\n\r\n            let lbl = document.createElement('span')\r\n            lbl.textContent = label\r\n            lbl.style.textAlign = 'center'\r\n            lbl.style.padding = '8px'\r\n            lbl.style.fontSize = '6pt'\r\n            lbl.style.fontFamily = Game.font\r\n\r\n            let icon = document.createElement('div')\r\n            icon.style.display = 'flex'\r\n            icon.style.flexDirection = 'column'\r\n            icon.style.padding = '4px'\r\n            icon.appendChild(img)\r\n            icon.appendChild(lbl)\r\n            \r\n            matrix.appendChild(icon)\r\n\r\n        })\r\n\r\n        this._body.appendChild(matrix)\r\n    }\r\n\r\n    private buttonFactory(label: string, color: Color = Color.DarkGray, width: number = this.width/2) {\r\n        let bg = color.darken(0.5).desaturate(0.5).clone();\r\n        bg.a = 0.8;\r\n        let fg = color.lighten(0.8).desaturate(0.4).clone();\r\n        let modalButton = document.createElement('button');\r\n        modalButton.textContent = label;\r\n        modalButton.style.display = 'block';\r\n        modalButton.style.fontSize = '7pt';\r\n        modalButton.style.fontFamily = Game.font //'Verdana';\r\n        modalButton.style.fontWeight = '500';\r\n        modalButton.style.padding = '20px';\r\n        modalButton.style.width = `${width}px`;\r\n        modalButton.style.textTransform = 'uppercase';\r\n        modalButton.style.border = 'none'; //1px solid rgba(255,255,255,0.08)';\r\n        modalButton.style.background = bg.toRGBA();\r\n        modalButton.style.color = fg.toRGBA();\r\n        modalButton.onmouseover = () => {\r\n            modalButton.style.background = bg.saturate(0.5).lighten(0.95).toRGBA();\r\n            modalButton.style.color = fg.lighten(0.9).toRGBA();\r\n        };\r\n        modalButton.onmouseleave = () => {\r\n            modalButton.style.background = bg.toRGBA();\r\n            modalButton.style.color = fg.toRGBA();\r\n        };\r\n        return modalButton;\r\n    }\r\n}\r\n","import { Color } from \"excalibur\";\r\nimport { EntityKind } from \"../../values/Entity\";\r\nimport { onlyUnique } from \"../../Util\";\r\nimport { Pane } from \"./Pane\";\r\nimport { assembleButton } from \"../../Elemental\";\r\n\r\nexport class Palette extends Pane {\r\n    built: EntityKind[] = [];\r\n    comprehended: EntityKind[] = [];\r\n    omniscient: boolean = false\r\n\r\n    constructor(\r\n        name: string,\r\n        x: number,\r\n        y: number,\r\n        private all: EntityKind[],\r\n        private onButtonClick: (EntityKind) => any = null,\r\n        private onButtonEnter: (EntityKind) => any = null,\r\n        private comprehend = true \r\n    ) {\r\n        super(name, x, y)\r\n        this.makePalette();\r\n    }\r\n\r\n    restrictionsOff() {\r\n        this.omniscient = true\r\n    }\r\n\r\n    updateBuilt(built: (EntityKind)[], unlocked: (EntityKind)[] = []) {\r\n        this.built = built;\r\n        if (this.omniscient) {\r\n            this.comprehended = this.all\r\n        } else if (this.comprehend) {\r\n            let nowComprehended = this.all.filter((e: EntityKind) => {\r\n                let s = new e();\r\n                let prereqs: (EntityKind)[] = s.prereqs;\r\n                return prereqs.every((prereq: EntityKind) => {\r\n                    let built = this.built.some((s: EntityKind) => s === prereq);\r\n                    return built;\r\n                });\r\n            });\r\n            this.comprehended = [\r\n                ...nowComprehended,\r\n                ...unlocked\r\n            ].filter(onlyUnique)\r\n        } else {\r\n            this.comprehended = [ ...this.built, ...unlocked ].filter(onlyUnique)\r\n        }\r\n        this.makePalette();\r\n    }\r\n\r\n    private makePalette() {\r\n\r\n        this.makeRootElement()\r\n\r\n\r\n        this.comprehended\r\n            .map((elem: EntityKind) => new elem())\r\n            .sort((a, b) => a.color > b.color ? -1 : 1)\r\n            .forEach(elem => {\r\n                if (elem.hide) { return }\r\n                let label = elem.name;\r\n                if (!this.built.map(m => new m().name).includes(elem.name)) {\r\n                    label += ' *';\r\n                }\r\n                let clr = elem.color;\r\n                let btn = assembleButton(label, clr);\r\n                this._element.appendChild(btn);\r\n                if (this.onButtonEnter) {\r\n                    btn.onmouseenter = () => { this.onButtonEnter(elem); };\r\n                }\r\n                if (this.onButtonClick) {\r\n                    btn.onclick = () => { this.onButtonClick(elem); };\r\n                }\r\n            });\r\n    }\r\n\r\n}\r\n","import { Label, Actor, FontStyle, Color } from \"excalibur\";\r\nimport { Structure } from \"../../models/Structure\";\r\nimport { Machine } from \"../../models/Machine\";\r\nimport { PureValue, Economy, ResourceBlock } from \"../../models/Economy\";\r\nimport { RoomRecipe } from \"../../models/RoomRecipe\";\r\nimport { Building } from \"../Building\";\r\nimport { Device } from \"../Device\";\r\nimport { countOccurrences, flatSingle } from \"../../Util\";\r\nimport { Game } from \"../../Game\";\r\nimport { Citizen } from \"../Citizen\";\r\n\r\nexport class CardBody extends Actor {\r\n    description: Label\r\n    values: Label\r\n    notes: Label\r\n    footer: Label\r\n\r\n    constructor(\r\n        private entity: Machine | Structure | RoomRecipe | Building | Device | Citizen,\r\n        x: number, y: number\r\n    ) {\r\n        super(x, y, 0, 0)\r\n        // resources / recipes\r\n\r\n        this.values = new Label('', 0, 0, Game.font)\r\n        this.values.fontSize = 10\r\n        this.add(this.values)\r\n\r\n        this.notes = new Label('behavioral notes', 0, 30, Game.font)\r\n        this.notes.fontSize = 11\r\n        this.add(this.notes)\r\n\r\n        this.description = new Label('description', 0, 60, Game.font)\r\n        this.description.fontSize = 12\r\n        this.description.fontStyle = FontStyle.Italic\r\n        this.description.color = Color.DarkGray\r\n        this.add(this.description)\r\n\r\n        this.footer = new Label('footer', 20, 80, Game.font)\r\n        this.footer.fontSize = 10\r\n        this.footer.fontStyle = FontStyle.Italic\r\n        this.add(this.footer)\r\n\r\n        this.show(entity)\r\n    }\r\n\r\n    describeResources = (arr: ResourceBlock[]) => {\r\n        let freqs = countOccurrences(arr)\r\n        return Object.keys(freqs)\r\n            .map(elem => `${elem} x${freqs[elem]}`)\r\n            .join(' + ')\r\n    }\r\n\r\n    show(entity: Machine | Structure | RoomRecipe | Building | Device | Citizen) {\r\n        if (entity) {\r\n            this.description.text = entity.description;\r\n\r\n            if (entity instanceof Machine || entity instanceof Device) {\r\n                this.values.text =  this.describeEconomy(entity.economy)\r\n                // let footerNotes = []\r\n                let resourceDescription = entity instanceof Machine\r\n                    ? `Cost: ${this.describeResources(entity.cost)}`\r\n                    : (entity.built ? this.describeResources(entity.product) : 'under construction')\r\n                let forDome = entity instanceof Machine ? entity.forDome : entity.machine.forDome\r\n                let domeStatus = `For Dome: ${forDome ? 'Yes' : 'No'}`\r\n                this.footer.text = resourceDescription === ''\r\n                    ? domeStatus\r\n                    : [resourceDescription, domeStatus].join(' | ') \r\n                this.notes.text = '' //\r\n                let op = entity.operation\r\n                if (op) {\r\n                    if (op.type === 'recipe') {\r\n                        this.notes.text = `Turns ${op.consumes.join(' + ')} -> ${op.produces}.`\r\n                    } else if (op.type === 'generator') {\r\n                        this.notes.text = `Generates ${op.generates}.`\r\n                    } else if (op.type === 'store') {\r\n                        this.notes.text = `Stores ${op.stores.join(' + ')}`\r\n                    } else if (op.type === 'spawn') {\r\n                        this.notes.text = 'Decants clones.'\r\n                    }\r\n                }\r\n                if (entity instanceof Device && entity.inUse) {\r\n                    this.notes.text += ' [IN USE]'\r\n                }\r\n            } else if (entity instanceof RoomRecipe) {\r\n                let { capacity, workSpeed } = entity.bonuses\r\n                let bonusMessages = [];\r\n                if (capacity > 0) {\r\n                    bonusMessages.push(`+${capacity} cap`)\r\n                }\r\n                if (workSpeed > 1.0) {\r\n                    bonusMessages.push(`+${Math.floor((workSpeed*100)-100)}% efficiency` )\r\n                }\r\n                this.values.text = bonusMessages.join('; ') \r\n                this.notes.text = entity.machines.map(m => (new m()).name).join(' + ')\r\n                this.footer.text = ''\r\n            } else if (entity instanceof Building) {\r\n                this.values.text =  this.describeEconomy(entity.economy(false))\r\n                this.notes.text = entity.getDevices().map(d => d.machine.name).join(' + ')\r\n\r\n                let product = entity.getDevices()\r\n                    .map(d => d.product)\r\n                    .reduce((a, b) => a.concat(b), [])\r\n                this.footer.text = product.length > 0\r\n                    ? \"Currently contains: \" + this.describeResources(product)\r\n                    : ''\r\n            } else {\r\n                this.values.text = ''\r\n                this.notes.text = ''\r\n                this.footer.text = ''\r\n            }\r\n\r\n        }\r\n        // other bonuses? behaviors?\r\n    }\r\n\r\n    private describeEconomy(e: Economy): string {\r\n        let values = []\r\n        let econ = e // entity.economy\r\n        for (let value in PureValue) {\r\n            let { supply, demand } = econ[value]\r\n            let delta = supply - demand\r\n            if (delta > 0) {\r\n                values.push(`+${delta.toFixed()} ${value}`)\r\n            } else if (delta < 0) {\r\n                values.push(`${delta.toFixed()} ${value}`)\r\n            }\r\n        }\r\n        return values.join(' | ')\r\n    }\r\n}\r\n","import { Label, Color, Actor, FontStyle } from \"excalibur\";\r\nimport { Structure } from \"../../models/Structure\";\r\nimport { Machine } from \"../../models/Machine\";\r\nimport { DeviceSize } from \"../../values/DeviceSize\";\r\nimport { RoomRecipe } from \"../../models/RoomRecipe\";\r\nimport { Building } from \"../Building\";\r\nimport { Device } from \"../Device\";\r\nimport { Game } from \"../../Game\";\r\nimport { Citizen } from \"../Citizen\";\r\nexport class CardTitle extends Actor {\r\n    \r\n    name: Label;\r\n    type: Label;\r\n    constructor(\r\n        private entity: Machine | Structure | RoomRecipe | Building | Device | Citizen,\r\n        x: number, y: number\r\n    ) {\r\n        super(x, y, 14, 32, entity && entity.color || Color.Gray);\r\n        this.name = new Label(entity && entity.name || '..', 20, 16, Game.font)\r\n        this.name.fontSize = 28\r\n        this.name.color = Color.Black\r\n        this.add(this.name)\r\n\r\n        this.type = new Label('..', 220, 18, Game.font)\r\n        this.type.fontSize = 10\r\n        this.type.color = Color.Gray\r\n        this.type.fontStyle = FontStyle.Italic\r\n        this.add(this.type)\r\n\r\n        if (entity) {\r\n            this.announce(entity)\r\n        }\r\n    }\r\n\r\n    announce(entity: Machine | Structure | RoomRecipe | Building | Device | Citizen): any {\r\n        this.name.text = entity.name\r\n        this.color = entity.color.desaturate(0.5).darken(0.2)\r\n        if (entity instanceof Machine) { this.type.text = `${DeviceSize[entity.size]} Machine Type` }\r\n        if (entity instanceof Structure) { this.type.text = 'Structure' }\r\n        if (entity instanceof RoomRecipe) { this.type.text = 'Function' }\r\n        if (entity instanceof Building) { this.type.text = 'Building' }\r\n        if (entity instanceof Device) { this.type.text = `${DeviceSize[entity.size]} Machine` }\r\n        if (entity instanceof Citizen) { this.type.text = 'Human Being' }\r\n    }\r\n}\r\n","import { Color, Actor } from \"excalibur\";\r\nimport { Structure } from \"../../models/Structure\";\r\nimport { Machine } from \"../../models/Machine\";\r\nimport { CardTitle } from \"./CardTitle\";\r\nimport { CardBody } from \"./CardBody\";\r\nimport { RoomRecipe } from \"../../models/RoomRecipe\";\r\nimport { Building } from \"../Building\";\r\nimport { Device } from \"../Device\";\r\nimport { Citizen } from \"../Citizen\";\r\n\r\nexport class Card extends Actor {\r\n    title: CardTitle\r\n    cardBody: CardBody\r\n    image: HTMLImageElement\r\n\r\n    constructor(private entity: Machine | Structure | RoomRecipe | Building | Device | Citizen, x: number, y: number) {\r\n        super(x + 160, y + 90, 320, 180, Color.White);\r\n        let x0 = -150, y0 = -50;\r\n        this.title = new CardTitle(entity, x0 - 3, y0); //x, y)\r\n        this.add(this.title);\r\n        this.cardBody = new CardBody(entity, x0 + 14, y0 + 40)\r\n        this.add(this.cardBody)\r\n\r\n        this.image = new Image();\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta) {\r\n        super.draw(ctx, delta)\r\n        if (this.entity) {\r\n            if (this.entity instanceof Machine || this.entity instanceof Device) {\r\n                // if (this.image.src !== null) {\r\n                    let ix = this.pos.x + 48, iy = this.pos.y - 16\r\n                    let isz = 92\r\n\r\n                    // maybe try-fail around this? something for painting?\r\n                    ctx.drawImage(this.image, ix, iy, isz, isz)\r\n                // }\r\n            }\r\n        }\r\n    }\r\n\r\n    present(entity: Machine | Structure | RoomRecipe | Building | Device | Citizen): any {\r\n        this.title.announce(entity)\r\n        this.cardBody.show(entity)\r\n\r\n        this.entity = entity\r\n        let src = null\r\n        if (this.entity instanceof Machine) { //} || this.entity instanceof Device) {\r\n            src = this.entity.image\r\n        } else if (this.entity instanceof Device) {\r\n            src = this.entity.machine.image\r\n        }\r\n        // console.log(\"img src\", { src })\r\n        if (src) {\r\n            this.image.src = src\r\n        }\r\n    }\r\n\r\n}\r\n","import { Sound, Color } from \"excalibur\";\r\nimport { sample } from \"../../Util\";\r\nimport { Game } from \"../../Game\";\r\n\r\ninterface MusicPlayerPlay { type: 'play'}\r\ninterface MusicPlayerPause { type: 'pause'}\r\n// interface MusicPlayerStop { type: 'stop'}\r\ninterface MusicPlayerNext { type: 'next'}\r\ntype MusicPlayerAction = MusicPlayerPlay | MusicPlayerPause | MusicPlayerNext\r\n\r\nexport class MusicPlayer {\r\n    private _wrapper: HTMLDivElement;\r\n    private _element: HTMLDivElement;\r\n    private _titleElem: HTMLSpanElement;\r\n\r\n    currentTrack: string\r\n    paused: boolean = false\r\n\r\n    constructor(private x: number, private y: number, private playlist: {\r\n        [track: string]: Sound;\r\n    }) {\r\n        this.makePlayer();\r\n        setTimeout(() => { this.startMusic() }, 3000)\r\n        this._titleElem.textContent = `Getting ready...`;\r\n        this.currentTrack = sample(Object.keys(this.playlist)); //[0];\r\n    }\r\n\r\n    hide() {\r\n        this._wrapper.style.display = 'none'\r\n    }\r\n\r\n    show() {\r\n        this._wrapper.style.display = 'block'\r\n    }\r\n\r\n    private startMusic() {\r\n        this._titleElem.textContent = `Playing: ${this.currentTrack}`;\r\n        this.playlist[this.currentTrack].play()\r\n        .then(() => {\r\n                this.advancePlaylist()\r\n        })\r\n    }\r\n\r\n    stop() {\r\n        this.handleAction({type: 'pause'})\r\n        // this.playlist[this.curr]\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D) {\r\n        if (this._element) {\r\n            let left = ctx.canvas.offsetLeft;\r\n            let top = ctx.canvas.offsetTop;\r\n            this._wrapper.style.left = `${left + this.x}px`;\r\n            this._wrapper.style.top = `${top + this.y}px`;\r\n        }\r\n    }\r\n\r\n    private makePlayer() {\r\n        this._wrapper = document.createElement('div')\r\n        this._wrapper.style.position = 'absolute'\r\n        this._wrapper.style.width = '20%'\r\n        this._wrapper.style.maxHeight = '20px'\r\n        this._wrapper.style.textAlign = 'left'\r\n        this._wrapper.style.border = 'none';\r\n        this._wrapper.style.overflow = 'hidden';\r\n        document.body.appendChild(this._wrapper);\r\n\r\n        this._element = document.createElement('div');\r\n        this._element.style.display = 'inline-block';\r\n        this._element.style.border = 'none';\r\n        this._wrapper.appendChild(this._element)\r\n\r\n        this._titleElem = document.createElement('span');\r\n        this._titleElem.style.fontFamily = Game.font //'Verdana';\r\n        this._titleElem.style.fontSize = '7pt';\r\n        this._titleElem.style.padding = '24px'\r\n        this._titleElem.style.color = 'white';\r\n        this._wrapper.appendChild(this.inlineBlock(this._titleElem));\r\n\r\n        let play = this.iconFactory({ type: 'play' }, '&#9655;')\r\n        this._wrapper.appendChild(this.inlineBlock(play));\r\n\r\n        let pause = this.iconFactory({ type: 'pause' }, '&#10072; &#10072;')\r\n        this._wrapper.appendChild(this.inlineBlock(pause))\r\n\r\n        let next = this.iconFactory({ type: 'next' }, '&rarr;')\r\n        this._wrapper.appendChild(this.inlineBlock(next))\r\n\r\n    }\r\n\r\n    handleAction(action: MusicPlayerAction) {\r\n        if (action.type === 'pause') {\r\n            this.song.pause()\r\n            this.paused = true\r\n            this._titleElem.textContent = `Paused: ${this.currentTrack}`;\r\n        } else if (action.type === 'play') {\r\n            this.song.play()\r\n            this.paused = false\r\n            this._titleElem.textContent = `Playing: ${this.currentTrack}`;\r\n        } else if (action.type === 'next') {\r\n            if (this.paused) {\r\n                this.song.play()\r\n                this.paused = false\r\n            }\r\n            this.song.stop()\r\n        }\r\n    }\r\n\r\n    advancePlaylist() {\r\n        let ndx = this.trackNames.indexOf(this.currentTrack)\r\n        ndx = (ndx + 1) % this.trackNames.length\r\n        this.currentTrack = this.trackNames[ndx]\r\n        this.startMusic()\r\n    }\r\n\r\n    get trackNames() { return Object.keys(this.playlist) }\r\n    get song() { return this.playlist[this.currentTrack] }\r\n\r\n    private inlineBlock(elem) {\r\n        let block = document.createElement('div');\r\n        block.style.display = 'inline-block';\r\n        block.style.border = 'none';\r\n        block.append(elem)\r\n        return block\r\n    }\r\n\r\n    private iconFactory(\r\n        action: MusicPlayerAction,\r\n        iconContent: string,\r\n    ) {\r\n        let bg = Color.Transparent\r\n        let fg = Color.White\r\n        let icon = document.createElement('button')\r\n        icon.innerHTML = iconContent\r\n        icon.style.display = 'block';\r\n        icon.style.fontSize = '7pt';\r\n        icon.style.fontFamily = Game.font //'Verdana';\r\n        icon.style.border = 'none'\r\n        icon.style.padding = '4px'\r\n        icon.style.background = bg.toRGBA();\r\n        icon.style.color = fg.toRGBA();\r\n        icon.onclick = () => { this.handleAction(action) }\r\n        return icon\r\n    }\r\n\r\n}\r\n","import { Label, Color, Actor } from \"excalibur\";\r\nimport { Game } from \"../../Game\";\r\nexport class EconomicValue extends Actor {\r\n    private nameLabel: Label;\r\n    private valueLabel: Label;\r\n    constructor(name: string, x: number, y: number) {\r\n        super(x, y, 0, 0);\r\n        this.nameLabel = new Label(name, x, y, Game.font);\r\n        this.nameLabel.fontSize = 10;\r\n        this.nameLabel.color = Color.White.darken(0.2);\r\n        this.add(this.nameLabel);\r\n\r\n        this.valueLabel = new Label('0', x + 40, y, Game.font);\r\n        this.valueLabel.fontSize = 10;\r\n        this.valueLabel.color = Color.White.darken(0.2);\r\n        this.add(this.valueLabel);\r\n    }\r\n\r\n    setCount(count: number) {\r\n        this.valueLabel.text = `${count}`;\r\n        let c = Color.Gray;\r\n        if (count === Number.POSITIVE_INFINITY) {\r\n            c = Color.Violet\r\n            this.valueLabel.text = 'Infinite'\r\n            // this.valueLabel.fon\r\n        } else if (count > 0) {\r\n            c = Color.Green;\r\n        }\r\n        else if (count < 0) {\r\n            c = Color.Red;\r\n        } else { \r\n            c = Color.DarkGray\r\n        }\r\n\r\n        this.valueLabel.color = c;\r\n    }\r\n}\r\n","import { Actor, Color } from \"excalibur\";\r\nimport { Economy, PureValue, availableCapacity, allValues } from \"../../models/Economy\";\r\nimport { EconomicValue } from \"./EconomicValue\";\r\nimport { eachChunk } from \"../../Util\";\r\n\r\nexport class EconomyView extends Actor {\r\n    private valueLabels: { [key in PureValue]: EconomicValue } = {\r\n        Power: null,\r\n        Oxygen: null,\r\n        Water: null,\r\n        Shelter: null,\r\n        Hope: null,\r\n        Joy: null,\r\n        Wisdom: null,\r\n        Wealth: null,\r\n        Beauty: null,\r\n        Wonder: null\r\n    }\r\n\r\n    constructor(market: Economy, x: number, y: number) {\r\n        super(x, y, 0, 0) //Color.DarkGray.clone().darken(0.5));\r\n\r\n        let index = 0\r\n        for (let [val1, val2] of eachChunk(allValues, 2)) {\r\n            this.addValue(index * 38, 0, val1)\r\n            this.addValue(index * 38, 7, val2)\r\n            index += 1\r\n        }\r\n\r\n        this.updateView(market);\r\n    }\r\n\r\n    private addValue(x: number, y: number, value: PureValue) {\r\n        let valueLabel: EconomicValue = new EconomicValue(value, x, y)\r\n        this.valueLabels[value] = valueLabel\r\n        this.add(valueLabel)\r\n    }\r\n\r\n    updateView(updatedEconomy: Economy): void {\r\n        let market = updatedEconomy;\r\n\r\n        for (let value of allValues) {\r\n            this.valueLabels[value].setCount(\r\n                availableCapacity(market, value)\r\n            )\r\n        }\r\n\r\n    }\r\n}\r\n","import { Label, Color, Actor, UIActor } from \"excalibur\";\r\nimport { ResourceBlock, blockColor } from \"../../models/Economy\";\r\nimport { Game } from \"../../Game\";\r\nclass Tooltip extends Actor {\r\n    messageLabel: Label\r\n    constructor(x: number, y: number, message: string) {\r\n        super(x, y, 60, 16, Color.Black)\r\n        this.messageLabel = new Label(message, -16, 6, Game.font) //'Verdana')\r\n        this.messageLabel.color = Color.White\r\n        this.add(this.messageLabel)\r\n    }\r\n}\r\n\r\nexport class ResourceListEntry extends UIActor {\r\n    icon: Actor;\r\n    count: Label;\r\n    hovering: boolean = false\r\n    tooltip: Tooltip\r\n\r\n    constructor(x: number, y: number, resourceBlock: ResourceBlock, protected value: number) {\r\n        super(x-5, y-5, 20, 10)\r\n        let icon = new Actor(5, 5, 10, 10, blockColor(resourceBlock));\r\n        this.add(icon);\r\n        this.count = new Label(`x${value}`, 15, 10, Game.font) //'Helvetica');\r\n        this.count.fontSize = 10;\r\n        this.count.color = Color.White;\r\n        this.add(this.count);\r\n\r\n        this.tooltip = new Tooltip(0, 5, ResourceBlock[resourceBlock])\r\n        this.tooltip.visible = false\r\n        this.add(this.tooltip)\r\n\r\n\r\n        this.on('pointerenter', () => {\r\n            this.tooltip.visible = true\r\n        })\r\n\r\n        this.on('pointerleave', () => {\r\n            this.tooltip.visible = false\r\n        })\r\n    }\r\n\r\n\r\n    credit(amt: number) {\r\n        this.value += amt;\r\n        this.count.text = `x${this.value}`;\r\n    }\r\n\r\n    debit(amt: number) {\r\n        this.value -= amt\r\n        this.count.text = `x${this.value}`\r\n    }\r\n}\r\n","import { Color, Actor } from \"excalibur\";\r\nimport { ResourceBlock } from \"../../models/Economy\";\r\nimport { ResourceListEntry } from \"./ResourceListEntry\";\r\nimport { eachCons, eachChunk } from \"../../Util\";\r\nexport class ResourcesList extends Actor {\r\n    entries: {\r\n        [block in ResourceBlock]: ResourceListEntry;\r\n    } = {\r\n            [ResourceBlock.Biomass]: null,\r\n            [ResourceBlock.Idea]: null,\r\n            [ResourceBlock.Ore]: null,\r\n            [ResourceBlock.Meal]: null,\r\n            [ResourceBlock.Mineral]: null,\r\n            [ResourceBlock.Data]: null,\r\n            [ResourceBlock.Alloy]: null,\r\n            [ResourceBlock.Bioplasma]: null,\r\n            [ResourceBlock.Algorithm]: null,\r\n            [ResourceBlock.Argent]: null,\r\n            [ResourceBlock.Aurum]: null,\r\n            [ResourceBlock.Omnium]: null,\r\n        };\r\n\r\n    constructor(x: number, y: number) {\r\n        super(x,y,0,0); // 200, 60, Color.Green.clone().darken(0.8));\r\n        let rx0 = 0, ry0 = -5;\r\n        let resources = [\r\n            ResourceBlock.Meal,\r\n            ResourceBlock.Bioplasma,\r\n\r\n            ResourceBlock.Data,\r\n            ResourceBlock.Algorithm,\r\n\r\n            ResourceBlock.Mineral,\r\n            ResourceBlock.Alloy,\r\n\r\n            ResourceBlock.Argent,\r\n            ResourceBlock.Aurum,\r\n        ];\r\n\r\n        eachChunk(resources, 2).forEach(([res1, res2], index) => {\r\n            let rx = rx0 + index * 36, ry = ry0 + index * 0;\r\n            this.addEntry(rx, ry, res1)\r\n            this.addEntry(rx, ry + 14, res2)\r\n        });\r\n    }\r\n\r\n    private addEntry(x: number, y: number, res: ResourceBlock) {\r\n        let entry = new ResourceListEntry(x, y, res, 0);\r\n        this.add(entry);\r\n        this.entries[res] = entry;\r\n    }\r\n\r\n    increment(resource: ResourceBlock) {\r\n        let res = this.entries[resource]\r\n        if (res) {\r\n            res.credit(1);\r\n        }\r\n    }\r\n\r\n    decrement(resource: ResourceBlock) {\r\n        let res = this.entries[resource]\r\n        if (res) {\r\n            res.debit(1)\r\n        }\r\n    }\r\n}\r\n","import { Label, Color, Actor, FontStyle, FontUnit } from \"excalibur\";\r\nimport { Economy, ResourceBlock, PureValue } from \"../../models/Economy\";\r\nimport { ResourcesList } from \"./ResourcesList\";\r\nimport { EconomyView } from \"./EconomyView\";\r\nimport { MusicPlayer } from \"./MusicPlayer\";\r\nimport { Resources } from \"../../Resources\";\r\nimport { drawRect } from \"../../Painting\";\r\nimport { Game } from \"../../Game\";\r\n\r\nexport class StatusAnalysisView extends Actor {\r\n    private messageLabel: Label\r\n    private popLabel: Label\r\n\r\n    private resources: ResourcesList\r\n    private economy: EconomyView\r\n\r\n    private musicPlayer: MusicPlayer\r\n    private clock: Label\r\n\r\n    constructor(market: Economy, w: number, h: number) {\r\n        super(0,0, w*2,h, Color.DarkGray.clone().darken(0.92));\r\n\r\n        let ty = 14\r\n\r\n        let brand = new Label(Game.title, 5, ty+18, Game.font)\r\n        brand.fontSize = 28\r\n        brand.color = Color.Gray\r\n        brand.fontStyle = FontStyle.Italic\r\n        this.add(brand)\r\n\r\n        let version = new Label(\"v0.1\", 100, ty + 14, Game.font)\r\n        version.fontSize = 7\r\n        version.color = Color.Gray.darken(0.4)\r\n        this.add(version)\r\n\r\n\r\n        this.resources = new ResourcesList(130, ty)\r\n        this.add(this.resources)\r\n\r\n        this.economy = new EconomyView(market, 280, ty)\r\n        this.add(this.economy)\r\n\r\n        this.clock = new Label('current time', 660, ty, Game.font) // 'Verdana')\r\n        this.clock.color = Color.White // 'white'\r\n        this.add(this.clock)\r\n\r\n        this.popLabel = new Label(\"\", 660, ty + 14, Game.font) // 'Verdana')\r\n        this.popLabel.fontSize = 10\r\n        this.popLabel.color = Color.White\r\n        this.add(this.popLabel)\r\n\r\n        this.messageLabel = new Label('hi', 750, ty, Game.font) // 'Verdana')\r\n        this.messageLabel.fontSize = 10\r\n        this.messageLabel.color = Color.White\r\n        this.messageLabel.fontStyle = FontStyle.Italic\r\n        this.add(this.messageLabel)\r\n\r\n        this.musicPlayer = new MusicPlayer(726, 12, {\r\n            // 'Crater Rock': Resources.CraterRock,\r\n            // 'Indivision': Resources.Indivision,\r\n            'Future Tense': Resources.FutureTense,\r\n            // 'Isomer': Resources.Isomer,\r\n            // 'Understanding': Resources.Understanding,\r\n            // 'Outbound': Resources.Outbound,\r\n            'Assembler': Resources.Assembler,\r\n        })\r\n// // enable propagating pointer events\r\n// this.enableCapturePointer = true;\r\n// // // enable move events, warning: performance intensive!\r\n// this.capturePointer.captureMoveEvents = true;\r\n//         this.on('pointerenter', () => { alert('hover!')})\r\n    }\r\n\r\n    draw(ctx, delta) {\r\n        super.draw(ctx, delta)\r\n        this.musicPlayer.draw(ctx)\r\n        // drawRect(\r\n        //     ctx,\r\n        //     {x: this.x, y: this.y, width: this.getWidth(), height: this.getHeight() },\r\n        //     0,\r\n        //     Color.Magenta\r\n        // )\r\n    }\r\n\r\n    show() {\r\n        this.musicPlayer.show()\r\n    }\r\n\r\n    hide() {\r\n        this.musicPlayer.stop()\r\n        this.musicPlayer.hide()\r\n    }\r\n\r\n    incrementResource(res: ResourceBlock) {\r\n        this.resources.increment(res)\r\n    }\r\n\r\n    decrementResource(res: ResourceBlock) {\r\n        this.resources.decrement(res)\r\n    }\r\n\r\n    setMessage(text: string) { this.messageLabel.text = text }\r\n\r\n    showEconomy(updatedEconomy: Economy): any {\r\n        this.economy.updateView(updatedEconomy)\r\n    }\r\n\r\n    showPopCap(curr: any, cap: any): any {\r\n        this.popLabel.text = `Pop: ${curr}/${cap}`\r\n    }\r\n\r\n    setClock(time: number = 0) {\r\n        let days = (Math.floor(time / (60 * 24))+1).toString()\r\n        let hh = Math.floor(time / 60) % 24\r\n        let hours = Math.floor((hh + 11) % 12 + 1).toString()\r\n        let minutes = Math.floor(time % 60).toString()\r\n        let ampm = hh < 12 ? 'AM' : 'PM'\r\n        this.clock.text = `Day ${days}. ${hours}:${minutes.padStart(2, '0')} ${ampm}`\r\n    }\r\n    \r\n}\r\n","import { UIActor, Label, Engine, Color } from \"excalibur\";\r\nimport { Structure, Corridor, SurfaceRoad, Ladder, allStructures } from \"../../models/Structure\";\r\nimport { Game } from \"../../Game\";\r\nimport { ResourceBlock, emptyMarket, PureValue } from \"../../models/Economy\";\r\nimport { Machine, allMachines, PersonnelRegistry } from \"../../models/Machine\";\r\nimport { flatSingle } from \"../../Util\";\r\nimport { Colony } from \"../Planet/Colony\";\r\nimport { StatusAnalysisView } from \"./StatusAnalysisView\";\r\nimport { Device } from \"../Device\";\r\nimport { Planet } from \"../Planet/Planet\";\r\nimport { Card } from \"./Card\";\r\nimport { allSpaceFunctions, RoomRecipe } from \"../../models/RoomRecipe\";\r\nimport { Palette } from \"./Palette\";\r\nimport { Building } from \"../Building\";\r\nimport { Modal } from \"./Modal\";\r\nimport { TechTree } from \"../../models/TechTree\";\r\nimport { CitizenList } from \"./CitizenList\";\r\nimport { Citizen } from \"../Citizen\";\r\nimport { assembleButton, assembleToggle } from \"../../Elemental\";\r\nimport { Pane } from \"./Pane\";\r\n\r\nclass ActionList extends Pane {\r\n\r\n    setup(btns: { label: string, action: () => any, colorize?: () => Color }[]) {\r\n        btns.forEach(btn => {\r\n            let theButton = btn.colorize\r\n                ? assembleToggle(btn.label, btn.colorize)\r\n                : assembleButton(btn.label, Color.White)\r\n            theButton.onclick = () => {\r\n                btn.action()\r\n                if (btn.colorize) {\r\n                    theButton.style.backgroundColor = btn.colorize().toRGBA()\r\n                }\r\n            }\r\n            this._element.appendChild(theButton)\r\n        })\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\nexport class Hud extends UIActor {\r\n\r\n    private hidePalettes: boolean = true\r\n    private structurePalette: Palette\r\n    private machinePalette: Palette\r\n    private functionPalette: Palette\r\n\r\n    private showCitizenList: boolean = true\r\n    private citizenList: CitizenList\r\n    private actionList: ActionList\r\n\r\n\r\n    private card: Card\r\n    private status: StatusAnalysisView\r\n\r\n    private modal: Modal = null\r\n\r\n    static structuresForPalette = [\r\n        SurfaceRoad,\r\n        Corridor,\r\n        Ladder,\r\n        ...allStructures\r\n    ];\r\n    static machinesForPalette = allMachines\r\n    static functionsForPalette = allSpaceFunctions\r\n\r\n\r\n    constructor(\r\n        private game: Game,\r\n        private onBuildingSelect = null,\r\n        private onMachineSelect = null,\r\n        private onFunctionSelect = null,\r\n        private onCitizenSelect = null,\r\n    ) {\r\n        super(0, 0, game.canvasWidth, game.canvasHeight);\r\n        let canvasHeight = game.canvasHeight / window.devicePixelRatio;\r\n        let canvasWidth = game.canvasWidth / window.devicePixelRatio;\r\n\r\n        this.status = new StatusAnalysisView(emptyMarket(), game.canvasWidth, 64);\r\n        this.add(this.status)\r\n\r\n        let displayInfo = (e) => this.showCard(e)\r\n        this.machinePalette = new Palette('Machine', canvasWidth - 220, 55, allMachines, onMachineSelect, displayInfo) // (e) => this.showCard(e))\r\n        this.structurePalette = new Palette('Structure', 20, 300, Hud.structuresForPalette, onBuildingSelect, displayInfo)\r\n        this.functionPalette = new Palette('Room Recipe', 20, 55, Hud.functionsForPalette, onFunctionSelect, displayInfo, false)\r\n\r\n        this.citizenList = new CitizenList(canvasWidth - 220, canvasHeight-300, onCitizenSelect) //, (citizen) => {})\r\n\r\n        this.card = new Card(null, 20, canvasHeight - 200)\r\n        this.add(this.card)\r\n\r\n        this.actionList = new ActionList('Actions', canvasWidth/2 - 100, canvasHeight - 100)\r\n        this.actionList.setup([\r\n            { label: 'Main Menu', action: () => {game.goToScene('menu')} },\r\n            { label: 'Debug Mode', action: () => {\r\n                game.toggleDebugMode() //goToScene('menu')\r\n            }, colorize: () => game.debugMode ? Color.Violet : Color.LightGray },\r\n            // { label: 'Main Menu', action: () => {game.goToScene('menu')} }\r\n        ])\r\n    }\r\n\r\n    hide() {\r\n        this.machinePalette.hide()\r\n        this.structurePalette.hide()\r\n        this.functionPalette.hide()\r\n        this.citizenList.hide()\r\n        this.actionList.hide()\r\n\r\n        this.status.hide()\r\n    }\r\n\r\n    show() {\r\n        this.machinePalette.show()\r\n        this.structurePalette.show()\r\n        this.functionPalette.show()\r\n        this.citizenList.show()\r\n        this.actionList.show()\r\n\r\n        this.status.show()\r\n    }\r\n\r\n    restrictionsOff() {\r\n        this.machinePalette.restrictionsOff()\r\n        this.structurePalette.restrictionsOff()\r\n        this.functionPalette.restrictionsOff()\r\n    }\r\n\r\n    systemMessage(\r\n        message: string,\r\n        title: string = 'Commander...',\r\n        buttons: { [intent: string]: () => any },\r\n    ): Modal {\r\n\r\n        let canvasHeight = this.game.canvasHeight / window.devicePixelRatio;\r\n        let canvasWidth = this.game.canvasWidth / window.devicePixelRatio;\r\n        this.modal = new Modal(\r\n            title,\r\n            message,\r\n            canvasWidth/2,\r\n            canvasHeight/2,\r\n        ) \r\n        this.modal.addButtons(buttons)\r\n        return this.modal\r\n    }\r\n\r\n\r\n    closeSystemMessage() {\r\n        console.log(\"hide system message\")\r\n        if (this.modal) {\r\n            this.modal.teardown()\r\n            this.modal = null\r\n        }\r\n    }\r\n\r\n\r\n    showPalettes() {\r\n        this.hidePalettes = false\r\n    }\r\n\r\n    setStatus(text: string) { this.status.setMessage(text) }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        super.draw(ctx, delta)\r\n        if (!this.hidePalettes) {\r\n            this.structurePalette.draw(ctx)\r\n            this.functionPalette.draw(ctx)\r\n\r\n            if (this.machinePalette.comprehended.length > 0) {\r\n                this.machinePalette.draw(ctx)\r\n            }\r\n        }\r\n\r\n        if (this.modal) {\r\n            this.modal.draw(ctx)\r\n        }\r\n\r\n        if (this.showCitizenList) {\r\n            this.citizenList.draw(ctx)\r\n        }\r\n\r\n        this.actionList.draw(ctx)\r\n    }\r\n\r\n    update(game: Game, delta: number) {\r\n        super.update(game, delta)\r\n    }\r\n\r\n    resourceGathered(resource: ResourceBlock) {\r\n        this.status.incrementResource(resource)\r\n    }\r\n\r\n    resourceExpended(resource: ResourceBlock) {\r\n        this.status.decrementResource(resource)\r\n    }\r\n\r\n    updateDetails(planet: Planet, techTree: TechTree, following: Citizen, rebuildPalettes: boolean = true, time: number = 0) {\r\n        if (!planet) { return }\r\n        if (rebuildPalettes) {\r\n            this.updatePalettes(planet.colony, techTree)\r\n        }\r\n        this.updateEconomy(planet)\r\n        this.updateMaxPop(planet.economy[PureValue.Shelter].demand, planet.maxPop)\r\n\r\n        this.status.setClock(time)\r\n\r\n        // let missingCitizens = planet.population.citizens.some(c => !this.citizenList.doesRosterInclude(c))\r\n        // let followedChanged = following !== this.citizenList.following\r\n        // if (missingCitizens || followedChanged) {\r\n        this.citizenList.updateRoster(planet.population.citizens.filter(c => c.alive), following)\r\n        // }\r\n\r\n        if (!this.showCitizenList && planet.hasMachineKind(PersonnelRegistry)) {\r\n            this.showCitizenList = true\r\n        }\r\n    }\r\n\r\n    showCard(entity: Machine | Structure | RoomRecipe | Building | Device | Citizen) {\r\n        this.card.present(entity)\r\n    }\r\n\r\n    private updateMaxPop(curr, cap) {\r\n        this.status.showPopCap(curr, cap)\r\n    }\r\n\r\n    private updateEconomy(planet: Planet) {\r\n        this.status.showEconomy(planet.economy)\r\n    }\r\n\r\n    private updatePalettes(colony: Colony, techTree: TechTree) {\r\n        this.updateBuildingPalette(colony)\r\n        this.updateMachinePalette(colony, techTree)\r\n        this.updateFunctionPalette(colony)\r\n    }\r\n\r\n    private updateBuildingPalette(colony: Colony) {\r\n        let builtStructures =\r\n            Hud.structuresForPalette.filter((structure) => colony.buildings.some(b => b.structure instanceof structure))\r\n        if (!builtStructures.every(s => this.structurePalette.built.includes(s))) {\r\n            this.structurePalette.updateBuilt(builtStructures)\r\n        }\r\n    }\r\n\r\n    private updateMachinePalette(colony: Colony, techTree: TechTree) {\r\n        let devices = colony.findAllDevices()\r\n        let builtMachines = [\r\n            ...Hud.machinesForPalette.filter((machine) => devices.some(d => d.machine instanceof machine && d.built)),\r\n            // ...techTree.allUnlockedMachines()\r\n        ]\r\n        if (!builtMachines.every(machine => this.machinePalette.built.includes(machine))) {\r\n            this.machinePalette.updateBuilt(builtMachines, techTree.allUnlockedMachines())\r\n        }\r\n    }\r\n\r\n    private updateFunctionPalette(colony: Colony) {\r\n        let builtReifiedFunctions = flatSingle(colony.buildings.map(b => b.spaceFunction))\r\n        let builtFunctions = Hud.functionsForPalette.filter((fn) => builtReifiedFunctions.some(rf => rf instanceof fn))\r\n        if (!builtFunctions.every(fn => this.functionPalette.built.includes(fn))) {\r\n            this.functionPalette.updateBuilt(builtFunctions)\r\n        }\r\n    }\r\n\r\n}","import { range } from '../../Util';\r\nimport { PlanetBackground } from './PlanetBackground';\r\nimport { Game } from '../../Game';\r\nexport class Mountains extends PlanetBackground {\r\n    peaks: {\r\n        x: number;\r\n        height: number;\r\n    }[] = [];\r\n    onInitialize() {\r\n        let peakCount = 4\r\n        let peakHeight = 10 * Game.mansheight\r\n        let xOff = this.getWidth() / 2;\r\n        let peakDistance = this.getWidth() / peakCount;\r\n        // for (let times of range(2)) {\r\n        let heightRange = 4 * Game.mansheight\r\n        let drift = 3 * (peakDistance / 2);\r\n        for (let i of range(peakCount)) {\r\n            let h = \r\n                (peakHeight) + (Math.random() * heightRange)\r\n            this.peaks.push({\r\n                x: Math.min(this.getWidth() / 2 - h / 2, -xOff + i * peakDistance + ((Math.random() * drift))),\r\n                height: h\r\n            });\r\n        }\r\n        // }\r\n    }\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        let baseColor = this.color.desaturate(0.35);\r\n        let brightColor = baseColor.lighten(0.1);\r\n        ctx.fillStyle = baseColor.toRGBA();\r\n        let yBase = this.pos.y - 3;\r\n        this.peaks.forEach(peak => {\r\n            let y0 = yBase - peak.height;\r\n            let mtnWidth = peak.height * 3.4;\r\n            ctx.beginPath();\r\n            ctx.moveTo(peak.x, y0);\r\n            ctx.lineTo(peak.x - mtnWidth, yBase);\r\n            ctx.lineTo(peak.x + mtnWidth, yBase);\r\n            ctx.fillStyle = baseColor.toRGBA();\r\n            ctx.fill();\r\n            ctx.beginPath();\r\n            ctx.moveTo(peak.x, y0);\r\n            ctx.lineTo(peak.x + 3 * (mtnWidth / 4), yBase);\r\n            ctx.lineTo(peak.x + mtnWidth, yBase);\r\n            ctx.fillStyle = brightColor.toRGBA();\r\n            ctx.fill();\r\n        });\r\n    }\r\n}\r\n","import { Actor, Color } from 'excalibur';\r\nimport { mixColors } from '../../Util';\r\nimport { Mountains } from \"./Mountains\";\r\nimport { MountainLayers } from \"./MountainLayers\";\r\nexport class SkyLayer extends Actor {\r\n    mountains: Mountains;\r\n    mountainLayers: MountainLayers;\r\n    backMountainLayers: MountainLayers;\r\n    constructor(y: number, width: number, lo: Color, hi: Color) {\r\n        super(0, y, width, 1500); //width,1500) //height)\r\n        let mid = mixColors(lo, hi);\r\n        let buffer = MountainLayers.layerHeight / 4\r\n        let ht = (MountainLayers.layerHeight - buffer) * MountainLayers.layerCount\r\n        this.backMountainLayers = new MountainLayers(-ht, width, mid);\r\n        this.backMountainLayers.skyColor = hi;\r\n        this.add(this.backMountainLayers);\r\n        this.mountains = new Mountains(0, width, mid);\r\n        this.add(this.mountains);\r\n        this.mountainLayers = new MountainLayers(0, this.getWidth(), lo);\r\n        this.mountainLayers.skyColor = mid;\r\n        this.add(this.mountainLayers);\r\n    }\r\n    setLoHi(lo: Color, hi: Color) {\r\n        let mid = mixColors(lo, hi);\r\n        this.backMountainLayers.color = mid;\r\n        this.backMountainLayers.skyColor = hi;\r\n        this.mountains.color = mid;\r\n        this.mountainLayers.color = lo;\r\n        this.mountainLayers.skyColor = mid;\r\n    }\r\n}\r\n","import { Actor, Color } from 'excalibur';\r\nimport { range, mixColors } from '../../Util';\r\nimport { SkyLayer } from \"./SkyLayer\";\r\nimport { MountainLayers } from './MountainLayers';\r\nexport class SkyLayers extends Actor {\r\n    layers: SkyLayer[] = [];\r\n    constructor(y: number, width: number, private lo: Color, hi: Color, private layerCount: number = 5) {\r\n        super(0, y, width, 1500);\r\n        let h = (MountainLayers.layerHeight * MountainLayers.layerCount) + (MountainLayers.layerHeight / 2)\r\n        for (let i of range(layerCount)) {\r\n            let c0 = mixColors(lo, hi, (i / (layerCount + 1)));\r\n            let c1 = mixColors(lo, hi, ((i + 1) / (layerCount + 1)));\r\n            let layer = new SkyLayer(-20 - ((h) * (layerCount - i - 1)), this.getWidth(), c1, c0);\r\n            this.layers.push(layer);\r\n            this.add(layer);\r\n        }\r\n    }\r\n    setHi(hi: Color) {\r\n        let lo = this.lo;\r\n        for (let i of range(this.layerCount)) {\r\n            let c0 = mixColors(lo, hi, (i / (this.layerCount + 1)));\r\n            let c1 = mixColors(lo, hi, ((i + 1) / (this.layerCount + 1)));\r\n            this.layers[i].setLoHi(c1, c0);\r\n            // let layer = new SkyLayer(-100 * (layerCount-i-1), this.getWidth(), c1, c0)\r\n        }\r\n    }\r\n}\r\n","import { CombatStrategy } from \"./CombatStrategy\";\r\nimport { minBy, closest, sleep } from \"../Util\";\r\nimport { Citizen } from \"../actors/Citizen\";\r\nimport { CommandCenter } from \"../models/Machine\";\r\n\r\nexport class AttackNearestHostileStrategy extends CombatStrategy {\r\n    vigilanceRange: number = 2000\r\n\r\n        // ideas -- if not on surface, get to surface?\r\n        // if evil, advance towards mission control, fight anything in the way\r\n        // if not, get to surface/ctrl and fight anything\r\n    protected async apply() {\r\n        let target = closest(\r\n            this.pawn.pos,\r\n            this.hostiles.filter(h => h.alive && !h.isDriving),\r\n            (h) => h.pos\r\n        )\r\n        if (target) {\r\n            // this.pawn.log(\"found new target\")\r\n            this.pawn.engageHostile(target)\r\n        } else {\r\n            this.pawn.log(\"no new targets?\")\r\n        }\r\n\r\n        let enemy = this.pawn.enemyCombatant\r\n        let dy = Math.abs(this.pawn.pos.y - enemy.y)\r\n        if (dy > 40) {\r\n            this.pawn.log(\"head to mission ctrl...\")\r\n            if (this.pawn.isEvil) {\r\n                this.pawn.log(\"to attack it!\")\r\n                await this.pawn.advanceTowards(this.planet.colony.origin)\r\n            } else {\r\n                this.pawn.log(\"to defend it!\")\r\n                let cmdCenter = this.planet.colony.findAllDevices().find(device => device.machine instanceof CommandCenter)\r\n                await this.pawn.visit(cmdCenter)\r\n            }\r\n        } else { \r\n            if (this.pawn.withinFiringRange()) {\r\n                await this.attack()\r\n            } else {\r\n                await this.pawn.advanceTowardsEnemy()\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    async attack() {\r\n        this.pawn.y = this.pawn.enemyCombatant.y\r\n        if (!(this.pawn.guarding || this.pawn.firing)) {\r\n            if (this.pawn.isEvil || this.pawn.health > 95) {\r\n                await this.pawn.fire()\r\n            } else {\r\n                if ((this.pawn.health < 50 && Math.random() < 0.05) || Math.random() < 0.01) {\r\n                    await this.pawn.guard()\r\n                } else {\r\n                    await this.pawn.fire()\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    canApply(): boolean {\r\n        let defensePoint = this.planet.colony.origin ? this.planet.colony.origin : this.pawn.pos\r\n        let timeToPlay = this.hostiles.some(hostile => hostile.alive &&\r\n            (this.pawn.isEvil ? true : defensePoint.distance(hostile.pos) < this.vigilanceRange) \r\n            && !hostile.isDriving\r\n        )\r\n        return timeToPlay\r\n\r\n    }\r\n\r\n    get hostiles() {\r\n        return this.pawn.isEvil\r\n            ? this.planet.population.citizens\r\n            : this.planet.population.raiders\r\n    }\r\n}","import { Strategy } from \"./Strategy\";\r\n\r\nexport abstract class EatingStrategy extends Strategy {\r\n    describe() { return 'eating' }\r\n}","import { EatingStrategy } from \"./EatingStrategy\";\r\nimport { ResourceBlock } from \"../models/Economy\";\r\n\r\nexport class WhenHungryEatingStrategy extends EatingStrategy {\r\n    canApply(): boolean {\r\n        return this.pawn.isHungry &&\r\n            this.planet.storedResources.includes(ResourceBlock.Meal)\r\n        // hunger > 0.6\r\n        // throw new Error(\"Method not implemented.\");\r\n    }\r\n\r\n    protected async apply() {\r\n        // find the store with the food! reserve it maybe?\r\n        let fridge = this.devices.find(d => d.machine.operation.type === 'store' &&\r\n          d.machine.operation.stores.includes(ResourceBlock.Meal) &&\r\n          d.product.includes(ResourceBlock.Meal) &&\r\n          !d.reserved\r\n        )\r\n\r\n        if (fridge) {\r\n            fridge.reserved = true\r\n            // take the meal to a desk? (maybe need table here... or eatingSurface aspect?)\r\n            await this.visitDevice(fridge)\r\n            await fridge.interact(this.pawn, { type: 'retrieve', resource: ResourceBlock.Meal })\r\n            fridge.reserved = false\r\n\r\n            let desk = this.devices.find(d => d.machine.isEatingSurface) // instanceof Desk)\r\n            if (desk) {\r\n                await this.visitDevice(desk)\r\n            }\r\n            await this.pawn.eat()\r\n            // fridge.interac\r\n            // this.pawn.interact()\r\n        }\r\n    }\r\n    \r\n    \r\n}","import { Strategy } from \"./Strategy\";\r\n\r\nexport abstract class SleepingStrategy extends Strategy {\r\n    describe() { return 'sleeping' }\r\n}","import { SleepingStrategy } from \"./SleepingStrategy\";\r\nimport { Bed } from \"../models/Machine\";\r\nimport { shuffle } from \"../Util\";\r\n\r\nexport class AnyBedSleepingStrategy extends SleepingStrategy {\r\n    canApply(): boolean {\r\n        if (!this.bed) {\r\n            // no available beds..\r\n            return false\r\n        }\r\n\r\n        if (this.planet.population.raiders.some(raider => raider.pos.distance(this.pawn.pos) < 1000)) {\r\n            // you can't sleep now!\r\n            return false\r\n        }\r\n\r\n        if (this.pawn.health < 100) {\r\n            return true\r\n        }\r\n\r\n        if (!this.pawn.isTired) {\r\n            return false\r\n        }\r\n\r\n        let bedtime = this.planet.hour > 21 || this.planet.hour < 4\r\n        return bedtime\r\n    }\r\n\r\n    protected async apply() {\r\n        this.pawn.log(\"try to sleep!\")\r\n        // find a bed\r\n        // let bed = shuffle(this.devices).find(d => d.machine instanceof Bed && !d.inUse)\r\n        let bed = this.bed\r\n        if (bed) {\r\n            this.pawn.log(\"found a bed!\")\r\n            bed.inUse = true\r\n            this.pawn.sleepingInBed = bed\r\n            this.pawn.log(\"going to bed!\")\r\n            await this.visitDevice(bed)\r\n            this.pawn.log(\"taking a rest!\")\r\n            await this.pawn.takeRest()\r\n            this.pawn.log(\"done resting!\")\r\n            bed.inUse = false\r\n        }\r\n        return true\r\n    }\r\n\r\n\r\n    private get bed() {\r\n        return shuffle(this.devices).find(d => d.machine instanceof Bed && !d.inUse )\r\n    }\r\n}","import { Strategy } from \"./Strategy\";\r\nimport { Device } from \"../actors/Device\";\r\nimport { containsUniq } from \"../Util\";\r\n\r\nexport abstract class ConstructionStrategy extends Strategy {\r\n    describe() { return 'building' }\r\n\r\n    canApply(): boolean {\r\n        return !!this.unbuiltDevice\r\n    }\r\n\r\n    get unbuiltDevice() {\r\n        const isUnbuilt = (d: Device) => !d.built && !d.inUse && d.building.isActive &&\r\n          // the player can TRY to build it, we don't have to hang forever on it though\r\n          containsUniq(this.planet.storedResources, d.machine.cost)\r\n        return this.planet.colony.findAllDevices().find(isUnbuilt)\r\n    }\r\n}","import { ConstructionStrategy } from \"./ConstructionStrategy\";\r\nimport { Device } from \"../actors/Device\";\r\n\r\nexport class ProxmityBasedConstruction extends ConstructionStrategy {\r\n    async apply() {\r\n        if (this.unbuiltDevice && this.unbuiltDevice.building) {\r\n            await this.constructDevice(this.unbuiltDevice)\r\n        }\r\n        await this.pause()\r\n    }\r\n\r\n    private async constructDevice(device: Device) {\r\n        device.inUse = true\r\n        let resources = device.machine.cost\r\n        if (await this.gatherIngredients(resources)) {\r\n            await this.visitDevice(device)\r\n            await device.assemble(this.pawn)\r\n        } \r\n\r\n        device.inUse = false\r\n    }\r\n}","import { ResourceBlock } from \"../models/Economy\";\r\n\r\nimport { Recipe } from \"../models/MechanicalOperation\";\r\n\r\nexport interface RetrieveResource {\r\n    type: 'retrieve'\r\n    resource: ResourceBlock\r\n    // count: number\r\n}\r\n\r\nexport interface WorkRecipe {\r\n    type: 'work'\r\n    recipe: Recipe\r\n}\r\n\r\nexport interface StoreResource {\r\n    type: 'store'\r\n    resource: ResourceBlock\r\n}\r\n\r\nexport interface DriveAround {\r\n    type: 'drive'\r\n}\r\n\r\nexport function retrieveResource(res: ResourceBlock): RetrieveResource {\r\n    return {\r\n        type: 'retrieve',\r\n        resource: res,\r\n        // count: 1\r\n    }\r\n}\r\n\r\nexport function drive(): DriveAround {\r\n    return { type: 'drive' }\r\n}\r\n\r\nexport type InteractionRequest = StoreResource | RetrieveResource | WorkRecipe | DriveAround\r\n\r\n","import { Device } from \"../actors/Device\";\r\nimport { MechanicalOperation, Recipe } from \"../models/MechanicalOperation\";\r\nimport { ResourceBlock } from \"../models/Economy\";\r\nimport { retrieveResource } from \"../values/InteractionRequest\";\r\nimport { Strategy } from \"./Strategy\";\r\n\r\nexport abstract class ProductionStrategy extends Strategy {\r\n    describe() { return 'making' }\r\n\r\n    protected async storeBlock(res: ResourceBlock) {\r\n        let stored = false\r\n        let tries = 0\r\n        while (!stored && tries < 30) {\r\n            tries++\r\n            if (await this.tryStoreBlock(res)) {\r\n                stored = true\r\n            } else {\r\n                await this.pause()\r\n            }\r\n        }\r\n    }\r\n\r\n    private async tryStoreBlock(res: ResourceBlock): Promise<boolean> {\r\n        let storesDesiredBlock = (d: Device) => d.operation.type === 'store' &&\r\n            d.product.length < d.getEffectiveOperationalCapacity(d.operation) && //operation.capacity &&\r\n            d.operation.stores.includes(res)\r\n        let openStore = this.planet.colony.closestDeviceByType(this.pawn.pos, [], storesDesiredBlock)\r\n        let stored = false\r\n        if (openStore) {\r\n            await this.visitDevice(openStore)\r\n            if (await openStore.interact(this.pawn, { type: 'store', resource: res })) {\r\n                stored = true\r\n            }\r\n        }\r\n\r\n        //if (!stored) {\r\n        //    await this.pause()\r\n        //    // should try agi\r\n        //    // await this.storeBlock(res)\r\n        //}\r\n\r\n        return stored\r\n    }\r\n\r\n}\r\n","import { shuffle, containsUniq } from \"../Util\";\r\nimport { Device } from \"../actors/Device\";\r\nimport { Recipe, ResourceStorage, ExploreForResource } from \"../models/MechanicalOperation\";\r\nimport { ProductionStrategy } from \"./ProductionStrategy\";\r\nimport { Resource } from \"excalibur\";\r\n\r\nexport class CapacityBasedProduction extends ProductionStrategy {\r\n    canApply(): boolean {\r\n\r\n        const storeWithCapacity = (d: Device) => d.operation.type === 'store' &&\r\n            d.product.length < d.getEffectiveOperationalCapacity(d.operation) //&&\r\n\r\n        let stores = this.devices.filter(storeWithCapacity)\r\n        let workable = stores.some((d: Device) => {\r\n            let recipe = this.findRecipe(d)\r\n            let explorer = this.findExplorer(d)\r\n            return !!(recipe || explorer)\r\n        })\r\n\r\n        return workable\r\n    }\r\n\r\n    async apply() {\r\n        let store = this.findStore()\r\n        let recipe = this.findRecipe(store)\r\n        let explorer = this.findExplorer(store)\r\n\r\n\r\n        if (recipe && containsUniq(this.planet.storedResources, recipe.consumes)) {\r\n            if (await this.workRecipe(recipe)) {\r\n                await this.storeBlock(recipe.produces)\r\n            }\r\n        } else if (explorer) {\r\n            if (await this.workExploration(explorer)) {\r\n                await this.storeBlock(explorer.gathers)\r\n            }\r\n        } else {\r\n            // console.warn(\"No recipe or explorer!\")\r\n        }\r\n    }\r\n\r\n    private findStore() {\r\n        const storeWithCapacity = (d: Device) => d.operation.type === 'store' &&\r\n            d.product.length < d.getEffectiveOperationalCapacity(d.operation) //&&\r\n        let store: Device = shuffle(this.devices).find(storeWithCapacity)\r\n        return store\r\n    }\r\n\r\n\r\n    private findRecipe(store: Device): Recipe {\r\n        if (store && store.operation.type === 'store') {\r\n            const storage: ResourceStorage = store.operation\r\n            const recipeForStoredResource = (r: Recipe) => storage.stores.some(stored => r.produces === stored)\r\n            let recipe: Recipe = shuffle(this.recipes).find(recipeForStoredResource)\r\n            return recipe\r\n        }\r\n    }\r\n\r\n    private findExplorer(store: Device): ExploreForResource {\r\n        if (store && store.operation.type === 'store') {\r\n            const storage: ResourceStorage = store.operation\r\n            // console.log(\"Looking for explorer for\", { stored: storage.stores })\r\n            const explorerForStored = (e: ExploreForResource) => storage.stores.some(stored => e.gathers === stored)\r\n            let explorer: ExploreForResource = shuffle(this.explorers).find(explorerForStored)\r\n            // console.log(\"Looked for explorer, found: \", { explorer })\r\n            return explorer\r\n        }\r\n    }\r\n}\r\n","import { Actor, Traits, Scene } from 'excalibur';\r\nimport { Citizen } from '../Citizen';\r\nimport { Planet } from './Planet';\r\nimport { Device } from '../Device';\r\nimport { World } from '../../models/World';\r\nimport { closest } from '../../Util';\r\n\r\nexport class Population extends Actor {\r\n    citizens: Citizen[] = []\r\n    raiders: Citizen[] = []\r\n\r\n    constructor(private planet: Planet, public scene: Scene) {\r\n        super(0, -planet.getHeight() / 2, 0, 0);\r\n        this.traits = this.traits.filter(trait => !(trait instanceof Traits.OffscreenCulling));\r\n        console.log(\"in pop ctor, scene is: \", { scene: this.scene })\r\n    }\r\n\r\n    update(engine, delta) {\r\n        super.update(engine, delta)\r\n        let notKilled = c => c.alive // && !c.isKilled()\r\n        this.citizens = this.citizens.filter(notKilled) //.sort(c => c.hover ? -1 : 1)\r\n        this.raiders = this.raiders.filter(notKilled) //.sort(c => c.hover ? -1 : 1)\r\n        let pos = engine.input.pointers.primary.lastWorldPos\r\n        let hoverables: (Citizen)[] = [\r\n            // ...this.planet.colony.findAllDevices(),\r\n            // ...this.planet.colony.buildings,\r\n            ...this.citizens,\r\n            ...this.raiders,\r\n        ]\r\n        if (hoverables.length > 0) {\r\n            hoverables.forEach(h => { h.hover = false; h.z = 1 })\r\n            let center = (d: Citizen) => {\r\n                let pos = d.getWorldPos()\r\n                // if (d instanceof Building) {\r\n                    // pos.addEqual(new Vector(d.getWidth()/2, d.getHeight()/2))\r\n                // }\r\n                return pos\r\n            }\r\n            // .add( new Vector(d.getWidth() / 2, d.getHeight() / 2))\r\n            let hoverable: Citizen = closest(\r\n                pos,\r\n                hoverables,\r\n                center\r\n            )\r\n            if (hoverable && center(hoverable).distance(pos) < hoverable.getWidth()*2) {\r\n                // console.log(\"HOVER ON\", { hoverable })\r\n                hoverable.hover = true\r\n                hoverable.z = 1000\r\n                // this.hud.showCard(hoverable)\r\n            }\r\n        }\r\n    }\r\n\r\n    // draw(ctx, delta) {\r\n        // this.citizens.forEach(c => c.draw(ctx, delta))\r\n        // this.raiders.forEach(c => c.draw(ctx, delta))\r\n    // }\r\n\r\n    increase(pos, elite: boolean = false) {\r\n        let citizen = new Citizen(World.nameCitizen(), pos, this.planet, { elite });\r\n        citizen.work();\r\n        this.citizens.push(citizen);\r\n        // scene.add?\r\n        if (this.scene) {\r\n            this.scene.add(citizen);\r\n        } else {\r\n            console.warn(\"no scene to add citizen to!?!?\")\r\n        }\r\n    }\r\n\r\n    tearDown() {\r\n        this.citizens.forEach((c) => this.scene.remove(c))\r\n        this.raiders.forEach((c) => this.scene.remove(c))\r\n    }\r\n}\r\n","import { Graph } from \"../../values/Graph\";\r\nimport { Vector } from \"excalibur\";\r\nimport { Building } from \"../Building\";\r\nimport { minBy } from \"../../Util\";\r\nimport { Scale } from \"../../values/Scale\";\r\n\r\nexport class NavigationTree {\r\n   graph: Graph<Vector>\r\n\r\n   constructor(root: Building) {\r\n       this.graph = root.graph()\r\n   }\r\n\r\n   seekPath(origin: Vector, dest: Vector): Vector[] {\r\n      return this.graph.shortestPath(origin, dest)\r\n   }\r\n\r\n   closestNode(testNode: Vector) {\r\n       let nodes = this.graph.dfs()\r\n       let closest = minBy(nodes,\r\n           (node: Vector) => Math.abs(testNode.distance(node))\r\n       )\r\n       if (closest) {\r\n           return closest\r\n       }\r\n       return false\r\n   }\r\n\r\n   closestNodeAtSameYCoordinate(testNode: Vector, tol: number = Scale.major.fourth) {\r\n       let nodes = this.graph.dfs()\r\n       let closest = minBy(\r\n           nodes.filter((node: Vector) => Math.abs(node.y - testNode.y) < tol),\r\n           (node: Vector) => Math.abs(testNode.distance(node)),\r\n       )\r\n       if (closest) {\r\n           return closest\r\n       }\r\n       return false\r\n   }\r\n}","import { Actor, Vector, Traits, Color } from 'excalibur';\r\nimport { Building } from '../Building';\r\nimport { minBy, flatSingle } from '../../Util';\r\nimport { Structure } from '../../models/Structure';\r\nimport { NavigationTree } from './NavigationTree';\r\nimport { Machine } from '../../models/Machine';\r\nimport { Device } from '../Device';\r\nimport { Game } from '../../Game';\r\n\r\nexport class Colony extends Actor {\r\n    debugMap: boolean = false\r\n    navTree: NavigationTree;\r\n    buildings: Building[] = [];\r\n    currentlyConstructing: Building | Device = null;\r\n\r\n    constructor(x: number, y: number) {\r\n        super(x, y, 0, 0); // 1000, 1000);\r\n        this.traits = this.traits.filter(trait => !(trait instanceof Traits.OffscreenCulling));\r\n    }\r\n\r\n\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        super.draw(ctx, delta);\r\n\r\n        let debugTree = this.debugMap //Game.debugPath\r\n        if (this.navTree && debugTree) {\r\n            let edges = this.navTree.graph.edgeList();\r\n            edges.forEach((edge) => {\r\n                let [a,b] = edge;\r\n                var gradient = ctx.createLinearGradient(a.x,a.y+this.pos.y,b.x,b.y+this.pos.y);\r\n\r\n                gradient.addColorStop(0, 'green');\r\n                gradient.addColorStop(1, 'blue');\r\n\r\n                ctx.beginPath()\r\n                ctx.moveTo(a.x, a.y + this.pos.y)\r\n                ctx.lineTo(b.x, b.y + this.pos.y)\r\n                ctx.closePath()\r\n                ctx.strokeStyle = gradient\r\n                ctx.lineWidth = 0.5\r\n                ctx.stroke()\r\n            })\r\n        }\r\n    }\r\n\r\n    update(engine: Game, delta: number) {\r\n        if (engine.debugMode) {\r\n            this.debugMap = true\r\n        } else {\r\n            this.debugMap = false\r\n        }\r\n\r\n    }\r\n\r\n    tearDown() {\r\n        this.navTree = null\r\n        this.currentlyConstructing = null\r\n        this.buildings.forEach(b => this.remove(b))\r\n    }\r\n\r\n    placeBuilding(building: Building) {\r\n        building.placed = true;\r\n        if (building.parentSlot) {\r\n            building.parentSlot.parent.childrenBuildings.push(building);\r\n            this.buildNavTree();\r\n        }\r\n        this.buildings.push(building);\r\n        building.afterConstruct();\r\n        this.add(building);\r\n    }\r\n\r\n    closestBuildingByType(cursor: Vector, structureTypes: (typeof Structure)[] = [], predicate: (Building) => boolean = () => true): Building {\r\n        let matching = this.buildings\r\n        .filter(building => //predicate(building) &&\r\n            (structureTypes.length > 0\r\n            ? structureTypes.some(st => building.structure instanceof st)\r\n            : true)\r\n             && predicate(building)\r\n        )\r\n\r\n        if (matching && matching.length > 0) {\r\n            let distanceToCursor = (building) => cursor.distance(building.nodes()[0]);\r\n            return minBy(matching, distanceToCursor);\r\n        }\r\n    }\r\n\r\n    pathBetween(origin: Vector, destination: Building): Vector[] {\r\n        if (!this.navTree) {\r\n            this.buildNavTree();\r\n        }\r\n        let srcNode = this.navTree.closestNode(origin);\r\n        let dest = destination.nodes()[0] //.length > 1 ? destination.nodes()[1] : destination.nodes()[0];\r\n        let destNode = this.navTree.closestNode(dest);\r\n        let path = this.navTree.seekPath(srcNode, destNode);\r\n        return path;\r\n    }\r\n\r\n    pathBetweenPoints(origin: Vector, destination: Vector, constrainSourceY: boolean = true): Vector[] {\r\n        if (!this.navTree) {\r\n            this.buildNavTree();\r\n        }\r\n        let srcNode = constrainSourceY ? this.navTree.closestNodeAtSameYCoordinate(origin) : this.navTree.closestNode(origin);\r\n        let dest = destination; //.nodes()[0];\r\n        let destNode = this.navTree.closestNode(dest);\r\n        let path = this.navTree.seekPath(srcNode, destNode);\r\n        // console.log(\"PATH FOUND BTWN POINTS\", { srcNode, destNode, path })\r\n        return path;\r\n    }\r\n\r\n\r\n\r\n    closestDeviceByType(cursor: Vector, machineTypes: (typeof Machine)[] = [], predicate: (Device) => boolean = () => true) {\r\n        let devices = this.findPoweredDevices()\r\n        devices = devices.filter(d => \r\n            (machineTypes.length > 0 ? machineTypes.some(machine => d.machine instanceof machine) : true)\r\n             && predicate(d)\r\n        )\r\n\r\n        if (devices && devices.length > 0) {\r\n            let proximity = (d) => cursor.distance(d.pos.add(d.building.pos))\r\n            return minBy(devices, proximity)\r\n        }\r\n    }\r\n\r\n    get origin() {\r\n        return this.buildings[0] ? this.buildings[0].pos : null\r\n    }\r\n\r\n    private buildNavTree() {\r\n        let ctrl = this.buildings[0] //.find(building => building.structure instanceof MissionControl);\r\n        if (ctrl) {\r\n            this.navTree = new NavigationTree(ctrl);\r\n        }\r\n    }\r\n\r\n    findAllDevices(): Device[] {\r\n        return flatSingle(this.buildings.map(b => b.getDevices()))\r\n    }\r\n\r\n    findPoweredDevices(): Device[] {\r\n        return flatSingle(this.activeBuildings.map(b => b.getDevices()))\r\n            .filter(d => d.built) /// ....\r\n    }\r\n\r\n    protected get activeBuildings() {\r\n        return this.buildings.filter(b => b.isActive)\r\n    }\r\n}\r\n","import { drawRect } from \"../../Painting\";\r\nimport { DomeView, Building } from \".\";\r\nimport { Orientation } from \"../../values/Orientation\";\r\nimport { Color } from \"excalibur\";\r\nimport { DeviceSize } from \"../../values/DeviceSize\";\r\n\r\nexport class GroundVehiclePoolView extends Building {\r\n\r\n    deviceSize = DeviceSize.Small\r\n    colorBase() { return Color.Orange.clone().darken(0.05); } \r\n    draw(ctx, delta) {\r\n        // drawRect(ctx, this.aabb())\r\n       super.draw(ctx, delta)\r\n    }\r\n\r\n    slots() {\r\n        let theSlots = [];\r\n        let slotY = this.getHeight();\r\n\r\n        let buffer = this.getWidth() / 4\r\n\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x - buffer, this.pos.y + slotY,\r\n                Orientation.Left\r\n            )\r\n        )\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth() + buffer,\r\n                this.pos.y + slotY,\r\n                Orientation.Right\r\n            )\r\n        )\r\n\r\n        return theSlots;\r\n    } \r\n}","import { Color, Vector } from \"excalibur\";\r\nimport { Building, DevicePlace } from \"./Building\";\r\nimport { Orientation } from \"../../values/Orientation\";\r\nimport { Slot } from \"../../values/Slot\";\r\nimport { Device } from \"../Device\";\r\nimport { DeviceSize, getVisibleDeviceSize } from \"../../values/DeviceSize\";\r\nimport { drawPatternedRect, drawRect, drawPatternedPoly, drawPoly } from \"../../Painting\";\r\nimport { measureDistance, eachCons } from \"../../Util\";\r\nimport { BackgroundPattern } from \"./BackgroundPatterns\";\r\n// import { drawPatternedRect, drawRect } from \"../../Util\";\r\n\r\nexport class MediumSurfaceRoomView extends Building {\r\n    hideBox = true\r\n    showLabel = true\r\n    // hideLabe\r\n\r\n    devicePlaceSize = DeviceSize.Medium\r\n    devicePlaceCount = 3\r\n    get floorHeight() { return this.getHeight() / 6 }\r\n\r\n    get floorY() {\r\n        return this.pos.y + this.getHeight() - this.floorHeight\r\n    }\r\n\r\n   nodes(): Vector[] {\r\n        let x = this.pos.x + this.getWidth()/2;\r\n        let y = this.pos.y + this.getHeight() - this.floorHeight\r\n        return [\r\n            new Vector(Math.floor(x), Math.floor(y))\r\n        ];\r\n    }\r\n    devicePlaces() {\r\n        let w = this.getWidth()/2\r\n        let x = this.pos.x + w;\r\n        let y = this.pos.y + this.getHeight() - this.floorHeight - 12 \r\n        y -= getVisibleDeviceSize(this.devicePlaceSize) / 3.5\r\n\r\n        let ds = [\r\n            new Vector(x - w/2, y),\r\n            ...(this.devicePlaceCount > 2 ? [new Vector(x,y)] : []),\r\n            new Vector(x + w/2, y),\r\n        ]\r\n\r\n        return ds.map(d => new DevicePlace(d, this.devicePlaceSize)) \r\n    }\r\n\r\n    //deviceInteractionPlaces() {\r\n\r\n    //}\r\n\r\n    graph(sg) {\r\n        let g = super.graph(sg)\r\n        let find = (s: Vector) => g.findOrCreate(s, measureDistance)\r\n        let slots: Vector[] = this.slots().map(s => s.pos)\r\n        // draw from left slot to each device place to right slot?\r\n        let devices = this.deviceInteractionPlaces().map(p => find(p)) //d.position))\r\n        eachCons(devices, 2).forEach(([left, right]) => g.edge(left, right))\r\n\r\n        if (this.isGroundFloor) {\r\n            let leftSlot = find(slots[0]), rightSlot = find(slots[slots.length - 1])\r\n            g.edge(leftSlot, devices[0])\r\n            g.edge(devices[devices.length - 1], rightSlot)\r\n        } else {\r\n            let topSlot = find(slots[1])\r\n            g.edge(devices[1], topSlot)\r\n        }\r\n\r\n        let node = this.nodes()[0]\r\n        devices.forEach(device => g.edge(device, find(node)))\r\n        // g.edge(devices[1], find(slots[1]))\r\n\r\n        return g\r\n    }\r\n\r\n\r\n    slots() {\r\n        let theSlots: Slot[] = []\r\n        let slotY = this.getHeight() - this.floorHeight;\r\n\r\n        if (this.isGroundFloor) {\r\n            theSlots.push(\r\n                this.buildSlot(\r\n                    this.pos.x, this.pos.y + slotY,\r\n                    Orientation.Left\r\n                )\r\n            )\r\n        }\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth() / 2,\r\n                this.pos.y + this.getHeight(), // + (2*this.floorHeight),\r\n                Orientation.Down\r\n            )\r\n        )\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth() / 2,\r\n                this.pos.y - 1, // + this.getHeight(),\r\n                Orientation.Up\r\n            )\r\n        )\r\n\r\n\r\n        if (this.isGroundFloor) {\r\n            theSlots.push(\r\n                this.buildSlot(\r\n                    this.pos.x + this.getWidth(),\r\n                    this.pos.y + slotY,\r\n                    Orientation.Right\r\n                )\r\n            )\r\n        }\r\n\r\n\r\n        return theSlots;\r\n    }\r\n\r\n    get isGroundFloor() {\r\n        return !this.parentSlot || !(this.parentSlot.parent instanceof MediumSurfaceRoomView)\r\n    }\r\n\r\n    constrainCursor(cursor: Vector): Vector {\r\n        if (this.planet.colony.buildings.length === 0) {\r\n            cursor.y = this.planet.getTop();\r\n        } // else {\r\n            // this.alignToSlot(cursor)\r\n        // }\r\n        return cursor;\r\n    }\r\n\r\n    reshape(cursor: Vector) {\r\n        if (this.planet.colony.buildings.length === 0) {\r\n            this.pos = cursor\r\n            this.pos.y -= this.getHeight() - 2 - this.floorHeight // hm\r\n        } else {\r\n            this.alignToSlot(cursor)\r\n\r\n        }\r\n    }\r\n\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        let color = this.mainColor()\r\n\r\n        ctx.fillStyle = color.toRGBA()\r\n\r\n        // ctx.fillRect(this.pos.x, this.pos.y, this.getWidth(), this.getHeight())\r\n        // let rect = \r\n            // { x: this.pos.x, y: this.pos.y, width: this.getWidth(), height: this.getHeight() };\r\n        drawPatternedPoly(\r\n            ctx,\r\n            this.angledRoofPoly(),\r\n            this.backgroundPattern,\r\n            this.mainColor()\r\n        )\r\n\r\n\r\n        if (!this.isActive) {\r\n            // draw overlay rect that darkens\r\n            let c = Color.Black.clone()\r\n            c.a = 0.6\r\n            drawPoly(ctx, this.angledRoofPoly(), c)\r\n        }\r\n\r\n        // floor\r\n        let floorColor = this.planet.color.darken(0.6)\r\n        let floorEdgeHeight = 12 // 6\r\n        let floorOff = -5\r\n        drawRect(\r\n            ctx,\r\n            { x: this.x, y: this.y + this.getHeight() - this.floorHeight - floorEdgeHeight,\r\n              width: this.getWidth(), height: floorEdgeHeight - floorOff },\r\n            //   0,\r\n              floorColor.lighten(0.4)\r\n        )\r\n\r\n        drawRect(\r\n            ctx,\r\n            { x: this.x, y: this.y + this.getHeight() - this.floorHeight - floorOff,\r\n              width: this.getWidth(), height: this.floorHeight + floorOff },\r\n            //   0,\r\n              floorColor\r\n        )\r\n\r\n        // a little flag :)\r\n        let flagpoleHeight = 18\r\n        let flagX = this.pos.x + 3 * (this.getWidth() / 4)\r\n        let flagY = this.pos.y - flagpoleHeight\r\n\r\n        ctx.fillStyle = Color.Black.fillStyle()\r\n        ctx.fillRect(flagX, flagY-1, 1, flagpoleHeight+1)\r\n        drawPatternedRect(\r\n            ctx,\r\n            { x: flagX, y: flagY, width: 10, height: 6 },\r\n            BackgroundPattern.USSF\r\n        )\r\n        // ctx.fillRect(flagX, flagY, 10, 5)\r\n\r\n        super.draw(ctx, delta)\r\n    }\r\n\r\n    colorBase() { return Color.White.clone(); }\r\n}","import { CommonAreaView } from \".\";\r\nimport { DeviceSize } from \"../../values/DeviceSize\";\r\n\r\nexport class MediumRoomThreeView extends CommonAreaView {\r\n    devicePlaceSize = DeviceSize.Medium\r\n    devicePlaceCount = 3\r\n\r\n    poly() { return this.angledRoofPoly() }\r\n\r\n    // devicePlaces() {\r\n    //     let w = this.getWidth()/2\r\n    //     let x = this.pos.x + w;\r\n    //     let y = this.pos.y + this.getHeight() - getVisibleDeviceSize(DeviceSize.Medium)/3\r\n    //     let ds = [\r\n    //         new Vector(x - w/3, y),\r\n    //         new Vector(x, y),\r\n    //         new Vector(x + w/3, y),\r\n    //     ]\r\n\r\n    //     return ds.map(d => new DevicePlace(d, DeviceSize.Medium))\r\n    // }\r\n}","import { CommonAreaView } from \".\";\r\nimport { Vector } from \"excalibur\";\r\nimport { DevicePlace } from \"./Building\";\r\nimport { DeviceSize, getVisibleDeviceSize } from \"../../values/DeviceSize\";\r\n\r\nexport class HugeRoomView extends CommonAreaView {\r\n    devicePlaceSize = DeviceSize.Huge\r\n    devicePlaces() {\r\n        let w = this.getWidth()/2\r\n        let x = this.pos.x + w;\r\n        let y = this.pos.y + this.getHeight() - this.floorHeight - getVisibleDeviceSize(DeviceSize.Huge)/2 \r\n        let ds = [\r\n            new Vector(x - w/3, y),\r\n            new Vector(x + w/3, y),\r\n        ]\r\n        return ds.map(d => new DevicePlace(d, DeviceSize.Huge))\r\n    }\r\n}","import { CommonAreaView } from \".\";\r\nimport { Vector } from \"excalibur\";\r\nimport { DevicePlace } from \"./Building\";\r\nimport { DeviceSize, getVisibleDeviceSize } from \"../../values/DeviceSize\";\r\n\r\nexport class LargeRoomView extends CommonAreaView {\r\n    devicePlaceSize = DeviceSize.Large\r\n    devicePlaces() {\r\n        let w = this.getWidth()/2\r\n        let x = this.pos.x + w;\r\n        let y = this.pos.y + this.getHeight() - getVisibleDeviceSize(DeviceSize.Large)/2 \r\n        let ds = [\r\n            new Vector(x - w/3, y),\r\n            new Vector(x + w/3, y),\r\n        ]\r\n\r\n        return ds.map(d => new DevicePlace(d, DeviceSize.Large))\r\n    }\r\n}","import { CommonAreaView } from \".\";\r\nimport { DeviceSize, getVisibleDeviceSize } from \"../../values/DeviceSize\";\r\nimport { DevicePlace } from \"./Building\";\r\nimport { Vector } from \"excalibur\";\r\n\r\nexport class MediumRoomView extends CommonAreaView {\r\n    devicePlaceSize = DeviceSize.Medium\r\n    devicePlaceCount = 2\r\n    // devicePlaces() {\r\n    //     let w = this.getWidth()/2\r\n    //     let x = this.pos.x + w;\r\n    //     let y = this.pos.y + this.getHeight() - this.floorHeight - getVisibleDeviceSize(DeviceSize.Medium)/3\r\n    //     let ds = [\r\n    //         new Vector(x - w/3, y),\r\n    //         new Vector(x + w/3, y),\r\n    //     ]\r\n\r\n    //     return ds.map(d => new DevicePlace(d, DeviceSize.Medium))\r\n    // }\r\n}","import { CommonAreaView } from \".\";\r\nimport { Vector } from \"excalibur\";\r\nimport { DevicePlace } from \"./Building\";\r\nimport { DeviceSize } from \"../../values/DeviceSize\";\r\n\r\nexport class SmallRoomThreeView extends CommonAreaView {\r\n    devicePlaceCount = 3\r\n    poly() { return this.angledRoofPoly() }\r\n    //devicePlaces() {\r\n    //    let w = this.getWidth()/2\r\n    //    let x = this.pos.x + w;\r\n    //    let y = this.pos.y + this.getHeight() - this.floorHeight - 10\r\n    //    let ds = [\r\n    //        new Vector(x - w / 2, y),\r\n    //        new Vector(x, y),\r\n    //        new Vector(x + w / 2, y),\r\n    //    ]\r\n\r\n    //    return ds.map(d => new DevicePlace(d, DeviceSize.Small))\r\n    //}\r\n}","import { DeviceSize } from \"../../values/DeviceSize\";\r\nimport { DevicePlace } from \"./Building\";\r\nimport { Vector } from \"excalibur\";\r\nimport { DomeView } from \".\";\r\n\r\nexport class BigDomeView extends DomeView {\r\n\r\n    devicePlaceCount = 3\r\n    // devicePlaces() {\r\n    //     let w = this.getWidth()/2\r\n    //     let x = this.pos.x + w;\r\n    //     let y = this.pos.y + this.getHeight() - 20\r\n    //     let ds = [\r\n    //         new Vector(x - w/3, y),\r\n    //         new Vector(x + w/3, y),\r\n    //     ]\r\n\r\n    //     return ds.map(d => new DevicePlace(d, DeviceSize.Large))\r\n    // }\r\n}","import { DomeView } from \".\";\r\nimport { Vector } from \"excalibur\";\r\nimport { DevicePlace } from \"./Building\";\r\nimport { DeviceSize } from \"../../values/DeviceSize\";\r\n\r\nexport class MidDomeView extends DomeView {\r\n\r\n    devicePlaceCount = 3\r\n    // devicePlaces() {\r\n    //     let w = this.getWidth()/2\r\n    //     let x = this.pos.x + w;\r\n    //     let y = this.pos.y + this.getHeight() - 20\r\n    //     let ds = [\r\n    //         new Vector(x - w/3, y),\r\n    //         new Vector(x + w/3, y),\r\n    //     ]\r\n\r\n    //     return ds.map(d => new DevicePlace(d, DeviceSize.Medium))\r\n    // }\r\n}","import { DomeView } from \".\";\r\nimport { Vector } from \"excalibur\";\r\nimport { DevicePlace } from \"./Building\";\r\nimport { DeviceSize } from \"../../values/DeviceSize\";\r\n\r\nexport class SmallDomeThreeView extends DomeView {\r\n\r\n    devicePlaceCount = 3\r\n    // devicePlaces() {\r\n    //     let w = this.getWidth()/2\r\n    //     let x = this.pos.x + w;\r\n    //     let y = this.pos.y + this.getHeight() - 6\r\n    //     let ds = [\r\n    //         new Vector(x - w/3, y),\r\n    //         new Vector(x, y),\r\n    //         new Vector(x + w/3, y),\r\n    //     ]\r\n\r\n    //     return ds.map(d => new DevicePlace(d, DeviceSize.Small))\r\n    // }\r\n}","import { CorridorView } from \".\";\r\n\r\nexport class SurfaceRoadView extends CorridorView {\r\n    edgeWidth: 0\r\n    colorBase() { return this.color.lighten(0.1); }\r\n\r\n}","import { TunnelView } from \".\";\r\nimport { Orientation } from \"../../values/Orientation\";\r\nimport { Slot } from \"../../values/Slot\";\r\nimport { Vector } from \"excalibur\";\r\nimport { Scale } from \"../../values/Scale\";\r\n\r\nexport class LadderView extends TunnelView {\r\n    originSlot: Slot = null\r\n    slotSize: number = Scale.major.third\r\n    constrainCursor(cursor: Vector): Vector {\r\n       if (this.pickingOrigin) {\r\n\r\n       } else {\r\n           cursor.x = this.pos.x\r\n       }\r\n       return cursor;\r\n    }\r\n\r\n    // minHeight: number = slt\r\n    reshape(cursor: Vector) {\r\n        if (this.pickingOrigin) { \r\n            let theSlot = this.alignToSlot(cursor)\r\n            if (theSlot) {\r\n                this.facing = theSlot.facing\r\n\r\n                if (theSlot) {\r\n                    this.originSlot = theSlot\r\n                }\r\n            }\r\n        } else {\r\n            if (this.facing === Orientation.Up) {\r\n                let maxHeight = this.originSlot.pos.y - this.planet.getTop() - 25\r\n\r\n                let h = Math.min(maxHeight, Math.max(this.slotSize, this.originSlot.pos.y - cursor.y))\r\n                this.setHeight((h/this.slotSize)*this.slotSize + 15)\r\n                this.pos.y = this.originSlot.pos.y - this.getHeight()\r\n            } else {\r\n                let h = Math.max(this.slotSize, cursor.y - this.originSlot.pos.y)\r\n                this.setHeight((h/this.slotSize)*this.slotSize + 15) // - cursor.y))\r\n            }\r\n        }\r\n    }\r\n}","import { DomeView } from \".\";\r\nimport { Color, Vector } from \"excalibur\";\r\nimport { DevicePlace } from \"./Building\";\r\nimport { DeviceSize } from \"../../values/DeviceSize\";\r\n\r\nexport class ArcologyView extends DomeView {\r\n\r\n    devicePlaces() {\r\n        let w = 3*this.getWidth()/5\r\n        let x = this.pos.x + w;\r\n        let y = this.pos.y + this.getHeight()/2\r\n        let ds = [\r\n            new Vector(x, y-800),\r\n            new Vector(x, y),\r\n            new Vector(x, y+800),\r\n        ]\r\n\r\n        return ds.map(d => new DevicePlace(d, DeviceSize.Huge))\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        this.drawShape(ctx, this.pos.x, this.pos.y)\r\n        this.getDevices().forEach(device => device.draw(ctx, delta))\r\n\r\n    }\r\n\r\n    private drawShape(ctx, xoff, yoff) {\r\n        let h = this.getHeight()\r\n        let w = this.getWidth()\r\n        ctx.beginPath();\r\n        ctx.moveTo(0 + xoff, h + yoff);\r\n        ctx.bezierCurveTo(1 + xoff, h - 150 + yoff, 121 + xoff, 70 + yoff, w - 80 + xoff, 8 + yoff);\r\n        ctx.bezierCurveTo(w - 40 + xoff, 2 + yoff, w - 5 + xoff, 11 + yoff, w - 10 + xoff, 25 + yoff);\r\n        ctx.bezierCurveTo(w - 5 + xoff, 10 + yoff, w + xoff, (h-10) + yoff, w + xoff, h + yoff);\r\n        ctx.lineTo(0 + xoff, h + yoff);\r\n        ctx.fillStyle = this.mainColor().toRGBA()\r\n        ctx.fill();\r\n    }\r\n}","import { Vector } from \"excalibur\";\r\nimport { Building } from \"./Building\";\r\nimport { range, eachCons, measureDistance } from \"../../Util\";\r\nimport { Slot } from \"../../values/Slot\";\r\nimport { Orientation, flip } from \"../../values/Orientation\";\r\nimport { Graph } from \"../../values/Graph\";\r\nimport { drawRect } from \"../../Painting\";\r\nimport { Scale } from \"../../values/Scale\";\r\n\r\nexport class TunnelView extends Building {\r\n    slotSize: number = Scale.major.third // + 10\r\n    pickingOrigin: boolean = true\r\n    hideBox = true\r\n\r\n    colorBase() { return this.planet.color.darken(0.2); }\r\n\r\n    draw(ctx, delta) {\r\n        let rect = this.aabb()\r\n        drawRect(ctx, rect, this.color.darken(0.1)) \r\n\r\n        let n = 5\r\n        rect.x = rect.x + this.getWidth() / n\r\n        rect.width -= (2) * (this.getWidth() / n)\r\n        drawRect(ctx, rect, this.color.darken(0.2)) \r\n        // super.draw(ctx, delta)\r\n    }\r\n\r\n    nodes(): Vector[] {\r\n        let x = this.pos.x + this.getWidth()/2;\r\n        let y = this.pos.y\r\n        return [\r\n            new Vector(Math.floor(x), y)\r\n        ];\r\n    }\r\n\r\n    graph(supergraph: Graph<Vector> = new Graph()): Graph<Vector> {\r\n        let g = supergraph;\r\n\r\n        let halfWidth = this.getWidth()/2\r\n        let x = this.pos.x + halfWidth\r\n\r\n        let root = g.findOrCreate(this.nodes()[0], measureDistance)\r\n        let first = g.findOrCreate(new Vector(x,this.slotHeights()[0]), measureDistance)\r\n        g.edge(root,first)\r\n\r\n        let heights = this.slotHeights()\r\n\r\n        eachCons(heights, 2).forEach(([y0,y1]: [number,number]) => {\r\n            let top = g.findOrCreate(new Vector(x,y0), measureDistance)\r\n            let btm = g.findOrCreate(new Vector(x,y1), measureDistance)\r\n            g.edge(top, btm)\r\n        })\r\n\r\n        let btm = g.findOrCreate(new Vector(x, this.pos.y + this.getHeight()), measureDistance)\r\n        let lst = g.findOrCreate(new Vector(x, heights[heights.length-1]), measureDistance)\r\n        g.edge(btm,lst)\r\n\r\n        heights.forEach(y1 => {\r\n            let btm = g.findOrCreate(new Vector(x,y1), measureDistance)\r\n\r\n            let left = g.findOrCreate(new Vector(x-halfWidth,y1), measureDistance)\r\n            g.edge(left,btm)\r\n\r\n            let right = g.findOrCreate(new Vector(x+halfWidth,y1), measureDistance)\r\n            g.edge(btm,right)\r\n        });\r\n\r\n        for (let child of this.childrenBuildings) {\r\n            let slot = g.findOrCreate(child.parentSlot.pos, measureDistance)\r\n            let childNode = g.findOrCreate(child.nodes()[0], measureDistance)\r\n            g.edge(childNode, slot)\r\n            g.edge(slot, childNode)\r\n\r\n            child.graph(g)\r\n        }\r\n\r\n        return g;\r\n    }\r\n\r\n    private slotHeights() {\r\n            // let minDepth = Scale.major.eighth + 50\r\n            // let buffer = 20\r\n\r\n        // let slotSize = Scale.major.eighth + 5 //minDepth + buffer\r\n        let slotCount = Math.floor((this.getHeight()) / this.slotSize)\r\n        let heights = []\r\n\r\n        let y = this.pos.y // + minDepth + buffer\r\n\r\n        if (slotCount > 0) {\r\n            for (let i of range(slotCount)) {\r\n                heights.push(\r\n                    y + ((i+1) * this.slotSize),\r\n                )\r\n            }\r\n        } else {\r\n            heights.push(this.slotSize)\r\n        }\r\n        return heights\r\n    }\r\n\r\n    slots() {\r\n        let theSlots: Slot[] = []\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth()/2,\r\n                this.pos.y,\r\n                Orientation.Up\r\n            )\r\n        )\r\n\r\n        for (let y of this.slotHeights()) {\r\n            theSlots.push(\r\n                this.buildSlot(\r\n                    this.pos.x, y,\r\n                    Orientation.Left\r\n                )\r\n            )\r\n\r\n            theSlots.push(\r\n                this.buildSlot(\r\n                    this.pos.x + this.getWidth(),\r\n                    y,\r\n                    Orientation.Right,\r\n                )\r\n            )\r\n        }\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth()/2,\r\n                this.pos.y + this.getHeight(),\r\n                Orientation.Down\r\n            )\r\n        )\r\n        return theSlots;\r\n    } \r\n\r\n    handleClick(cursor: Vector) {\r\n        if (this.pickingOrigin) {\r\n            this.pickingOrigin = false;\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    constrainCursor(cursor: Vector): Vector {\r\n        if (this.pickingOrigin) {\r\n            // this.alignToSlot(cursor)\r\n        } else {\r\n            // cursor.y = Math.max(this.planet.getTop() + 100, cursor.y)\r\n        }\r\n        return cursor;\r\n    }\r\n\r\n    reshape(cursor: Vector) {\r\n        // this.pos.y = this.planet.getTop() + 2\r\n        if (this.pickingOrigin) {\r\n            this.alignToSlot(cursor)\r\n        } // else {\r\n            // min depth/height has to be at least \r\n            // let minDepth = Scale.major.eighth\r\n            // let buffer = 100\r\n\r\n            let depth = \r\n                (this.slotSize * Math.floor(Math.abs(cursor.y - this.planet.getTop()) / this.slotSize)) + 15\r\n\r\n          this.setHeight(\r\n              Math.max(depth, this.slotSize + 15)\r\n          )\r\n        // }\r\n    }\r\n\r\n}","import { Color, Vector } from \"excalibur\";\r\nimport { Building, DevicePlace } from \"./Building\";\r\nimport { Orientation } from \"../../values/Orientation\";\r\nimport { DeviceSize, getVisibleDeviceSize } from \"../../values/DeviceSize\";\r\nimport { Graph } from \"../../values/Graph\";\r\nimport { measureDistance, eachCons } from \"../../Util\";\r\n\r\nexport class DomeView extends Building {\r\n    hideBox = true\r\n    showLabel = true\r\n\r\n    graph(sg) {\r\n        let g = super.graph(sg)\r\n        let find = (s: Vector) => g.findOrCreate(s, measureDistance)\r\n\r\n        let slots: Vector[] = this.slots().map(s => s.pos)\r\n        let leftSlot = find(slots[0]), rightSlot = find(slots[slots.length-1])\r\n        let devices = this.deviceInteractionPlaces().map(position => find(position))\r\n        g.edge(leftSlot, devices[0])\r\n        eachCons(devices, 2).forEach(([left, right]) => g.edge(left, right))\r\n        g.edge(devices[devices.length-1], rightSlot)\r\n\r\n        let node = this.nodes()[0]\r\n        devices.forEach(device => g.edge(device, find(node)))\r\n\r\n        return g\r\n\r\n    }\r\n\r\n    slots() {\r\n        let theSlots = [];\r\n        let slotY = this.getHeight();\r\n\r\n        let buffer = this.getWidth() / 4\r\n\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x - buffer, this.pos.y + slotY,\r\n                Orientation.Left\r\n            )\r\n        )\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth() + buffer,\r\n                this.pos.y + slotY,\r\n                Orientation.Right\r\n            )\r\n        )\r\n\r\n        return theSlots;\r\n    } \r\n\r\n    //reshape(cursor: Vector) {\r\n    //    this.alignToSlot(cursor)\r\n    //}\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n        let color: Color = this.mainColor()\r\n\r\n        let h = this.getHeight() //getWidth()/2\r\n\r\n        ctx.beginPath()\r\n        ctx.arc(\r\n            this.pos.x + this.getWidth()/2,\r\n            this.pos.y + h, //this.getHeight(),\r\n            this.getWidth()/1.5,\r\n            0,\r\n            Math.PI,\r\n            true\r\n        )\r\n        ctx.closePath()\r\n        ctx.fillStyle = color.toRGBA()\r\n        ctx.fill()\r\n\r\n        super.draw(ctx, delta)\r\n    }\r\n\r\n    colorBase() { return Color.White.clone().darken(0.05); } \r\n\r\n    deviceSize = DeviceSize.Small\r\n    devicePlaceCount = 2\r\n    devicePlaces() {\r\n        let w = this.getWidth()/2\r\n        let x = this.pos.x + w;\r\n        let y = this.pos.y + this.getHeight() - getVisibleDeviceSize(this.deviceSize)/3 // - 16\r\n        let ds = [\r\n            new Vector(x - w/3, y),\r\n            ...(this.devicePlaceCount === 3 ? [new Vector(x,y)] : []),\r\n            new Vector(x + w/3, y),\r\n        ]\r\n\r\n        return ds.map(d => new DevicePlace(d, this.deviceSize)) // DeviceSize.Small))\r\n    }\r\n}","import { Building, DevicePlace } from \"./Building\";\r\nimport { Orientation } from \"../../values/Orientation\";\r\nimport { Slot } from \"../../values/Slot\";\r\nimport { Vector, Color } from \"excalibur\";\r\nimport { DeviceSize, getVisibleDeviceSize } from \"../../values/DeviceSize\";\r\nimport { drawRect, drawPatternedPoly, drawPoly } from \"../../Painting\";\r\nimport { measureDistance, eachCons } from \"../../Util\";\r\n\r\nexport class CommonAreaView extends Building {\r\n    get floorHeight() { return this.getHeight() / 6 }\r\n    edgeWidth: number = 0\r\n    showLabel = true\r\n    hideBox = true\r\n\r\n    colorBase() { return this.color.darken(0.3); }\r\n\r\n    poly() { return this.aabbPoly() }\r\n\r\n    get floorY() {\r\n        return this.pos.y + this.getHeight() - this.floorHeight\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, delta: number) {\r\n\r\n\r\n        drawPatternedPoly(\r\n            ctx,\r\n            this.poly(),\r\n            this.backgroundPattern,\r\n            this.mainColor()\r\n        )\r\n\r\n        if (!this.isActive) {\r\n            let c = Color.Black.clone()\r\n            c.a = 0.6\r\n            drawPoly(ctx, this.poly(), c)\r\n        }\r\n\r\n        let floorEdgeHeight = 12 // 6\r\n        let floorColor = this.planet.color.darken(0.6)\r\n        let floorOff = -5\r\n        drawRect(\r\n            ctx,\r\n            { x: this.x, y: this.y + this.getHeight() - this.floorHeight - floorEdgeHeight,\r\n              width: this.getWidth(), height: floorEdgeHeight - floorOff },\r\n            //   0,\r\n              floorColor.lighten(0.4)\r\n        )\r\n\r\n        drawRect(\r\n            ctx,\r\n            { x: this.x, y: this.y + this.getHeight() - this.floorHeight - floorOff,\r\n              width: this.getWidth(), height: this.floorHeight + floorOff },\r\n            //   0,\r\n              floorColor\r\n        )\r\n\r\n        super.draw(ctx, delta)\r\n    }\r\n\r\n\r\n    slots() {\r\n        let theSlots = []\r\n        let slotY = this.getHeight() - this.floorHeight\r\n        let leftSlot: Slot = this.buildSlot(\r\n            this.pos.x,\r\n            this.pos.y + slotY,\r\n            Orientation.Left,\r\n        )\r\n        theSlots.push(leftSlot)\r\n\r\n        let rightSlot: Slot = this.buildSlot(\r\n            this.pos.x + this.getWidth(),\r\n            this.pos.y + slotY,\r\n            Orientation.Right,\r\n        )\r\n        theSlots.push(rightSlot)\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth()/2,\r\n                this.pos.y,\r\n                Orientation.Up\r\n            )\r\n        )\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth()/2,\r\n                this.pos.y + this.getHeight(),\r\n                Orientation.Down\r\n            )\r\n        )\r\n        return theSlots;\r\n    }\r\n\r\n    nodes(): Vector[] {\r\n        let x = this.pos.x + this.getWidth()/2;\r\n        let y = this.pos.y + this.getHeight()-this.floorHeight\r\n        return [\r\n            new Vector(Math.floor(x), Math.floor(y))\r\n        ];\r\n    }\r\n\r\n    graph(sg) {\r\n        let g = super.graph(sg)\r\n        let slots: Slot[] = this.slots()\r\n        let find = (s: Vector) => g.findOrCreate(s, measureDistance)\r\n        let leftSlot = find(slots[0].pos), rightSlot = find(slots[1].pos)\r\n        let devices = this.deviceInteractionPlaces().map(p => find(p))\r\n        g.edge(leftSlot, devices[0])\r\n        eachCons(devices, 2).forEach(([left, right]) => g.edge(left, right))\r\n        g.edge(devices[devices.length-1], rightSlot)\r\n\r\n        let node = this.nodes()[0]\r\n        devices.forEach(device => g.edge(device, find(node)))\r\n        return g\r\n    }\r\n  \r\n    reshape(cursor) {\r\n        this.alignToSlot(cursor);\r\n    }\r\n\r\n    devicePlaces() {\r\n        let w = this.getWidth()/2\r\n        let x = this.pos.x + w;\r\n        let y = this.pos.y + this.getHeight() - this.floorHeight - 10 \r\n        y -= getVisibleDeviceSize(this.devicePlaceSize) / 3.5 ///2\r\n\r\n        let ds = [\r\n            new Vector(x - w/2, y),\r\n            ...(this.devicePlaceCount > 2 ? [new Vector(x,y)] : []),\r\n            new Vector(x + w/2, y),\r\n        ]\r\n\r\n        return ds.map(d => new DevicePlace(d, this.devicePlaceSize)) \r\n        //DeviceSize.Small))\r\n    }\r\n\r\n    devicePlaceSize: DeviceSize = DeviceSize.Small\r\n    devicePlaceCount: number = 2\r\n}","import { Building } from \"./Building\";\r\nimport { Vector } from \"excalibur\";\r\nimport { Orientation } from \"../../values/Orientation\";\r\nimport { Slot } from \"../../values/Slot\";\r\n\r\nexport class CorridorView extends Building {\r\n    edgeWidth: number = 0\r\n\r\n    pickingOrigin: boolean = true\r\n    facing: Orientation = Orientation.Left\r\n\r\n   nodes(): Vector[] {\r\n        let x = this.pos.x + this.getWidth()/2;\r\n        let y = this.pos.y + 3*this.getHeight()/4\r\n        return [\r\n            new Vector(Math.floor(x), Math.floor(y))\r\n        ];\r\n    }\r\n    colorBase() { return this.color.darken(0.2); }\r\n\r\n    slots() {\r\n        let theSlots: Slot[] = [];\r\n        let slotY = 3 * this.getHeight() / 4;\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x, this.pos.y + slotY,\r\n                Orientation.Left\r\n            )\r\n        )\r\n\r\n        theSlots.push(\r\n            this.buildSlot(\r\n                this.pos.x + this.getWidth(),\r\n                this.pos.y + slotY,\r\n                Orientation.Right\r\n            )\r\n        )\r\n\r\n        return theSlots;\r\n    } \r\n\r\n    \r\n    handleClick(cursor: Vector) {\r\n        if (this.pickingOrigin) {\r\n            this.pickingOrigin = false;\r\n            this.reshape(this.constrainCursor(cursor))\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    constrainCursor(cursor: Vector): Vector {\r\n        let newCursor = cursor.clone();\r\n        if (this.pickingOrigin) {\r\n        } else {\r\n            newCursor.y = this.pos.y\r\n        }\r\n\r\n        return newCursor;\r\n    }\r\n\r\n    originX: number = 0\r\n    reshape(cursor: Vector) {\r\n\r\n        if (this.pickingOrigin) {\r\n            let theSlot = this.alignToSlot(cursor)\r\n            if (theSlot) {\r\n                this.facing = theSlot.facing\r\n\r\n                if (theSlot && this.facing === Orientation.Left) {\r\n                    this.originX = theSlot.pos.x\r\n                }\r\n            }\r\n\r\n        } else {\r\n            if (this.facing === Orientation.Left) {\r\n                this.setWidth(Math.abs(this.originX - cursor.x))\r\n                this.pos.x = this.originX - this.getWidth()\r\n            } else {\r\n                this.setWidth(Math.abs(this.pos.x - cursor.x))\r\n            }\r\n        }\r\n    }\r\n}","module.exports = __webpack_public_path__ + \"0a266eded2bf27831b18735ffc081448.png\";","module.exports = __webpack_public_path__ + \"2475589a97ba4901bfa7ab53b5487778.png\";","module.exports = __webpack_public_path__ + \"98240dde9344ac8d071d076ac951e15d.png\";","module.exports = __webpack_public_path__ + \"da31cf43235263c1c3e0ad45a46360a1.png\";","module.exports = __webpack_public_path__ + \"a6a38278ac501400c6199e0df9e1bf84.png\";","module.exports = __webpack_public_path__ + \"ece1d5d5858bc048d2d949ecc3f5e9bc.png\";","module.exports = __webpack_public_path__ + \"3654f0489813e0668743efde017c9653.png\";","module.exports = __webpack_public_path__ + \"3abbdabf07943966f102ac7345a59986.png\";","module.exports = __webpack_public_path__ + \"d1b4690b9f5fa4957f98602afc8cfdb6.png\";","module.exports = __webpack_public_path__ + \"0eb7a15ea04678b14a2b88b5965aabeb.png\";","module.exports = __webpack_public_path__ + \"0bd75ea6429e913502be7c59f8c485a2.svg\";","module.exports = __webpack_public_path__ + \"490d8337dc1436fdb073e0ce7c1aa4e2.svg\";","module.exports = __webpack_public_path__ + \"9a1897cb324167653e7d23e377df09f7.svg\";","module.exports = __webpack_public_path__ + \"f74ccf77b74f12d78334366e7365d1ee.svg\";","module.exports = __webpack_public_path__ + \"d754bb375d83b60c875254997ad378af.svg\";","module.exports = __webpack_public_path__ + \"48be2487ecb6d75a112437662b61e05d.svg\";","module.exports = __webpack_public_path__ + \"c39dae9d5741e8fcd6c6a812b599a99c.svg\";","module.exports = __webpack_public_path__ + \"f91c0d7d285b0686ece2084cc3640bce.svg\";","module.exports = __webpack_public_path__ + \"824e22e59890ae78258b54985e42ca6d.svg\";","module.exports = __webpack_public_path__ + \"dfe6e4db2f0c22d18befa85c1e163369.svg\";","module.exports = __webpack_public_path__ + \"9a947d50110c1d1db07c76a4bba2e653.svg\";","module.exports = __webpack_public_path__ + \"4976b6042ef557ca6085c8d0168251f4.svg\";","module.exports = __webpack_public_path__ + \"46418cf15643d9b1b171c1b64160a5af.svg\";","module.exports = __webpack_public_path__ + \"36a02c2483b688be86ce07bea4bd7295.svg\";","module.exports = __webpack_public_path__ + \"29c5f1be64c99bbc14d5063eea2f0953.svg\";","module.exports = __webpack_public_path__ + \"502f86b65239e20806bbae8bc77a6116.svg\";","module.exports = __webpack_public_path__ + \"5289b20985e3c3a98081267a2da1772e.svg\";","module.exports = __webpack_public_path__ + \"1d893905e4eea3bbc48b0e129e318ea6.svg\";","module.exports = __webpack_public_path__ + \"bd556d00e484db4e52d198d0bf39d0f2.svg\";","module.exports = __webpack_public_path__ + \"650cd431226df0755357c71d61bef1f2.svg\";","module.exports = __webpack_public_path__ + \"f12c591f538ab3026bf13e93f3fa9485.svg\";","module.exports = __webpack_public_path__ + \"3aeb9dd24809ba3fbd4eeb31a28c3b19.svg\";","module.exports = __webpack_public_path__ + \"6cc6f6773bb6eb26fcef87b9629f7b87.svg\";","module.exports = __webpack_public_path__ + \"43062e54318df93f49e2be9a4281eb4a.svg\";","module.exports = __webpack_public_path__ + \"24611230ec712ba7ee38b99561aedd87.svg\";","module.exports = __webpack_public_path__ + \"c4ab2ceb2f61e18493fc776770c65654.svg\";","module.exports = __webpack_public_path__ + \"bbd50a175546bd70d21c5eadbc30d479.svg\";","module.exports = __webpack_public_path__ + \"7441c2ab240d0f733451d75204ac0792.svg\";","module.exports = __webpack_public_path__ + \"91a8cce06c3c05ce6e4b176afafd7b0a.svg\";","module.exports = __webpack_public_path__ + \"0ce4f9c3384680565b6bb16495b64233.svg\";","module.exports = __webpack_public_path__ + \"1db542acabeb82ec8da785e77afd4dca.svg\";","import { ResourceBlock } from \"./Economy\";\r\n\r\nexport type MechanicalOperation =\r\n    Recipe |\r\n    ResourceGenerator |\r\n    ResourceStorage |\r\n    SpawnClone |\r\n    AccelerateTime |\r\n    ExploreForResource |\r\n    Noop\r\n\r\nexport interface Noop {\r\n    type: 'noop'\r\n}\r\n\r\nexport interface Recipe {\r\n    type: 'recipe'\r\n    consumes: ResourceBlock[]\r\n    produces: ResourceBlock\r\n    workTime: number\r\n}\r\n\r\nexport interface ResourceGenerator {\r\n    type: 'generator'\r\n    generates: ResourceBlock\r\n    generationTime: number\r\n    capacity: number\r\n}\r\n\r\nexport interface ResourceStorage {\r\n    type: 'store'\r\n    stores: ResourceBlock[]\r\n    capacity: number\r\n}\r\n\r\nexport interface SpawnClone {\r\n    type: 'spawn'\r\n}\r\n\r\nexport interface AccelerateTime {\r\n    type: 'accelerate'\r\n    factor: number\r\n}\r\n\r\nexport interface ExploreForResource {\r\n    type: 'explore'\r\n    gathers: ResourceBlock\r\n    capacity: number\r\n}\r\n\r\nfunction store(res: ResourceBlock[], capacity: number = 10): ResourceStorage {\r\n    return {\r\n        type: 'store',\r\n        stores: res,\r\n        capacity\r\n    }\r\n}\r\n\r\nfunction generate(res: ResourceBlock, cap: number = 4): ResourceGenerator {\r\n    return {\r\n        type: 'generator',\r\n        generates: res,\r\n        generationTime: 1000,\r\n        capacity: cap\r\n    }\r\n}\r\n\r\nfunction recipe(input: ResourceBlock[], output: ResourceBlock): Recipe {\r\n    return {\r\n        type: 'recipe',\r\n        consumes: input,\r\n        produces: output,\r\n        workTime: 1000,\r\n    }\r\n}\r\n\r\nfunction spawn(): SpawnClone {\r\n    return {\r\n        type: 'spawn',\r\n    }\r\n}\r\n\r\nfunction accelerateTime(): AccelerateTime {\r\n    return {\r\n        type: 'accelerate',\r\n        factor: 2\r\n    }\r\n}\r\n\r\nfunction explore(block: ResourceBlock, cap: number = 4): ExploreForResource {\r\n    return {\r\n        type: 'explore',\r\n        gathers: block,\r\n        capacity: cap\r\n    }\r\n}\r\n\r\nexport const mechanicalOperations = {\r\n    store,\r\n    generate,\r\n    recipe,\r\n    spawn,\r\n    accelerateTime,\r\n    explore,\r\n}","import { Scene, Timer, Engine, Actor } from \"excalibur\";\r\nimport { Planet } from \"../actors/Planet/Planet\";\r\nimport { Player } from \"../actors/player\";\r\nimport { Game } from \"../Game\";\r\nimport { CloneReception, Kitchen, Workshop, Archive, Refinery, Mine } from \"../models/RoomRecipe\";\r\nimport { Orientation } from \"../values/Orientation\";\r\nimport { GameController } from \"../GameController\";\r\nimport { Construction } from \"../Construction\";\r\n\r\nexport class Play extends Scene {\r\n    private controller: GameController\r\n    private planet: Planet\r\n    private time: number = Game.startHour*60\r\n    private construction: Construction\r\n\r\n    public onInitialize(game: Game) {\r\n        this.planet = new Planet(this)\r\n        this.add(this.planet)\r\n        this.construction = new Construction(this.planet, game,\r\n            \"Welcome to the Colony, sir... \"\r\n            + \"We are what is left of the crew of the Osiris. \"\r\n            + \"Can you help us build a functioning society? \"\r\n            + \"First, choose a location for the Command post. \"\r\n            + \"Then we'll lay out some infrastructure.\"\r\n        )\r\n        this.addTimer(\r\n            new Timer(() => { this.stepTime() }, this.timeStepIntervalMillis, true)\r\n        )\r\n        this.addTimer(\r\n            new Timer(() => {\r\n                this.planet.sendRaidingParty()\r\n            }, Game.raidingPartyFrequency, true)\r\n        )\r\n    }\r\n\r\n    public onActivate() {\r\n        this.add(this.construction)\r\n        this.controller = new GameController(this.engine, this.camera)\r\n        this.construction.standup(this.controller)\r\n        this.controller.activate()\r\n        this.camera.zoom(0.25)\r\n    }\r\n\r\n    public onDeactivate() {\r\n        this.construction.teardown()\r\n        this.controller.deactivate()\r\n    }\r\n\r\n    timeStepIntervalMillis: number = 50\r\n    private stepTime() { \r\n        this.time += this.timeStepIntervalMillis / Game.minuteTickMillis\r\n        this.planet.setTime(this.time) \r\n        // this.construction.setT\r\n    }\r\n} ","module.exports = __webpack_public_path__ + \"37914c496c3c503f7a53d7c9a1457b53.mp3\";","module.exports = __webpack_public_path__ + \"1b8e735649248c4c552a84996e61f241.mp3\";","module.exports = __webpack_public_path__ + \"1a607294aebce07746d6f25ffa517d80.mp3\";","module.exports = __webpack_public_path__ + \"22bdefc1e8515661fdeb8e8076820641.mp3\";","module.exports = __webpack_public_path__ + \"cf150ab26eba01503f4f6dc3d9ab47f7.mp3\";","module.exports = __webpack_public_path__ + \"94754f62e0ae4d23d386e246f5e0cb6e.png\";","import { Game } from './Game';\r\nimport { World } from './models/World';\r\nimport { Play } from './scenes/Play';\r\nimport { Arena } from './scenes/Arena';\r\nimport { Menu } from './scenes/Menu';\r\nimport { Sandbox } from './scenes/Sandbox';\r\n\r\nconst theWorld = new World();\r\nconst game = new Game(theWorld);\r\n\r\nconst menu = new Menu(game)\r\ngame.add('menu', menu)\r\n\r\nconst play = new Play(game);\r\ngame.add('play', play);\r\n\r\nconst arena = new Arena(game)\r\ngame.add('arena', arena)\r\n\r\nconst sandbox = new Sandbox(game)\r\ngame.add('sandbox', sandbox)\r\n\r\ngame.start().then(() => {\r\n  game.goToScene('menu')\r\n});\r\n"],"sourceRoot":""}